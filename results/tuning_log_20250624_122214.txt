2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO - 전달받은 데이터 사용: (1333765, 33)
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO - 모델 타입: random_forest
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed/processed_data_with_features.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'onehot', 'drop_first': True, 'sparse': False}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'none', 'with_mean': False, 'with_std': False}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 5, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'pr_auc', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'metrics': {'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy', 'pr_auc'], 'regression_metrics': ['mae', 'rmse', 'r2'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2', 'pr_auc']}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'random_forest', 'random_forest': {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'bootstrap': True, 'oob_score': True, 'max_samples': 0.8, 'class_weight': 'balanced', 'sample_weight': 'auto', 'n_jobs': 28, 'random_state': 42, 'min_impurity_decrease': 0.0, 'min_weight_fraction_leaf': 0.0, 'max_leaf_nodes': None, 'ccp_alpha': 0.0, 'criterion': 'gini', 'max_features_regression': 'sqrt', 'min_impurity_decrease_regression': 0.0, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'sample_weight': 'auto'}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 100, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 12:22:14,422 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 12:22:14,446 - __main__ - INFO - MLflow Run 시작: 790ace0ee64c4612af44c4a87c8509f4
2025-06-24 12:22:14,449 - __main__ - INFO - 튜닝 파라미터 로깅 완료: 6개 파라미터
2025-06-24 12:22:14,449 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 최적화 시작
2025-06-24 12:22:14,454 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = random_forest
2025-06-24 12:22:16,480 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:22:16,480 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:22:16,480 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:22:16,480 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:22:16,480 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:22:16,480 - src.training - INFO - 교차 검증 시작
2025-06-24 12:22:16,480 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:22:16,499 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:22:16,964 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:22:16,964 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:22:16,964 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:22:16,964 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:22:16,964 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:22:16,964 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:22:16,964 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:22:16,964 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:22:16,964 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:22:17,134 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:22:17,135 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:22:17,135 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:22:17,135 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:22:17,135 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:22:17,135 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:22:17,135 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:22:17,135 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:22:17,135 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:22:17,135 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:22:18,625 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:22:19,688 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:22:19,688 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:22:19,692 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:22:19,723 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:22:19,723 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:22:19,724 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:22:19,724 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:22:20,982 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:22:21,236 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:22:21,236 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:22:21,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:22:21,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:22:21,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:22:21,433 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:22:21,433 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:22:21,433 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:22:21,433 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:22:21,434 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:21,434 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:22:21,482 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:22:21,482 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:22:21,482 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:21,482 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:21,482 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:22:21,482 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:22:21,482 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:21,540 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:22:21,541 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:22:21,541 - src.training - INFO - 모델 학습 시작
2025-06-24 12:22:21,653 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:22:21,653 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:22:21,653 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:22:21,653 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:22:21,653 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:22:21,654 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:22:21,654 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:22:21,654 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:22:21,654 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:22:21,654 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:22:21,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:22:21,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:21,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:22:21,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:21,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:21,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:21,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:21,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:21,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:22:21,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:22,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:22:22,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:22,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:22:22,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:22,049 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:22:22,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:22,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:22,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:22,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:22,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:22,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:22:22,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:22,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:22:22,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:22,139 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:22:22,139 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:22,139 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   n_estimators: 218
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:22:22,152 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:22:40,382 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:22:40,382 - src.models.random_forest_model - INFO -   - 트리 개수: 218
2025-06-24 12:22:40,382 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:22:40,382 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:22:40,382 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:22:40,382 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:22:40,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:22:40,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:40,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:22:40,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:40,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:40,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:40,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:40,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:40,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:22:40,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:40,473 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:22:40,580 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:22:40,580 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:22:40,580 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:22:40,580 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:22:40,580 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:22:40,580 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:22:40,580 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:22:40,580 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:22:40,583 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:22:40,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:22:40,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:22:40,588 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:22:41,814 - src.training - INFO -   precision: 0.001143728555089592
2025-06-24 12:22:41,814 - src.training - INFO -   recall: 0.011111111111111112
2025-06-24 12:22:41,814 - src.training - INFO -   f1: 0.002073971655720705
2025-06-24 12:22:41,814 - src.training - INFO -   accuracy: 0.9869331040101385
2025-06-24 12:22:41,814 - src.training - INFO -   balanced_accuracy: 0.49961908933903315
2025-06-24 12:22:41,814 - src.training - INFO -   positive_samples: 270
2025-06-24 12:22:41,814 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:22:41,814 - src.training - INFO -   total_samples: 220940
2025-06-24 12:22:41,814 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:22:41,814 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:22:41,814 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:22:41,814 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:22:41,814 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:22:41,814 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:22:41,814 - src.training - INFO - 모델 학습 완료
2025-06-24 12:22:41,814 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.001143728555089592, 'recall': 0.011111111111111112, 'f1': 0.002073971655720705, 'accuracy': 0.9869331040101385, 'balanced_accuracy': 0.49961908933903315, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:22:41,814 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:41,814 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:41,814 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:41,814 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:41,832 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:22:41,832 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:22:42,284 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = random_forest
2025-06-24 12:22:44,085 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:22:44,085 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:22:44,085 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:22:44,085 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:22:44,086 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:22:44,086 - src.training - INFO - 교차 검증 시작
2025-06-24 12:22:44,086 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:22:44,104 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:22:44,574 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:22:44,574 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:22:44,574 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:22:44,574 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:22:44,574 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:22:44,574 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:22:44,574 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:22:44,574 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:22:44,574 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:22:44,745 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:22:44,745 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:22:44,745 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:22:44,745 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:22:46,241 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:22:47,414 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:22:47,414 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:22:47,420 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:22:47,453 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:22:47,453 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:22:47,453 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:22:47,453 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:22:48,855 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:22:49,134 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:22:49,134 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:22:49,301 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:22:49,301 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:22:49,344 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:22:49,344 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:22:49,344 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:22:49,344 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:22:49,344 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:22:49,344 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:49,344 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:22:49,387 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:22:49,387 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:22:49,387 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:49,387 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:49,387 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:22:49,387 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:22:49,387 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:49,452 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:22:49,452 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:22:49,452 - src.training - INFO - 모델 학습 시작
2025-06-24 12:22:49,568 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:22:49,568 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:22:49,568 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:22:49,568 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:22:49,568 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:22:49,568 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:22:49,568 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:22:49,568 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:22:49,568 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:22:49,568 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:22:49,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:22:49,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:49,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:22:49,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:49,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:49,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:49,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:49,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:49,946 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:22:49,946 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:50,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:22:50,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:50,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:22:50,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:50,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:22:50,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:22:50,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:22:50,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:22:50,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:22:50,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:22:50,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:22:50,092 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:22:50,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:22:50,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:50,107 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:22:50,107 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:22:50,107 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   n_estimators: 440
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   max_depth: 13
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:22:50,119 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:22,922 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:23:22,922 - src.models.random_forest_model - INFO -   - 트리 개수: 440
2025-06-24 12:23:22,922 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:23:22,922 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:23:22,922 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:23:22,922 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:23:22,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:23:22,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:22,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:22,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:22,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:22,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:22,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:22,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:22,999 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:23:22,999 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:23,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:23:23,199 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:23:23,200 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:23:23,200 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:23:23,200 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:23:23,200 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:23,200 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:23,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:23:23,200 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:23:23,203 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:23:23,207 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:23:23,208 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:23:23,208 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:23:24,386 - src.training - INFO -   precision: 0.003254552499031383
2025-06-24 12:23:24,386 - src.training - INFO -   recall: 0.15555555555555556
2025-06-24 12:23:24,386 - src.training - INFO -   f1: 0.006375711574952561
2025-06-24 12:23:24,386 - src.training - INFO -   accuracy: 0.9407486195347153
2025-06-24 12:23:24,386 - src.training - INFO -   balanced_accuracy: 0.548632447646813
2025-06-24 12:23:24,386 - src.training - INFO -   positive_samples: 270
2025-06-24 12:23:24,386 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:23:24,386 - src.training - INFO -   total_samples: 220940
2025-06-24 12:23:24,386 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:23:24,386 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:23:24,386 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:23:24,386 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:23:24,386 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:23:24,386 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:23:24,387 - src.training - INFO - 모델 학습 완료
2025-06-24 12:23:24,387 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003254552499031383, 'recall': 0.15555555555555556, 'f1': 0.006375711574952561, 'accuracy': 0.9407486195347153, 'balanced_accuracy': 0.548632447646813, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:23:24,387 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:24,387 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:24,387 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:24,387 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:24,404 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:23:24,404 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:23:24,851 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = random_forest
2025-06-24 12:23:26,737 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:23:26,737 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:23:26,737 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:23:26,737 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:23:26,738 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:23:26,738 - src.training - INFO - 교차 검증 시작
2025-06-24 12:23:26,738 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:23:26,754 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:23:27,187 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:23:27,188 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:23:27,188 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:23:27,188 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:23:27,188 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:23:27,188 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:23:27,188 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:23:27,188 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:23:27,188 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:23:27,369 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:23:27,369 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:23:27,369 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:23:27,369 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:23:27,369 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:23:27,370 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:23:27,370 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:23:27,370 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:23:27,370 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:23:27,370 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:23:28,740 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:23:29,805 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:23:29,805 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:23:29,811 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:23:29,842 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:23:29,842 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:23:29,842 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:23:29,842 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:23:31,120 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:23:31,375 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:23:31,376 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:23:31,535 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:23:31,535 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:23:31,576 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:23:31,576 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:23:31,577 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:23:31,577 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:23:31,577 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:23:31,577 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:31,577 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:31,626 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:23:31,626 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:23:31,626 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:31,626 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:31,626 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:23:31,626 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:23:31,626 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:31,684 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:23:31,684 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:23:31,684 - src.training - INFO - 모델 학습 시작
2025-06-24 12:23:31,798 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:23:31,798 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:23:31,798 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:23:31,798 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:23:31,798 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:23:31,798 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:23:31,798 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:23:31,798 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:23:31,798 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:23:31,798 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:23:31,798 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:23:31,798 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:31,798 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:31,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:31,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:31,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:32,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:32,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:32,124 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:23:32,124 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:32,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:23:32,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:32,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:23:32,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:32,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:32,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:32,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:32,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:32,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:32,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:32,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:23:32,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:32,283 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:23:32,283 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:32,283 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:23:32,283 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:32,283 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:23:32,296 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:23:32,296 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:23:32,296 - src.models.random_forest_model - INFO -   n_estimators: 132
2025-06-24 12:23:32,296 - src.models.random_forest_model - INFO -   max_depth: 6
2025-06-24 12:23:32,296 - src.models.random_forest_model - INFO -   min_samples_split: 7
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:23:32,297 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:32,297 - src.hyperparameter_tuning - ERROR - Trial 2 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:23:32,744 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = random_forest
2025-06-24 12:23:34,583 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:23:34,583 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:23:34,583 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:23:34,583 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:23:34,583 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:23:34,583 - src.training - INFO - 교차 검증 시작
2025-06-24 12:23:34,583 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:23:34,601 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:23:35,038 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:23:35,038 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:23:35,038 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:23:35,038 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:23:35,038 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:23:35,038 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:23:35,038 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:23:35,038 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:23:35,038 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:23:35,226 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:23:35,226 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:23:35,226 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:23:35,226 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:23:36,597 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:23:37,670 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:23:37,670 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:23:37,676 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:23:37,708 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:23:37,708 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:23:37,708 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:23:37,708 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:23:38,989 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:23:39,246 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:23:39,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:23:39,405 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:23:39,405 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:23:39,446 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:23:39,446 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:23:39,446 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:23:39,446 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:23:39,446 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:23:39,446 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:39,446 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:39,494 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:23:39,495 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:23:39,495 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:39,495 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:39,495 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:23:39,495 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:23:39,495 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:39,555 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:23:39,555 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:23:39,555 - src.training - INFO - 모델 학습 시작
2025-06-24 12:23:39,668 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:23:39,668 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:23:39,668 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:23:39,668 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:23:39,668 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:23:39,668 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:23:39,668 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:23:39,668 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:23:39,668 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:23:39,668 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:23:39,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:23:39,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:39,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:39,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:39,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:39,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:39,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:39,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:39,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:23:39,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:23:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:23:40,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:40,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:40,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:40,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:40,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:40,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:40,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:40,140 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:23:40,140 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:40,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:23:40,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:40,154 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:23:40,154 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:40,154 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:23:40,166 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   n_estimators: 112
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   max_depth: 8
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   min_samples_split: 8
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:23:40,167 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:48,713 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:23:48,713 - src.models.random_forest_model - INFO -   - 트리 개수: 112
2025-06-24 12:23:48,713 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:23:48,713 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:23:48,713 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:23:48,714 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:23:48,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:23:48,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:48,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:48,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:48,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:48,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:48,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:48,803 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:48,806 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:23:48,806 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:48,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:23:48,864 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:23:48,864 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:23:48,864 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:23:48,864 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:23:48,864 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:48,864 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:48,864 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:23:48,864 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:23:48,868 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:23:48,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:23:48,873 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:23:48,873 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:23:50,273 - src.training - INFO -   precision: 0.002656957291871679
2025-06-24 12:23:50,273 - src.training - INFO -   recall: 0.6
2025-06-24 12:23:50,273 - src.training - INFO -   f1: 0.005290486920740668
2025-06-24 12:23:50,273 - src.training - INFO -   accuracy: 0.724278084547841
2025-06-24 12:23:50,273 - src.training - INFO -   balanced_accuracy: 0.662215072279875
2025-06-24 12:23:50,273 - src.training - INFO -   positive_samples: 270
2025-06-24 12:23:50,273 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:23:50,273 - src.training - INFO -   total_samples: 220940
2025-06-24 12:23:50,273 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:23:50,273 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:23:50,273 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:23:50,273 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:23:50,273 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:23:50,273 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:23:50,273 - src.training - INFO - 모델 학습 완료
2025-06-24 12:23:50,273 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002656957291871679, 'recall': 0.6, 'f1': 0.005290486920740668, 'accuracy': 0.724278084547841, 'balanced_accuracy': 0.662215072279875, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:23:50,273 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:50,273 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:50,273 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:50,273 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:50,290 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:23:50,291 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:23:50,755 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = random_forest
2025-06-24 12:23:52,753 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:23:52,753 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:23:52,753 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:23:52,753 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:23:52,753 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:23:52,753 - src.training - INFO - 교차 검증 시작
2025-06-24 12:23:52,753 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:23:52,771 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:23:53,245 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:23:53,245 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:23:53,245 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:23:53,245 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:23:53,245 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:23:53,245 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:23:53,245 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:23:53,245 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:23:53,245 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:23:53,415 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:23:53,415 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:23:53,415 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:23:53,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:23:54,918 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:23:56,097 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:23:56,097 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:23:56,103 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:23:56,136 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:23:56,136 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:23:56,136 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:23:56,136 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:23:57,541 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:23:57,820 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:23:57,820 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:23:57,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:23:57,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:23:58,032 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:23:58,032 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:23:58,032 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:23:58,032 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:23:58,032 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:23:58,032 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:58,032 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,085 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:23:58,085 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:23:58,085 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,085 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,085 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:23:58,085 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:23:58,085 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,150 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:23:58,151 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:23:58,151 - src.training - INFO - 모델 학습 시작
2025-06-24 12:23:58,267 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:23:58,267 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:23:58,267 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:23:58,267 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:23:58,267 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:23:58,267 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:23:58,267 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:23:58,267 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:23:58,267 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:23:58,267 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:23:58,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:23:58,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:58,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:58,356 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:58,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:58,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:58,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:58,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:58,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:23:58,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:58,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:23:58,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:23:58,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:58,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:23:58,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:23:58,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:23:58,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:23:58,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:23:58,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:23:58,793 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:23:58,793 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:23:58,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:23:58,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,808 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:23:58,808 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:23:58,808 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:23:58,819 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   n_estimators: 317
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:23:58,820 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:23:58,820 - src.hyperparameter_tuning - ERROR - Trial 4 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:23:59,292 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = random_forest
2025-06-24 12:24:01,283 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:24:01,283 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:24:01,283 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:24:01,283 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:24:01,283 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:24:01,283 - src.training - INFO - 교차 검증 시작
2025-06-24 12:24:01,283 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:24:01,301 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:24:01,780 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:24:01,780 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:24:01,780 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:24:01,780 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:24:01,780 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:24:01,780 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:24:01,780 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:24:01,780 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:24:01,780 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:24:01,948 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:24:01,948 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:24:01,948 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:24:01,948 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:24:03,450 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:24:04,615 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:04,615 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:24:04,621 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:24:04,654 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:24:04,654 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:24:04,654 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:24:04,654 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:06,056 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:06,336 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:24:06,336 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:06,503 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:06,503 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:06,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:06,546 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:06,546 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:06,546 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:24:06,546 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:24:06,546 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:06,546 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:24:06,589 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:24:06,589 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:24:06,589 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:06,589 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:06,589 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:24:06,589 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:24:06,589 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:06,655 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:06,655 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:06,655 - src.training - INFO - 모델 학습 시작
2025-06-24 12:24:06,771 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:24:06,771 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:24:06,771 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:24:06,771 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:24:06,771 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:24:06,771 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:24:06,771 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:24:06,771 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:24:06,771 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:06,771 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:24:06,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:24:06,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:06,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:06,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:06,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:06,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:07,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:07,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:07,144 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:24:07,144 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:07,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:24:07,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:07,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:24:07,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:07,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:07,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:07,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:07,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:07,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:07,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:07,294 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:24:07,294 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:07,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:24:07,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:07,309 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:07,309 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:07,309 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:24:07,319 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   n_estimators: 414
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   max_depth: 8
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:24:07,320 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:07,320 - src.hyperparameter_tuning - ERROR - Trial 5 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:24:07,792 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = random_forest
2025-06-24 12:24:09,803 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:24:09,803 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:24:09,803 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:24:09,803 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:24:09,803 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:24:09,803 - src.training - INFO - 교차 검증 시작
2025-06-24 12:24:09,803 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:24:09,821 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:24:10,308 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:24:10,309 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:24:10,309 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:24:10,309 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:24:10,309 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:24:10,309 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:24:10,309 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:24:10,309 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:24:10,309 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:24:10,478 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:10,479 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:10,479 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:10,479 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:10,479 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:10,479 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:24:10,479 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:24:10,479 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:24:10,479 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:24:10,479 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:24:11,985 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:24:13,151 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:13,151 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:24:13,157 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:24:13,189 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:24:13,189 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:24:13,189 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:24:13,189 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:14,577 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:14,856 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:24:14,856 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:15,024 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:15,025 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:15,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:15,067 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:15,067 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:15,067 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:24:15,067 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:24:15,067 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:15,067 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,110 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:24:15,110 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:24:15,110 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,110 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,110 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:24:15,110 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:24:15,110 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,176 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:15,176 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:15,176 - src.training - INFO - 모델 학습 시작
2025-06-24 12:24:15,291 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:24:15,291 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:24:15,291 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:24:15,291 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:24:15,291 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:24:15,291 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:24:15,291 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:24:15,291 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:24:15,291 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:15,291 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:24:15,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:24:15,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:15,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:15,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:15,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:15,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:15,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:15,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:15,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:24:15,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:15,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:24:15,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:24:15,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:15,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:15,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:15,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:15,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:15,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:15,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:15,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:24:15,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:15,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:24:15,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,831 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:15,831 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:15,831 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   n_estimators: 65
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   min_samples_split: 6
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:24:15,841 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:15,841 - src.hyperparameter_tuning - ERROR - Trial 6 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:24:16,303 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = random_forest
2025-06-24 12:24:18,342 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:24:18,342 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:24:18,342 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:24:18,342 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:24:18,342 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:24:18,342 - src.training - INFO - 교차 검증 시작
2025-06-24 12:24:18,342 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:24:18,358 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:24:18,840 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:24:18,840 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:24:18,840 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:24:18,841 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:24:18,841 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:24:18,841 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:24:18,841 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:24:18,841 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:24:18,841 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:24:19,013 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:24:19,013 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:24:19,013 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:24:19,013 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:24:20,495 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:24:21,637 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:21,637 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:24:21,643 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:24:21,675 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:24:21,675 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:24:21,675 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:24:21,675 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:23,051 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:23,331 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:24:23,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:23,500 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:23,500 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:23,543 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:23,543 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:23,543 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:23,543 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:24:23,543 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:24:23,543 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:23,543 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:24:23,596 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:24:23,596 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:24:23,596 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:23,596 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:23,596 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:24:23,596 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:24:23,596 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:23,661 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:23,661 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:23,661 - src.training - INFO - 모델 학습 시작
2025-06-24 12:24:23,777 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:24:23,777 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:24:23,777 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:24:23,777 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:24:23,777 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:24:23,777 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:24:23,777 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:24:23,777 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:24:23,777 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:23,777 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:24:23,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:24:23,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:23,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:23,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:23,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:23,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:24,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:24,142 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:24,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:24:24,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:24,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:24:24,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:24,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:24:24,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:24,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:24,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:24,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:24,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:24,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:24,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:24,301 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:24:24,301 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:24,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:24:24,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:24,316 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:24,316 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:24,316 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   n_estimators: 133
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   min_samples_split: 16
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:24:24,327 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:24,327 - src.hyperparameter_tuning - ERROR - Trial 7 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:24:24,790 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = random_forest
2025-06-24 12:24:26,815 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:24:26,815 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:24:26,815 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:24:26,815 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:24:26,815 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:24:26,815 - src.training - INFO - 교차 검증 시작
2025-06-24 12:24:26,815 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:24:26,832 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:24:27,312 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:24:27,312 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:24:27,312 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:24:27,312 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:24:27,312 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:24:27,312 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:24:27,312 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:24:27,312 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:24:27,312 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:24:27,484 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:27,484 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:27,485 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:27,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:27,485 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:27,485 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:24:27,485 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:24:27,485 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:24:27,485 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:24:27,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:24:28,980 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:24:30,131 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:30,131 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:24:30,137 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:24:30,170 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:24:30,170 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:24:30,170 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:24:30,170 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:31,564 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:31,844 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:24:31,844 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:32,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:32,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:32,054 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:32,054 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:32,054 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:32,054 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:24:32,054 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:24:32,054 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:32,054 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,107 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:24:32,107 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:24:32,107 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,107 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,107 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:24:32,107 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:24:32,107 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,173 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:32,173 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:32,173 - src.training - INFO - 모델 학습 시작
2025-06-24 12:24:32,289 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:24:32,289 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:24:32,289 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:24:32,289 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:24:32,289 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:24:32,289 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:24:32,289 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:24:32,289 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:24:32,289 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:32,289 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:24:32,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:24:32,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:32,289 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:32,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:32,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:32,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:32,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:32,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:32,681 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:24:32,681 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:24:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:24:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:32,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:32,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:32,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:32,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:32,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:32,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:24:32,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:32,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:24:32,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,849 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:32,849 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:32,849 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   n_estimators: 89
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   max_depth: 6
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   min_samples_split: 2
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:24:32,860 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:24:32,861 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:24:32,861 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:32,861 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:24:32,861 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:32,861 - src.hyperparameter_tuning - ERROR - Trial 8 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:24:33,328 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = random_forest
2025-06-24 12:24:35,341 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:24:35,341 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:24:35,341 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:24:35,341 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:24:35,341 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:24:35,341 - src.training - INFO - 교차 검증 시작
2025-06-24 12:24:35,341 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:24:35,359 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:24:35,836 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:24:35,836 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:24:35,836 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:24:35,836 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:24:35,836 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:24:35,836 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:24:35,836 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:24:35,836 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:24:35,836 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:24:36,009 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:36,009 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:36,009 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:36,009 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:36,009 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:36,009 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:24:36,009 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:24:36,009 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:24:36,009 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:24:36,010 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:24:37,498 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:24:38,640 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:38,640 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:24:38,647 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:24:38,679 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:24:38,679 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:24:38,679 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:24:38,679 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:40,070 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:40,351 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:24:40,352 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:40,519 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:40,519 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:40,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:40,563 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:40,563 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:40,563 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:24:40,563 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:24:40,563 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:40,563 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:24:40,615 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:24:40,615 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:24:40,615 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:40,615 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:40,615 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:24:40,615 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:24:40,615 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:40,681 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:40,681 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:40,682 - src.training - INFO - 모델 학습 시작
2025-06-24 12:24:40,796 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:24:40,796 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:24:40,797 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:24:40,797 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:24:40,797 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:24:40,797 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:24:40,797 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:24:40,797 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:24:40,797 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:40,797 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:24:40,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:24:40,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:40,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:40,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:40,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:41,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:41,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:41,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:41,169 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:24:41,169 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:41,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:24:41,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:41,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:24:41,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:41,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:41,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:41,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:41,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:41,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:41,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:41,319 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:24:41,319 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:41,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:24:41,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:41,333 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:41,333 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:41,333 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   n_estimators: 210
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   max_depth: 8
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:24:41,344 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:41,344 - src.hyperparameter_tuning - ERROR - Trial 9 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:24:41,799 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = random_forest
2025-06-24 12:24:43,618 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:24:43,618 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:24:43,618 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:24:43,618 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:24:43,618 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:24:43,618 - src.training - INFO - 교차 검증 시작
2025-06-24 12:24:43,618 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:24:43,636 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:24:44,083 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:24:44,083 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:24:44,083 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:24:44,083 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:24:44,083 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:24:44,083 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:24:44,083 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:24:44,083 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:24:44,083 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:24:44,262 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:44,262 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:44,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:24:44,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:24:44,263 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:44,263 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:24:44,263 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:24:44,263 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:24:44,263 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:24:44,263 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:24:45,616 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:24:46,658 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:46,658 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:24:46,664 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:24:46,696 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:24:46,697 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:24:46,697 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:24:46,697 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:24:47,945 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:24:48,199 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:24:48,199 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:48,359 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:48,359 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:24:48,399 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:24:48,399 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:48,399 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:24:48,399 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:24:48,399 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:24:48,399 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:48,399 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:24:48,439 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:24:48,439 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:24:48,439 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:48,439 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:48,439 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:24:48,439 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:24:48,439 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:48,498 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:48,498 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:24:48,498 - src.training - INFO - 모델 학습 시작
2025-06-24 12:24:48,611 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:24:48,611 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:24:48,611 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:24:48,611 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:24:48,611 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:24:48,611 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:24:48,611 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:24:48,611 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:24:48,611 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:48,611 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:24:48,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:24:48,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:48,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:48,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:48,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:48,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:48,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:48,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:48,932 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:24:48,932 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:49,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:24:49,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:49,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:24:49,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:49,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:24:49,018 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:24:49,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:24:49,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:24:49,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:24:49,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:24:49,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:24:49,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:24:49,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:24:49,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:49,092 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:24:49,092 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:24:49,092 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   n_estimators: 211
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:24:49,103 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:24:49,104 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:25:06,071 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:25:06,071 - src.models.random_forest_model - INFO -   - 트리 개수: 211
2025-06-24 12:25:06,071 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:25:06,071 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:25:06,071 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:25:06,071 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:25:06,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:25:06,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:06,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:25:06,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:25:06,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:25:06,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:25:06,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:25:06,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:25:06,150 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:25:06,150 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:06,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:25:06,260 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:25:06,260 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:25:06,260 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:25:06,260 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:25:06,260 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:25:06,260 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:25:06,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:25:06,260 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:25:06,263 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:25:06,267 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:25:06,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:25:06,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:25:07,466 - src.training - INFO -   precision: 0.0017992083483267362
2025-06-24 12:25:07,466 - src.training - INFO -   recall: 0.018518518518518517
2025-06-24 12:25:07,466 - src.training - INFO -   f1: 0.0032797638570022957
2025-06-24 12:25:07,466 - src.training - INFO -   accuracy: 0.9862451344256359
2025-06-24 12:25:07,466 - src.training - INFO -   balanced_accuracy: 0.5029738557155061
2025-06-24 12:25:07,466 - src.training - INFO -   positive_samples: 270
2025-06-24 12:25:07,466 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:25:07,466 - src.training - INFO -   total_samples: 220940
2025-06-24 12:25:07,466 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:25:07,466 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:25:07,466 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:25:07,466 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:25:07,466 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:25:07,466 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:25:07,466 - src.training - INFO - 모델 학습 완료
2025-06-24 12:25:07,466 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0017992083483267362, 'recall': 0.018518518518518517, 'f1': 0.0032797638570022957, 'accuracy': 0.9862451344256359, 'balanced_accuracy': 0.5029738557155061, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:25:07,466 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:07,466 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:07,466 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:07,466 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:07,483 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:25:07,483 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:25:07,938 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = random_forest
2025-06-24 12:25:09,766 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:25:09,766 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:25:09,766 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:25:09,767 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:25:09,767 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:25:09,767 - src.training - INFO - 교차 검증 시작
2025-06-24 12:25:09,767 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:25:09,784 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:25:10,230 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:25:10,230 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:25:10,230 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:25:10,230 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:25:10,230 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:25:10,230 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:25:10,230 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:25:10,230 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:25:10,230 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:25:10,410 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:25:10,410 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:25:10,410 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:25:10,410 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:25:11,763 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:25:12,811 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:25:12,811 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:25:12,816 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:25:12,849 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:25:12,849 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:25:12,849 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:25:12,849 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:25:14,106 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:25:14,358 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:25:14,358 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:25:14,517 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:25:14,517 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:25:14,558 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:25:14,558 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:25:14,558 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:25:14,558 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:25:14,558 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:25:14,558 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:14,558 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:25:14,597 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:25:14,597 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:25:14,597 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:14,597 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:14,597 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:25:14,597 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:25:14,597 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:14,655 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:25:14,655 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:25:14,655 - src.training - INFO - 모델 학습 시작
2025-06-24 12:25:14,768 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:25:14,768 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:25:14,768 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:25:14,768 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:25:14,768 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:25:14,768 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:25:14,768 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:25:14,768 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:25:14,768 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:25:14,768 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:25:14,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:25:14,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:14,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:25:14,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:25:14,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:25:14,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:25:15,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:25:15,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:25:15,091 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:25:15,091 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:15,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:25:15,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:15,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:25:15,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:15,160 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:25:15,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:25:15,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:25:15,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:25:15,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:25:15,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:25:15,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:25:15,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:15,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:25:15,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:15,252 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:25:15,252 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:15,252 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   n_estimators: 481
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   max_depth: 12
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   min_samples_split: 18
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:25:15,264 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:25:50,900 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:25:50,901 - src.models.random_forest_model - INFO -   - 트리 개수: 481
2025-06-24 12:25:50,901 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:25:50,901 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:25:50,901 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:25:50,901 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:25:50,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:25:50,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:50,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:25:50,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:25:50,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:25:50,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:25:50,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:25:50,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:25:50,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:25:50,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:50,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:25:51,190 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:25:51,191 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:25:51,191 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:25:51,191 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:25:51,191 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:25:51,191 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:25:51,191 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:25:51,191 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:25:51,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:25:51,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:25:51,199 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:25:51,199 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:25:52,435 - src.training - INFO -   precision: 0.0031164166490597928
2025-06-24 12:25:52,435 - src.training - INFO -   recall: 0.21851851851851853
2025-06-24 12:25:52,435 - src.training - INFO -   f1: 0.006145193209040725
2025-06-24 12:25:52,435 - src.training - INFO -   accuracy: 0.9136236082194261
2025-06-24 12:25:52,435 - src.training - INFO -   balanced_accuracy: 0.5664963100590961
2025-06-24 12:25:52,435 - src.training - INFO -   positive_samples: 270
2025-06-24 12:25:52,435 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:25:52,435 - src.training - INFO -   total_samples: 220940
2025-06-24 12:25:52,435 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:25:52,435 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:25:52,435 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:25:52,435 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:25:52,435 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:25:52,435 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:25:52,435 - src.training - INFO - 모델 학습 완료
2025-06-24 12:25:52,435 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031164166490597928, 'recall': 0.21851851851851853, 'f1': 0.006145193209040725, 'accuracy': 0.9136236082194261, 'balanced_accuracy': 0.5664963100590961, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:25:52,435 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:52,435 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:52,435 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:52,435 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:52,453 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:25:52,453 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:25:52,905 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = random_forest
2025-06-24 12:25:54,665 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:25:54,665 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:25:54,665 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:25:54,665 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:25:54,665 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:25:54,665 - src.training - INFO - 교차 검증 시작
2025-06-24 12:25:54,665 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:25:54,682 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:25:55,130 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:25:55,130 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:25:55,130 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:25:55,130 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:25:55,130 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:25:55,130 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:25:55,130 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:25:55,130 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:25:55,130 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:25:55,306 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:25:55,307 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:25:55,307 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:25:55,307 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:25:55,307 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:25:55,307 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:25:55,307 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:25:55,307 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:25:55,307 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:25:55,307 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:25:56,647 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:25:57,687 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:25:57,687 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:25:57,692 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:25:57,723 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:25:57,723 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:25:57,723 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:25:57,723 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:25:58,980 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:25:59,236 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:25:59,236 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:25:59,395 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:25:59,395 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:25:59,435 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:25:59,435 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:25:59,435 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:25:59,435 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:25:59,435 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:25:59,435 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:59,435 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:25:59,475 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:25:59,475 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:25:59,475 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:59,475 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:59,475 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:25:59,475 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:25:59,475 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:25:59,534 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:25:59,534 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:25:59,534 - src.training - INFO - 모델 학습 시작
2025-06-24 12:25:59,646 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:25:59,646 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:25:59,646 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:25:59,646 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:25:59,646 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:25:59,646 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:25:59,646 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:25:59,646 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:25:59,646 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:25:59,646 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:25:59,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:25:59,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:25:59,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:25:59,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:25:59,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:25:59,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:25:59,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:25:59,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:25:59,967 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:25:59,967 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:00,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:26:00,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:00,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:26:00,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:00,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:00,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:00,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:00,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:00,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:00,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:00,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:26:00,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:00,128 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:26:00,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:00,129 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:26:00,129 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:00,129 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   n_estimators: 113
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   max_depth: 13
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   min_samples_split: 19
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:26:00,139 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:26:09,263 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:26:09,263 - src.models.random_forest_model - INFO -   - 트리 개수: 113
2025-06-24 12:26:09,263 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:26:09,263 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:26:09,263 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:26:09,264 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:26:09,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:26:09,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:09,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:09,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:09,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:09,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:09,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:09,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:09,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:26:09,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:09,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:26:09,409 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:26:09,410 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:26:09,410 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:26:09,410 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:26:09,410 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:26:09,410 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:26:09,410 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:26:09,410 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:26:09,413 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:26:09,418 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:26:09,418 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:26:09,418 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:26:10,738 - src.training - INFO -   precision: 0.003284807764091079
2025-06-24 12:26:10,738 - src.training - INFO -   recall: 0.16296296296296298
2025-06-24 12:26:10,738 - src.training - INFO -   f1: 0.006439809732894255
2025-06-24 12:26:10,738 - src.training - INFO -   accuracy: 0.938548927310582
2025-06-24 12:26:10,738 - src.training - INFO -   balanced_accuracy: 0.5512304278720194
2025-06-24 12:26:10,738 - src.training - INFO -   positive_samples: 270
2025-06-24 12:26:10,738 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:26:10,738 - src.training - INFO -   total_samples: 220940
2025-06-24 12:26:10,738 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:26:10,738 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:26:10,738 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:26:10,738 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:26:10,738 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:26:10,738 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:26:10,738 - src.training - INFO - 모델 학습 완료
2025-06-24 12:26:10,738 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003284807764091079, 'recall': 0.16296296296296298, 'f1': 0.006439809732894255, 'accuracy': 0.938548927310582, 'balanced_accuracy': 0.5512304278720194, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:26:10,738 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:10,738 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:10,738 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:10,738 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:10,755 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:26:10,755 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:26:11,227 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = random_forest
2025-06-24 12:26:13,222 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:26:13,222 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:26:13,222 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:26:13,222 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:26:13,222 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:26:13,222 - src.training - INFO - 교차 검증 시작
2025-06-24 12:26:13,223 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:26:13,240 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:26:13,728 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:26:13,728 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:26:13,728 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:26:13,728 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:26:13,728 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:26:13,728 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:26:13,728 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:26:13,728 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:26:13,729 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:26:13,899 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:26:13,899 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:26:13,899 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:26:13,899 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:26:15,388 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:26:16,546 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:26:16,546 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:26:16,552 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:26:16,584 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:26:16,584 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:26:16,584 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:26:16,584 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:26:17,977 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:26:18,255 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:26:18,255 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:26:18,423 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:26:18,424 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:26:18,467 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:26:18,467 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:26:18,467 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:26:18,467 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:26:18,467 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:26:18,467 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:18,467 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:26:18,510 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:26:18,510 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:26:18,510 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:18,510 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:18,510 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:26:18,510 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:26:18,510 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:18,576 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:26:18,576 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:26:18,576 - src.training - INFO - 모델 학습 시작
2025-06-24 12:26:18,691 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:26:18,691 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:26:18,691 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:26:18,691 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:26:18,691 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:26:18,691 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:26:18,691 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:26:18,691 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:26:18,692 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:26:18,692 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:26:18,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:26:18,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:18,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:18,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:18,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:18,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:18,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:19,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:19,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:26:19,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:19,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:26:19,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:19,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:26:19,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:19,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:19,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:19,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:19,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:19,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:19,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:19,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:26:19,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:19,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:26:19,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:19,231 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:26:19,231 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:19,231 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   n_estimators: 387
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   max_depth: 16
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   min_samples_split: 16
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:26:19,241 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:26:49,468 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:26:49,469 - src.models.random_forest_model - INFO -   - 트리 개수: 387
2025-06-24 12:26:49,469 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:26:49,469 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:26:49,469 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:26:49,469 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:26:49,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:26:49,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:49,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:49,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:49,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:49,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:49,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:49,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:49,562 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:26:49,562 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:49,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:26:49,751 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:26:49,751 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:26:49,751 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:26:49,751 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:26:49,751 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:26:49,751 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:26:49,751 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:26:49,751 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:26:49,755 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:26:49,759 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:26:49,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:26:49,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:26:51,053 - src.training - INFO -   precision: 0.0037469693630152083
2025-06-24 12:26:51,053 - src.training - INFO -   recall: 0.06296296296296296
2025-06-24 12:26:51,053 - src.training - INFO -   f1: 0.007073018514666112
2025-06-24 12:26:51,053 - src.training - INFO -   accuracy: 0.9783968498234815
2025-06-24 12:26:51,053 - src.training - INFO -   balanced_accuracy: 0.5212399443445802
2025-06-24 12:26:51,053 - src.training - INFO -   positive_samples: 270
2025-06-24 12:26:51,053 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:26:51,053 - src.training - INFO -   total_samples: 220940
2025-06-24 12:26:51,053 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:26:51,053 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:26:51,053 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:26:51,053 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:26:51,054 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:26:51,054 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:26:51,054 - src.training - INFO - 모델 학습 완료
2025-06-24 12:26:51,054 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0037469693630152083, 'recall': 0.06296296296296296, 'f1': 0.007073018514666112, 'accuracy': 0.9783968498234815, 'balanced_accuracy': 0.5212399443445802, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:26:51,054 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:51,054 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:51,054 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:51,054 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:51,071 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:26:51,071 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:26:51,541 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = random_forest
2025-06-24 12:26:53,510 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:26:53,510 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:26:53,510 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:26:53,510 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:26:53,510 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:26:53,510 - src.training - INFO - 교차 검증 시작
2025-06-24 12:26:53,510 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:26:53,527 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:26:53,969 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:26:53,969 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:26:53,969 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:26:53,969 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:26:53,969 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:26:53,969 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:26:53,969 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:26:53,969 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:26:53,969 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:26:54,147 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:26:54,147 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:26:54,147 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:26:54,147 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:26:55,491 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:26:56,536 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:26:56,536 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:26:56,542 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:26:56,572 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:26:56,573 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:26:56,573 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:26:56,573 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:26:57,823 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:26:58,076 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:26:58,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:26:58,235 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:26:58,235 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:26:58,275 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:26:58,275 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:26:58,275 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:26:58,275 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:26:58,275 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:26:58,275 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:58,275 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,314 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:26:58,314 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:26:58,314 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,314 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,314 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:26:58,314 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:26:58,314 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,372 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:26:58,372 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:26:58,372 - src.training - INFO - 모델 학습 시작
2025-06-24 12:26:58,484 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:26:58,484 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:26:58,485 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:26:58,485 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:26:58,485 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:26:58,485 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:26:58,485 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:26:58,485 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:26:58,485 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:26:58,485 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:26:58,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:26:58,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:58,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:58,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:58,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:58,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:58,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:58,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:58,805 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:26:58,805 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:58,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:26:58,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:26:58,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:58,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:26:58,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:26:58,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:26:58,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:26:58,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:26:58,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:26:58,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:26:58,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:26:58,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:26:58,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,963 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:26:58,963 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:26:58,963 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   n_estimators: 417
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   max_depth: 18
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:26:58,974 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:27:31,258 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:27:31,258 - src.models.random_forest_model - INFO -   - 트리 개수: 417
2025-06-24 12:27:31,258 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:27:31,258 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:27:31,259 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:27:31,259 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:27:31,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:27:31,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:31,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:27:31,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:27:31,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:27:31,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:27:31,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:27:31,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:27:31,349 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:27:31,349 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:31,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:27:31,549 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:27:31,549 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:27:31,549 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:27:31,549 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:27:31,549 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:27:31,549 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:27:31,549 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:27:31,549 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:27:31,552 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:27:31,556 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:27:31,557 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:27:31,557 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:27:32,719 - src.training - INFO -   precision: 0.002522863450015768
2025-06-24 12:27:32,719 - src.training - INFO -   recall: 0.02962962962962963
2025-06-24 12:27:32,719 - src.training - INFO -   f1: 0.004649811101424005
2025-06-24 12:27:32,719 - src.training - INFO -   accuracy: 0.9844980537702543
2025-06-24 12:27:32,719 - src.training - INFO -   balanced_accuracy: 0.5076480046457841
2025-06-24 12:27:32,719 - src.training - INFO -   positive_samples: 270
2025-06-24 12:27:32,719 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:27:32,719 - src.training - INFO -   total_samples: 220940
2025-06-24 12:27:32,719 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:27:32,719 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:27:32,719 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:27:32,719 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:27:32,720 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:27:32,720 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:27:32,720 - src.training - INFO - 모델 학습 완료
2025-06-24 12:27:32,720 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002522863450015768, 'recall': 0.02962962962962963, 'f1': 0.004649811101424005, 'accuracy': 0.9844980537702543, 'balanced_accuracy': 0.5076480046457841, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:27:32,720 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:32,720 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:32,720 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:32,720 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:32,737 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:27:32,737 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:27:33,193 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = random_forest
2025-06-24 12:27:34,968 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:27:34,968 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:27:34,968 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:27:34,969 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:27:34,969 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:27:34,969 - src.training - INFO - 교차 검증 시작
2025-06-24 12:27:34,969 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:27:34,987 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:27:35,422 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:27:35,422 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:27:35,422 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:27:35,422 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:27:35,422 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:27:35,422 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:27:35,422 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:27:35,422 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:27:35,422 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:27:35,601 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:27:35,601 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:27:35,601 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:27:35,601 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:27:35,601 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:27:35,601 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:27:35,601 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:27:35,601 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:27:35,601 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:27:35,602 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:27:36,943 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:27:37,985 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:27:37,986 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:27:37,991 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:27:38,024 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:27:38,024 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:27:38,024 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:27:38,024 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:27:39,275 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:27:39,530 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:27:39,530 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:27:39,689 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:27:39,689 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:27:39,730 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:27:39,730 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:27:39,730 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:27:39,730 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:27:39,730 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:27:39,730 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:39,730 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:27:39,771 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:27:39,771 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:27:39,771 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:39,771 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:39,771 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:27:39,771 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:27:39,771 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:39,831 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:27:39,831 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:27:39,831 - src.training - INFO - 모델 학습 시작
2025-06-24 12:27:39,945 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:27:39,945 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:27:39,945 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:27:39,945 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:27:39,945 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:27:39,945 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:27:39,945 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:27:39,945 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:27:39,945 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:27:39,945 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:27:39,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:27:39,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:39,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:27:40,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:27:40,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:27:40,131 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:27:40,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:27:40,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:27:40,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:27:40,267 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:40,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:27:40,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:40,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:27:40,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:40,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:27:40,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:27:40,367 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:27:40,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:27:40,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:27:40,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:27:40,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:27:40,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:27:40,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:27:40,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:40,430 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:27:40,430 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:27:40,430 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   n_estimators: 252
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   max_depth: 16
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   min_samples_split: 19
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:27:40,442 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:28:00,098 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:28:00,098 - src.models.random_forest_model - INFO -   - 트리 개수: 252
2025-06-24 12:28:00,098 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:28:00,098 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:28:00,098 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:28:00,098 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:28:00,099 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:28:00,099 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:00,099 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:00,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:00,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:00,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:00,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:00,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:00,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:28:00,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:00,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:28:00,316 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:28:00,316 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:28:00,316 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:28:00,316 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:28:00,316 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:00,316 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:00,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:28:00,317 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:28:00,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:28:00,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:28:00,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:28:00,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:28:01,502 - src.training - INFO -   precision: 0.0038643194504079004
2025-06-24 12:28:01,502 - src.training - INFO -   recall: 0.06666666666666667
2025-06-24 12:28:01,502 - src.training - INFO -   f1: 0.007305194805194805
2025-06-24 12:28:01,502 - src.training - INFO -   accuracy: 0.9778582420566669
2025-06-24 12:28:01,502 - src.training - INFO -   balanced_accuracy: 0.5228198969804082
2025-06-24 12:28:01,502 - src.training - INFO -   positive_samples: 270
2025-06-24 12:28:01,502 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:28:01,502 - src.training - INFO -   total_samples: 220940
2025-06-24 12:28:01,502 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:28:01,502 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:28:01,502 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:28:01,502 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:28:01,503 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:28:01,503 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:28:01,503 - src.training - INFO - 모델 학습 완료
2025-06-24 12:28:01,503 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0038643194504079004, 'recall': 0.06666666666666667, 'f1': 0.007305194805194805, 'accuracy': 0.9778582420566669, 'balanced_accuracy': 0.5228198969804082, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:28:01,503 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:01,503 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:01,503 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:01,503 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:01,521 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:28:01,521 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:28:01,966 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = random_forest
2025-06-24 12:28:03,755 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:28:03,755 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:28:03,755 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:28:03,755 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:28:03,755 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:28:03,755 - src.training - INFO - 교차 검증 시작
2025-06-24 12:28:03,755 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:28:03,771 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:28:04,220 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:28:04,220 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:28:04,220 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:28:04,220 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:28:04,220 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:28:04,220 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:28:04,220 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:28:04,220 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:28:04,220 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:28:04,397 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:28:04,397 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:28:04,397 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:28:04,397 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:28:05,758 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:28:06,800 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:28:06,800 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:28:06,806 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:28:06,837 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:28:06,838 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:28:06,838 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:28:06,838 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:28:08,129 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:28:08,381 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:28:08,381 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:28:08,541 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:28:08,541 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:28:08,583 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:28:08,583 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:28:08,583 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:28:08,583 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:28:08,583 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:28:08,583 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:08,583 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:08,624 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:28:08,624 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:28:08,624 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:08,624 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:08,624 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:28:08,624 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:28:08,624 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:08,683 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:28:08,683 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:28:08,683 - src.training - INFO - 모델 학습 시작
2025-06-24 12:28:08,794 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:28:08,795 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:28:08,795 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:28:08,795 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:28:08,795 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:28:08,795 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:28:08,795 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:28:08,795 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:28:08,795 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:28:08,795 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:28:08,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:28:08,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:08,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:08,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:08,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:08,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:09,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:09,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:09,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:28:09,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:09,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:28:09,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:09,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:28:09,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:09,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:09,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:09,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:09,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:09,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:09,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:09,260 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:28:09,260 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:09,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:28:09,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:09,274 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:28:09,274 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:09,274 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   n_estimators: 444
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   min_samples_split: 8
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:28:09,284 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:28:39,491 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:28:39,491 - src.models.random_forest_model - INFO -   - 트리 개수: 444
2025-06-24 12:28:39,491 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:28:39,491 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:28:39,491 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:28:39,491 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:28:39,491 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:28:39,491 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:39,492 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:39,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:39,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:39,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:39,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:39,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:39,583 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:28:39,583 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:39,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:28:39,754 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:28:39,754 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:28:39,754 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:28:39,754 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:28:39,754 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:39,754 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:39,754 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:28:39,754 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:28:39,757 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:28:39,762 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:28:39,763 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:28:39,763 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:28:40,563 - src.training - INFO -   precision: 0.002336673401784119
2025-06-24 12:28:40,563 - src.training - INFO -   recall: 0.6296296296296297
2025-06-24 12:28:40,563 - src.training - INFO -   f1: 0.004656067266477685
2025-06-24 12:28:40,563 - src.training - INFO -   accuracy: 0.6710283334842039
2025-06-24 12:28:40,563 - src.training - INFO -   balanced_accuracy: 0.6503543081759423
2025-06-24 12:28:40,563 - src.training - INFO -   positive_samples: 270
2025-06-24 12:28:40,563 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:28:40,563 - src.training - INFO -   total_samples: 220940
2025-06-24 12:28:40,563 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:28:40,563 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:28:40,563 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:28:40,563 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:28:40,563 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:28:40,563 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:28:40,563 - src.training - INFO - 모델 학습 완료
2025-06-24 12:28:40,563 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002336673401784119, 'recall': 0.6296296296296297, 'f1': 0.004656067266477685, 'accuracy': 0.6710283334842039, 'balanced_accuracy': 0.6503543081759423, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:28:40,563 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:40,563 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:40,563 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:40,563 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:40,581 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:28:40,581 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:28:41,025 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = random_forest
2025-06-24 12:28:42,817 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:28:42,817 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:28:42,817 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:28:42,817 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:28:42,817 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:28:42,817 - src.training - INFO - 교차 검증 시작
2025-06-24 12:28:42,817 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:28:42,834 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:28:43,277 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:28:43,277 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:28:43,277 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:28:43,277 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:28:43,277 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:28:43,277 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:28:43,277 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:28:43,277 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:28:43,277 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:28:43,457 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:28:43,457 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:28:43,457 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:28:43,457 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:28:44,791 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:28:45,827 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:28:45,827 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:28:45,833 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:28:45,863 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:28:45,863 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:28:45,863 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:28:45,863 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:28:47,112 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:28:47,369 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:28:47,369 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:28:47,530 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:28:47,530 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:28:47,570 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:28:47,570 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:28:47,570 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:28:47,570 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:28:47,571 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:28:47,571 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:47,571 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:47,610 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:28:47,610 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:28:47,610 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:47,610 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:47,610 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:28:47,610 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:28:47,610 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:47,668 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:28:47,668 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:28:47,668 - src.training - INFO - 모델 학습 시작
2025-06-24 12:28:47,780 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:28:47,780 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:28:47,780 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:28:47,780 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:28:47,780 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:28:47,780 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:28:47,780 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:28:47,780 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:28:47,780 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:28:47,780 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:28:47,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:28:47,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:47,781 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:47,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:47,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:47,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:48,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:48,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:48,099 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:28:48,099 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:48,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:28:48,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:48,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:28:48,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:48,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:48,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:48,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:48,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:48,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:48,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:48,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:28:48,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:48,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:28:48,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:48,258 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:28:48,258 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:48,258 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   n_estimators: 466
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:28:48,269 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:28:48,269 - src.hyperparameter_tuning - ERROR - Trial 17 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:28:48,721 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = random_forest
2025-06-24 12:28:50,481 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:28:50,481 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:28:50,481 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:28:50,481 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:28:50,481 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:28:50,481 - src.training - INFO - 교차 검증 시작
2025-06-24 12:28:50,482 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:28:50,498 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:28:50,941 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:28:50,941 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:28:50,941 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:28:50,941 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:28:50,941 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:28:50,941 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:28:50,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:28:50,941 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:28:50,941 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:28:51,117 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:28:51,117 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:28:51,117 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:28:51,117 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:28:52,455 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:28:53,493 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:28:53,493 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:28:53,499 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:28:53,530 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:28:53,530 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:28:53,530 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:28:53,530 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:28:54,787 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:28:55,046 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:28:55,046 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:28:55,207 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:28:55,207 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:28:55,248 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:28:55,248 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:28:55,248 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:28:55,248 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:28:55,248 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:28:55,248 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:55,248 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,297 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:28:55,297 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:28:55,297 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,297 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,297 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:28:55,297 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:28:55,297 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,354 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:28:55,354 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:28:55,354 - src.training - INFO - 모델 학습 시작
2025-06-24 12:28:55,466 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:28:55,466 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:28:55,466 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:28:55,466 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:28:55,466 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:28:55,466 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:28:55,466 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:28:55,466 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:28:55,466 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:28:55,466 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:28:55,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:28:55,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:55,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:55,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:55,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:55,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:55,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:55,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:55,786 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:28:55,786 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:55,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:28:55,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:28:55,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:55,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:28:55,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:28:55,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:28:55,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:28:55,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:28:55,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:28:55,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:28:55,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:28:55,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:28:55,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,943 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:28:55,943 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:28:55,943 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   n_estimators: 156
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   min_samples_split: 9
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:28:55,953 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:28:55,954 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:28:55,954 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:28:55,954 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:29:08,697 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:29:08,697 - src.models.random_forest_model - INFO -   - 트리 개수: 156
2025-06-24 12:29:08,697 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:29:08,697 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:29:08,697 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:29:08,697 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:29:08,697 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:29:08,697 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:08,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:29:08,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:29:08,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:29:08,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:29:08,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:29:08,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:29:08,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:29:08,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:08,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:29:08,863 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:29:08,864 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:29:08,864 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:29:08,864 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:29:08,864 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:29:08,864 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:29:08,864 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:29:08,864 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:29:08,867 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:29:08,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:29:08,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:29:08,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:29:10,103 - src.training - INFO -   precision: 0.002228826151560178
2025-06-24 12:29:10,103 - src.training - INFO -   recall: 0.022222222222222223
2025-06-24 12:29:10,103 - src.training - INFO -   f1: 0.004051316677920324
2025-06-24 12:29:10,103 - src.training - INFO -   accuracy: 0.986647958721825
2025-06-24 12:29:10,103 - src.training - INFO -   balanced_accuracy: 0.5050251003257755
2025-06-24 12:29:10,103 - src.training - INFO -   positive_samples: 270
2025-06-24 12:29:10,103 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:29:10,103 - src.training - INFO -   total_samples: 220940
2025-06-24 12:29:10,103 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:29:10,103 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:29:10,103 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:29:10,103 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:29:10,103 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:29:10,103 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:29:10,103 - src.training - INFO - 모델 학습 완료
2025-06-24 12:29:10,103 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002228826151560178, 'recall': 0.022222222222222223, 'f1': 0.004051316677920324, 'accuracy': 0.986647958721825, 'balanced_accuracy': 0.5050251003257755, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:29:10,103 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:10,103 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:10,103 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:10,103 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:10,121 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:29:10,121 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:29:10,584 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = random_forest
2025-06-24 12:29:12,392 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:29:12,392 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:29:12,392 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:29:12,392 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:29:12,392 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:29:12,392 - src.training - INFO - 교차 검증 시작
2025-06-24 12:29:12,392 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:29:12,409 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:29:12,855 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:29:12,856 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:29:12,856 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:29:12,856 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:29:12,856 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:29:12,856 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:29:12,856 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:29:12,856 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:29:12,856 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:29:13,034 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:29:13,034 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:29:13,034 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:29:13,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:29:14,383 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:29:15,436 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:29:15,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:29:15,442 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:29:15,474 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:29:15,474 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:29:15,474 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:29:15,474 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:29:16,832 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:29:17,111 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:29:17,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:29:17,278 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:29:17,279 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:29:17,321 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:29:17,321 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:29:17,321 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:29:17,321 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:29:17,321 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:29:17,321 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:17,321 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:29:17,365 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:29:17,365 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:29:17,365 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:17,365 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:17,365 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:29:17,365 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:29:17,365 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:17,430 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:29:17,430 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:29:17,430 - src.training - INFO - 모델 학습 시작
2025-06-24 12:29:17,545 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:29:17,546 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:29:17,546 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:29:17,546 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:29:17,546 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:29:17,546 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:29:17,546 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:29:17,546 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:29:17,546 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:29:17,546 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:29:17,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:29:17,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:17,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:29:17,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:29:17,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:29:17,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:29:17,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:29:17,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:29:17,920 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:29:17,920 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:17,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:29:17,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:17,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:29:17,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:17,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:29:18,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:29:18,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:29:18,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:29:18,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:29:18,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:29:18,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:29:18,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:18,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:29:18,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:18,083 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:29:18,083 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:18,083 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   n_estimators: 76
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   min_samples_split: 10
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:29:18,095 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:29:24,986 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:29:24,986 - src.models.random_forest_model - INFO -   - 트리 개수: 76
2025-06-24 12:29:24,986 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:29:24,986 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:29:24,986 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:29:24,986 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:29:24,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:29:24,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:24,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:29:25,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:29:25,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:29:25,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:29:25,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:29:25,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:29:25,077 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:29:25,077 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:25,080 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:29:25,126 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:29:25,126 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:29:25,126 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:29:25,126 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:29:25,126 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:29:25,126 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:29:25,126 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:29:25,127 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:29:25,130 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:29:25,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:29:25,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:29:25,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:29:26,509 - src.training - INFO -   precision: 0.00321590410758661
2025-06-24 12:29:26,509 - src.training - INFO -   recall: 0.08148148148148149
2025-06-24 12:29:26,509 - src.training - INFO -   f1: 0.006187596681198144
2025-06-24 12:29:26,509 - src.training - INFO -   accuracy: 0.9680139404363175
2025-06-24 12:29:26,509 - src.training - INFO -   balanced_accuracy: 0.5252900677901811
2025-06-24 12:29:26,509 - src.training - INFO -   positive_samples: 270
2025-06-24 12:29:26,509 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:29:26,509 - src.training - INFO -   total_samples: 220940
2025-06-24 12:29:26,509 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:29:26,509 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:29:26,509 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:29:26,509 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:29:26,510 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:29:26,510 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:29:26,510 - src.training - INFO - 모델 학습 완료
2025-06-24 12:29:26,510 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.00321590410758661, 'recall': 0.08148148148148149, 'f1': 0.006187596681198144, 'accuracy': 0.9680139404363175, 'balanced_accuracy': 0.5252900677901811, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:29:26,510 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:26,510 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:26,510 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:26,510 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:26,527 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:29:26,527 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:29:26,992 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = random_forest
2025-06-24 12:29:28,978 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:29:28,978 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:29:28,978 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:29:28,978 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:29:28,978 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:29:28,978 - src.training - INFO - 교차 검증 시작
2025-06-24 12:29:28,978 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:29:28,996 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:29:29,473 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:29:29,473 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:29:29,473 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:29:29,473 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:29:29,473 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:29:29,473 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:29:29,473 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:29:29,473 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:29:29,473 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:29:29,646 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:29:29,646 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:29:29,646 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:29:29,646 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:29:31,112 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:29:32,261 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:29:32,262 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:29:32,268 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:29:32,300 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:29:32,300 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:29:32,300 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:29:32,300 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:29:33,662 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:29:33,937 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:29:33,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:29:34,105 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:29:34,105 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:29:34,148 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:29:34,148 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:29:34,148 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:29:34,148 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:29:34,148 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:29:34,149 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:34,149 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,191 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:29:34,191 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:29:34,191 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,191 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,191 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:29:34,191 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:29:34,191 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,257 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:29:34,257 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:29:34,257 - src.training - INFO - 모델 학습 시작
2025-06-24 12:29:34,374 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:29:34,374 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:29:34,374 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:29:34,374 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:29:34,374 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:29:34,374 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:29:34,374 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:29:34,374 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:29:34,374 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:29:34,374 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:29:34,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:29:34,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:34,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:29:34,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:29:34,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:29:34,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:29:34,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:29:34,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:29:34,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:29:34,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:34,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:29:34,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:29:34,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:34,811 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:29:34,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:29:34,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:29:34,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:29:34,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:29:34,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:29:34,897 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:29:34,897 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:29:34,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:29:34,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,912 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:29:34,912 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:29:34,912 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   n_estimators: 373
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:29:34,923 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:03,234 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:30:03,234 - src.models.random_forest_model - INFO -   - 트리 개수: 373
2025-06-24 12:30:03,234 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:30:03,234 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:30:03,234 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:30:03,235 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:30:03,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:30:03,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:03,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:03,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:03,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:03,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:03,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:03,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:03,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:30:03,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:03,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:30:03,484 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:30:03,485 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:30:03,485 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:30:03,485 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:30:03,485 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:03,485 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:03,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:30:03,485 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:30:03,489 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:30:03,493 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:30:03,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:30:03,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:30:04,856 - src.training - INFO -   precision: 0.0031486880466472305
2025-06-24 12:30:04,856 - src.training - INFO -   recall: 0.3
2025-06-24 12:30:04,856 - src.training - INFO -   f1: 0.0062319676860934795
2025-06-24 12:30:04,856 - src.training - INFO -   accuracy: 0.883076853444374
2025-06-24 12:30:04,856 - src.training - INFO -   balanced_accuracy: 0.5918951375356868
2025-06-24 12:30:04,856 - src.training - INFO -   positive_samples: 270
2025-06-24 12:30:04,856 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:30:04,856 - src.training - INFO -   total_samples: 220940
2025-06-24 12:30:04,856 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:30:04,856 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:30:04,856 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:30:04,856 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:30:04,857 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:30:04,857 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:30:04,857 - src.training - INFO - 모델 학습 완료
2025-06-24 12:30:04,857 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031486880466472305, 'recall': 0.3, 'f1': 0.0062319676860934795, 'accuracy': 0.883076853444374, 'balanced_accuracy': 0.5918951375356868, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:30:04,857 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:04,857 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:04,857 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:04,857 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:04,874 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:30:04,874 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:30:05,341 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = random_forest
2025-06-24 12:30:07,317 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:30:07,318 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:30:07,318 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:30:07,318 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:30:07,318 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:30:07,318 - src.training - INFO - 교차 검증 시작
2025-06-24 12:30:07,318 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:30:07,336 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:30:07,817 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:30:07,817 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:30:07,817 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:30:07,817 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:30:07,817 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:30:07,817 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:30:07,817 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:30:07,817 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:30:07,817 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:30:07,986 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:07,986 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:07,987 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:07,987 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:07,987 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:07,987 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:30:07,987 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:30:07,987 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:30:07,987 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:30:07,987 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:30:09,456 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:30:10,617 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:10,617 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:30:10,623 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:30:10,655 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:30:10,655 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:30:10,655 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:30:10,655 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:12,032 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:12,312 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:30:12,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:30:12,480 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:30:12,481 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:30:12,524 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:30:12,524 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:30:12,524 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:30:12,524 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:30:12,524 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:30:12,524 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:12,524 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:12,577 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:30:12,577 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:30:12,577 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:12,577 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:12,577 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:30:12,577 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:30:12,577 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:12,643 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:30:12,643 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:30:12,643 - src.training - INFO - 모델 학습 시작
2025-06-24 12:30:12,759 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:30:12,759 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:30:12,759 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:30:12,759 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:30:12,759 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:30:12,759 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:30:12,759 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:30:12,759 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:30:12,759 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:30:12,759 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:30:12,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:30:12,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:12,760 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:12,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:12,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:12,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:13,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:13,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:13,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:30:13,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:13,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:30:13,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:13,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:30:13,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:13,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:13,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:13,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:13,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:13,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:13,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:13,286 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:30:13,286 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:13,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:30:13,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:13,301 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:30:13,301 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:13,301 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   n_estimators: 86
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:30:13,312 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:30:13,313 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:30:13,313 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:30:13,313 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:30:13,313 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:13,313 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:30:13,313 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:13,313 - src.hyperparameter_tuning - ERROR - Trial 21 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:30:13,784 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = random_forest
2025-06-24 12:30:15,790 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:30:15,790 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:30:15,790 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:30:15,790 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:30:15,790 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:30:15,790 - src.training - INFO - 교차 검증 시작
2025-06-24 12:30:15,790 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:30:15,808 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:30:16,283 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:30:16,283 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:30:16,283 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:30:16,283 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:30:16,283 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:30:16,283 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:30:16,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:30:16,283 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:30:16,283 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:30:16,452 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:30:16,452 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:30:16,452 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:30:16,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:30:17,937 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:30:19,096 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:19,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:30:19,102 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:30:19,134 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:30:19,134 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:30:19,134 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:30:19,134 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:20,523 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:20,800 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:30:20,800 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:30:20,968 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:30:20,968 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:30:21,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:30:21,011 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:30:21,011 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:30:21,011 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:30:21,011 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:30:21,011 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:21,011 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,064 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:30:21,064 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:30:21,064 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,064 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,064 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:30:21,064 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:30:21,064 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,130 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:30:21,130 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:30:21,130 - src.training - INFO - 모델 학습 시작
2025-06-24 12:30:21,246 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:30:21,246 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:30:21,246 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:30:21,246 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:30:21,246 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:30:21,246 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:30:21,246 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:30:21,246 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:30:21,246 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:30:21,246 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:30:21,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:30:21,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:21,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:21,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:21,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:21,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:21,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:21,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:21,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:30:21,621 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:21,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:30:21,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:30:21,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:21,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:21,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:21,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:21,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:21,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:21,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:21,768 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:30:21,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:21,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:30:21,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,783 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:30:21,783 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:21,783 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   n_estimators: 182
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   min_samples_split: 8
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:30:21,793 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:21,793 - src.hyperparameter_tuning - ERROR - Trial 22 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:30:22,270 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = random_forest
2025-06-24 12:30:24,245 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:30:24,246 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:30:24,246 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:30:24,246 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:30:24,246 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:30:24,246 - src.training - INFO - 교차 검증 시작
2025-06-24 12:30:24,246 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:30:24,263 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:30:24,738 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:30:24,738 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:30:24,738 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:30:24,738 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:30:24,738 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:30:24,738 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:30:24,738 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:30:24,738 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:30:24,738 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:30:24,909 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:30:24,909 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:30:24,909 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:30:24,909 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:30:26,398 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:30:27,557 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:27,557 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:30:27,563 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:30:27,595 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:30:27,595 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:30:27,595 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:30:27,595 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:28,983 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:29,261 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:30:29,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:30:29,430 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:30:29,430 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:30:29,474 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:30:29,474 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:30:29,474 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:30:29,474 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:30:29,474 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:30:29,474 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:29,474 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:29,527 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:30:29,527 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:30:29,527 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:29,527 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:29,527 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:30:29,527 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:30:29,527 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:29,594 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:30:29,594 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:30:29,594 - src.training - INFO - 모델 학습 시작
2025-06-24 12:30:29,709 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:30:29,710 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:30:29,710 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:30:29,710 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:30:29,710 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:30:29,710 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:30:29,710 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:30:29,710 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:30:29,710 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:30:29,710 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:30:29,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:30:29,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:29,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:29,799 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:29,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:29,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:29,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:30,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:30,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:30:30,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:30,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:30:30,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:30,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:30:30,144 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:30,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:30,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:30,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:30,194 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:30,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:30,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:30,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:30:30,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:30,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:30:30,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:30,246 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:30:30,246 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:30,246 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   n_estimators: 289
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:30:30,258 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:30:53,150 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:30:53,150 - src.models.random_forest_model - INFO -   - 트리 개수: 289
2025-06-24 12:30:53,150 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:30:53,150 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:30:53,150 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:30:53,151 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:30:53,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:30:53,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:53,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:30:53,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:30:53,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:30:53,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:30:53,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:30:53,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:30:53,228 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:30:53,228 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:53,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:30:53,378 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:30:53,378 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:30:53,378 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:30:53,378 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:30:53,378 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:53,378 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:30:53,378 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:30:53,378 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:30:53,381 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:30:53,385 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:30:53,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:30:53,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:30:54,547 - src.training - INFO -   precision: 0.0014099400775467042
2025-06-24 12:30:54,547 - src.training - INFO -   recall: 0.014814814814814815
2025-06-24 12:30:54,547 - src.training - INFO -   f1: 0.002574831026713872
2025-06-24 12:30:54,547 - src.training - INFO -   accuracy: 0.9859735674843849
2025-06-24 12:30:54,547 - src.training - INFO -   balanced_accuracy: 0.5009883200824425
2025-06-24 12:30:54,547 - src.training - INFO -   positive_samples: 270
2025-06-24 12:30:54,547 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:30:54,547 - src.training - INFO -   total_samples: 220940
2025-06-24 12:30:54,547 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:30:54,547 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:30:54,547 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:30:54,547 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:30:54,548 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:30:54,548 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:30:54,548 - src.training - INFO - 모델 학습 완료
2025-06-24 12:30:54,548 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0014099400775467042, 'recall': 0.014814814814814815, 'f1': 0.002574831026713872, 'accuracy': 0.9859735674843849, 'balanced_accuracy': 0.5009883200824425, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:30:54,548 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:54,548 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:54,548 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:30:54,548 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:30:54,565 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:30:54,565 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:30:55,018 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = random_forest
2025-06-24 12:30:56,861 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:30:56,861 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:30:56,861 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:30:56,861 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:30:56,861 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:30:56,861 - src.training - INFO - 교차 검증 시작
2025-06-24 12:30:56,861 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:30:56,879 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:30:57,331 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:30:57,331 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:30:57,331 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:30:57,331 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:30:57,331 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:30:57,331 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:30:57,331 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:30:57,331 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:30:57,331 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:30:57,511 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:30:57,511 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:30:57,511 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:30:57,511 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:30:58,845 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:30:59,882 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:30:59,882 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:30:59,888 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:30:59,919 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:30:59,919 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:30:59,919 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:30:59,919 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:01,177 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:01,432 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:31:01,432 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:01,598 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:01,598 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:01,639 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:01,639 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:01,639 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:01,639 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:31:01,639 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:31:01,639 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:01,639 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:01,688 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:31:01,688 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:31:01,688 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:01,688 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:01,688 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:31:01,688 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:31:01,688 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:01,746 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:01,746 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:01,746 - src.training - INFO - 모델 학습 시작
2025-06-24 12:31:01,859 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:31:01,859 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:31:01,859 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:31:01,859 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:31:01,859 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:31:01,859 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:31:01,859 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:31:01,859 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:31:01,859 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:01,859 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:31:01,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:31:01,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:01,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:01,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:01,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:02,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:02,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:02,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:02,178 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:31:02,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:02,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:31:02,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:02,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:31:02,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:02,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:02,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:02,279 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:02,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:02,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:02,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:02,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:31:02,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:02,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:31:02,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:02,338 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:02,338 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:02,338 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   n_estimators: 185
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   min_samples_split: 16
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:31:02,348 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:02,348 - src.hyperparameter_tuning - ERROR - Trial 24 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:31:02,801 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = random_forest
2025-06-24 12:31:04,620 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:31:04,621 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:31:04,621 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:31:04,621 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:31:04,621 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:31:04,621 - src.training - INFO - 교차 검증 시작
2025-06-24 12:31:04,621 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:31:04,637 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:31:05,089 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:31:05,089 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:31:05,089 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:31:05,089 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:31:05,089 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:31:05,089 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:31:05,089 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:31:05,089 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:31:05,089 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:31:05,268 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:05,268 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:05,269 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:05,269 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:05,269 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:05,269 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:31:05,269 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:31:05,269 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:31:05,269 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:31:05,269 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:31:06,600 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:31:07,642 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:07,642 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:31:07,648 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:31:07,681 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:31:07,681 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:31:07,681 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:31:07,681 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:08,940 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:09,202 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:31:09,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:09,362 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:09,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:09,403 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:09,403 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:09,403 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:09,403 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:31:09,403 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:31:09,403 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:09,403 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:09,443 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:31:09,443 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:31:09,443 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:09,443 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:09,443 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:31:09,443 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:31:09,443 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:09,500 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:09,501 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:09,501 - src.training - INFO - 모델 학습 시작
2025-06-24 12:31:09,613 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:31:09,613 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:31:09,613 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:31:09,613 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:31:09,613 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:31:09,613 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:31:09,613 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:31:09,613 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:31:09,613 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:09,613 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:31:09,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:31:09,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:09,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:09,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:09,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:09,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:09,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:09,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:09,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:31:09,932 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:09,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:31:10,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:10,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:31:10,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:10,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:10,017 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:10,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:10,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:10,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:10,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:10,077 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:31:10,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:31:10,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:10,091 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:10,091 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:10,091 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   n_estimators: 59
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   max_depth: 4
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   min_samples_split: 9
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:31:10,101 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:10,101 - src.hyperparameter_tuning - ERROR - Trial 25 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:31:10,557 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = random_forest
2025-06-24 12:31:12,414 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:31:12,415 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:31:12,415 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:31:12,415 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:31:12,415 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:31:12,415 - src.training - INFO - 교차 검증 시작
2025-06-24 12:31:12,415 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:31:12,432 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:31:12,876 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:31:12,876 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:31:12,876 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:31:12,876 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:31:12,876 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:31:12,876 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:31:12,876 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:31:12,876 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:31:12,876 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:31:13,055 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:31:13,055 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:31:13,055 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:31:13,055 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:31:14,386 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:31:15,430 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:15,430 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:31:15,435 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:31:15,466 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:31:15,466 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:31:15,466 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:31:15,466 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:16,711 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:16,972 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:31:16,972 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:17,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:17,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:17,172 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:17,173 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:17,173 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:17,173 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:31:17,173 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:31:17,173 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:17,173 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,223 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:31:17,223 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:31:17,223 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,223 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,223 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:31:17,223 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:31:17,223 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,282 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:17,282 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:17,282 - src.training - INFO - 모델 학습 시작
2025-06-24 12:31:17,396 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:31:17,396 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:31:17,396 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:31:17,396 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:31:17,396 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:31:17,396 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:31:17,396 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:31:17,396 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:31:17,396 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:17,396 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:31:17,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:31:17,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:17,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:17,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:17,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:17,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:17,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:31:17,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:17,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:31:17,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:31:17,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:17,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:17,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:17,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:17,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:17,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:17,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:17,872 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:31:17,872 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:17,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:31:17,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,885 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:17,885 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:17,885 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:31:17,895 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   n_estimators: 294
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   min_samples_split: 6
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:31:17,896 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:34,658 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:31:34,658 - src.models.random_forest_model - INFO -   - 트리 개수: 294
2025-06-24 12:31:34,658 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:31:34,658 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:31:34,658 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:31:34,659 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:31:34,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:31:34,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:34,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:34,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:34,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:34,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:34,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:34,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:34,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:31:34,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:34,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:31:34,868 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:31:34,869 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:31:34,869 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:31:34,869 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:31:34,869 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:34,869 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:34,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:31:34,869 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:31:34,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:31:34,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:31:34,877 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:31:34,877 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:31:35,737 - src.training - INFO -   precision: 0.001954937044400265
2025-06-24 12:31:35,737 - src.training - INFO -   recall: 0.8740740740740741
2025-06-24 12:31:35,737 - src.training - INFO -   f1: 0.0039011488552772957
2025-06-24 12:31:35,737 - src.training - INFO -   accuracy: 0.4545215895718295
2025-06-24 12:31:35,737 - src.training - INFO -   balanced_accuracy: 0.6640411608418134
2025-06-24 12:31:35,737 - src.training - INFO -   positive_samples: 270
2025-06-24 12:31:35,737 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:31:35,737 - src.training - INFO -   total_samples: 220940
2025-06-24 12:31:35,737 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:31:35,737 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:31:35,737 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:31:35,737 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:31:35,737 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:31:35,737 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:31:35,737 - src.training - INFO - 모델 학습 완료
2025-06-24 12:31:35,737 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.001954937044400265, 'recall': 0.8740740740740741, 'f1': 0.0039011488552772957, 'accuracy': 0.4545215895718295, 'balanced_accuracy': 0.6640411608418134, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:31:35,737 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:35,737 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:35,737 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:35,737 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:35,754 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:31:35,754 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:31:36,220 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = random_forest
2025-06-24 12:31:38,206 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:31:38,206 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:31:38,207 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:31:38,207 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:31:38,207 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:31:38,207 - src.training - INFO - 교차 검증 시작
2025-06-24 12:31:38,207 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:31:38,224 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:31:38,705 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:31:38,705 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:31:38,705 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:31:38,705 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:31:38,705 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:31:38,705 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:31:38,705 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:31:38,705 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:31:38,705 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:31:38,872 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:31:38,872 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:31:38,872 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:31:38,872 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:31:40,346 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:31:41,496 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:41,497 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:31:41,503 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:31:41,535 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:31:41,535 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:31:41,535 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:31:41,535 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:42,920 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:43,199 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:31:43,199 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:43,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:43,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:43,411 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:43,411 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:43,411 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:43,411 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:31:43,411 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:31:43,411 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:43,411 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:43,464 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:31:43,464 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:31:43,464 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:43,464 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:43,464 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:31:43,464 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:31:43,464 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:43,529 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:43,530 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:43,530 - src.training - INFO - 모델 학습 시작
2025-06-24 12:31:43,646 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:31:43,646 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:31:43,646 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:31:43,646 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:31:43,646 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:31:43,646 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:31:43,646 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:31:43,646 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:31:43,646 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:43,646 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:31:43,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:31:43,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:43,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:43,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:43,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:43,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:43,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:44,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:44,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:31:44,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:44,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:31:44,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:44,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:31:44,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:44,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:44,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:44,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:44,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:44,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:44,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:44,171 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:31:44,171 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:44,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:31:44,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:44,185 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:44,185 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:44,185 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   n_estimators: 486
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:31:44,196 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:44,196 - src.hyperparameter_tuning - ERROR - Trial 27 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:31:44,673 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = random_forest
2025-06-24 12:31:46,643 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:31:46,643 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:31:46,643 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:31:46,644 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:31:46,644 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:31:46,644 - src.training - INFO - 교차 검증 시작
2025-06-24 12:31:46,644 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:31:46,661 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:31:47,106 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:31:47,106 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:31:47,106 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:31:47,106 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:31:47,106 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:31:47,106 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:31:47,106 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:31:47,106 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:31:47,106 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:31:47,282 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:31:47,282 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:31:47,282 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:31:47,282 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:31:48,603 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:31:49,633 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:49,633 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:31:49,639 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:31:49,670 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:31:49,670 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:31:49,670 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:31:49,670 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:31:50,907 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:31:51,163 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:31:51,163 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:51,325 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:51,325 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:31:51,365 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:31:51,366 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:51,366 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:31:51,366 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:31:51,366 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:31:51,366 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:51,366 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:31:51,415 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:31:51,415 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:31:51,415 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:51,415 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:51,415 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:31:51,415 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:31:51,415 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:51,473 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:51,473 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:31:51,473 - src.training - INFO - 모델 학습 시작
2025-06-24 12:31:51,585 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:31:51,585 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:31:51,585 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:31:51,585 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:31:51,585 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:31:51,585 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:31:51,585 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:31:51,585 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:31:51,585 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:51,585 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:31:51,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:31:51,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:51,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:51,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:51,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:51,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:51,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:51,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:51,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:31:51,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:51,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:31:51,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:51,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:31:51,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:51,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:31:51,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:31:52,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:31:52,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:31:52,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:31:52,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:31:52,056 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:31:52,056 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:31:52,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:31:52,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:52,069 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:31:52,069 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:31:52,069 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   n_estimators: 188
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   max_depth: 8
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:31:52,079 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:05,845 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:32:05,846 - src.models.random_forest_model - INFO -   - 트리 개수: 188
2025-06-24 12:32:05,846 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:32:05,846 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:32:05,846 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:32:05,846 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:32:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:05,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:05,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:05,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:05,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:05,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:05,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:05,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:05,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:05,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:32:06,014 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:32:06,015 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:32:06,015 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:32:06,015 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:32:06,015 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:06,015 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:06,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:32:06,015 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:32:06,019 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:32:06,023 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:32:06,024 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:32:06,024 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:32:07,417 - src.training - INFO -   precision: 0.0026536336306074806
2025-06-24 12:32:07,417 - src.training - INFO -   recall: 0.5851851851851851
2025-06-24 12:32:07,417 - src.training - INFO -   f1: 0.0052833090903011155
2025-06-24 12:32:07,417 - src.training - INFO -   accuracy: 0.7307187471711777
2025-06-24 12:32:07,417 - src.training - INFO -   balanced_accuracy: 0.6580409997163521
2025-06-24 12:32:07,417 - src.training - INFO -   positive_samples: 270
2025-06-24 12:32:07,417 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:32:07,417 - src.training - INFO -   total_samples: 220940
2025-06-24 12:32:07,417 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:32:07,417 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:32:07,418 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:32:07,418 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:32:07,418 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:32:07,418 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:32:07,418 - src.training - INFO - 모델 학습 완료
2025-06-24 12:32:07,418 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026536336306074806, 'recall': 0.5851851851851851, 'f1': 0.0052833090903011155, 'accuracy': 0.7307187471711777, 'balanced_accuracy': 0.6580409997163521, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:32:07,418 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:07,418 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:07,418 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:07,418 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:07,435 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:32:07,435 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:32:07,915 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = random_forest
2025-06-24 12:32:09,904 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:32:09,904 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:32:09,904 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:32:09,904 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:32:09,904 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:32:09,904 - src.training - INFO - 교차 검증 시작
2025-06-24 12:32:09,904 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:32:09,922 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:32:10,399 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:32:10,400 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:32:10,400 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:32:10,400 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:32:10,400 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:32:10,400 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:32:10,400 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:32:10,400 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:32:10,400 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:32:10,565 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:32:10,565 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:32:10,565 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:32:10,565 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:32:12,043 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:32:13,195 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:32:13,195 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:32:13,201 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:32:13,233 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:32:13,233 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:32:13,233 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:32:13,233 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:32:14,619 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:32:14,903 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:32:14,903 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:32:15,072 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:32:15,072 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:32:15,116 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:32:15,116 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:32:15,116 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:32:15,116 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:32:15,116 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:32:15,116 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:15,116 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,169 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:32:15,169 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:32:15,169 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,169 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,169 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:32:15,169 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:32:15,169 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,236 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:32:15,236 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:32:15,236 - src.training - INFO - 모델 학습 시작
2025-06-24 12:32:15,352 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:32:15,352 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:32:15,352 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:32:15,352 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:32:15,352 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:32:15,352 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:32:15,352 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:32:15,352 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:32:15,352 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:32:15,352 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:32:15,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:32:15,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:15,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:15,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:15,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:15,572 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:15,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:15,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:15,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:32:15,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:15,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:32:15,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:15,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:15,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:15,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:15,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:15,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:15,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:15,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:15,878 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:15,878 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:15,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:32:15,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,893 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:32:15,893 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:15,893 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   n_estimators: 60
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   min_samples_split: 5
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:32:15,903 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:20,030 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:32:20,030 - src.models.random_forest_model - INFO -   - 트리 개수: 60
2025-06-24 12:32:20,030 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:32:20,030 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:32:20,030 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:32:20,031 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:32:20,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:20,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:20,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:20,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:20,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:20,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:20,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:20,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:20,120 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:20,120 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:20,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:32:20,158 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:32:20,158 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:32:20,158 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:32:20,158 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:32:20,158 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:20,158 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:20,158 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:32:20,158 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:32:20,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:32:20,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:32:20,167 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:32:20,167 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:32:21,077 - src.training - INFO -   precision: 0.002039835725229595
2025-06-24 12:32:21,077 - src.training - INFO -   recall: 0.8333333333333334
2025-06-24 12:32:21,077 - src.training - INFO -   f1: 0.0040697096036102845
2025-06-24 12:32:21,077 - src.training - INFO -   accuracy: 0.5015705621435684
2025-06-24 12:32:21,077 - src.training - INFO -   balanced_accuracy: 0.6672489841543179
2025-06-24 12:32:21,077 - src.training - INFO -   positive_samples: 270
2025-06-24 12:32:21,077 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:32:21,077 - src.training - INFO -   total_samples: 220940
2025-06-24 12:32:21,077 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:32:21,077 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:32:21,077 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:32:21,077 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:32:21,077 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:32:21,078 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:32:21,078 - src.training - INFO - 모델 학습 완료
2025-06-24 12:32:21,078 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002039835725229595, 'recall': 0.8333333333333334, 'f1': 0.0040697096036102845, 'accuracy': 0.5015705621435684, 'balanced_accuracy': 0.6672489841543179, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:32:21,078 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:21,078 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:21,078 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:21,078 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:21,096 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:32:21,096 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:32:21,568 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = random_forest
2025-06-24 12:32:23,527 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:32:23,528 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:32:23,528 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:32:23,528 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:32:23,528 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:32:23,528 - src.training - INFO - 교차 검증 시작
2025-06-24 12:32:23,528 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:32:23,546 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:32:24,022 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:32:24,022 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:32:24,022 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:32:24,022 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:32:24,022 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:32:24,022 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:32:24,022 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:32:24,022 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:32:24,022 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:32:24,181 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:32:24,181 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:32:24,181 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:32:24,181 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:32:25,637 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:32:26,788 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:32:26,788 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:32:26,794 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:32:26,826 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:32:26,826 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:32:26,826 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:32:26,826 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:32:28,207 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:32:28,485 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:32:28,486 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:32:28,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:32:28,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:32:28,697 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:32:28,698 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:32:28,698 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:32:28,698 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:32:28,698 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:32:28,698 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:28,698 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:28,751 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:32:28,751 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:32:28,751 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:28,751 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:28,751 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:32:28,751 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:32:28,751 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:28,818 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:32:28,818 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:32:28,818 - src.training - INFO - 모델 학습 시작
2025-06-24 12:32:28,934 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:32:28,934 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:32:28,934 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:32:28,934 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:32:28,934 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:32:28,934 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:32:28,934 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:32:28,934 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:32:28,934 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:32:28,934 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:32:28,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:32:28,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:28,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:29,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:29,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:29,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:29,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:29,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:29,307 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:32:29,307 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:29,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:32:29,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:29,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:29,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:29,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:29,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:29,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:29,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:29,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:29,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:29,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:29,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:29,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:32:29,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:29,469 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:32:29,469 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:29,469 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   n_estimators: 113
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   max_depth: 8
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   min_samples_split: 7
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:32:29,480 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:32:29,481 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:38,108 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:32:38,108 - src.models.random_forest_model - INFO -   - 트리 개수: 113
2025-06-24 12:32:38,108 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:32:38,108 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:32:38,109 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:32:38,109 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:32:38,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:38,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:38,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:38,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:38,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:38,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:38,180 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:38,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:38,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:38,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:38,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:32:38,259 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:32:38,260 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:32:38,260 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:32:38,260 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:32:38,260 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:38,260 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:38,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:32:38,260 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:32:38,263 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:32:38,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:32:38,269 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:32:38,269 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:32:39,668 - src.training - INFO -   precision: 0.0026452385705729685
2025-06-24 12:32:39,668 - src.training - INFO -   recall: 0.5888888888888889
2025-06-24 12:32:39,668 - src.training - INFO -   f1: 0.005266819040047699
2025-06-24 12:32:39,668 - src.training - INFO -   accuracy: 0.7281614918077306
2025-06-24 12:32:39,668 - src.training - INFO -   balanced_accuracy: 0.6586103935992911
2025-06-24 12:32:39,668 - src.training - INFO -   positive_samples: 270
2025-06-24 12:32:39,668 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:32:39,668 - src.training - INFO -   total_samples: 220940
2025-06-24 12:32:39,668 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:32:39,668 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:32:39,668 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:32:39,668 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:32:39,668 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:32:39,668 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:32:39,668 - src.training - INFO - 모델 학습 완료
2025-06-24 12:32:39,668 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026452385705729685, 'recall': 0.5888888888888889, 'f1': 0.005266819040047699, 'accuracy': 0.7281614918077306, 'balanced_accuracy': 0.6586103935992911, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:32:39,668 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:39,668 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:39,668 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:39,668 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:39,685 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:32:39,685 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:32:40,162 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = random_forest
2025-06-24 12:32:42,125 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:32:42,125 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:32:42,125 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:32:42,125 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:32:42,125 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:32:42,125 - src.training - INFO - 교차 검증 시작
2025-06-24 12:32:42,125 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:32:42,143 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:32:42,624 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:32:42,624 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:32:42,624 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:32:42,624 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:32:42,624 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:32:42,624 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:32:42,624 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:32:42,624 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:32:42,624 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:32:42,785 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:32:42,786 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:32:42,786 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:32:42,786 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:32:42,786 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:32:42,786 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:32:42,786 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:32:42,786 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:32:42,786 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:32:42,786 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:32:44,262 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:32:45,409 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:32:45,409 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:32:45,416 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:32:45,448 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:32:45,448 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:32:45,448 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:32:45,448 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:32:46,831 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:32:47,111 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:32:47,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:32:47,280 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:32:47,280 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:32:47,324 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:32:47,324 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:32:47,324 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:32:47,324 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:32:47,324 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:32:47,324 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:47,324 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:47,377 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:32:47,377 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:32:47,377 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:47,377 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:47,377 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:32:47,377 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:32:47,377 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:47,442 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:32:47,442 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:32:47,442 - src.training - INFO - 모델 학습 시작
2025-06-24 12:32:47,559 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:32:47,559 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:32:47,559 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:32:47,559 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:32:47,559 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:32:47,559 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:32:47,559 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:32:47,559 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:32:47,559 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:32:47,559 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:32:47,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:32:47,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:47,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:47,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:47,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:47,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:47,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:47,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:47,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:32:47,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:47,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:32:47,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:47,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:47,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:47,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:48,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:48,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:48,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:48,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:48,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:48,083 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:48,084 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:48,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:32:48,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:48,098 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:32:48,098 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:48,098 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   n_estimators: 111
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   min_samples_split: 8
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:32:48,109 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:32:56,093 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:32:56,093 - src.models.random_forest_model - INFO -   - 트리 개수: 111
2025-06-24 12:32:56,093 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:32:56,093 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:32:56,093 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:32:56,094 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:32:56,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:32:56,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:56,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:32:56,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:32:56,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:32:56,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:32:56,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:32:56,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:32:56,174 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:32:56,174 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:56,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:32:56,245 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:32:56,246 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:32:56,246 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:32:56,246 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:32:56,246 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:56,246 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:32:56,246 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:32:56,246 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:32:56,252 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:32:56,256 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:32:56,257 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:32:56,257 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:32:57,526 - src.training - INFO -   precision: 0.0024087799315849487
2025-06-24 12:32:57,526 - src.training - INFO -   recall: 0.6259259259259259
2025-06-24 12:32:57,526 - src.training - INFO -   f1: 0.00479909129632259
2025-06-24 12:32:57,526 - src.training - INFO -   accuracy: 0.6827554992305603
2025-06-24 12:32:57,526 - src.training - INFO -   balanced_accuracy: 0.6543754793902072
2025-06-24 12:32:57,526 - src.training - INFO -   positive_samples: 270
2025-06-24 12:32:57,526 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:32:57,526 - src.training - INFO -   total_samples: 220940
2025-06-24 12:32:57,526 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:32:57,526 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:32:57,526 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:32:57,526 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:32:57,526 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:32:57,526 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:32:57,526 - src.training - INFO - 모델 학습 완료
2025-06-24 12:32:57,526 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0024087799315849487, 'recall': 0.6259259259259259, 'f1': 0.00479909129632259, 'accuracy': 0.6827554992305603, 'balanced_accuracy': 0.6543754793902072, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:32:57,526 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:57,526 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:57,526 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:32:57,526 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:32:57,543 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:32:57,544 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:32:57,990 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = random_forest
2025-06-24 12:32:59,842 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:32:59,842 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:32:59,842 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:32:59,842 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:32:59,842 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:32:59,842 - src.training - INFO - 교차 검증 시작
2025-06-24 12:32:59,842 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:32:59,859 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:33:00,309 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:33:00,309 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:33:00,309 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:33:00,309 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:33:00,310 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:33:00,310 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:33:00,310 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:33:00,310 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:33:00,310 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:33:00,494 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:33:00,495 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:33:00,495 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:33:00,495 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:33:00,495 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:33:00,495 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:33:00,495 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:33:00,495 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:33:00,495 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:33:00,495 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:33:01,824 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:33:02,849 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:33:02,849 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:33:02,855 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:33:02,886 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:33:02,886 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:33:02,886 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:33:02,886 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:33:04,131 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:33:04,386 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:33:04,386 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:33:04,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:33:04,546 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:33:04,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:33:04,587 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:33:04,587 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:33:04,587 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:33:04,587 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:33:04,587 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:04,587 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:04,636 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:33:04,636 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:33:04,636 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:04,636 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:04,636 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:33:04,636 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:33:04,636 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:04,693 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:33:04,693 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:33:04,693 - src.training - INFO - 모델 학습 시작
2025-06-24 12:33:04,809 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:33:04,809 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:33:04,809 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:33:04,809 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:33:04,809 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:33:04,809 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:33:04,809 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:33:04,809 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:33:04,809 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:33:04,809 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:33:04,809 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:33:04,809 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:04,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:04,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:04,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:04,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:05,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:05,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:05,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:33:05,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:05,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:33:05,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:05,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:33:05,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:05,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:05,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:05,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:05,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:05,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:05,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:05,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:33:05,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:05,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:33:05,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:05,293 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:33:05,293 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:05,293 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   n_estimators: 207
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   min_samples_split: 18
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:33:05,302 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:33:05,303 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:33:21,910 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:33:21,911 - src.models.random_forest_model - INFO -   - 트리 개수: 207
2025-06-24 12:33:21,911 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:33:21,911 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:33:21,911 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:33:21,911 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:33:21,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:33:21,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:21,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:21,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:21,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:21,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:21,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:21,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:21,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:33:21,989 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:21,993 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:33:22,100 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:33:22,100 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:33:22,100 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:33:22,100 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:33:22,100 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:22,100 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:22,100 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:33:22,100 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:33:22,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:33:22,107 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:33:22,108 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:33:22,108 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:33:23,284 - src.training - INFO -   precision: 0.0017193947730398899
2025-06-24 12:33:23,284 - src.training - INFO -   recall: 0.018518518518518517
2025-06-24 12:33:23,284 - src.training - INFO -   f1: 0.0031466331025802393
2025-06-24 12:33:23,284 - src.training - INFO -   accuracy: 0.9856612655019462
2025-06-24 12:33:23,284 - src.training - INFO -   balanced_accuracy: 0.5026815640582805
2025-06-24 12:33:23,284 - src.training - INFO -   positive_samples: 270
2025-06-24 12:33:23,284 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:33:23,284 - src.training - INFO -   total_samples: 220940
2025-06-24 12:33:23,284 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:33:23,284 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:33:23,284 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:33:23,284 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:33:23,285 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:33:23,285 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:33:23,285 - src.training - INFO - 모델 학습 완료
2025-06-24 12:33:23,285 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0017193947730398899, 'recall': 0.018518518518518517, 'f1': 0.0031466331025802393, 'accuracy': 0.9856612655019462, 'balanced_accuracy': 0.5026815640582805, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:33:23,285 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:23,285 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:23,285 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:23,285 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:23,302 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:33:23,303 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:33:23,760 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = random_forest
2025-06-24 12:33:25,554 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:33:25,554 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:33:25,554 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:33:25,554 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:33:25,554 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:33:25,554 - src.training - INFO - 교차 검증 시작
2025-06-24 12:33:25,554 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:33:25,572 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:33:26,024 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:33:26,024 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:33:26,024 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:33:26,024 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:33:26,024 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:33:26,024 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:33:26,024 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:33:26,024 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:33:26,024 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:33:26,201 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:33:26,202 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:33:26,202 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:33:26,202 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:33:26,202 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:33:26,202 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:33:26,202 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:33:26,202 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:33:26,202 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:33:26,202 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:33:27,535 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:33:28,573 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:33:28,573 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:33:28,579 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:33:28,615 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:33:28,615 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:33:28,615 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:33:28,615 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:33:29,857 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:33:30,113 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:33:30,114 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:33:30,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:33:30,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:33:30,314 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:33:30,314 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:33:30,314 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:33:30,314 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:33:30,314 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:33:30,314 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:30,314 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:30,362 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:33:30,363 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:33:30,363 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:30,363 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:30,363 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:33:30,363 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:33:30,363 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:30,420 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:33:30,420 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:33:30,420 - src.training - INFO - 모델 학습 시작
2025-06-24 12:33:30,533 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:33:30,533 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:33:30,533 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:33:30,533 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:33:30,533 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:33:30,533 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:33:30,533 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:33:30,533 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:33:30,533 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:33:30,533 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:33:30,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:33:30,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:30,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:30,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:30,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:30,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:30,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:30,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:30,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:33:30,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:30,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:33:30,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:30,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:33:30,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:30,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:30,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:30,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:30,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:30,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:30,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:31,001 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:33:31,001 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:31,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:33:31,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:31,016 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:33:31,016 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:31,016 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:33:31,026 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:33:31,026 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:33:31,026 - src.models.random_forest_model - INFO -   n_estimators: 115
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   max_depth: 9
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   min_samples_split: 5
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:33:31,027 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:33:39,704 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:33:39,704 - src.models.random_forest_model - INFO -   - 트리 개수: 115
2025-06-24 12:33:39,705 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:33:39,705 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:33:39,705 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:33:39,705 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:33:39,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:33:39,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:39,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:39,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:39,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:39,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:39,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:39,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:39,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:33:39,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:39,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:33:39,842 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:33:39,842 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:33:39,842 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:33:39,842 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:33:39,842 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:39,842 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:39,842 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:33:39,842 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:33:39,846 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:33:39,850 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:33:39,851 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:33:39,851 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:33:41,214 - src.training - INFO -   precision: 0.0027789839339991316
2025-06-24 12:33:41,214 - src.training - INFO -   recall: 0.4740740740740741
2025-06-24 12:33:41,214 - src.training - INFO -   f1: 0.005525577379667602
2025-06-24 12:33:41,214 - src.training - INFO -   accuracy: 0.791463745813343
2025-06-24 12:33:41,214 - src.training - INFO -   balanced_accuracy: 0.6329630804502786
2025-06-24 12:33:41,214 - src.training - INFO -   positive_samples: 270
2025-06-24 12:33:41,214 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:33:41,214 - src.training - INFO -   total_samples: 220940
2025-06-24 12:33:41,214 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:33:41,214 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:33:41,214 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:33:41,214 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:33:41,216 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:33:41,216 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:33:41,216 - src.training - INFO - 모델 학습 완료
2025-06-24 12:33:41,216 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027789839339991316, 'recall': 0.4740740740740741, 'f1': 0.005525577379667602, 'accuracy': 0.791463745813343, 'balanced_accuracy': 0.6329630804502786, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:33:41,216 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:41,216 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:41,216 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:41,216 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:41,233 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:33:41,233 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:33:41,699 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = random_forest
2025-06-24 12:33:43,655 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:33:43,655 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:33:43,655 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:33:43,655 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:33:43,655 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:33:43,655 - src.training - INFO - 교차 검증 시작
2025-06-24 12:33:43,655 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:33:43,672 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:33:44,151 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:33:44,151 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:33:44,151 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:33:44,151 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:33:44,151 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:33:44,151 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:33:44,151 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:33:44,151 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:33:44,151 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:33:44,309 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:33:44,309 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:33:44,309 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:33:44,309 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:33:45,791 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:33:46,946 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:33:46,946 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:33:46,952 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:33:46,984 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:33:46,984 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:33:46,984 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:33:46,984 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:33:48,363 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:33:48,644 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:33:48,644 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:33:48,814 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:33:48,814 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:33:48,857 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:33:48,857 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:33:48,857 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:33:48,857 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:33:48,857 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:33:48,857 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:48,857 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:33:48,910 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:33:48,910 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:33:48,911 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:48,911 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:48,911 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:33:48,911 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:33:48,911 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:48,977 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:33:48,977 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:33:48,977 - src.training - INFO - 모델 학습 시작
2025-06-24 12:33:49,093 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:33:49,093 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:33:49,094 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:33:49,094 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:33:49,094 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:33:49,094 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:33:49,094 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:33:49,094 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:33:49,094 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:33:49,094 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:33:49,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:33:49,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:49,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:49,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:49,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:49,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:49,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:49,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:49,468 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:33:49,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:49,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:33:49,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:49,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:33:49,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:49,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:33:49,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:33:49,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:33:49,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:33:49,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:33:49,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:33:49,616 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:33:49,616 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:33:49,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:33:49,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:49,631 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:33:49,631 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:33:49,631 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   n_estimators: 145
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   max_depth: 12
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:33:49,641 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:34:01,485 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:34:01,485 - src.models.random_forest_model - INFO -   - 트리 개수: 145
2025-06-24 12:34:01,485 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:34:01,485 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:34:01,485 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:34:01,485 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:34:01,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:34:01,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:01,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:01,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:01,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:01,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:01,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:01,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:01,575 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:34:01,575 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:01,578 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:34:01,644 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:34:01,644 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:34:01,644 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:34:01,644 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:34:01,644 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:01,644 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:01,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:34:01,644 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:34:01,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:34:01,652 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:34:01,652 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:34:01,652 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:34:03,020 - src.training - INFO -   precision: 0.0031848824247571526
2025-06-24 12:34:03,020 - src.training - INFO -   recall: 0.2222222222222222
2025-06-24 12:34:03,020 - src.training - INFO -   f1: 0.006279763462242923
2025-06-24 12:34:03,020 - src.training - INFO -   accuracy: 0.9140535892097402
2025-06-24 12:34:03,020 - src.training - INFO -   balanced_accuracy: 0.5685611496301667
2025-06-24 12:34:03,020 - src.training - INFO -   positive_samples: 270
2025-06-24 12:34:03,020 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:34:03,020 - src.training - INFO -   total_samples: 220940
2025-06-24 12:34:03,020 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:34:03,020 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:34:03,020 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:34:03,020 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:34:03,020 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:34:03,020 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:34:03,021 - src.training - INFO - 모델 학습 완료
2025-06-24 12:34:03,021 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031848824247571526, 'recall': 0.2222222222222222, 'f1': 0.006279763462242923, 'accuracy': 0.9140535892097402, 'balanced_accuracy': 0.5685611496301667, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:34:03,021 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:03,021 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:03,021 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:03,021 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:03,038 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:34:03,038 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:34:03,509 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = random_forest
2025-06-24 12:34:05,464 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:34:05,464 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:34:05,464 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:34:05,464 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:34:05,464 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:34:05,464 - src.training - INFO - 교차 검증 시작
2025-06-24 12:34:05,464 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:34:05,482 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:34:05,958 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:34:05,958 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:34:05,958 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:34:05,958 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:34:05,958 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:34:05,958 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:34:05,958 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:34:05,958 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:34:05,958 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:34:06,126 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:34:06,126 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:34:06,126 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:34:06,126 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:34:07,613 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:34:08,770 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:34:08,771 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:34:08,777 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:34:08,808 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:34:08,808 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:34:08,809 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:34:08,809 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:34:10,198 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:34:10,484 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:34:10,484 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:34:10,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:34:10,655 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:34:10,698 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:34:10,698 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:34:10,698 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:34:10,698 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:34:10,698 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:34:10,698 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:10,698 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:10,751 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:34:10,752 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:34:10,752 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:10,752 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:10,752 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:34:10,752 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:34:10,752 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:10,817 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:34:10,817 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:34:10,818 - src.training - INFO - 모델 학습 시작
2025-06-24 12:34:10,935 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:34:10,935 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:34:10,935 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:34:10,935 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:34:10,935 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:34:10,935 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:34:10,935 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:34:10,935 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:34:10,935 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:34:10,935 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:34:10,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:34:10,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:10,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:11,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:11,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:11,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:11,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:11,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:11,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:34:11,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:11,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:34:11,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:11,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:34:11,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:11,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:11,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:11,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:11,423 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:11,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:11,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:11,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:34:11,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:11,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:34:11,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:11,475 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:34:11,475 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:11,475 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   n_estimators: 327
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   max_depth: 10
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   min_samples_split: 18
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:34:11,485 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:34:35,863 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:34:35,863 - src.models.random_forest_model - INFO -   - 트리 개수: 327
2025-06-24 12:34:35,863 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:34:35,863 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:34:35,863 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:34:35,864 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:34:35,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:34:35,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:35,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:35,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:35,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:35,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:35,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:35,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:35,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:34:35,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:35,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:34:36,094 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:34:36,094 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:34:36,094 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:34:36,094 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:34:36,094 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:36,094 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:36,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:34:36,094 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:34:36,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:34:36,103 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:34:36,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:34:36,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:34:37,427 - src.training - INFO -   precision: 0.002843601895734597
2025-06-24 12:34:37,427 - src.training - INFO -   recall: 0.37777777777777777
2025-06-24 12:34:37,427 - src.training - INFO -   f1: 0.005644714997232983
2025-06-24 12:34:37,427 - src.training - INFO -   accuracy: 0.83734950665339
2025-06-24 12:34:37,427 - src.training - INFO -   balanced_accuracy: 0.607844795899357
2025-06-24 12:34:37,428 - src.training - INFO -   positive_samples: 270
2025-06-24 12:34:37,428 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:34:37,428 - src.training - INFO -   total_samples: 220940
2025-06-24 12:34:37,428 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:34:37,428 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:34:37,428 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:34:37,428 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:34:37,428 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:34:37,428 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:34:37,428 - src.training - INFO - 모델 학습 완료
2025-06-24 12:34:37,428 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002843601895734597, 'recall': 0.37777777777777777, 'f1': 0.005644714997232983, 'accuracy': 0.83734950665339, 'balanced_accuracy': 0.607844795899357, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:34:37,428 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:37,428 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:37,428 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:37,428 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:37,446 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:34:37,446 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:34:37,926 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = random_forest
2025-06-24 12:34:39,889 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:34:39,889 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:34:39,889 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:34:39,889 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:34:39,889 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:34:39,889 - src.training - INFO - 교차 검증 시작
2025-06-24 12:34:39,889 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:34:39,906 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:34:40,391 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:34:40,391 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:34:40,391 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:34:40,391 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:34:40,391 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:34:40,391 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:34:40,391 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:34:40,391 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:34:40,391 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:34:40,553 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:34:40,553 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:34:40,553 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:34:40,553 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:34:42,014 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:34:43,157 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:34:43,157 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:34:43,164 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:34:43,195 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:34:43,196 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:34:43,196 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:34:43,196 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:34:44,561 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:34:44,840 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:34:44,840 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:34:45,009 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:34:45,009 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:34:45,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:34:45,052 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:34:45,052 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:34:45,052 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:34:45,052 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:34:45,052 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:45,052 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,105 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:34:45,105 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:34:45,105 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,105 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,105 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:34:45,105 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:34:45,105 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,171 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:34:45,171 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:34:45,171 - src.training - INFO - 모델 학습 시작
2025-06-24 12:34:45,287 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:34:45,287 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:34:45,287 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:34:45,287 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:34:45,288 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:34:45,288 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:34:45,288 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:34:45,288 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:34:45,288 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:34:45,288 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:34:45,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:34:45,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:45,288 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:45,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:45,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:45,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:45,572 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:45,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:45,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:34:45,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:45,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:34:45,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:34:45,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:45,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:45,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:45,757 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:45,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:45,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:45,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:45,809 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:34:45,809 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:45,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:34:45,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,824 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:34:45,824 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:45,824 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   n_estimators: 178
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   max_depth: 10
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   min_samples_split: 6
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:34:45,835 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:34:45,835 - src.hyperparameter_tuning - ERROR - Trial 36 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:34:46,278 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = random_forest
2025-06-24 12:34:48,075 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:34:48,075 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:34:48,075 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:34:48,075 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:34:48,075 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:34:48,075 - src.training - INFO - 교차 검증 시작
2025-06-24 12:34:48,075 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:34:48,092 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:34:48,534 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:34:48,534 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:34:48,534 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:34:48,534 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:34:48,534 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:34:48,534 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:34:48,534 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:34:48,534 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:34:48,534 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:34:48,711 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:34:48,711 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:34:48,711 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:34:48,711 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:34:50,033 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:34:51,061 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:34:51,061 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:34:51,067 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:34:51,100 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:34:51,100 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:34:51,100 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:34:51,100 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:34:52,336 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:34:52,590 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:34:52,590 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:34:52,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:34:52,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:34:52,792 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:34:52,792 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:34:52,792 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:34:52,792 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:34:52,792 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:34:52,792 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:52,792 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:34:52,844 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:34:52,844 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:34:52,844 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:52,844 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:52,844 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:34:52,844 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:34:52,844 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:52,903 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:34:52,903 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:34:52,903 - src.training - INFO - 모델 학습 시작
2025-06-24 12:34:53,017 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:34:53,017 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:34:53,017 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:34:53,017 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:34:53,017 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:34:53,017 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:34:53,017 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:34:53,017 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:34:53,017 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:34:53,017 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:34:53,017 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:34:53,017 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:53,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:53,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:53,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:53,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:53,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:53,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:53,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:34:53,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:53,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:34:53,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:53,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:34:53,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:53,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:34:53,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:34:53,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:34:53,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:34:53,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:34:53,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:34:53,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:34:53,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:34:53,493 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:34:53,493 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:53,493 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:34:53,493 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:34:53,493 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   n_estimators: 350
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   max_depth: 13
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:34:53,503 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:35:19,718 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:35:19,718 - src.models.random_forest_model - INFO -   - 트리 개수: 350
2025-06-24 12:35:19,718 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:35:19,719 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:35:19,719 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:35:19,719 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:35:19,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:35:19,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:19,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:35:19,737 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:35:19,751 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:35:19,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:35:19,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:35:19,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:35:19,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:35:19,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:19,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:35:19,949 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:35:19,949 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:35:19,949 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:35:19,949 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:35:19,950 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:35:19,950 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:35:19,950 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:35:19,950 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:35:19,954 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:35:19,958 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:35:19,959 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:35:19,959 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:35:21,192 - src.training - INFO -   precision: 0.0032457729468599035
2025-06-24 12:35:21,192 - src.training - INFO -   recall: 0.15925925925925927
2025-06-24 12:35:21,192 - src.training - INFO -   f1: 0.006361887853232727
2025-06-24 12:35:21,192 - src.training - INFO -   accuracy: 0.939205214085272
2025-06-24 12:35:21,192 - src.training - INFO -   balanced_accuracy: 0.5497093867329966
2025-06-24 12:35:21,192 - src.training - INFO -   positive_samples: 270
2025-06-24 12:35:21,192 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:35:21,192 - src.training - INFO -   total_samples: 220940
2025-06-24 12:35:21,192 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:35:21,192 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:35:21,192 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:35:21,192 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:35:21,193 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:35:21,193 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:35:21,193 - src.training - INFO - 모델 학습 완료
2025-06-24 12:35:21,193 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032457729468599035, 'recall': 0.15925925925925927, 'f1': 0.006361887853232727, 'accuracy': 0.939205214085272, 'balanced_accuracy': 0.5497093867329966, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:35:21,193 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:21,193 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:21,193 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:21,193 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:21,210 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:35:21,210 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:35:21,655 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = random_forest
2025-06-24 12:35:23,497 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:35:23,497 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:35:23,497 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:35:23,497 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:35:23,497 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:35:23,497 - src.training - INFO - 교차 검증 시작
2025-06-24 12:35:23,497 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:35:23,514 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:35:23,969 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:35:23,969 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:35:23,969 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:35:23,969 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:35:23,969 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:35:23,969 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:35:23,969 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:35:23,969 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:35:23,969 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:35:24,147 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:35:24,147 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:35:24,147 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:35:24,147 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:35:24,147 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:35:24,147 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:35:24,147 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:35:24,147 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:35:24,148 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:35:24,148 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:35:25,479 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:35:26,511 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:35:26,511 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:35:26,517 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:35:26,547 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:35:26,547 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:35:26,547 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:35:26,547 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:35:27,792 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:35:28,048 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:35:28,048 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:35:28,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:35:28,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:35:28,249 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:35:28,249 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:35:28,249 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:35:28,249 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:35:28,250 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:35:28,250 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:28,250 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,298 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:35:28,298 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:35:28,298 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,298 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,298 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:35:28,298 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:35:28,298 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,356 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:35:28,356 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:35:28,356 - src.training - INFO - 모델 학습 시작
2025-06-24 12:35:28,468 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:35:28,468 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:35:28,469 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:35:28,469 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:35:28,469 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:35:28,469 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:35:28,469 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:35:28,469 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:35:28,469 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:35:28,469 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:35:28,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:35:28,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:28,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:35:28,545 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:35:28,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:35:28,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:35:28,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:35:28,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:35:28,790 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:35:28,790 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:28,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:35:28,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:35:28,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:28,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:35:28,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:35:28,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:35:28,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:35:28,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:35:28,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:35:28,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:35:28,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:35:28,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:35:28,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,950 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:35:28,950 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:35:28,950 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:35:28,959 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   n_estimators: 420
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   max_depth: 16
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   min_samples_split: 2
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:35:28,960 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:01,064 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:36:01,064 - src.models.random_forest_model - INFO -   - 트리 개수: 420
2025-06-24 12:36:01,075 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:36:01,075 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:36:01,075 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:36:01,076 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:36:01,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:36:01,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:01,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:01,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:01,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:01,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:01,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:01,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:01,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:36:01,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:01,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:36:01,356 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:36:01,356 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:36:01,356 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:36:01,356 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:36:01,356 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:01,356 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:01,356 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:36:01,356 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:36:01,359 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:36:01,364 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:36:01,364 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:36:01,364 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:36:02,607 - src.training - INFO -   precision: 0.0037045107866637613
2025-06-24 12:36:02,607 - src.training - INFO -   recall: 0.06296296296296296
2025-06-24 12:36:02,607 - src.training - INFO -   f1: 0.006997324552377032
2025-06-24 12:36:02,607 - src.training - INFO -   accuracy: 0.9781614918077306
2025-06-24 12:36:02,607 - src.training - INFO -   balanced_accuracy: 0.5211221213509698
2025-06-24 12:36:02,607 - src.training - INFO -   positive_samples: 270
2025-06-24 12:36:02,607 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:36:02,607 - src.training - INFO -   total_samples: 220940
2025-06-24 12:36:02,607 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:36:02,607 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:36:02,607 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:36:02,607 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:36:02,608 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:36:02,608 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:36:02,608 - src.training - INFO - 모델 학습 완료
2025-06-24 12:36:02,608 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0037045107866637613, 'recall': 0.06296296296296296, 'f1': 0.006997324552377032, 'accuracy': 0.9781614918077306, 'balanced_accuracy': 0.5211221213509698, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:36:02,608 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:02,608 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:02,608 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:02,608 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:02,625 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:36:02,625 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:36:03,071 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = random_forest
2025-06-24 12:36:04,870 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:36:04,870 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:36:04,870 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:36:04,870 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:36:04,870 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:36:04,870 - src.training - INFO - 교차 검증 시작
2025-06-24 12:36:04,870 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:36:04,885 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:36:05,329 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:36:05,329 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:36:05,329 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:36:05,329 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:36:05,329 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:36:05,329 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:36:05,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:36:05,329 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:36:05,329 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:36:05,505 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:36:05,505 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:36:05,505 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:36:05,505 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:36:06,835 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:36:07,879 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:36:07,879 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:36:07,884 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:36:07,915 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:36:07,915 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:36:07,915 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:36:07,915 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:36:09,164 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:36:09,419 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:36:09,419 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:36:09,579 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:36:09,579 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:36:09,620 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:36:09,620 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:36:09,620 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:36:09,620 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:36:09,620 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:36:09,620 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:09,620 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:09,671 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:36:09,671 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:36:09,671 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:09,671 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:09,671 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:36:09,671 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:36:09,671 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:09,731 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:36:09,731 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:36:09,731 - src.training - INFO - 모델 학습 시작
2025-06-24 12:36:09,846 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:36:09,847 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:36:09,847 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:36:09,847 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:36:09,847 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:36:09,847 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:36:09,847 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:36:09,847 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:36:09,847 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:36:09,847 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:36:09,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:36:09,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:09,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:09,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:09,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:10,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:10,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:10,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:10,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:36:10,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:10,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:36:10,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:10,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:36:10,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:10,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:10,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:10,268 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:10,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:10,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:10,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:10,314 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:36:10,314 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:10,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:36:10,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:10,328 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:36:10,328 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:10,328 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:36:10,337 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:36:10,337 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:36:10,337 - src.models.random_forest_model - INFO -   n_estimators: 432
2025-06-24 12:36:10,337 - src.models.random_forest_model - INFO -   max_depth: 13
2025-06-24 12:36:10,337 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:36:10,337 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:36:10,338 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:42,469 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:36:42,469 - src.models.random_forest_model - INFO -   - 트리 개수: 432
2025-06-24 12:36:42,469 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:36:42,469 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:36:42,469 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:36:42,469 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:36:42,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:36:42,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:42,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:42,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:42,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:42,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:42,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:42,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:42,547 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:36:42,547 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:42,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:36:42,738 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:36:42,738 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:36:42,738 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:36:42,738 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:36:42,738 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:42,738 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:42,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:36:42,738 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:36:42,742 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:36:42,746 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:36:42,746 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:36:42,747 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:36:43,973 - src.training - INFO -   precision: 0.003205378781956063
2025-06-24 12:36:43,973 - src.training - INFO -   recall: 0.15185185185185185
2025-06-24 12:36:43,973 - src.training - INFO -   f1: 0.006278232907128091
2025-06-24 12:36:43,973 - src.training - INFO -   accuracy: 0.9412555444917172
2025-06-24 12:36:43,974 - src.training - INFO -   balanced_accuracy: 0.5470366342233837
2025-06-24 12:36:43,974 - src.training - INFO -   positive_samples: 270
2025-06-24 12:36:43,974 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:36:43,974 - src.training - INFO -   total_samples: 220940
2025-06-24 12:36:43,974 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:36:43,974 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:36:43,974 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:36:43,974 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:36:43,974 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:36:43,974 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:36:43,974 - src.training - INFO - 모델 학습 완료
2025-06-24 12:36:43,974 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003205378781956063, 'recall': 0.15185185185185185, 'f1': 0.006278232907128091, 'accuracy': 0.9412555444917172, 'balanced_accuracy': 0.5470366342233837, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:36:43,974 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:43,974 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:43,974 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:43,974 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:43,991 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:36:43,992 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:36:44,446 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = random_forest
2025-06-24 12:36:46,299 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:36:46,299 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:36:46,299 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:36:46,299 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:36:46,299 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:36:46,299 - src.training - INFO - 교차 검증 시작
2025-06-24 12:36:46,299 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:36:46,316 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:36:46,759 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:36:46,759 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:36:46,759 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:36:46,759 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:36:46,759 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:36:46,759 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:36:46,759 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:36:46,759 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:36:46,759 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:36:46,935 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:36:46,935 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:36:46,935 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:36:46,935 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:36:48,269 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:36:49,312 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:36:49,312 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:36:49,318 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:36:49,348 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:36:49,348 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:36:49,348 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:36:49,348 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:36:50,602 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:36:50,855 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:36:50,855 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:36:51,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:36:51,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:36:51,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:36:51,056 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:36:51,056 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:36:51,056 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:36:51,056 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:36:51,056 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:51,056 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,105 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:36:51,105 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:36:51,105 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,105 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,105 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:36:51,105 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:36:51,105 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,163 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:36:51,163 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:36:51,163 - src.training - INFO - 모델 학습 시작
2025-06-24 12:36:51,275 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:36:51,275 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:36:51,275 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:36:51,275 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:36:51,275 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:36:51,275 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:36:51,275 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:36:51,275 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:36:51,275 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:36:51,275 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:36:51,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:36:51,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:51,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:51,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:51,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:51,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:51,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:51,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:51,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:36:51,598 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:51,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:36:51,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:36:51,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:51,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:51,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:51,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:51,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:51,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:51,740 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:51,742 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:36:51,742 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:51,756 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:36:51,756 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,756 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:36:51,756 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:51,756 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   n_estimators: 376
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   min_samples_split: 9
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:36:51,766 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:51,767 - src.hyperparameter_tuning - ERROR - Trial 40 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:36:52,210 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = random_forest
2025-06-24 12:36:53,999 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:36:53,999 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:36:53,999 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:36:53,999 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:36:53,999 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:36:53,999 - src.training - INFO - 교차 검증 시작
2025-06-24 12:36:53,999 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:36:54,014 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:36:54,468 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:36:54,468 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:36:54,468 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:36:54,468 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:36:54,468 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:36:54,468 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:36:54,468 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:36:54,468 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:36:54,468 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:36:54,646 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:36:54,646 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:36:54,646 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:36:54,646 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:36:55,976 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:36:57,004 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:36:57,004 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:36:57,010 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:36:57,041 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:36:57,041 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:36:57,041 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:36:57,041 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:36:58,289 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:36:58,547 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:36:58,547 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:36:58,707 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:36:58,707 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:36:58,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:36:58,748 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:36:58,748 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:36:58,748 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:36:58,748 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:36:58,748 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:58,748 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:36:58,797 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:36:58,797 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:36:58,797 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:58,797 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:58,797 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:36:58,797 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:36:58,797 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:58,854 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:36:58,855 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:36:58,855 - src.training - INFO - 모델 학습 시작
2025-06-24 12:36:58,966 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:36:58,966 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:36:58,966 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:36:58,966 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:36:58,966 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:36:58,966 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:36:58,966 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:36:58,966 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:36:58,966 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:36:58,966 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:36:58,966 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:36:58,966 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:58,967 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:59,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:59,098 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:59,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:59,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:59,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:59,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:36:59,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:59,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:36:59,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:59,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:36:59,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:59,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:36:59,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:36:59,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:36:59,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:36:59,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:36:59,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:36:59,433 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:36:59,433 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:36:59,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:36:59,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:59,447 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:36:59,447 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:36:59,447 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   n_estimators: 303
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   max_depth: 4
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:36:59,459 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:36:59,459 - src.hyperparameter_tuning - ERROR - Trial 41 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:36:59,922 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = random_forest
2025-06-24 12:37:01,711 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:37:01,711 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:37:01,711 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:37:01,711 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:37:01,711 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:37:01,711 - src.training - INFO - 교차 검증 시작
2025-06-24 12:37:01,711 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:37:01,728 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:37:02,171 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:37:02,171 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:37:02,171 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:37:02,171 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:37:02,171 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:37:02,171 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:37:02,172 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:37:02,172 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:37:02,172 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:37:02,351 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:37:02,351 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:37:02,351 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:37:02,351 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:37:03,682 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:37:04,717 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:04,717 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:37:04,723 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:37:04,752 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:37:04,753 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:37:04,753 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:37:04,753 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:06,002 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:06,256 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:37:06,256 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:06,416 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:06,416 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:06,457 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:06,457 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:06,457 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:06,457 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:37:06,457 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:37:06,457 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:06,457 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:06,508 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:37:06,508 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:37:06,508 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:06,508 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:06,508 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:37:06,508 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:37:06,508 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:06,569 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:06,569 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:06,569 - src.training - INFO - 모델 학습 시작
2025-06-24 12:37:06,684 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:37:06,684 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:37:06,684 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:37:06,684 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:37:06,684 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:37:06,684 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:37:06,684 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:37:06,684 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:37:06,684 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:06,684 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:37:06,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:37:06,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:06,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:06,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:06,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:06,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:06,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:06,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:07,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:37:07,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:07,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:37:07,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:07,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:37:07,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:07,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:07,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:07,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:07,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:07,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:07,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:07,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:37:07,153 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:07,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:37:07,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:07,166 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:07,166 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:07,166 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   n_estimators: 328
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   min_samples_split: 8
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:37:07,178 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:37:07,178 - src.hyperparameter_tuning - ERROR - Trial 42 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:37:07,627 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = random_forest
2025-06-24 12:37:09,414 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:37:09,415 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:37:09,415 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:37:09,415 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:37:09,415 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:37:09,415 - src.training - INFO - 교차 검증 시작
2025-06-24 12:37:09,415 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:37:09,431 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:37:09,870 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:37:09,871 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:37:09,871 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:37:09,871 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:37:09,871 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:37:09,871 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:37:09,871 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:37:09,871 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:37:09,871 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:37:10,049 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:37:10,049 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:37:10,049 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:37:10,049 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:37:11,381 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:37:12,424 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:12,424 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:37:12,430 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:37:12,461 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:37:12,461 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:37:12,461 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:37:12,461 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:13,718 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:13,973 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:37:13,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:14,133 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:14,133 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:14,173 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:14,174 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:14,174 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:14,174 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:37:14,174 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:37:14,174 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:14,174 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,222 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:37:14,222 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:37:14,222 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,222 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,222 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:37:14,222 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:37:14,222 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,280 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:14,280 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:14,280 - src.training - INFO - 모델 학습 시작
2025-06-24 12:37:14,392 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:37:14,393 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:37:14,393 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:37:14,393 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:37:14,393 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:37:14,393 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:37:14,393 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:37:14,393 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:37:14,393 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:14,393 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:37:14,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:37:14,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:14,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:14,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:14,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:14,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:14,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:14,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:14,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:37:14,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:14,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:37:14,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:37:14,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:14,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:14,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:14,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:14,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:14,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:14,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:14,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:37:14,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:14,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:37:14,870 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,870 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:14,870 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:14,870 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   n_estimators: 252
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:37:14,882 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:37:14,883 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:37:28,903 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:37:28,903 - src.models.random_forest_model - INFO -   - 트리 개수: 252
2025-06-24 12:37:28,903 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:37:28,903 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:37:28,903 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:37:28,903 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:37:28,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:37:28,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:28,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:28,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:28,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:28,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:28,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:28,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:28,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:37:28,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:28,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:37:29,081 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:37:29,082 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:37:29,082 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:37:29,082 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:37:29,082 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:29,082 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:29,082 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:37:29,082 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:37:29,085 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:37:29,089 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:37:29,090 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:37:29,090 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:37:29,906 - src.training - INFO -   precision: 0.0019576451851053066
2025-06-24 12:37:29,906 - src.training - INFO -   recall: 0.8740740740740741
2025-06-24 12:37:29,906 - src.training - INFO -   f1: 0.003906540973159084
2025-06-24 12:37:29,906 - src.training - INFO -   accuracy: 0.4552774508916448
2025-06-24 12:37:29,906 - src.training - INFO -   balanced_accuracy: 0.6644195539174467
2025-06-24 12:37:29,906 - src.training - INFO -   positive_samples: 270
2025-06-24 12:37:29,906 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:37:29,906 - src.training - INFO -   total_samples: 220940
2025-06-24 12:37:29,906 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:37:29,906 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:37:29,906 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:37:29,906 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:37:29,906 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:37:29,906 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:37:29,907 - src.training - INFO - 모델 학습 완료
2025-06-24 12:37:29,907 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0019576451851053066, 'recall': 0.8740740740740741, 'f1': 0.003906540973159084, 'accuracy': 0.4552774508916448, 'balanced_accuracy': 0.6644195539174467, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:37:29,907 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:29,907 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:29,907 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:29,907 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:29,924 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:37:29,924 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:37:30,370 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = random_forest
2025-06-24 12:37:32,153 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:37:32,153 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:37:32,153 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:37:32,153 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:37:32,153 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:37:32,153 - src.training - INFO - 교차 검증 시작
2025-06-24 12:37:32,153 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:37:32,168 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:37:32,609 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:37:32,609 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:37:32,609 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:37:32,609 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:37:32,609 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:37:32,609 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:37:32,609 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:37:32,609 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:37:32,609 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:37:32,792 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:37:32,792 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:37:32,792 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:37:32,792 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:37:34,119 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:37:35,156 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:35,156 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:37:35,162 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:37:35,195 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:37:35,196 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:37:35,196 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:37:35,196 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:36,443 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:36,701 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:37:36,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:36,861 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:36,861 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:36,902 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:36,902 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:36,902 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:36,902 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:37:36,902 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:37:36,902 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:36,902 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:36,951 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:37:36,951 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:37:36,951 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:36,951 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:36,951 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:37:36,951 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:37:36,951 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:37,008 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:37,008 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:37,008 - src.training - INFO - 모델 학습 시작
2025-06-24 12:37:37,120 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:37:37,120 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:37:37,120 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:37:37,120 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:37:37,120 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:37:37,120 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:37:37,120 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:37:37,120 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:37:37,120 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:37,120 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:37:37,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:37:37,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:37,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:37,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:37,253 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:37,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:37,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:37,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:37,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:37:37,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:37,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:37:37,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:37,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:37:37,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:37,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:37,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:37,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:37,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:37,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:37,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:37,587 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:37:37,587 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:37,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:37:37,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:37,601 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:37,601 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:37,601 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   n_estimators: 148
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:37:37,611 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:37:50,271 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:37:50,271 - src.models.random_forest_model - INFO -   - 트리 개수: 148
2025-06-24 12:37:50,271 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:37:50,272 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:37:50,272 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:37:50,272 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:37:50,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:37:50,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:50,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:50,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:50,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:50,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:50,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:37:50,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:37:50,362 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:37:50,362 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:50,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:37:50,441 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:37:50,441 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:37:50,441 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:37:50,441 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:37:50,441 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:50,441 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:50,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:37:50,442 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:37:50,445 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:37:50,449 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:37:50,450 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:37:50,450 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:37:51,764 - src.training - INFO -   precision: 0.001352265043948614
2025-06-24 12:37:51,764 - src.training - INFO -   recall: 0.014814814814814815
2025-06-24 12:37:51,764 - src.training - INFO -   f1: 0.0024783147459727386
2025-06-24 12:37:51,764 - src.training - INFO -   accuracy: 0.9854259074861953
2025-06-24 12:37:51,764 - src.training - INFO -   balanced_accuracy: 0.5007141550396184
2025-06-24 12:37:51,764 - src.training - INFO -   positive_samples: 270
2025-06-24 12:37:51,764 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:37:51,764 - src.training - INFO -   total_samples: 220940
2025-06-24 12:37:51,764 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:37:51,764 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:37:51,764 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:37:51,764 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:37:51,765 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:37:51,765 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:37:51,765 - src.training - INFO - 모델 학습 완료
2025-06-24 12:37:51,765 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.001352265043948614, 'recall': 0.014814814814814815, 'f1': 0.0024783147459727386, 'accuracy': 0.9854259074861953, 'balanced_accuracy': 0.5007141550396184, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:37:51,765 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:51,765 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:51,765 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:51,765 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:51,782 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:37:51,782 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:37:52,254 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = random_forest
2025-06-24 12:37:54,227 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:37:54,227 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:37:54,227 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:37:54,227 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:37:54,227 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:37:54,227 - src.training - INFO - 교차 검증 시작
2025-06-24 12:37:54,227 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:37:54,244 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:37:54,728 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:37:54,728 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:37:54,728 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:37:54,728 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:37:54,728 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:37:54,728 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:37:54,728 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:37:54,728 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:37:54,728 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:37:54,893 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:37:54,893 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:37:54,893 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:37:54,893 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:37:56,374 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:37:57,529 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:57,529 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:37:57,535 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:37:57,567 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:37:57,567 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:37:57,567 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:37:57,567 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:37:58,953 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:37:59,234 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:37:59,234 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:59,403 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:59,403 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:37:59,446 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:37:59,447 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:59,447 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:37:59,447 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:37:59,447 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:37:59,447 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:59,447 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:37:59,499 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:37:59,499 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:37:59,499 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:59,499 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:59,500 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:37:59,500 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:37:59,500 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:37:59,565 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:59,565 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:37:59,565 - src.training - INFO - 모델 학습 시작
2025-06-24 12:37:59,681 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:37:59,681 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:37:59,681 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:37:59,681 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:37:59,681 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:37:59,681 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:37:59,681 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:37:59,681 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:37:59,681 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:37:59,681 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:37:59,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:37:59,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:37:59,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:37:59,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:37:59,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:37:59,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:37:59,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:00,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:00,061 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:38:00,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:00,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:38:00,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:00,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:38:00,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:00,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:00,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:00,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:00,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:00,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:00,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:00,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:38:00,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:00,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:38:00,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:00,224 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:38:00,224 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:00,225 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   n_estimators: 338
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   max_depth: 6
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:38:00,237 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:38:00,237 - src.hyperparameter_tuning - ERROR - Trial 45 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:38:00,713 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = random_forest
2025-06-24 12:38:02,677 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:38:02,677 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:38:02,677 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:38:02,677 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:38:02,677 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:38:02,677 - src.training - INFO - 교차 검증 시작
2025-06-24 12:38:02,677 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:38:02,694 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:38:03,171 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:38:03,171 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:38:03,171 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:38:03,171 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:38:03,171 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:38:03,171 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:38:03,171 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:38:03,171 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:38:03,171 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:38:03,338 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:38:03,338 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:38:03,338 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:38:03,338 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:38:04,822 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:38:05,974 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:38:05,974 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:38:05,980 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:38:06,012 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:38:06,012 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:38:06,012 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:38:06,012 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:38:07,400 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:38:07,680 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:38:07,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:38:07,852 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:38:07,852 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:38:07,895 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:38:07,895 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:38:07,895 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:38:07,895 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:38:07,895 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:38:07,895 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:07,895 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:38:07,948 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:38:07,948 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:38:07,948 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:07,948 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:07,948 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:38:07,948 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:38:07,948 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:08,013 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:38:08,013 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:38:08,013 - src.training - INFO - 모델 학습 시작
2025-06-24 12:38:08,129 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:38:08,129 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:38:08,129 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:38:08,129 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:38:08,129 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:38:08,129 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:38:08,129 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:38:08,129 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:38:08,129 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:38:08,129 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:38:08,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:38:08,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:08,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:08,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:08,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:08,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:08,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:08,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:08,506 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:38:08,506 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:08,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:38:08,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:08,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:38:08,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:08,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:08,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:08,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:08,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:08,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:08,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:08,655 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:38:08,655 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:08,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:38:08,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:08,671 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:38:08,671 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:08,671 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   n_estimators: 212
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   max_depth: 6
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:38:08,683 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:38:08,683 - src.hyperparameter_tuning - ERROR - Trial 46 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:38:09,159 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = random_forest
2025-06-24 12:38:11,131 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:38:11,131 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:38:11,131 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:38:11,131 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:38:11,131 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:38:11,131 - src.training - INFO - 교차 검증 시작
2025-06-24 12:38:11,131 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:38:11,148 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:38:11,627 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:38:11,627 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:38:11,627 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:38:11,627 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:38:11,627 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:38:11,627 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:38:11,627 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:38:11,627 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:38:11,627 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:38:11,793 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:38:11,793 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:38:11,793 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:38:11,793 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:38:13,267 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:38:14,419 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:38:14,419 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:38:14,425 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:38:14,458 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:38:14,458 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:38:14,458 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:38:14,458 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:38:15,843 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:38:16,121 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:38:16,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:38:16,291 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:38:16,291 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:38:16,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:38:16,334 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:38:16,334 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:38:16,334 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:38:16,334 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:38:16,334 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:16,334 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:38:16,387 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:38:16,387 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:38:16,387 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:16,387 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:16,387 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:38:16,387 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:38:16,387 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:16,452 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:38:16,452 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:38:16,452 - src.training - INFO - 모델 학습 시작
2025-06-24 12:38:16,568 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:38:16,568 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:38:16,568 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:38:16,569 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:38:16,569 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:38:16,569 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:38:16,569 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:38:16,569 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:38:16,569 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:38:16,569 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:38:16,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:38:16,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:16,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:16,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:16,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:16,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:16,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:16,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:16,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:38:16,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:17,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:38:17,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:17,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:38:17,012 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:17,012 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:17,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:17,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:17,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:17,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:17,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:17,098 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:38:17,098 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:17,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:38:17,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:17,114 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:38:17,114 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:17,114 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   n_estimators: 406
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   min_samples_split: 17
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:38:17,126 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:38:50,173 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:38:50,173 - src.models.random_forest_model - INFO -   - 트리 개수: 406
2025-06-24 12:38:50,173 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:38:50,173 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:38:50,173 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:38:50,174 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:38:50,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:38:50,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:50,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:50,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:50,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:50,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:50,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:38:50,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:38:50,263 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:38:50,263 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:50,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:38:50,463 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:38:50,464 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:38:50,464 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:38:50,464 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:38:50,464 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:38:50,464 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:38:50,464 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:38:50,464 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:38:50,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:38:50,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:38:50,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:38:50,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:38:51,787 - src.training - INFO -   precision: 0.0013966480446927375
2025-06-24 12:38:51,787 - src.training - INFO -   recall: 0.014814814814814815
2025-06-24 12:38:51,787 - src.training - INFO -   f1: 0.0025526483726866626
2025-06-24 12:38:51,787 - src.training - INFO -   accuracy: 0.9858513623608219
2025-06-24 12:38:51,787 - src.training - INFO -   balanced_accuracy: 0.5009271427588371
2025-06-24 12:38:51,787 - src.training - INFO -   positive_samples: 270
2025-06-24 12:38:51,787 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:38:51,787 - src.training - INFO -   total_samples: 220940
2025-06-24 12:38:51,787 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:38:51,787 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:38:51,787 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:38:51,787 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:38:51,787 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:38:51,787 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:38:51,788 - src.training - INFO - 모델 학습 완료
2025-06-24 12:38:51,788 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0013966480446927375, 'recall': 0.014814814814814815, 'f1': 0.0025526483726866626, 'accuracy': 0.9858513623608219, 'balanced_accuracy': 0.5009271427588371, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:38:51,788 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:51,788 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:51,788 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:51,788 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:51,805 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:38:51,805 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:38:52,277 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = random_forest
2025-06-24 12:38:54,283 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:38:54,283 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:38:54,283 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:38:54,283 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:38:54,283 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:38:54,283 - src.training - INFO - 교차 검증 시작
2025-06-24 12:38:54,283 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:38:54,301 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:38:54,777 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:38:54,777 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:38:54,777 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:38:54,777 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:38:54,777 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:38:54,777 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:38:54,777 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:38:54,777 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:38:54,777 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:38:54,942 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:38:54,942 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:38:54,942 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:38:54,942 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:38:56,413 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:38:57,566 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:38:57,566 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:38:57,572 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:38:57,604 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:38:57,604 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:38:57,604 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:38:57,604 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:38:58,976 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:38:59,255 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:38:59,255 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:38:59,424 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:38:59,424 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:38:59,467 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:38:59,467 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:38:59,467 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:38:59,467 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:38:59,467 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:38:59,467 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:59,467 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:38:59,520 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:38:59,520 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:38:59,520 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:59,520 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:59,520 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:38:59,520 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:38:59,520 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:38:59,586 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:38:59,586 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:38:59,586 - src.training - INFO - 모델 학습 시작
2025-06-24 12:38:59,702 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:38:59,702 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:38:59,702 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:38:59,702 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:38:59,702 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:38:59,702 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:38:59,702 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:38:59,702 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:38:59,702 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:38:59,702 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:38:59,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:38:59,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:38:59,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:38:59,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:38:59,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:38:59,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:38:59,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:39:00,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:39:00,082 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:39:00,082 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:00,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:39:00,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:00,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:39:00,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:00,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:39:00,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:39:00,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:39:00,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:39:00,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:39:00,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:39:00,229 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:39:00,229 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:00,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:39:00,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:00,244 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:39:00,244 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:00,244 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   n_estimators: 352
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:39:00,255 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:39:00,256 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:39:19,621 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:39:19,621 - src.models.random_forest_model - INFO -   - 트리 개수: 352
2025-06-24 12:39:19,621 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:39:19,622 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:39:19,622 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:39:19,622 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:39:19,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:39:19,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:19,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:39:19,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:39:19,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:39:19,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:39:19,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:39:19,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:39:19,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:39:19,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:19,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:39:19,820 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:39:19,820 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:39:19,820 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:39:19,820 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:39:19,820 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:39:19,820 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:39:19,820 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:39:19,820 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:39:19,823 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:39:19,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:39:19,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:39:19,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:39:20,614 - src.training - INFO -   precision: 0.0019473954621542337
2025-06-24 12:39:20,614 - src.training - INFO -   recall: 0.8703703703703703
2025-06-24 12:39:20,614 - src.training - INFO -   f1: 0.003886096044450324
2025-06-24 12:39:20,614 - src.training - INFO -   accuracy: 0.4547207386620802
2025-06-24 12:39:20,614 - src.training - INFO -   balanced_accuracy: 0.6622912711959705
2025-06-24 12:39:20,614 - src.training - INFO -   positive_samples: 270
2025-06-24 12:39:20,614 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:39:20,614 - src.training - INFO -   total_samples: 220940
2025-06-24 12:39:20,614 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:39:20,614 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:39:20,614 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:39:20,614 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:39:20,615 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:39:20,615 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:39:20,615 - src.training - INFO - 모델 학습 완료
2025-06-24 12:39:20,615 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0019473954621542337, 'recall': 0.8703703703703703, 'f1': 0.003886096044450324, 'accuracy': 0.4547207386620802, 'balanced_accuracy': 0.6622912711959705, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:39:20,615 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:20,615 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:20,615 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:20,615 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:20,633 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:39:20,633 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:39:21,073 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = random_forest
2025-06-24 12:39:22,907 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:39:22,907 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:39:22,907 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:39:22,907 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:39:22,907 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:39:22,907 - src.training - INFO - 교차 검증 시작
2025-06-24 12:39:22,907 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:39:22,923 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:39:23,373 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:39:23,373 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:39:23,373 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:39:23,373 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:39:23,373 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:39:23,373 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:39:23,373 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:39:23,373 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:39:23,373 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:39:23,552 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:39:23,552 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:39:23,552 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:39:23,552 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:39:24,888 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:39:25,923 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:39:25,923 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:39:25,940 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:39:25,970 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:39:25,970 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:39:25,970 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:39:25,971 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:39:27,218 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:39:27,472 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:39:27,472 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:39:27,632 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:39:27,632 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:39:27,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:39:27,673 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:39:27,673 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:39:27,673 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:39:27,673 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:39:27,673 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:27,673 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:39:27,722 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:39:27,722 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:39:27,722 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:27,722 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:27,722 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:39:27,722 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:39:27,722 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:27,782 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:39:27,782 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:39:27,782 - src.training - INFO - 모델 학습 시작
2025-06-24 12:39:27,897 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:39:27,897 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:39:27,897 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:39:27,897 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:39:27,897 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:39:27,897 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:39:27,897 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:39:27,897 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:39:27,897 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:39:27,897 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:39:27,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:39:27,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:27,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:39:27,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:39:28,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:39:28,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:39:28,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:39:28,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:39:28,218 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:39:28,218 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:28,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:39:28,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:28,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:39:28,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:28,287 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:39:28,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:39:28,318 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:39:28,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:39:28,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:39:28,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:39:28,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:39:28,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:28,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:39:28,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:28,379 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:39:28,379 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:28,379 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   n_estimators: 311
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:39:28,389 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:39:53,278 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:39:53,278 - src.models.random_forest_model - INFO -   - 트리 개수: 311
2025-06-24 12:39:53,278 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:39:53,278 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:39:53,278 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:39:53,279 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:39:53,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:39:53,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:53,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:39:53,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:39:53,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:39:53,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:39:53,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:39:53,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:39:53,356 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:39:53,356 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:53,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:39:53,505 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:39:53,506 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:39:53,506 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:39:53,506 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:39:53,506 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:39:53,506 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:39:53,506 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:39:53,506 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:39:53,509 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:39:53,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:39:53,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:39:53,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:39:54,663 - src.training - INFO -   precision: 0.0017331022530329288
2025-06-24 12:39:54,663 - src.training - INFO -   recall: 0.018518518518518517
2025-06-24 12:39:54,664 - src.training - INFO -   f1: 0.003169572107765452
2025-06-24 12:39:54,664 - src.training - INFO -   accuracy: 0.9857653661627591
2025-06-24 12:39:54,664 - src.training - INFO -   balanced_accuracy: 0.502733678074685
2025-06-24 12:39:54,664 - src.training - INFO -   positive_samples: 270
2025-06-24 12:39:54,664 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:39:54,664 - src.training - INFO -   total_samples: 220940
2025-06-24 12:39:54,664 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:39:54,664 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:39:54,664 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:39:54,664 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:39:54,664 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:39:54,664 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:39:54,664 - src.training - INFO - 모델 학습 완료
2025-06-24 12:39:54,664 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0017331022530329288, 'recall': 0.018518518518518517, 'f1': 0.003169572107765452, 'accuracy': 0.9857653661627591, 'balanced_accuracy': 0.502733678074685, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:39:54,664 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:54,664 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:54,664 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:39:54,664 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:39:54,682 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:39:54,682 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:39:55,136 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = random_forest
2025-06-24 12:39:56,946 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:39:56,946 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:39:56,946 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:39:56,946 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:39:56,946 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:39:56,946 - src.training - INFO - 교차 검증 시작
2025-06-24 12:39:56,946 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:39:56,961 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:39:57,412 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:39:57,412 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:39:57,412 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:39:57,412 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:39:57,412 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:39:57,412 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:39:57,412 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:39:57,412 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:39:57,412 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:39:57,592 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:39:57,592 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:39:57,592 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:39:57,592 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:39:58,916 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:39:59,938 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:39:59,938 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:39:59,944 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:39:59,975 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:39:59,975 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:39:59,975 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:39:59,975 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:01,218 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:01,472 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:40:01,473 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:01,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:01,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:01,674 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:01,674 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:01,674 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:01,674 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:40:01,674 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:40:01,674 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:01,674 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:40:01,722 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:40:01,723 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:40:01,723 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:01,723 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:01,723 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:40:01,723 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:40:01,723 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:01,781 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:01,781 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:01,781 - src.training - INFO - 모델 학습 시작
2025-06-24 12:40:01,899 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:40:01,899 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:40:01,899 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:40:01,899 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:40:01,899 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:40:01,899 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:40:01,899 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:40:01,899 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:40:01,899 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:01,899 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:40:01,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:40:01,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:01,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:01,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:02,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:02,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:02,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:02,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:02,223 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:40:02,223 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:02,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:40:02,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:02,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:40:02,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:02,292 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:02,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:02,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:02,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:02,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:02,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:02,373 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:40:02,373 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:02,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:40:02,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:02,386 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:02,386 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:02,386 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   n_estimators: 330
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   min_samples_split: 2
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:40:02,397 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:29,370 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:40:29,371 - src.models.random_forest_model - INFO -   - 트리 개수: 330
2025-06-24 12:40:29,371 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:40:29,371 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:40:29,371 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:40:29,371 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:40:29,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:40:29,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:29,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:29,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:29,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:29,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:29,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:29,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:29,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:40:29,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:29,463 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:40:29,620 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:40:29,620 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:40:29,620 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:40:29,620 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:40:29,620 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:40:29,620 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:40:29,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:40:29,620 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:40:29,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:40:29,628 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:40:29,629 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:40:29,629 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:40:31,022 - src.training - INFO -   precision: 0.00138264777048047
2025-06-24 12:40:31,022 - src.training - INFO -   recall: 0.014814814814814815
2025-06-24 12:40:31,022 - src.training - INFO -   f1: 0.002529244388239014
2025-06-24 12:40:31,022 - src.training - INFO -   accuracy: 0.9857201050058839
2025-06-24 12:40:31,022 - src.training - INFO -   balanced_accuracy: 0.5008614337816314
2025-06-24 12:40:31,022 - src.training - INFO -   positive_samples: 270
2025-06-24 12:40:31,022 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:40:31,022 - src.training - INFO -   total_samples: 220940
2025-06-24 12:40:31,022 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:40:31,022 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:40:31,022 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:40:31,022 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:40:31,022 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:40:31,022 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:40:31,022 - src.training - INFO - 모델 학습 완료
2025-06-24 12:40:31,022 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.00138264777048047, 'recall': 0.014814814814814815, 'f1': 0.002529244388239014, 'accuracy': 0.9857201050058839, 'balanced_accuracy': 0.5008614337816314, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:40:31,022 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:31,022 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:31,022 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:31,022 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:31,040 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:40:31,040 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:40:31,496 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = random_forest
2025-06-24 12:40:33,482 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:40:33,482 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:40:33,482 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:40:33,482 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:40:33,482 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:40:33,482 - src.training - INFO - 교차 검증 시작
2025-06-24 12:40:33,482 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:40:33,499 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:40:33,977 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:40:33,978 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:40:33,978 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:40:33,978 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:40:33,978 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:40:33,978 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:40:33,978 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:40:33,978 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:40:33,978 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:40:34,145 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:40:34,145 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:40:34,145 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:40:34,145 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:40:34,145 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:34,145 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:40:34,145 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:40:34,146 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:40:34,146 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:40:34,146 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:40:35,603 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:40:36,743 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:36,743 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:40:36,749 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:40:36,781 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:40:36,781 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:40:36,781 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:40:36,781 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:38,157 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:38,433 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:40:38,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:38,602 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:38,602 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:38,645 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:38,645 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:38,645 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:38,645 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:40:38,645 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:40:38,645 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:38,645 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:40:38,698 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:40:38,698 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:40:38,698 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:38,698 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:38,698 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:40:38,698 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:40:38,698 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:38,765 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:38,765 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:38,765 - src.training - INFO - 모델 학습 시작
2025-06-24 12:40:38,882 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:40:38,882 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:40:38,882 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:40:38,882 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:40:38,882 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:40:38,882 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:40:38,882 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:40:38,882 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:40:38,882 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:38,882 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:40:38,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:40:38,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:38,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:38,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:39,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:39,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:39,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:39,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:39,262 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:40:39,262 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:39,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:40:39,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:39,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:40:39,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:39,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:39,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:39,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:39,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:39,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:39,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:39,408 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:40:39,408 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:39,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:40:39,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:39,423 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:39,423 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:39,423 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   n_estimators: 446
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   min_samples_split: 7
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:39,433 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:40:39,434 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:39,434 - src.hyperparameter_tuning - ERROR - Trial 51 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:40:39,902 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = random_forest
2025-06-24 12:40:41,888 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:40:41,889 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:40:41,889 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:40:41,889 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:40:41,889 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:40:41,889 - src.training - INFO - 교차 검증 시작
2025-06-24 12:40:41,889 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:40:41,906 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:40:42,387 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:40:42,387 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:40:42,387 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:40:42,387 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:40:42,387 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:40:42,387 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:40:42,387 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:40:42,387 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:40:42,387 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:40:42,555 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:40:42,555 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:40:42,555 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:40:42,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:40:44,016 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:40:45,155 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:45,155 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:40:45,161 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:40:45,193 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:40:45,193 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:40:45,193 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:40:45,193 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:46,550 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:46,829 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:40:46,829 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:46,998 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:46,998 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:47,041 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:47,041 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:47,041 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:47,041 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:40:47,041 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:40:47,041 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:47,041 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,094 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:40:47,094 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:40:47,094 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,094 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,094 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:40:47,094 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:40:47,094 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,160 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:47,160 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:47,160 - src.training - INFO - 모델 학습 시작
2025-06-24 12:40:47,276 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:40:47,276 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:40:47,276 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:40:47,276 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:40:47,276 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:40:47,276 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:40:47,276 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:40:47,276 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:40:47,276 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:47,276 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:40:47,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:40:47,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:47,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:47,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:47,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:47,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:47,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:47,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:47,652 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:40:47,652 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:47,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:40:47,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:40:47,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:47,714 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:47,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:47,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:47,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:47,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:47,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:47,800 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:40:47,800 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:47,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:40:47,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,814 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:47,814 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:47,814 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   n_estimators: 454
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:40:47,825 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:47,825 - src.hyperparameter_tuning - ERROR - Trial 52 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:40:48,294 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = random_forest
2025-06-24 12:40:50,293 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:40:50,293 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:40:50,293 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:40:50,293 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:40:50,293 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:40:50,293 - src.training - INFO - 교차 검증 시작
2025-06-24 12:40:50,293 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:40:50,311 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:40:50,787 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:40:50,787 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:40:50,787 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:40:50,787 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:40:50,787 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:40:50,787 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:40:50,787 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:40:50,787 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:40:50,787 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:40:50,954 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:40:50,954 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:40:50,954 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:40:50,954 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:40:52,442 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:40:53,597 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:53,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:40:53,604 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:40:53,638 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:40:53,638 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:40:53,638 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:40:53,638 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:40:55,013 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:40:55,291 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:40:55,291 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:55,460 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:55,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:40:55,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:40:55,504 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:55,504 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:40:55,504 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:40:55,504 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:40:55,504 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:55,504 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:40:55,557 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:40:55,557 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:40:55,557 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:55,557 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:55,557 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:40:55,557 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:40:55,557 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:55,622 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:55,622 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:40:55,622 - src.training - INFO - 모델 학습 시작
2025-06-24 12:40:55,738 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:40:55,739 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:40:55,739 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:40:55,739 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:40:55,739 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:40:55,739 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:40:55,739 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:40:55,739 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:40:55,739 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:55,739 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:40:55,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:40:55,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:55,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:55,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:55,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:55,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:56,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:56,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:56,127 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:40:56,127 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:56,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:40:56,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:56,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:40:56,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:56,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:40:56,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:40:56,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:40:56,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:40:56,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:40:56,279 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:40:56,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:40:56,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:40:56,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:40:56,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:56,295 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:40:56,295 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:40:56,295 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   n_estimators: 355
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:40:56,307 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:23,245 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:41:23,245 - src.models.random_forest_model - INFO -   - 트리 개수: 355
2025-06-24 12:41:23,245 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:41:23,245 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:41:23,245 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:41:23,245 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:41:23,245 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:41:23,245 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:23,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:23,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:23,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:23,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:23,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:23,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:23,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:41:23,336 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:23,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:41:23,495 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:41:23,495 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:41:23,495 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:41:23,495 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:41:23,495 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:41:23,495 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:41:23,495 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:41:23,496 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:41:23,499 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:41:23,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:41:23,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:41:23,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:41:24,902 - src.training - INFO -   precision: 0.0032380134982249445
2025-06-24 12:41:24,902 - src.training - INFO -   recall: 0.3074074074074074
2025-06-24 12:41:24,902 - src.training - INFO -   f1: 0.006408524109176543
2025-06-24 12:41:24,902 - src.training - INFO -   accuracy: 0.8835113605503757
2025-06-24 12:41:24,902 - src.training - INFO -   balanced_accuracy: 0.5958118289586092
2025-06-24 12:41:24,902 - src.training - INFO -   positive_samples: 270
2025-06-24 12:41:24,902 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:41:24,902 - src.training - INFO -   total_samples: 220940
2025-06-24 12:41:24,902 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:41:24,902 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:41:24,902 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:41:24,902 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:41:24,902 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:41:24,902 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:41:24,902 - src.training - INFO - 모델 학습 완료
2025-06-24 12:41:24,902 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032380134982249445, 'recall': 0.3074074074074074, 'f1': 0.006408524109176543, 'accuracy': 0.8835113605503757, 'balanced_accuracy': 0.5958118289586092, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:41:24,902 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:24,902 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:24,902 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:24,902 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:24,920 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:41:24,920 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:41:25,390 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = random_forest
2025-06-24 12:41:27,225 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:41:27,225 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:41:27,225 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:41:27,225 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:41:27,225 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:41:27,225 - src.training - INFO - 교차 검증 시작
2025-06-24 12:41:27,225 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:41:27,242 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:41:27,685 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:41:27,686 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:41:27,686 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:41:27,686 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:41:27,686 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:41:27,686 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:41:27,686 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:41:27,686 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:41:27,686 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:41:27,871 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:41:27,871 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:41:27,871 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:41:27,871 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:41:29,201 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:41:30,237 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:30,237 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:41:30,243 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:41:30,273 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:41:30,274 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:41:30,274 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:41:30,274 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:31,506 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:31,765 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:41:31,765 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:31,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:31,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:31,968 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:31,968 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:31,968 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:31,968 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:41:31,968 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:41:31,968 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:31,968 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,017 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:41:32,017 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:41:32,017 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,017 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,017 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:41:32,017 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:41:32,017 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,075 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:32,075 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:32,075 - src.training - INFO - 모델 학습 시작
2025-06-24 12:41:32,189 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:41:32,189 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:41:32,189 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:41:32,189 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:41:32,189 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:41:32,189 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:41:32,189 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:41:32,189 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:41:32,189 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:32,189 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:41:32,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:41:32,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:32,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:32,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:32,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:32,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:32,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:32,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:32,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:41:32,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:32,582 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:41:32,582 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,582 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:41:32,582 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:32,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:32,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:32,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:32,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:32,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:32,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:32,661 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:41:32,661 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:32,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:41:32,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,674 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:32,674 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:32,674 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   n_estimators: 361
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   min_samples_split: 4
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:41:32,685 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:32,686 - src.hyperparameter_tuning - ERROR - Trial 54 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:41:33,151 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = random_forest
2025-06-24 12:41:34,965 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:41:34,965 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:41:34,965 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:41:34,965 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:41:34,965 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:41:34,965 - src.training - INFO - 교차 검증 시작
2025-06-24 12:41:34,965 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:41:34,980 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:41:35,429 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:41:35,429 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:41:35,429 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:41:35,429 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:41:35,429 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:41:35,429 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:41:35,429 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:41:35,429 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:41:35,429 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:41:35,601 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:35,602 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:35,602 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:35,602 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:35,602 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:35,602 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:41:35,602 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:41:35,602 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:41:35,602 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:41:35,602 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:41:36,916 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:41:37,944 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:37,945 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:41:37,950 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:41:37,980 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:41:37,980 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:41:37,980 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:41:37,980 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:39,199 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:39,449 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:41:39,450 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:39,610 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:39,610 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:39,650 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:39,650 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:39,650 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:39,650 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:41:39,651 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:41:39,651 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:39,651 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:41:39,690 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:41:39,690 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:41:39,690 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:39,690 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:39,690 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:41:39,690 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:41:39,690 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:39,747 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:39,747 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:39,747 - src.training - INFO - 모델 학습 시작
2025-06-24 12:41:39,859 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:41:39,859 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:41:39,859 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:41:39,859 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:41:39,859 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:41:39,859 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:41:39,859 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:41:39,859 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:41:39,859 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:39,859 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:41:39,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:41:39,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:39,860 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:39,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:39,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:40,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:40,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:40,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:40,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:41:40,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:40,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:41:40,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:40,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:41:40,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:40,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:40,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:40,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:40,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:40,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:40,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:40,324 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:41:40,324 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:40,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:41:40,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:40,337 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:40,337 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:40,337 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   n_estimators: 369
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   min_samples_split: 4
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:40,349 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:41:40,350 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:40,350 - src.hyperparameter_tuning - ERROR - Trial 55 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:41:40,806 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = random_forest
2025-06-24 12:41:42,594 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:41:42,594 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:41:42,594 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:41:42,594 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:41:42,594 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:41:42,594 - src.training - INFO - 교차 검증 시작
2025-06-24 12:41:42,594 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:41:42,610 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:41:43,058 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:41:43,058 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:41:43,058 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:41:43,058 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:41:43,058 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:41:43,058 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:41:43,058 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:41:43,058 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:41:43,058 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:41:43,234 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:41:43,234 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:41:43,234 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:41:43,234 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:41:44,564 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:41:45,596 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:45,596 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:41:45,602 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:41:45,638 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:41:45,638 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:41:45,638 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:41:45,638 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:46,880 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:47,135 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:41:47,135 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:47,295 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:47,295 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:47,336 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:47,336 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:47,336 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:47,336 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:41:47,336 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:41:47,336 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:47,336 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:41:47,385 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:41:47,385 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:41:47,385 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:47,385 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:47,385 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:41:47,385 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:41:47,385 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:47,443 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:47,443 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:47,443 - src.training - INFO - 모델 학습 시작
2025-06-24 12:41:47,556 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:41:47,557 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:41:47,557 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:41:47,557 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:41:47,557 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:41:47,557 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:41:47,557 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:41:47,557 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:41:47,557 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:47,557 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:41:47,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:41:47,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:47,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:47,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:47,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:47,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:47,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:47,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:47,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:41:47,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:47,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:41:47,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:47,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:41:47,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:47,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:47,966 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:47,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:47,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:48,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:48,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:48,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:41:48,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:48,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:41:48,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:48,039 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:48,039 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:48,039 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   n_estimators: 136
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   min_samples_split: 5
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:41:48,049 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:41:48,050 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:48,050 - src.hyperparameter_tuning - ERROR - Trial 56 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:41:48,506 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = random_forest
2025-06-24 12:41:50,323 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:41:50,324 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:41:50,324 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:41:50,324 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:41:50,324 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:41:50,324 - src.training - INFO - 교차 검증 시작
2025-06-24 12:41:50,324 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:41:50,340 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:41:50,785 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:41:50,785 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:41:50,785 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:41:50,785 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:41:50,785 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:41:50,785 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:41:50,785 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:41:50,785 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:41:50,785 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:41:50,970 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:50,971 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:50,971 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:41:50,971 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:41:50,971 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:50,971 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:41:50,971 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:41:50,971 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:41:50,971 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:41:50,971 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:41:52,298 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:41:53,333 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:53,333 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:41:53,339 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:41:53,370 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:41:53,370 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:41:53,370 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:41:53,370 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:41:54,604 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:41:54,859 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:41:54,859 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:55,020 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:55,020 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:41:55,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:41:55,061 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:55,061 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:41:55,061 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:41:55,061 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:41:55,061 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:55,061 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,109 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:41:55,110 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:41:55,110 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,110 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,110 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:41:55,110 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:41:55,110 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,168 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:55,168 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:41:55,168 - src.training - INFO - 모델 학습 시작
2025-06-24 12:41:55,282 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:41:55,282 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:41:55,282 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:41:55,282 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:41:55,282 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:41:55,282 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:41:55,282 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:41:55,282 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:41:55,282 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:55,282 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:41:55,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:41:55,283 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:55,283 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:55,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:55,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:55,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:55,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:55,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:55,609 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:41:55,609 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:55,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:41:55,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:41:55,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:55,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:41:55,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:41:55,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:41:55,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:41:55,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:41:55,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:41:55,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:41:55,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:41:55,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:41:55,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,768 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:41:55,768 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:41:55,768 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:41:55,780 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:41:55,780 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:41:55,780 - src.models.random_forest_model - INFO -   n_estimators: 128
2025-06-24 12:41:55,780 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:41:55,780 - src.models.random_forest_model - INFO -   min_samples_split: 13
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:41:55,781 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:42:05,839 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:42:05,839 - src.models.random_forest_model - INFO -   - 트리 개수: 128
2025-06-24 12:42:05,839 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:42:05,839 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:42:05,839 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:42:05,840 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:42:05,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:42:05,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:05,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:42:05,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:42:05,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:42:05,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:42:05,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:42:05,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:42:05,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:42:05,917 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:05,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:42:05,988 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:42:05,988 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:42:05,989 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:42:05,989 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:42:05,989 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:42:05,989 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:42:05,989 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:42:05,989 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:42:05,993 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:42:05,997 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:42:05,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:42:05,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:42:07,243 - src.training - INFO -   precision: 0.0031165672152331726
2025-06-24 12:42:07,243 - src.training - INFO -   recall: 0.3037037037037037
2025-06-24 12:42:07,243 - src.training - INFO -   f1: 0.0061698205485120955
2025-06-24 12:42:07,243 - src.training - INFO -   accuracy: 0.8804336018828641
2025-06-24 12:42:07,243 - src.training - INFO -   balanced_accuracy: 0.5924214807094219
2025-06-24 12:42:07,243 - src.training - INFO -   positive_samples: 270
2025-06-24 12:42:07,243 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:42:07,243 - src.training - INFO -   total_samples: 220940
2025-06-24 12:42:07,243 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:42:07,243 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:42:07,243 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:42:07,243 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:42:07,243 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:42:07,243 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:42:07,243 - src.training - INFO - 모델 학습 완료
2025-06-24 12:42:07,243 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031165672152331726, 'recall': 0.3037037037037037, 'f1': 0.0061698205485120955, 'accuracy': 0.8804336018828641, 'balanced_accuracy': 0.5924214807094219, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:42:07,243 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:07,243 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:07,243 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:07,243 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:07,261 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:42:07,261 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:42:07,718 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = random_forest
2025-06-24 12:42:09,545 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:42:09,545 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:42:09,546 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:42:09,546 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:42:09,546 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:42:09,546 - src.training - INFO - 교차 검증 시작
2025-06-24 12:42:09,546 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:42:09,562 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:42:10,012 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:42:10,012 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:42:10,012 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:42:10,012 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:42:10,012 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:42:10,012 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:42:10,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:42:10,012 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:42:10,012 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:42:10,198 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:42:10,198 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:42:10,198 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:42:10,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:42:11,520 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:42:12,549 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:42:12,549 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:42:12,555 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:42:12,586 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:42:12,586 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:42:12,586 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:42:12,586 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:42:13,829 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:42:14,083 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:42:14,083 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:42:14,243 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:42:14,243 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:42:14,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:42:14,284 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:42:14,284 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:42:14,284 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:42:14,284 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:42:14,284 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:14,284 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,332 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:42:14,332 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:42:14,332 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,332 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,332 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:42:14,332 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:42:14,332 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,390 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:42:14,390 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:42:14,390 - src.training - INFO - 모델 학습 시작
2025-06-24 12:42:14,506 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:42:14,506 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:42:14,506 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:42:14,506 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:42:14,506 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:42:14,506 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:42:14,506 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:42:14,506 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:42:14,506 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:42:14,506 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:42:14,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:42:14,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:14,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:42:14,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:42:14,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:42:14,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:42:14,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:42:14,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:42:14,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:42:14,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:14,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:42:14,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:42:14,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:14,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:42:14,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:42:14,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:42:14,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:42:14,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:42:14,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:42:14,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:42:14,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:14,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:42:14,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,992 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:42:14,992 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:14,992 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   n_estimators: 246
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   min_samples_split: 6
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:42:15,004 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:42:32,208 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:42:32,208 - src.models.random_forest_model - INFO -   - 트리 개수: 246
2025-06-24 12:42:32,208 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:42:32,208 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:42:32,208 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:42:32,208 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:42:32,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:42:32,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:32,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:42:32,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:42:32,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:42:32,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:42:32,278 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:42:32,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:42:32,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:42:32,298 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:32,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:42:32,397 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:42:32,398 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:42:32,398 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:42:32,398 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:42:32,398 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:42:32,398 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:42:32,398 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:42:32,398 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:42:32,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:42:32,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:42:32,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:42:32,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:42:33,325 - src.training - INFO -   precision: 0.002392610727798798
2025-06-24 12:42:33,325 - src.training - INFO -   recall: 0.6370370370370371
2025-06-24 12:42:33,325 - src.training - INFO -   f1: 0.004767316167299537
2025-06-24 12:42:33,325 - src.training - INFO -   accuracy: 0.6749615280166561
2025-06-24 12:42:33,325 - src.training - INFO -   balanced_accuracy: 0.6560224837154189
2025-06-24 12:42:33,325 - src.training - INFO -   positive_samples: 270
2025-06-24 12:42:33,325 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:42:33,325 - src.training - INFO -   total_samples: 220940
2025-06-24 12:42:33,325 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:42:33,325 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:42:33,325 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:42:33,325 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:42:33,325 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:42:33,325 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:42:33,325 - src.training - INFO - 모델 학습 완료
2025-06-24 12:42:33,325 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002392610727798798, 'recall': 0.6370370370370371, 'f1': 0.004767316167299537, 'accuracy': 0.6749615280166561, 'balanced_accuracy': 0.6560224837154189, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:42:33,325 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:33,325 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:33,325 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:33,325 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:33,343 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:42:33,343 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:42:33,792 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = random_forest
2025-06-24 12:42:35,754 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:42:35,754 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:42:35,754 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:42:35,754 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:42:35,754 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:42:35,754 - src.training - INFO - 교차 검증 시작
2025-06-24 12:42:35,754 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:42:35,771 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:42:36,250 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:42:36,250 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:42:36,250 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:42:36,250 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:42:36,250 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:42:36,250 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:42:36,250 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:42:36,250 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:42:36,250 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:42:36,413 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:42:36,413 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:42:36,413 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:42:36,413 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:42:37,875 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:42:39,014 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:42:39,014 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:42:39,020 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:42:39,052 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:42:39,052 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:42:39,052 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:42:39,052 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:42:40,420 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:42:40,699 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:42:40,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:42:40,867 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:42:40,868 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:42:40,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:42:40,910 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:42:40,911 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:42:40,911 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:42:40,911 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:42:40,911 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:40,911 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:42:40,963 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:42:40,963 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:42:40,963 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:40,964 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:40,964 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:42:40,964 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:42:40,964 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:41,030 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:42:41,030 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:42:41,030 - src.training - INFO - 모델 학습 시작
2025-06-24 12:42:41,146 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:42:41,146 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:42:41,146 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:42:41,146 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:42:41,146 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:42:41,146 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:42:41,146 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:42:41,146 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:42:41,146 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:42:41,146 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:42:41,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:42:41,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:41,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:42:41,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:42:41,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:42:41,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:42:41,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:42:41,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:42:41,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:42:41,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:41,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:42:41,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:41,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:42:41,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:41,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:42:41,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:42:41,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:42:41,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:42:41,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:42:41,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:42:41,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:42:41,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:42:41,687 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:42:41,687 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:41,687 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:42:41,687 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:42:41,687 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:42:41,699 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   n_estimators: 427
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   max_depth: 17
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   min_samples_split: 18
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:42:41,700 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:15,891 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:43:15,891 - src.models.random_forest_model - INFO -   - 트리 개수: 427
2025-06-24 12:43:15,891 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:43:15,891 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:43:15,891 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:43:15,891 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:43:15,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:43:15,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:15,892 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:15,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:15,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:15,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:15,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:15,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:15,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:43:15,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:15,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:43:16,192 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:43:16,192 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:43:16,192 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:43:16,192 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:43:16,192 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:16,192 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:16,192 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:43:16,192 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:43:16,196 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:43:16,200 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:43:16,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:43:16,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:43:17,596 - src.training - INFO -   precision: 0.0028669724770642203
2025-06-24 12:43:17,596 - src.training - INFO -   recall: 0.037037037037037035
2025-06-24 12:43:17,596 - src.training - INFO -   f1: 0.005321979776476849
2025-06-24 12:43:17,596 - src.training - INFO -   accuracy: 0.9830813795600616
2025-06-24 12:43:17,596 - src.training - INFO -   balanced_accuracy: 0.5106379729074251
2025-06-24 12:43:17,596 - src.training - INFO -   positive_samples: 270
2025-06-24 12:43:17,596 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:43:17,596 - src.training - INFO -   total_samples: 220940
2025-06-24 12:43:17,596 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:43:17,596 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:43:17,596 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:43:17,596 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:43:17,596 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:43:17,596 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:43:17,596 - src.training - INFO - 모델 학습 완료
2025-06-24 12:43:17,596 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028669724770642203, 'recall': 0.037037037037037035, 'f1': 0.005321979776476849, 'accuracy': 0.9830813795600616, 'balanced_accuracy': 0.5106379729074251, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:43:17,596 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:17,596 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:17,596 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:17,596 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:17,614 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:43:17,614 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:43:18,091 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = random_forest
2025-06-24 12:43:20,061 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:43:20,061 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:43:20,062 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:43:20,062 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:43:20,062 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:43:20,062 - src.training - INFO - 교차 검증 시작
2025-06-24 12:43:20,062 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:43:20,079 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:43:20,564 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:43:20,564 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:43:20,564 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:43:20,564 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:43:20,564 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:43:20,564 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:43:20,564 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:43:20,564 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:43:20,564 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:43:20,751 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:43:20,751 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:43:20,751 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:43:20,751 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:43:22,077 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:43:23,112 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:23,112 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:43:23,118 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:43:23,148 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:43:23,148 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:43:23,148 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:43:23,148 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:24,382 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:24,638 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:43:24,638 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:24,798 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:24,798 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:24,838 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:24,838 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:24,838 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:24,838 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:43:24,838 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:43:24,838 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:24,838 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:24,887 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:43:24,887 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:43:24,887 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:24,887 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:24,887 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:43:24,887 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:43:24,887 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:24,945 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:24,945 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:24,945 - src.training - INFO - 모델 학습 시작
2025-06-24 12:43:25,056 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:43:25,056 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:43:25,056 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:43:25,056 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:43:25,056 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:43:25,056 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:43:25,056 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:43:25,056 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:43:25,056 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:25,056 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:43:25,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:43:25,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:25,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:25,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:25,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:25,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:25,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:25,367 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:25,380 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:43:25,380 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:25,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:43:25,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:25,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:43:25,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:25,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:25,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:25,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:25,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:25,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:25,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:25,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:43:25,525 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:25,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:43:25,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:25,539 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:25,540 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:25,540 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   n_estimators: 258
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   min_samples_split: 16
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:43:25,551 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:25,551 - src.hyperparameter_tuning - ERROR - Trial 60 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:43:26,013 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = random_forest
2025-06-24 12:43:27,790 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:43:27,791 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:43:27,791 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:43:27,791 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:43:27,791 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:43:27,791 - src.training - INFO - 교차 검증 시작
2025-06-24 12:43:27,791 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:43:27,808 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:43:28,253 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:43:28,253 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:43:28,253 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:43:28,253 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:43:28,253 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:43:28,253 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:43:28,253 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:43:28,253 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:43:28,253 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:43:28,437 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:43:28,437 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:43:28,437 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:43:28,437 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:43:29,759 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:43:30,795 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:30,795 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:43:30,801 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:43:30,832 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:43:30,832 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:43:30,832 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:43:30,832 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:32,071 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:32,328 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:43:32,328 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:32,488 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:32,489 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:32,529 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:32,529 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:32,529 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:32,529 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:43:32,529 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:43:32,529 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:32,529 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:32,577 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:43:32,577 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:43:32,577 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:32,577 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:32,577 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:43:32,577 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:43:32,577 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:32,634 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:32,635 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:32,635 - src.training - INFO - 모델 학습 시작
2025-06-24 12:43:32,746 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:43:32,746 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:43:32,746 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:43:32,746 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:43:32,746 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:43:32,746 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:43:32,746 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:43:32,746 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:43:32,746 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:32,746 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:43:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:43:32,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:32,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:32,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:32,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:32,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:32,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:33,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:33,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:43:33,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:33,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:43:33,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:33,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:43:33,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:33,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:33,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:33,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:33,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:33,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:33,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:33,217 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:43:33,217 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:33,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:43:33,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:33,232 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:33,232 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:33,232 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   n_estimators: 104
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   min_samples_split: 4
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:43:33,243 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:33,243 - src.hyperparameter_tuning - ERROR - Trial 61 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:43:33,699 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = random_forest
2025-06-24 12:43:35,489 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:43:35,489 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:43:35,489 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:43:35,489 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:43:35,489 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:43:35,489 - src.training - INFO - 교차 검증 시작
2025-06-24 12:43:35,489 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:43:35,505 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:43:35,945 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:43:35,945 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:43:35,945 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:43:35,945 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:43:35,945 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:43:35,945 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:43:35,945 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:43:35,945 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:43:35,945 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:43:36,130 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:36,130 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:36,130 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:36,130 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:36,130 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:36,131 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:43:36,131 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:43:36,131 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:43:36,131 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:43:36,131 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:43:37,448 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:43:38,492 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:38,493 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:43:38,498 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:43:38,529 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:43:38,529 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:43:38,529 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:43:38,529 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:39,763 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:40,018 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:43:40,018 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:40,178 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:40,178 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:40,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:40,219 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:40,219 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:40,219 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:43:40,219 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:43:40,219 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:40,219 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,267 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:43:40,267 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:43:40,267 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,267 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,267 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:43:40,267 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:43:40,267 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,326 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:40,326 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:40,326 - src.training - INFO - 모델 학습 시작
2025-06-24 12:43:40,438 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:43:40,438 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:43:40,438 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:43:40,438 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:43:40,438 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:43:40,438 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:43:40,438 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:43:40,438 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:43:40,438 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:40,438 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:43:40,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:43:40,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:40,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:40,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:40,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:40,624 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:40,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:40,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:40,761 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:43:40,761 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:40,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:43:40,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:43:40,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:40,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:40,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:40,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:40,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:40,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:40,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:40,908 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:43:40,908 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:40,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:43:40,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,923 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:40,923 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:40,923 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   n_estimators: 72
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   min_samples_split: 8
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:43:40,934 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:40,934 - src.hyperparameter_tuning - ERROR - Trial 62 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:43:41,390 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = random_forest
2025-06-24 12:43:43,221 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:43:43,221 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:43:43,221 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:43:43,221 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:43:43,221 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:43:43,221 - src.training - INFO - 교차 검증 시작
2025-06-24 12:43:43,221 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:43:43,237 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:43:43,681 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:43:43,681 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:43:43,681 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:43:43,681 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:43:43,681 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:43:43,681 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:43:43,681 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:43:43,681 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:43:43,682 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:43:43,868 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:43:43,868 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:43:43,868 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:43:43,868 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:43:45,198 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:43:46,228 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:46,229 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:43:46,234 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:43:46,265 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:43:46,265 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:43:46,265 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:43:46,265 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:47,510 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:47,770 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:43:47,770 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:47,930 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:47,930 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:47,970 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:47,970 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:47,970 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:47,970 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:43:47,971 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:43:47,971 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:47,971 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,019 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:43:48,019 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:43:48,019 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,019 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,019 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:43:48,019 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:43:48,019 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,077 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:48,077 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:48,077 - src.training - INFO - 모델 학습 시작
2025-06-24 12:43:48,189 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:43:48,189 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:43:48,189 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:43:48,189 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:43:48,189 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:43:48,189 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:43:48,189 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:43:48,189 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:43:48,189 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:48,189 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:43:48,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:43:48,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:48,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:48,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:48,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:48,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:48,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:48,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:48,515 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:43:48,515 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:43:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:43:48,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:48,584 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:48,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:48,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:48,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:48,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:48,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:48,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:43:48,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:48,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:43:48,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,677 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:48,677 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:48,677 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   n_estimators: 84
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   min_samples_split: 7
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:43:48,688 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:48,688 - src.hyperparameter_tuning - ERROR - Trial 63 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:43:49,141 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = random_forest
2025-06-24 12:43:50,944 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:43:50,944 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:43:50,944 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:43:50,944 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:43:50,944 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:43:50,944 - src.training - INFO - 교차 검증 시작
2025-06-24 12:43:50,944 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:43:50,961 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:43:51,402 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:43:51,402 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:43:51,402 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:43:51,402 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:43:51,402 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:43:51,402 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:43:51,402 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:43:51,402 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:43:51,402 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:43:51,585 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:43:51,585 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:43:51,585 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:43:51,585 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:43:52,910 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:43:53,944 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:53,944 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:43:53,950 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:43:53,980 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:43:53,980 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:43:53,980 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:43:53,980 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:55,201 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:43:55,460 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:43:55,460 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:55,621 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:55,621 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:43:55,663 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:43:55,663 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:55,663 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:43:55,663 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:43:55,663 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:43:55,663 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:55,663 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:43:55,711 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:43:55,711 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:43:55,711 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:55,712 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:55,712 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:43:55,712 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:43:55,712 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:55,770 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:55,770 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:43:55,770 - src.training - INFO - 모델 학습 시작
2025-06-24 12:43:55,882 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:43:55,882 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:43:55,882 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:43:55,882 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:43:55,882 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:43:55,882 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:43:55,882 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:43:55,882 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:43:55,882 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:55,882 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:43:55,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:43:55,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:55,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:55,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:56,018 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:56,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:56,131 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:56,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:56,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:43:56,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:56,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:43:56,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:56,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:43:56,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:56,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:43:56,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:43:56,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:43:56,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:43:56,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:43:56,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:43:56,361 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:43:56,361 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:43:56,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:43:56,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:56,375 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:43:56,375 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:43:56,375 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   n_estimators: 401
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   min_samples_split: 11
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:43:56,389 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:43:56,389 - src.hyperparameter_tuning - ERROR - Trial 64 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:43:56,820 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = random_forest
2025-06-24 12:43:58,635 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:43:58,635 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:43:58,635 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:43:58,635 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:43:58,635 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:43:58,635 - src.training - INFO - 교차 검증 시작
2025-06-24 12:43:58,635 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:43:58,652 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:43:59,093 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:43:59,093 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:43:59,093 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:43:59,093 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:43:59,093 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:43:59,093 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:43:59,093 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:43:59,093 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:43:59,093 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:43:59,279 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:59,280 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:59,280 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:43:59,280 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:43:59,280 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:43:59,280 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:43:59,280 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:43:59,280 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:43:59,280 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:43:59,280 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:44:00,615 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:44:01,649 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:01,649 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:44:01,655 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:44:01,685 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:44:01,685 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:44:01,685 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:44:01,685 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:44:02,933 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:03,188 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:44:03,188 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:44:03,348 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:44:03,348 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:44:03,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:44:03,388 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:44:03,388 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:44:03,388 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:44:03,388 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:44:03,388 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:03,388 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:44:03,437 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:44:03,437 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:44:03,437 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:03,437 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:03,437 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:44:03,437 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:44:03,437 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:03,495 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:44:03,495 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:44:03,495 - src.training - INFO - 모델 학습 시작
2025-06-24 12:44:03,607 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:44:03,607 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:44:03,607 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:44:03,607 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:44:03,607 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:44:03,607 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:44:03,607 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:44:03,607 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:44:03,607 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:44:03,607 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:44:03,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:44:03,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:03,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:03,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:03,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:03,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:03,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:03,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:03,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:44:03,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:04,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:44:04,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:04,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:44:04,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:04,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:04,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:04,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:04,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:04,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:04,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:04,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:44:04,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:04,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:44:04,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:04,094 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:44:04,094 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:04,094 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   n_estimators: 494
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   min_samples_split: 4
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:44:04,107 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:44:04,107 - src.hyperparameter_tuning - ERROR - Trial 65 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:44:04,555 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = random_forest
2025-06-24 12:44:06,332 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:44:06,332 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:44:06,332 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:44:06,332 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:44:06,332 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:44:06,332 - src.training - INFO - 교차 검증 시작
2025-06-24 12:44:06,332 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:44:06,349 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:44:06,789 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:44:06,789 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:44:06,789 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:44:06,789 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:44:06,789 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:44:06,789 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:44:06,789 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:44:06,789 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:44:06,789 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:44:06,978 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:44:06,978 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:44:06,978 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:44:06,978 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:44:08,315 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:44:09,354 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:09,354 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:44:09,360 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:44:09,391 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:44:09,391 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:44:09,391 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:44:09,391 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:44:10,606 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:10,862 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:44:10,862 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:44:11,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:44:11,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:44:11,063 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:44:11,063 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:44:11,063 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:44:11,063 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:44:11,063 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:44:11,063 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:11,063 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,111 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:44:11,111 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:44:11,111 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,111 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,111 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:44:11,112 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:44:11,112 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,170 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:44:11,170 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:44:11,170 - src.training - INFO - 모델 학습 시작
2025-06-24 12:44:11,281 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:44:11,281 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:44:11,281 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:44:11,281 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:44:11,281 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:44:11,281 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:44:11,281 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:44:11,281 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:44:11,281 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:44:11,281 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:44:11,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:44:11,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:11,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:11,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:11,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:11,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:11,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:11,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:11,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:44:11,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:11,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:44:11,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:44:11,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:11,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:11,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:11,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:11,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:11,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:11,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:11,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:44:11,754 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:11,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:44:11,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,768 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:44:11,768 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:11,768 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:44:11,780 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:44:11,780 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:44:11,780 - src.models.random_forest_model - INFO -   n_estimators: 430
2025-06-24 12:44:11,780 - src.models.random_forest_model - INFO -   max_depth: 10
2025-06-24 12:44:11,780 - src.models.random_forest_model - INFO -   min_samples_split: 2
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:44:11,781 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:44:11,781 - src.hyperparameter_tuning - ERROR - Trial 66 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:44:12,230 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = random_forest
2025-06-24 12:44:14,002 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:44:14,002 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:44:14,002 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:44:14,002 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:44:14,002 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:44:14,002 - src.training - INFO - 교차 검증 시작
2025-06-24 12:44:14,002 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:44:14,018 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:44:14,460 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:44:14,460 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:44:14,460 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:44:14,460 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:44:14,460 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:44:14,460 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:44:14,460 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:44:14,460 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:44:14,460 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:44:14,647 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:44:14,648 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:44:14,648 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:44:14,648 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:44:14,648 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:44:14,648 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:44:14,648 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:44:14,648 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:44:14,648 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:44:14,648 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:44:15,971 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:44:17,013 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:17,013 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:44:17,019 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:44:17,049 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:44:17,050 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:44:17,050 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:44:17,050 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:44:18,290 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:18,551 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:44:18,551 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:44:18,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:44:18,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:44:18,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:44:18,751 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:44:18,751 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:44:18,751 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:44:18,751 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:44:18,751 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:18,751 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:44:18,800 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:44:18,800 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:44:18,800 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:18,800 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:18,800 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:44:18,800 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:44:18,800 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:18,858 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:44:18,858 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:44:18,858 - src.training - INFO - 모델 학습 시작
2025-06-24 12:44:18,969 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:44:18,969 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:44:18,969 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:44:18,970 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:44:18,970 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:44:18,970 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:44:18,970 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:44:18,970 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:44:18,970 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:44:18,970 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:44:18,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:44:18,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:18,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:19,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:19,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:19,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:19,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:19,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:19,302 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:44:19,302 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:19,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:44:19,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:19,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:44:19,367 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:19,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:19,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:19,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:19,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:19,428 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:19,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:19,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:44:19,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:19,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:44:19,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:19,460 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:44:19,460 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:19,460 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   n_estimators: 429
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   max_depth: 14
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   min_samples_split: 17
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:44:19,473 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:44:53,110 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:44:53,110 - src.models.random_forest_model - INFO -   - 트리 개수: 429
2025-06-24 12:44:53,110 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:44:53,110 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:44:53,110 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:44:53,111 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:44:53,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:44:53,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:53,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:44:53,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:44:53,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:44:53,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:44:53,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:44:53,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:44:53,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:44:53,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:53,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:44:53,391 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:44:53,392 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:44:53,392 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:44:53,392 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:44:53,392 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:44:53,392 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:44:53,392 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:44:53,392 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:44:53,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:44:53,399 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:44:53,400 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:44:53,400 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:44:54,637 - src.training - INFO -   precision: 0.003725619110234495
2025-06-24 12:44:54,637 - src.training - INFO -   recall: 0.1259259259259259
2025-06-24 12:44:54,637 - src.training - INFO -   f1: 0.007237122179650915
2025-06-24 12:44:54,637 - src.training - INFO -   accuracy: 0.9577803928668417
2025-06-24 12:44:54,637 - src.training - INFO -   balanced_accuracy: 0.5423620656955501
2025-06-24 12:44:54,637 - src.training - INFO -   positive_samples: 270
2025-06-24 12:44:54,638 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:44:54,638 - src.training - INFO -   total_samples: 220940
2025-06-24 12:44:54,638 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:44:54,638 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:44:54,638 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:44:54,638 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:44:54,638 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:44:54,638 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:44:54,638 - src.training - INFO - 모델 학습 완료
2025-06-24 12:44:54,638 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003725619110234495, 'recall': 0.1259259259259259, 'f1': 0.007237122179650915, 'accuracy': 0.9577803928668417, 'balanced_accuracy': 0.5423620656955501, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:44:54,638 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:54,638 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:54,638 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:44:54,638 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:44:54,656 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:44:54,656 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:44:55,101 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = random_forest
2025-06-24 12:44:56,945 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:44:56,945 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:44:56,945 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:44:56,945 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:44:56,945 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:44:56,945 - src.training - INFO - 교차 검증 시작
2025-06-24 12:44:56,945 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:44:56,962 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:44:57,401 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:44:57,401 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:44:57,401 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:44:57,401 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:44:57,401 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:44:57,401 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:44:57,401 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:44:57,401 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:44:57,401 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:44:57,583 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:44:57,584 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:44:57,584 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:44:57,584 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:44:57,584 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:44:57,584 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:44:57,584 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:44:57,584 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:44:57,584 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:44:57,584 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:44:58,902 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:44:59,933 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:44:59,933 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:44:59,939 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:44:59,968 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:44:59,969 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:44:59,969 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:44:59,969 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:45:01,202 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:45:01,461 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:45:01,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:45:01,621 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:45:01,621 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:45:01,662 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:45:01,662 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:45:01,662 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:45:01,662 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:45:01,662 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:45:01,662 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:01,662 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:45:01,711 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:45:01,711 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:45:01,711 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:01,711 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:01,711 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:45:01,711 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:45:01,711 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:01,768 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:45:01,769 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:45:01,769 - src.training - INFO - 모델 학습 시작
2025-06-24 12:45:01,881 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:45:01,881 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:45:01,881 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:45:01,881 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:45:01,881 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:45:01,881 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:45:01,881 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:45:01,881 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:45:01,881 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:45:01,881 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:45:01,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:45:01,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:01,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:01,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:02,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:02,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:02,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:02,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:02,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:45:02,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:02,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:45:02,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:02,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:45:02,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:02,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:02,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:02,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:02,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:02,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:02,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:02,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:45:02,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:02,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:45:02,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:02,362 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:45:02,362 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:02,362 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   n_estimators: 98
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   max_depth: 16
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:45:02,374 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:45:02,374 - src.hyperparameter_tuning - ERROR - Trial 68 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:45:02,830 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = random_forest
2025-06-24 12:45:04,607 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:45:04,607 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:45:04,607 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:45:04,607 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:45:04,607 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:45:04,607 - src.training - INFO - 교차 검증 시작
2025-06-24 12:45:04,607 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:45:04,623 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:45:05,065 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:45:05,065 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:45:05,065 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:45:05,065 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:45:05,065 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:45:05,065 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:45:05,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:45:05,065 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:45:05,065 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:45:05,249 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:45:05,249 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:45:05,249 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:45:05,249 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:45:06,575 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:45:07,608 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:45:07,608 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:45:07,614 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:45:07,645 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:45:07,645 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:45:07,645 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:45:07,645 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:45:08,878 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:45:09,138 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:45:09,138 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:45:09,298 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:45:09,298 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:45:09,339 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:45:09,339 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:45:09,339 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:45:09,339 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:45:09,339 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:45:09,339 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:09,339 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:45:09,388 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:45:09,388 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:45:09,388 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:09,388 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:09,388 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:45:09,388 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:45:09,388 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:09,445 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:45:09,445 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:45:09,445 - src.training - INFO - 모델 학습 시작
2025-06-24 12:45:09,557 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:45:09,557 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:45:09,557 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:45:09,557 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:45:09,557 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:45:09,557 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:45:09,557 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:45:09,557 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:45:09,557 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:45:09,557 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:45:09,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:45:09,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:09,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:09,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:09,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:09,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:09,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:09,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:09,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:45:09,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:09,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:45:09,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:09,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:45:09,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:09,948 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:09,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:09,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:09,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:10,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:10,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:10,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:45:10,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:10,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:45:10,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:10,039 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:45:10,039 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:10,039 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   n_estimators: 480
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   min_samples_split: 9
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:45:10,051 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:45:44,632 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:45:44,632 - src.models.random_forest_model - INFO -   - 트리 개수: 480
2025-06-24 12:45:44,632 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:45:44,632 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:45:44,632 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:45:44,632 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:45:44,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:45:44,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:44,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:44,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:44,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:44,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:44,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:44,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:44,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:45:44,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:44,713 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:45:44,901 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:45:44,901 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:45:44,901 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:45:44,901 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:45:44,901 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:45:44,901 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:45:44,901 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:45:44,901 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:45:44,905 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:45:44,909 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:45:44,910 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:45:44,910 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:45:46,105 - src.training - INFO -   precision: 0.0031533307055577452
2025-06-24 12:45:46,105 - src.training - INFO -   recall: 0.2962962962962963
2025-06-24 12:45:46,105 - src.training - INFO -   f1: 0.0062402496099844
2025-06-24 12:45:46,105 - src.training - INFO -   accuracy: 0.8846745722820676
2025-06-24 12:45:46,105 - src.training - INFO -   balanced_accuracy: 0.5908453883711056
2025-06-24 12:45:46,105 - src.training - INFO -   positive_samples: 270
2025-06-24 12:45:46,105 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:45:46,105 - src.training - INFO -   total_samples: 220940
2025-06-24 12:45:46,105 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:45:46,105 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:45:46,105 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:45:46,105 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:45:46,106 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:45:46,106 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:45:46,106 - src.training - INFO - 모델 학습 완료
2025-06-24 12:45:46,106 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031533307055577452, 'recall': 0.2962962962962963, 'f1': 0.0062402496099844, 'accuracy': 0.8846745722820676, 'balanced_accuracy': 0.5908453883711056, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:45:46,106 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:46,106 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:46,106 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:46,106 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:46,123 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:45:46,123 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:45:46,574 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = random_forest
2025-06-24 12:45:48,388 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:45:48,388 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:45:48,388 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:45:48,388 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:45:48,388 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:45:48,388 - src.training - INFO - 교차 검증 시작
2025-06-24 12:45:48,388 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:45:48,405 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:45:48,848 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:45:48,848 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:45:48,848 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:45:48,848 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:45:48,848 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:45:48,848 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:45:48,848 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:45:48,848 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:45:48,848 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:45:49,036 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:45:49,036 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:45:49,036 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:45:49,036 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:45:50,358 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:45:51,390 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:45:51,390 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:45:51,396 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:45:51,426 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:45:51,426 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:45:51,426 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:45:51,426 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:45:52,662 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:45:52,915 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:45:52,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:45:53,075 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:45:53,075 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:45:53,116 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:45:53,116 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:45:53,116 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:45:53,116 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:45:53,116 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:45:53,116 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:53,116 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,165 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:45:53,165 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:45:53,165 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,165 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,165 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:45:53,165 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:45:53,165 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,224 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:45:53,224 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:45:53,224 - src.training - INFO - 모델 학습 시작
2025-06-24 12:45:53,336 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:45:53,337 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:45:53,337 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:45:53,337 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:45:53,337 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:45:53,337 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:45:53,337 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:45:53,337 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:45:53,337 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:45:53,337 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:45:53,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:45:53,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:53,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:53,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:53,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:53,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:53,586 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:53,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:53,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:45:53,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:53,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:45:53,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:45:53,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:53,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:45:53,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:45:53,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:45:53,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:45:53,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:45:53,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:45:53,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:45:53,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:45:53,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:45:53,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,829 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:45:53,829 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:45:53,829 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   n_estimators: 185
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   max_depth: 11
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   min_samples_split: 7
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:45:53,842 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:08,367 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:46:08,368 - src.models.random_forest_model - INFO -   - 트리 개수: 185
2025-06-24 12:46:08,368 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:46:08,368 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:46:08,368 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:46:08,368 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:46:08,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:46:08,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:08,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:08,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:08,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:08,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:08,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:08,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:08,459 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:46:08,459 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:08,461 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:46:08,537 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:46:08,537 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:46:08,537 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:46:08,537 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:46:08,538 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:08,538 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:08,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:46:08,538 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:46:08,541 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:46:08,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:46:08,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:46:08,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:46:09,932 - src.training - INFO -   precision: 0.0032325462214688374
2025-06-24 12:46:09,932 - src.training - INFO -   recall: 0.3037037037037037
2025-06-24 12:46:09,932 - src.training - INFO -   f1: 0.00639700432967976
2025-06-24 12:46:09,932 - src.training - INFO -   accuracy: 0.8847062550918802
2025-06-24 12:46:09,932 - src.training - INFO -   balanced_accuracy: 0.5945604212088103
2025-06-24 12:46:09,932 - src.training - INFO -   positive_samples: 270
2025-06-24 12:46:09,932 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:46:09,932 - src.training - INFO -   total_samples: 220940
2025-06-24 12:46:09,932 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:46:09,932 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:46:09,932 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:46:09,932 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:46:09,932 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:46:09,932 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:46:09,932 - src.training - INFO - 모델 학습 완료
2025-06-24 12:46:09,932 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032325462214688374, 'recall': 0.3037037037037037, 'f1': 0.00639700432967976, 'accuracy': 0.8847062550918802, 'balanced_accuracy': 0.5945604212088103, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:46:09,932 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:09,932 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:09,932 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:09,932 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:09,950 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:46:09,950 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:46:10,422 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = random_forest
2025-06-24 12:46:12,381 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:46:12,381 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:46:12,381 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:46:12,381 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:46:12,381 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:46:12,381 - src.training - INFO - 교차 검증 시작
2025-06-24 12:46:12,381 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:46:12,398 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:46:12,877 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:46:12,877 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:46:12,877 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:46:12,877 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:46:12,878 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:46:12,878 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:46:12,878 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:46:12,878 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:46:12,878 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:46:13,042 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:46:13,042 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:46:13,042 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:46:13,042 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:46:14,497 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:46:15,639 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:15,639 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:46:15,645 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:46:15,677 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:46:15,677 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:46:15,677 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:46:15,677 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:17,040 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:17,318 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:46:17,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:17,487 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:17,487 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:17,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:17,531 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:17,531 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:17,531 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:46:17,531 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:46:17,531 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:17,531 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:17,584 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:46:17,584 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:46:17,584 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:17,584 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:17,584 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:46:17,584 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:46:17,584 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:17,651 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:17,651 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:17,651 - src.training - INFO - 모델 학습 시작
2025-06-24 12:46:17,767 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:46:17,767 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:46:17,767 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:46:17,767 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:46:17,767 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:46:17,767 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:46:17,767 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:46:17,767 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:46:17,767 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:17,767 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:46:17,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:46:17,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:17,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:17,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:17,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:17,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:18,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:18,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:18,149 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:46:18,149 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:18,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:46:18,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:18,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:46:18,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:18,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:18,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:18,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:18,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:18,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:18,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:18,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:46:18,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:18,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:46:18,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:18,311 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:18,311 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:18,311 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:46:18,322 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   n_estimators: 159
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   max_depth: 17
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   min_samples_split: 19
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:46:18,323 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:18,323 - src.hyperparameter_tuning - ERROR - Trial 71 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:46:18,798 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = random_forest
2025-06-24 12:46:20,762 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:46:20,762 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:46:20,762 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:46:20,762 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:46:20,762 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:46:20,762 - src.training - INFO - 교차 검증 시작
2025-06-24 12:46:20,762 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:46:20,779 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:46:21,259 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:46:21,259 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:46:21,259 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:46:21,259 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:46:21,259 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:46:21,259 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:46:21,259 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:46:21,259 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:46:21,259 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:46:21,424 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:46:21,424 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:46:21,424 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:46:21,424 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:46:22,882 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:46:24,020 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:24,020 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:46:24,026 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:46:24,058 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:46:24,058 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:46:24,058 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:46:24,058 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:25,413 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:25,699 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:46:25,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:25,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:25,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:25,912 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:25,912 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:25,912 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:25,912 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:46:25,912 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:46:25,912 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:25,912 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:25,965 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:46:25,965 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:46:25,965 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:25,965 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:25,965 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:46:25,965 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:46:25,965 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:26,031 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:26,031 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:26,031 - src.training - INFO - 모델 학습 시작
2025-06-24 12:46:26,146 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:46:26,146 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:46:26,146 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:46:26,146 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:46:26,146 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:46:26,146 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:46:26,146 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:46:26,146 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:46:26,147 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:26,147 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:46:26,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:46:26,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:26,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:26,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:26,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:26,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:26,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:26,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:26,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:46:26,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:26,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:46:26,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:26,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:46:26,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:26,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:26,606 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:26,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:26,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:26,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:26,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:26,674 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:46:26,674 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:26,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:46:26,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:26,689 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:26,689 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:26,689 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   n_estimators: 138
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:46:26,702 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:26,702 - src.hyperparameter_tuning - ERROR - Trial 72 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:46:27,176 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = random_forest
2025-06-24 12:46:29,135 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:46:29,135 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:46:29,135 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:46:29,135 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:46:29,135 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:46:29,135 - src.training - INFO - 교차 검증 시작
2025-06-24 12:46:29,135 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:46:29,152 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:46:29,632 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:46:29,632 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:46:29,632 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:46:29,632 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:46:29,632 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:46:29,632 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:46:29,632 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:46:29,632 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:46:29,632 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:46:29,797 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:46:29,797 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:46:29,797 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:46:29,797 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:46:31,256 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:46:32,398 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:32,398 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:46:32,404 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:46:32,436 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:46:32,436 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:46:32,436 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:46:32,436 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:33,775 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:34,059 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:46:34,059 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:34,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:34,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:34,282 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:34,282 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:34,282 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:34,282 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:46:34,282 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:46:34,282 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:34,282 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:34,335 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:46:34,335 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:46:34,335 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:34,335 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:34,335 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:46:34,335 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:46:34,335 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:34,403 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:34,403 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:34,403 - src.training - INFO - 모델 학습 시작
2025-06-24 12:46:34,520 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:46:34,520 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:46:34,520 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:46:34,520 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:46:34,520 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:46:34,520 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:46:34,520 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:46:34,520 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:46:34,520 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:34,520 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:46:34,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:46:34,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:34,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:34,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:34,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:34,739 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:34,809 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:34,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:34,898 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:46:34,898 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:34,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:46:34,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:34,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:46:34,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:34,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:34,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:34,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:35,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:35,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:35,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:35,046 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:46:35,046 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:35,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:46:35,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:35,061 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:35,061 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:35,061 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   n_estimators: 234
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   min_samples_split: 6
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:46:35,074 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:50,256 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:46:50,256 - src.models.random_forest_model - INFO -   - 트리 개수: 234
2025-06-24 12:46:50,256 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:46:50,257 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:46:50,257 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:46:50,257 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:46:50,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:46:50,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:50,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:50,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:50,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:50,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:50,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:50,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:50,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:46:50,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:50,350 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:46:50,446 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:46:50,447 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:46:50,447 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:46:50,447 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:46:50,447 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:50,447 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:50,447 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:46:50,447 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:46:50,450 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:46:50,454 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:46:50,455 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:46:50,455 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:46:51,319 - src.training - INFO -   precision: 0.0021425115764738406
2025-06-24 12:46:51,319 - src.training - INFO -   recall: 0.8037037037037037
2025-06-24 12:46:51,319 - src.training - INFO -   f1: 0.004273630518054612
2025-06-24 12:46:51,319 - src.training - INFO -   accuracy: 0.5423237077939712
2025-06-24 12:46:51,319 - src.training - INFO -   balanced_accuracy: 0.6728538004629
2025-06-24 12:46:51,319 - src.training - INFO -   positive_samples: 270
2025-06-24 12:46:51,319 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:46:51,319 - src.training - INFO -   total_samples: 220940
2025-06-24 12:46:51,319 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:46:51,319 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:46:51,319 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:46:51,319 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:46:51,320 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:46:51,320 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:46:51,320 - src.training - INFO - 모델 학습 완료
2025-06-24 12:46:51,320 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0021425115764738406, 'recall': 0.8037037037037037, 'f1': 0.004273630518054612, 'accuracy': 0.5423237077939712, 'balanced_accuracy': 0.6728538004629, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:46:51,320 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:51,320 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:51,320 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:51,320 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:51,337 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:46:51,337 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:46:51,811 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = random_forest
2025-06-24 12:46:53,805 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:46:53,805 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:46:53,805 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:46:53,805 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:46:53,805 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:46:53,805 - src.training - INFO - 교차 검증 시작
2025-06-24 12:46:53,805 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:46:53,822 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:46:54,299 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:46:54,299 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:46:54,299 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:46:54,299 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:46:54,299 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:46:54,299 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:46:54,299 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:46:54,299 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:46:54,299 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:46:54,469 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:54,470 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:54,470 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:46:54,470 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:46:54,470 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:54,470 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:46:54,470 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:46:54,470 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:46:54,470 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:46:54,470 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:46:55,928 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:46:57,066 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:57,066 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:46:57,074 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:46:57,106 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:46:57,106 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:46:57,106 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:46:57,106 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:46:58,464 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:46:58,754 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:46:58,754 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:58,923 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:58,923 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:46:58,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:46:58,967 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:58,967 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:46:58,967 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:46:58,967 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:46:58,967 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:58,967 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,019 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:46:59,020 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:46:59,020 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,020 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,020 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:46:59,020 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:46:59,020 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,088 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:59,088 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:46:59,088 - src.training - INFO - 모델 학습 시작
2025-06-24 12:46:59,195 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:46:59,195 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:46:59,195 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:46:59,195 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:46:59,195 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:46:59,195 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:46:59,195 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:46:59,195 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:46:59,195 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:59,195 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:46:59,195 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:46:59,195 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:59,195 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:59,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:59,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:59,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:59,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:59,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:59,574 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:46:59,574 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:59,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:46:59,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:46:59,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:59,642 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:46:59,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:46:59,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:46:59,692 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:46:59,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:46:59,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:46:59,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:46:59,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:46:59,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:46:59,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,744 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:46:59,744 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:46:59,744 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:46:59,756 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:46:59,756 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:46:59,756 - src.models.random_forest_model - INFO -   n_estimators: 114
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   min_samples_split: 16
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   min_samples_leaf: 9
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:46:59,757 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:46:59,757 - src.hyperparameter_tuning - ERROR - Trial 74 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:47:00,204 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = random_forest
2025-06-24 12:47:02,213 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:47:02,213 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:47:02,213 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:47:02,213 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:47:02,213 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:47:02,213 - src.training - INFO - 교차 검증 시작
2025-06-24 12:47:02,213 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:47:02,230 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:47:02,703 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:47:02,703 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:47:02,703 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:47:02,703 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:47:02,703 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:47:02,703 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:47:02,703 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:47:02,703 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:47:02,703 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:47:02,874 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:47:02,874 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:47:02,874 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:47:02,874 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:47:04,324 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:47:05,454 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:47:05,454 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:47:05,462 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:47:05,494 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:47:05,494 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:47:05,494 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:47:05,494 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:47:06,853 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:47:07,143 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:47:07,143 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:47:07,311 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:47:07,312 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:47:07,355 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:47:07,355 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:47:07,355 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:47:07,355 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:47:07,355 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:47:07,355 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:07,355 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:07,408 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:47:07,408 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:47:07,408 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:07,408 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:07,408 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:47:07,408 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:47:07,408 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:07,474 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:47:07,474 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:47:07,474 - src.training - INFO - 모델 학습 시작
2025-06-24 12:47:07,591 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:47:07,591 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:47:07,591 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:47:07,591 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:47:07,591 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:47:07,591 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:47:07,591 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:47:07,591 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:47:07,591 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:47:07,591 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:47:07,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:47:07,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:07,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:07,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:07,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:07,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:07,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:07,973 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:47:07,973 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:08,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:47:08,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:08,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:47:08,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:08,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:08,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:08,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:08,088 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:08,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:08,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:08,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:47:08,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:08,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:47:08,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:08,139 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:47:08,140 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:08,140 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   n_estimators: 92
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   min_samples_split: 16
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:47:08,153 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:47:08,154 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:47:16,184 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:47:16,184 - src.models.random_forest_model - INFO -   - 트리 개수: 92
2025-06-24 12:47:16,184 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:47:16,184 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:47:16,184 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:47:16,184 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:47:16,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:47:16,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:16,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:16,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:16,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:16,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:16,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:16,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:16,263 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:47:16,263 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:16,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:47:16,322 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:47:16,323 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:47:16,323 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:47:16,323 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:47:16,323 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:16,323 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:16,323 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:47:16,323 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:47:16,326 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:47:16,330 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:47:16,330 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:47:16,330 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:47:17,564 - src.training - INFO -   precision: 0.0016398819285011479
2025-06-24 12:47:17,564 - src.training - INFO -   recall: 0.018518518518518517
2025-06-24 12:47:17,564 - src.training - INFO -   f1: 0.0030129557095510697
2025-06-24 12:47:17,564 - src.training - INFO -   accuracy: 0.9850230831900063
2025-06-24 12:47:17,564 - src.training - INFO -   balanced_accuracy: 0.5023620824794524
2025-06-24 12:47:17,564 - src.training - INFO -   positive_samples: 270
2025-06-24 12:47:17,564 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:47:17,564 - src.training - INFO -   total_samples: 220940
2025-06-24 12:47:17,564 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:47:17,564 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:47:17,564 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:47:17,564 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:47:17,565 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:47:17,565 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:47:17,565 - src.training - INFO - 모델 학습 완료
2025-06-24 12:47:17,565 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0016398819285011479, 'recall': 0.018518518518518517, 'f1': 0.0030129557095510697, 'accuracy': 0.9850230831900063, 'balanced_accuracy': 0.5023620824794524, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:47:17,565 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:17,565 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:17,565 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:17,565 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:17,582 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:47:17,582 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:47:18,030 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = random_forest
2025-06-24 12:47:19,823 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:47:19,823 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:47:19,823 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:47:19,823 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:47:19,823 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:47:19,823 - src.training - INFO - 교차 검증 시작
2025-06-24 12:47:19,823 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:47:19,840 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:47:20,281 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:47:20,281 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:47:20,281 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:47:20,281 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:47:20,281 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:47:20,281 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:47:20,281 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:47:20,281 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:47:20,281 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:47:20,467 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:47:20,467 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:47:20,467 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:47:20,467 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:47:21,773 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:47:22,800 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:47:22,800 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:47:22,808 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:47:22,839 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:47:22,839 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:47:22,839 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:47:22,839 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:47:24,073 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:47:24,337 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:47:24,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:47:24,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:47:24,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:47:24,539 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:47:24,539 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:47:24,539 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:47:24,539 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:47:24,539 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:47:24,539 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:24,539 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:24,588 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:47:24,588 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:47:24,588 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:24,588 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:24,588 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:47:24,588 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:47:24,588 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:24,647 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:47:24,647 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:47:24,647 - src.training - INFO - 모델 학습 시작
2025-06-24 12:47:24,754 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:47:24,754 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:47:24,754 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:47:24,754 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:47:24,754 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:47:24,754 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:47:24,754 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:47:24,754 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:47:24,754 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:47:24,754 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:47:24,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:47:24,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:24,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:24,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:24,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:24,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:24,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:25,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:25,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:47:25,078 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:25,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:47:25,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:25,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:47:25,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:25,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:25,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:25,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:25,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:25,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:25,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:25,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:47:25,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:25,245 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:47:25,245 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:25,245 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:47:25,245 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:25,245 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   n_estimators: 54
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   max_depth: 8
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   min_samples_split: 11
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:47:25,257 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:47:29,896 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:47:29,896 - src.models.random_forest_model - INFO -   - 트리 개수: 54
2025-06-24 12:47:29,896 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:47:29,896 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:47:29,896 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:47:29,896 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:47:29,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:47:29,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:29,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:29,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:29,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:29,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:29,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:29,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:29,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:47:29,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:29,988 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:47:30,024 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:47:30,024 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:47:30,024 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:47:30,024 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:47:30,024 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:30,024 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:30,024 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:47:30,024 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:47:30,027 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:47:30,032 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:47:30,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:47:30,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:47:31,352 - src.training - INFO -   precision: 0.0026511499793416887
2025-06-24 12:47:31,352 - src.training - INFO -   recall: 0.5703703703703704
2025-06-24 12:47:31,352 - src.training - INFO -   f1: 0.005277768257993763
2025-06-24 12:47:31,352 - src.training - INFO -   accuracy: 0.7372589843396398
2025-06-24 12:47:31,352 - src.training - INFO -   balanced_accuracy: 0.6539167753424335
2025-06-24 12:47:31,352 - src.training - INFO -   positive_samples: 270
2025-06-24 12:47:31,352 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:47:31,352 - src.training - INFO -   total_samples: 220940
2025-06-24 12:47:31,352 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:47:31,352 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:47:31,352 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:47:31,352 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:47:31,353 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:47:31,353 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:47:31,353 - src.training - INFO - 모델 학습 완료
2025-06-24 12:47:31,353 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026511499793416887, 'recall': 0.5703703703703704, 'f1': 0.005277768257993763, 'accuracy': 0.7372589843396398, 'balanced_accuracy': 0.6539167753424335, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:47:31,353 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:31,353 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:31,353 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:31,353 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:31,370 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:47:31,371 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:47:31,839 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = random_forest
2025-06-24 12:47:33,798 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:47:33,798 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:47:33,798 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:47:33,798 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:47:33,798 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:47:33,798 - src.training - INFO - 교차 검증 시작
2025-06-24 12:47:33,798 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:47:33,815 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:47:34,291 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:47:34,291 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:47:34,291 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:47:34,291 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:47:34,291 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:47:34,291 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:47:34,291 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:47:34,291 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:47:34,291 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:47:34,462 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:47:34,462 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:47:34,462 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:47:34,462 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:47:35,918 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:47:37,054 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:47:37,055 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:47:37,063 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:47:37,095 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:47:37,095 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:47:37,095 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:47:37,095 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:47:38,462 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:47:38,748 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:47:38,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:47:38,917 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:47:38,917 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:47:38,960 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:47:38,960 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:47:38,960 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:47:38,961 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:47:38,961 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:47:38,961 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:38,961 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,013 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:47:39,014 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:47:39,014 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,014 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,014 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:47:39,014 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:47:39,014 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,082 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:47:39,082 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:47:39,082 - src.training - INFO - 모델 학습 시작
2025-06-24 12:47:39,198 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:47:39,198 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:47:39,198 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:47:39,198 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:47:39,198 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:47:39,198 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:47:39,198 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:47:39,198 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:47:39,198 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:47:39,198 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:47:39,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:47:39,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:39,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:39,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:39,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:39,423 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:39,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:39,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:39,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:47:39,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:39,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:47:39,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:47:39,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:39,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:47:39,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:47:39,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:47:39,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:47:39,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:47:39,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:47:39,731 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:47:39,731 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:47:39,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:47:39,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,746 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:47:39,746 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:47:39,746 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   n_estimators: 387
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:47:39,760 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:48:06,293 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:48:06,293 - src.models.random_forest_model - INFO -   - 트리 개수: 387
2025-06-24 12:48:06,293 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:48:06,293 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:48:06,293 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:48:06,293 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:48:06,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:48:06,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:06,294 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:06,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:06,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:06,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:06,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:06,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:06,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:48:06,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:06,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:48:06,545 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:48:06,545 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:48:06,545 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:48:06,545 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:48:06,545 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:06,545 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:06,545 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:48:06,545 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:48:06,549 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:48:06,553 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:48:06,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:48:06,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:48:07,470 - src.training - INFO -   precision: 0.0023706480690244506
2025-06-24 12:48:07,470 - src.training - INFO -   recall: 0.6370370370370371
2025-06-24 12:48:07,470 - src.training - INFO -   f1: 0.004723717455783808
2025-06-24 12:48:07,470 - src.training - INFO -   accuracy: 0.6719471349687698
2025-06-24 12:48:07,470 - src.training - INFO -   balanced_accuracy: 0.6545134430664861
2025-06-24 12:48:07,470 - src.training - INFO -   positive_samples: 270
2025-06-24 12:48:07,470 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:48:07,470 - src.training - INFO -   total_samples: 220940
2025-06-24 12:48:07,470 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:48:07,470 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:48:07,470 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:48:07,470 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:48:07,470 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:48:07,470 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:48:07,470 - src.training - INFO - 모델 학습 완료
2025-06-24 12:48:07,470 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0023706480690244506, 'recall': 0.6370370370370371, 'f1': 0.004723717455783808, 'accuracy': 0.6719471349687698, 'balanced_accuracy': 0.6545134430664861, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:48:07,470 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:07,470 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:07,470 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:07,470 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:07,488 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:48:07,488 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:48:07,949 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = random_forest
2025-06-24 12:48:09,943 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:48:09,944 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:48:09,944 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:48:09,944 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:48:09,944 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:48:09,944 - src.training - INFO - 교차 검증 시작
2025-06-24 12:48:09,944 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:48:09,961 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:48:10,441 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:48:10,441 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:48:10,441 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:48:10,441 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:48:10,441 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:48:10,441 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:48:10,441 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:48:10,441 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:48:10,441 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:48:10,612 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:48:10,612 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:48:10,612 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:48:10,612 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:48:12,066 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:48:13,201 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:48:13,201 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:48:13,209 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:48:13,241 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:48:13,241 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:48:13,241 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:48:13,241 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:48:14,586 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:48:14,869 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:48:14,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:48:15,040 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:48:15,040 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:48:15,082 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:48:15,083 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:48:15,083 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:48:15,083 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:48:15,083 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:48:15,083 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:15,083 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,135 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:48:15,136 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:48:15,136 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,136 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,136 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:48:15,136 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:48:15,136 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,203 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:48:15,203 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:48:15,203 - src.training - INFO - 모델 학습 시작
2025-06-24 12:48:15,318 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:48:15,318 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:48:15,318 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:48:15,318 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:48:15,318 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:48:15,318 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:48:15,318 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:48:15,318 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:48:15,318 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:48:15,318 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:48:15,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:48:15,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:15,319 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:15,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:15,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:15,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:15,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:15,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:15,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:48:15,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:48:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:48:15,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:15,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:15,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:15,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:15,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:15,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:15,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:15,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:48:15,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:15,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:48:15,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,868 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:48:15,868 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:15,868 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:48:15,881 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   n_estimators: 128
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:48:15,882 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:48:26,509 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:48:26,509 - src.models.random_forest_model - INFO -   - 트리 개수: 128
2025-06-24 12:48:26,509 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:48:26,509 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:48:26,509 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:48:26,510 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:48:26,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:48:26,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:26,510 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:26,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:26,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:26,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:26,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:26,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:26,587 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:48:26,587 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:26,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:48:26,667 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:48:26,667 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:48:26,667 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:48:26,667 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:48:26,667 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:26,667 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:26,667 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:48:26,667 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:48:26,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:48:26,674 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:48:26,675 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:48:26,675 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:48:27,852 - src.training - INFO -   precision: 0.001951219512195122
2025-06-24 12:48:27,852 - src.training - INFO -   recall: 0.022222222222222223
2025-06-24 12:48:27,852 - src.training - INFO -   f1: 0.003587443946188341
2025-06-24 12:48:27,852 - src.training - INFO -   accuracy: 0.984914456413506
2025-06-24 12:48:27,852 - src.training - INFO -   balanced_accuracy: 0.5041572886612992
2025-06-24 12:48:27,852 - src.training - INFO -   positive_samples: 270
2025-06-24 12:48:27,852 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:48:27,852 - src.training - INFO -   total_samples: 220940
2025-06-24 12:48:27,852 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:48:27,852 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:48:27,852 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:48:27,852 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:48:27,853 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:48:27,853 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:48:27,853 - src.training - INFO - 모델 학습 완료
2025-06-24 12:48:27,853 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.001951219512195122, 'recall': 0.022222222222222223, 'f1': 0.003587443946188341, 'accuracy': 0.984914456413506, 'balanced_accuracy': 0.5041572886612992, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:48:27,853 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:27,853 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:27,853 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:27,853 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:27,871 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:48:27,871 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:48:28,312 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = random_forest
2025-06-24 12:48:30,121 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:48:30,121 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:48:30,121 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:48:30,121 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:48:30,121 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:48:30,121 - src.training - INFO - 교차 검증 시작
2025-06-24 12:48:30,121 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:48:30,138 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:48:30,588 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:48:30,588 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:48:30,588 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:48:30,588 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:48:30,588 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:48:30,588 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:48:30,588 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:48:30,588 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:48:30,588 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:48:30,775 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:48:30,775 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:48:30,775 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:48:30,775 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:48:32,089 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:48:33,112 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:48:33,112 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:48:33,120 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:48:33,151 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:48:33,151 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:48:33,151 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:48:33,151 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:48:34,383 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:48:34,646 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:48:34,646 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:48:34,806 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:48:34,806 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:48:34,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:48:34,847 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:48:34,847 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:48:34,847 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:48:34,847 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:48:34,847 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:34,847 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:34,896 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:48:34,896 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:48:34,896 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:34,896 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:34,896 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:48:34,896 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:48:34,896 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:34,955 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:48:34,955 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:48:34,955 - src.training - INFO - 모델 학습 시작
2025-06-24 12:48:35,061 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:48:35,061 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:48:35,061 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:48:35,061 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:48:35,061 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:48:35,061 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:48:35,061 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:48:35,061 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:48:35,061 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:48:35,061 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:48:35,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:48:35,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:35,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:35,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:35,194 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:35,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:35,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:35,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:35,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:48:35,385 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:35,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:48:35,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:35,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:48:35,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:35,459 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:35,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:35,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:35,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:35,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:35,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:35,540 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:48:35,540 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:35,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:48:35,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:35,554 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:48:35,554 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:35,554 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   n_estimators: 234
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   min_samples_leaf: 6
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:48:35,566 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:48:54,298 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:48:54,298 - src.models.random_forest_model - INFO -   - 트리 개수: 234
2025-06-24 12:48:54,298 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:48:54,298 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:48:54,298 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:48:54,298 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:48:54,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:48:54,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:54,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:48:54,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:48:54,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:48:54,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:48:54,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:48:54,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:48:54,375 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:48:54,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:54,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:48:54,495 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:48:54,496 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:48:54,496 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:48:54,496 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:48:54,496 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:54,496 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:48:54,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:48:54,496 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:48:54,499 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:48:54,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:48:54,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:48:54,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:48:55,689 - src.training - INFO -   precision: 0.0017367141368530739
2025-06-24 12:48:55,690 - src.training - INFO -   recall: 0.018518518518518517
2025-06-24 12:48:55,690 - src.training - INFO -   f1: 0.0031756113051762463
2025-06-24 12:48:55,690 - src.training - INFO -   accuracy: 0.9857925228568842
2025-06-24 12:48:55,690 - src.training - INFO -   balanced_accuracy: 0.5027472730354862
2025-06-24 12:48:55,690 - src.training - INFO -   positive_samples: 270
2025-06-24 12:48:55,690 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:48:55,690 - src.training - INFO -   total_samples: 220940
2025-06-24 12:48:55,690 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:48:55,690 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:48:55,690 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:48:55,690 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:48:55,690 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:48:55,690 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:48:55,690 - src.training - INFO - 모델 학습 완료
2025-06-24 12:48:55,690 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0017367141368530739, 'recall': 0.018518518518518517, 'f1': 0.0031756113051762463, 'accuracy': 0.9857925228568842, 'balanced_accuracy': 0.5027472730354862, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:48:55,690 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:55,690 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:55,690 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:48:55,690 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:48:55,708 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:48:55,708 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:48:56,135 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = random_forest
2025-06-24 12:48:57,918 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:48:57,918 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:48:57,918 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:48:57,918 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:48:57,918 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:48:57,918 - src.training - INFO - 교차 검증 시작
2025-06-24 12:48:57,918 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:48:57,935 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:48:58,379 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:48:58,379 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:48:58,379 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:48:58,379 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:48:58,379 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:48:58,379 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:48:58,379 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:48:58,379 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:48:58,379 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:48:58,566 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:48:58,566 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:48:58,566 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:48:58,566 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:48:58,566 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:48:58,566 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:48:58,566 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:48:58,566 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:48:58,566 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:48:58,567 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:48:59,883 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:49:00,911 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:00,911 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:49:00,919 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:49:00,951 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:49:00,951 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:49:00,951 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:49:00,951 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:02,187 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:02,451 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:49:02,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:02,612 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:02,612 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:02,653 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:02,653 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:02,653 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:02,653 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:49:02,653 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:49:02,653 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:02,653 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:02,702 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:49:02,702 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:49:02,702 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:02,702 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:02,702 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:49:02,702 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:49:02,702 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:02,760 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:02,760 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:02,760 - src.training - INFO - 모델 학습 시작
2025-06-24 12:49:02,873 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:49:02,873 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:49:02,873 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:49:02,873 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:49:02,873 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:49:02,873 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:49:02,873 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:49:02,874 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:49:02,874 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:02,874 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:49:02,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:49:02,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:02,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:02,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:03,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:03,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:03,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:03,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:03,202 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:49:03,202 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:03,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:49:03,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:03,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:03,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:03,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:03,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:03,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:03,324 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:03,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:03,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:03,357 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:03,357 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:03,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:49:03,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:03,371 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:03,371 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:03,371 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   n_estimators: 53
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   max_depth: 19
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   min_samples_split: 7
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:49:03,386 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:08,622 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:49:08,622 - src.models.random_forest_model - INFO -   - 트리 개수: 53
2025-06-24 12:49:08,622 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:49:08,622 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:49:08,622 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:49:08,622 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:49:08,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:08,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:08,623 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:08,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:08,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:08,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:08,692 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:08,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:08,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:08,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:08,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:49:08,751 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:49:08,751 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:49:08,751 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:49:08,751 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:49:08,751 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:08,751 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:08,751 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:49:08,751 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:49:08,755 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:49:08,759 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:49:08,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:49:08,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:49:10,048 - src.training - INFO -   precision: 0.0023003614853762734
2025-06-24 12:49:10,048 - src.training - INFO -   recall: 0.025925925925925925
2025-06-24 12:49:10,048 - src.training - INFO -   f1: 0.004225777241171144
2025-06-24 12:49:10,048 - src.training - INFO -   accuracy: 0.9850683443468815
2025-06-24 12:49:10,048 - src.training - INFO -   balanced_accuracy: 0.5060839127975576
2025-06-24 12:49:10,048 - src.training - INFO -   positive_samples: 270
2025-06-24 12:49:10,049 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:49:10,049 - src.training - INFO -   total_samples: 220940
2025-06-24 12:49:10,049 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:49:10,049 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:49:10,049 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:49:10,049 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:49:10,050 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:49:10,050 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:49:10,050 - src.training - INFO - 모델 학습 완료
2025-06-24 12:49:10,050 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0023003614853762734, 'recall': 0.025925925925925925, 'f1': 0.004225777241171144, 'accuracy': 0.9850683443468815, 'balanced_accuracy': 0.5060839127975576, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:49:10,050 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:10,050 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:10,050 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:10,050 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:10,067 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:49:10,067 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:49:10,530 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = random_forest
2025-06-24 12:49:12,546 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:49:12,547 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:49:12,547 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:49:12,547 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:49:12,547 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:49:12,547 - src.training - INFO - 교차 검증 시작
2025-06-24 12:49:12,547 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:49:12,564 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:49:13,040 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:49:13,040 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:49:13,040 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:49:13,040 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:49:13,040 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:49:13,040 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:49:13,040 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:49:13,040 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:49:13,040 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:49:13,213 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:13,213 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:13,213 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:13,213 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:13,214 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:13,214 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:49:13,214 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:49:13,214 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:49:13,214 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:49:13,214 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:49:14,663 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:49:15,791 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:15,791 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:49:15,797 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:49:15,832 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:49:15,832 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:49:15,832 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:49:15,832 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:17,183 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:17,464 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:49:17,464 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:17,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:17,633 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:17,676 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:17,676 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:17,677 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:17,677 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:49:17,677 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:49:17,677 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:17,677 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:17,729 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:49:17,730 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:49:17,730 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:17,730 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:17,730 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:49:17,730 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:49:17,730 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:17,795 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:17,795 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:17,795 - src.training - INFO - 모델 학습 시작
2025-06-24 12:49:17,912 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:49:17,912 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:49:17,912 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:49:17,912 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:49:17,912 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:49:17,912 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:49:17,912 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:49:17,912 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:49:17,912 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:17,912 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:49:17,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:49:17,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:17,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:18,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:18,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:18,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:18,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:18,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:18,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:49:18,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:49:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:18,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:18,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:18,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:18,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:18,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:18,441 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:18,441 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:18,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:49:18,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:18,456 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:18,456 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:18,456 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   n_estimators: 64
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   min_samples_split: 4
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:49:18,470 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:18,470 - src.hyperparameter_tuning - ERROR - Trial 81 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:49:18,947 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = random_forest
2025-06-24 12:49:20,913 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:49:20,913 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:49:20,913 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:49:20,913 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:49:20,913 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:49:20,913 - src.training - INFO - 교차 검증 시작
2025-06-24 12:49:20,913 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:49:20,930 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:49:21,413 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:49:21,413 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:49:21,413 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:49:21,413 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:49:21,413 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:49:21,413 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:49:21,413 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:49:21,413 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:49:21,413 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:49:21,577 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:49:21,577 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:49:21,577 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:49:21,577 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:49:23,004 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:49:24,124 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:24,124 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:49:24,130 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:49:24,163 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:49:24,163 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:49:24,163 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:49:24,163 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:25,509 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:25,788 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:49:25,789 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:25,957 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:25,957 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:26,000 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:26,000 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:26,000 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:26,000 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:49:26,000 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:49:26,000 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:26,000 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,053 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:49:26,053 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:49:26,053 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,053 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,053 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:49:26,053 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:49:26,054 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,119 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:26,119 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:26,119 - src.training - INFO - 모델 학습 시작
2025-06-24 12:49:26,235 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:49:26,235 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:49:26,235 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:49:26,235 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:49:26,235 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:49:26,235 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:49:26,235 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:49:26,235 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:49:26,235 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:26,235 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:49:26,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:49:26,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:26,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:26,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:26,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:26,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:26,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:26,606 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:26,618 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:49:26,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:26,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:49:26,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:26,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:26,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:26,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:26,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:26,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:26,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:26,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:26,768 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:26,768 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:26,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:49:26,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,784 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:26,784 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:26,784 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   n_estimators: 92
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:49:26,798 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:33,584 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:49:33,584 - src.models.random_forest_model - INFO -   - 트리 개수: 92
2025-06-24 12:49:33,584 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:49:33,584 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:49:33,584 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:49:33,585 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:49:33,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:33,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:33,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:33,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:33,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:33,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:33,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:33,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:33,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:33,663 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:33,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:49:33,712 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:49:33,712 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:49:33,713 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:49:33,713 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:49:33,713 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:33,713 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:33,713 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:49:33,713 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:49:33,716 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:49:33,720 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:49:33,721 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:49:33,721 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:49:34,965 - src.training - INFO -   precision: 0.002425703950634797
2025-06-24 12:49:34,965 - src.training - INFO -   recall: 0.6333333333333333
2025-06-24 12:49:34,966 - src.training - INFO -   f1: 0.00483289761887939
2025-06-24 12:49:34,966 - src.training - INFO -   accuracy: 0.6812573549379922
2025-06-24 12:49:34,966 - src.training - INFO -   balanced_accuracy: 0.6573246627694446
2025-06-24 12:49:34,966 - src.training - INFO -   positive_samples: 270
2025-06-24 12:49:34,966 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:49:34,966 - src.training - INFO -   total_samples: 220940
2025-06-24 12:49:34,966 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:49:34,966 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:49:34,966 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:49:34,966 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:49:34,966 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:49:34,966 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:49:34,966 - src.training - INFO - 모델 학습 완료
2025-06-24 12:49:34,966 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002425703950634797, 'recall': 0.6333333333333333, 'f1': 0.00483289761887939, 'accuracy': 0.6812573549379922, 'balanced_accuracy': 0.6573246627694446, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:49:34,966 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:34,966 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:34,966 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:34,966 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:34,984 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:49:34,984 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:49:35,424 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = random_forest
2025-06-24 12:49:37,235 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:49:37,235 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:49:37,235 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:49:37,235 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:49:37,235 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:49:37,235 - src.training - INFO - 교차 검증 시작
2025-06-24 12:49:37,235 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:49:37,250 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:49:37,692 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:49:37,692 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:49:37,692 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:49:37,692 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:49:37,692 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:49:37,692 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:49:37,692 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:49:37,692 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:49:37,692 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:49:37,877 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:49:37,877 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:49:37,877 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:49:37,877 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:49:39,175 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:49:40,182 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:40,182 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:49:40,188 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:49:40,219 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:49:40,219 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:49:40,219 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:49:40,219 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:41,436 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:41,691 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:49:41,691 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:41,851 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:41,851 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:41,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:41,892 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:41,892 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:41,892 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:49:41,892 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:49:41,892 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:41,892 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:41,940 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:49:41,940 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:49:41,940 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:41,940 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:41,940 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:49:41,940 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:49:41,940 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:41,999 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:41,999 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:41,999 - src.training - INFO - 모델 학습 시작
2025-06-24 12:49:42,111 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:49:42,111 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:49:42,111 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:49:42,111 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:49:42,111 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:49:42,111 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:49:42,111 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:49:42,111 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:49:42,111 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:42,111 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:49:42,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:49:42,111 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:42,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:42,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:42,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:42,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:42,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:42,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:42,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:49:42,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:42,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:49:42,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:42,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:42,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:42,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:42,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:42,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:42,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:42,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:42,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:42,585 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:42,585 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:42,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:49:42,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:42,599 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:42,599 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:42,599 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   n_estimators: 97
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   min_samples_leaf: 8
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:49:42,612 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:50,788 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:49:50,788 - src.models.random_forest_model - INFO -   - 트리 개수: 97
2025-06-24 12:49:50,788 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:49:50,789 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:49:50,789 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:49:50,789 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:49:50,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:50,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:50,789 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:50,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:50,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:50,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:50,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:50,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:50,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:50,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:49:50,936 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:49:50,936 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:49:50,936 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:49:50,936 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:49:50,936 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:50,936 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:50,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:49:50,936 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:49:50,939 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:49:50,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:49:50,944 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:49:50,944 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:49:52,121 - src.training - INFO -   precision: 0.004031632811288572
2025-06-24 12:49:52,121 - src.training - INFO -   recall: 0.0962962962962963
2025-06-24 12:49:52,121 - src.training - INFO -   f1: 0.007739246911742819
2025-06-24 12:49:52,121 - src.training - INFO -   accuracy: 0.9698243867113243
2025-06-24 12:49:52,121 - src.training - INFO -   balanced_accuracy: 0.5335947426104675
2025-06-24 12:49:52,121 - src.training - INFO -   positive_samples: 270
2025-06-24 12:49:52,121 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:49:52,121 - src.training - INFO -   total_samples: 220940
2025-06-24 12:49:52,121 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:49:52,121 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:49:52,121 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:49:52,121 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:49:52,121 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:49:52,121 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:49:52,121 - src.training - INFO - 모델 학습 완료
2025-06-24 12:49:52,121 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.004031632811288572, 'recall': 0.0962962962962963, 'f1': 0.007739246911742819, 'accuracy': 0.9698243867113243, 'balanced_accuracy': 0.5335947426104675, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:49:52,121 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:52,121 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:52,121 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:52,121 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:52,139 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:49:52,139 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:49:52,594 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = random_forest
2025-06-24 12:49:54,415 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:49:54,415 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:49:54,415 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:49:54,415 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:49:54,415 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:49:54,415 - src.training - INFO - 교차 검증 시작
2025-06-24 12:49:54,415 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:49:54,432 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:49:54,882 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:49:54,882 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:49:54,882 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:49:54,882 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:49:54,882 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:49:54,882 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:49:54,882 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:49:54,882 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:49:54,882 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:49:55,068 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:49:55,068 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:49:55,068 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:49:55,068 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:49:56,367 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:49:57,384 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:57,384 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:49:57,390 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:49:57,421 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:49:57,421 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:49:57,421 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:49:57,421 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:49:58,633 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:49:58,895 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:49:58,895 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:59,055 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:59,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:49:59,096 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:49:59,096 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:59,096 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:49:59,096 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:49:59,096 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:49:59,096 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:59,096 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,144 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:49:59,145 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:49:59,145 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,145 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,145 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:49:59,145 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:49:59,145 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,202 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:59,202 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:49:59,202 - src.training - INFO - 모델 학습 시작
2025-06-24 12:49:59,315 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:49:59,315 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:49:59,315 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:49:59,315 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:49:59,315 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:49:59,315 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:49:59,315 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:49:59,315 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:49:59,315 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:59,315 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:49:59,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:49:59,315 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:59,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:59,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:59,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:59,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:59,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:59,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:59,642 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:49:59,642 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:59,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:49:59,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:49:59,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:59,710 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:49:59,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:49:59,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:49:59,755 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:49:59,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:49:59,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:49:59,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:49:59,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:49:59,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:49:59,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,802 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:49:59,802 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:49:59,802 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   n_estimators: 199
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   max_depth: 6
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   min_samples_split: 3
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:49:59,816 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:49:59,816 - src.hyperparameter_tuning - ERROR - Trial 84 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:50:00,264 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = random_forest
2025-06-24 12:50:02,088 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:50:02,088 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:50:02,088 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:50:02,088 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:50:02,088 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:50:02,088 - src.training - INFO - 교차 검증 시작
2025-06-24 12:50:02,088 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:50:02,105 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:50:02,550 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:50:02,550 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:50:02,550 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:50:02,550 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:50:02,550 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:50:02,550 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:50:02,550 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:50:02,550 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:50:02,550 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:50:02,734 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:50:02,734 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:50:02,734 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:50:02,734 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:50:04,040 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:50:05,067 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:05,067 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:50:05,073 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:50:05,104 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:50:05,104 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:50:05,104 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:50:05,104 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:06,321 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:06,586 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:50:06,586 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:06,747 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:06,747 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:06,788 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:06,788 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:06,788 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:06,788 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:50:06,788 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:50:06,788 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:06,788 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:06,836 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:50:06,836 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:50:06,836 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:06,836 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:06,836 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:50:06,836 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:50:06,836 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:06,895 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:06,895 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:06,895 - src.training - INFO - 모델 학습 시작
2025-06-24 12:50:07,007 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:50:07,007 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:50:07,007 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:50:07,007 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:50:07,007 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:50:07,007 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:50:07,007 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:50:07,007 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:50:07,007 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:07,007 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:50:07,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:50:07,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:07,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:07,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:07,142 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:07,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:07,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:07,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:07,334 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:50:07,334 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:07,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:50:07,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:07,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:50:07,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:07,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:07,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:07,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:07,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:07,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:07,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:07,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:50:07,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:07,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:50:07,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:07,495 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:07,495 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:07,495 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:50:07,508 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   n_estimators: 117
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   max_depth: 5
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   min_samples_split: 9
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:50:07,509 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:15,563 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:50:15,563 - src.models.random_forest_model - INFO -   - 트리 개수: 117
2025-06-24 12:50:15,563 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:50:15,563 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:50:15,563 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:50:15,564 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:50:15,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:50:15,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:15,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:15,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:15,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:15,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:15,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:15,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:15,654 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:50:15,654 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:15,656 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:50:15,713 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:50:15,713 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:50:15,713 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:50:15,713 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:50:15,713 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:15,713 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:15,713 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:50:15,713 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:50:15,716 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:50:15,721 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:50:15,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:50:15,722 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:50:16,630 - src.training - INFO -   precision: 0.002173256866888017
2025-06-24 12:50:16,630 - src.training - INFO -   recall: 0.8
2025-06-24 12:50:16,630 - src.training - INFO -   f1: 0.004334738109572547
2025-06-24 12:50:16,630 - src.training - INFO -   accuracy: 0.5508825925590658
2025-06-24 12:50:16,630 - src.training - INFO -   balanced_accuracy: 0.6752888929170254
2025-06-24 12:50:16,630 - src.training - INFO -   positive_samples: 270
2025-06-24 12:50:16,630 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:50:16,630 - src.training - INFO -   total_samples: 220940
2025-06-24 12:50:16,630 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:50:16,630 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:50:16,630 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:50:16,630 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:50:16,631 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:50:16,631 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:50:16,631 - src.training - INFO - 모델 학습 완료
2025-06-24 12:50:16,631 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002173256866888017, 'recall': 0.8, 'f1': 0.004334738109572547, 'accuracy': 0.5508825925590658, 'balanced_accuracy': 0.6752888929170254, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:50:16,631 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:16,631 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:16,631 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:16,631 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:16,648 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:50:16,648 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:50:17,115 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = random_forest
2025-06-24 12:50:19,101 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:50:19,101 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:50:19,101 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:50:19,101 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:50:19,102 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:50:19,102 - src.training - INFO - 교차 검증 시작
2025-06-24 12:50:19,102 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:50:19,119 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:50:19,601 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:50:19,601 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:50:19,601 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:50:19,601 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:50:19,601 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:50:19,601 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:50:19,601 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:50:19,601 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:50:19,601 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:50:19,765 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:19,765 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:19,765 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:19,765 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:19,766 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:19,766 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:50:19,766 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:50:19,766 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:50:19,766 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:50:19,766 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:50:21,204 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:50:22,327 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:22,328 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:50:22,334 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:50:22,366 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:50:22,367 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:50:22,367 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:50:22,367 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:23,711 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:23,988 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:50:23,988 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:24,157 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:24,157 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:24,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:24,200 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:24,200 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:24,200 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:50:24,200 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:50:24,200 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:24,200 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,253 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:50:24,253 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:50:24,253 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,253 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,253 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:50:24,253 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:50:24,253 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,320 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:24,320 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:24,320 - src.training - INFO - 모델 학습 시작
2025-06-24 12:50:24,437 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:50:24,437 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:50:24,437 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:50:24,437 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:50:24,437 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:50:24,437 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:50:24,437 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:50:24,437 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:50:24,437 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:24,437 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:50:24,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:50:24,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:24,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:24,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:24,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:24,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:24,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:24,804 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:24,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:50:24,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:24,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:50:24,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:50:24,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:24,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:24,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:24,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:24,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:24,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:24,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:24,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:50:24,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:24,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:50:24,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,978 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:24,978 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:24,978 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:50:24,991 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:50:24,991 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:50:24,991 - src.models.random_forest_model - INFO -   n_estimators: 289
2025-06-24 12:50:24,991 - src.models.random_forest_model - INFO -   max_depth: 14
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:50:24,992 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:24,992 - src.hyperparameter_tuning - ERROR - Trial 86 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:50:25,458 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = random_forest
2025-06-24 12:50:27,422 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:50:27,422 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:50:27,422 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:50:27,422 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:50:27,422 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:50:27,422 - src.training - INFO - 교차 검증 시작
2025-06-24 12:50:27,422 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:50:27,439 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:50:27,919 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:50:27,919 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:50:27,919 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:50:27,919 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:50:27,919 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:50:27,919 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:50:27,919 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:50:27,919 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:50:27,919 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:50:28,084 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:28,084 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:28,084 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:28,084 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:28,084 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:28,085 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:50:28,085 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:50:28,085 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:50:28,085 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:50:28,085 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:50:29,525 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:50:30,645 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:30,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:50:30,651 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:50:30,684 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:50:30,684 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:50:30,684 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:50:30,684 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:32,025 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:32,303 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:50:32,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:32,471 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:32,472 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:32,515 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:32,515 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:32,515 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:32,515 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:50:32,515 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:50:32,515 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:32,515 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:32,568 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:50:32,568 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:50:32,568 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:32,568 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:32,568 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:50:32,568 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:50:32,568 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:32,634 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:32,634 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:32,634 - src.training - INFO - 모델 학습 시작
2025-06-24 12:50:32,750 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:50:32,750 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:50:32,750 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:50:32,750 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:50:32,750 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:50:32,750 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:50:32,750 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:50:32,750 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:50:32,750 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:32,750 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:50:32,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:50:32,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:32,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:32,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:32,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:32,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:33,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:33,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:33,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:50:33,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:33,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:50:33,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:33,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:50:33,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:33,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:33,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:33,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:33,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:33,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:33,277 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:33,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:50:33,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:33,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:50:33,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:33,295 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:33,295 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:33,295 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   n_estimators: 178
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:50:33,308 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:33,308 - src.hyperparameter_tuning - ERROR - Trial 87 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:50:33,780 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = random_forest
2025-06-24 12:50:35,746 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:50:35,746 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:50:35,746 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:50:35,746 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:50:35,746 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:50:35,746 - src.training - INFO - 교차 검증 시작
2025-06-24 12:50:35,746 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:50:35,763 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:50:36,250 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:50:36,250 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:50:36,250 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:50:36,250 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:50:36,250 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:50:36,250 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:50:36,250 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:50:36,250 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:50:36,250 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:50:36,417 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:50:36,417 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:50:36,417 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:50:36,417 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:50:37,855 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:50:38,974 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:38,974 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:50:38,980 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:50:39,013 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:50:39,013 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:50:39,013 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:50:39,013 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:40,359 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:40,638 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:50:40,638 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:40,807 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:40,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:40,851 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:40,851 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:40,851 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:40,851 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:50:40,851 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:50:40,851 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:40,851 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:40,904 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:50:40,904 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:50:40,904 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:40,904 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:40,904 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:50:40,904 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:50:40,904 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:40,969 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:40,969 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:40,969 - src.training - INFO - 모델 학습 시작
2025-06-24 12:50:41,086 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:50:41,086 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:50:41,086 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:50:41,086 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:50:41,086 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:50:41,086 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:50:41,086 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:50:41,086 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:50:41,086 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:41,086 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:50:41,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:50:41,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:41,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:41,176 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:41,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:41,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:41,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:41,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:41,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:50:41,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:41,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:50:41,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:41,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:50:41,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:41,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:41,547 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:41,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:41,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:41,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:41,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:41,616 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:50:41,616 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:41,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:50:41,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:41,632 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:41,632 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:41,632 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   n_estimators: 106
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   max_depth: 10
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   min_samples_split: 2
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   min_samples_leaf: 7
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:50:41,645 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:41,645 - src.hyperparameter_tuning - ERROR - Trial 88 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:50:42,117 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = random_forest
2025-06-24 12:50:44,089 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:50:44,089 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:50:44,089 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:50:44,089 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:50:44,089 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:50:44,089 - src.training - INFO - 교차 검증 시작
2025-06-24 12:50:44,089 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:50:44,106 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:50:44,585 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:50:44,585 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:50:44,585 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:50:44,585 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:50:44,585 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:50:44,585 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:50:44,585 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:50:44,585 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:50:44,585 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:50:44,751 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:50:44,751 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:50:44,751 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:50:44,751 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:50:46,185 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:50:47,303 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:47,303 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:50:47,309 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:50:47,342 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:50:47,342 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:50:47,342 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:50:47,342 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:50:48,684 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:50:48,968 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:50:48,968 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:49,139 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:49,139 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:50:49,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:50:49,182 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:49,182 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:50:49,182 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:50:49,182 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:50:49,183 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:49,183 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,235 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:50:49,235 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:50:49,235 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,235 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,235 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:50:49,236 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:50:49,236 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,301 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:49,301 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:50:49,301 - src.training - INFO - 모델 학습 시작
2025-06-24 12:50:49,419 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:50:49,420 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:50:49,420 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:50:49,420 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:50:49,420 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:50:49,420 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:50:49,420 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:50:49,420 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:50:49,420 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:49,420 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:50:49,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:50:49,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:49,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:49,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:49,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:49,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:49,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:49,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:49,803 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:50:49,803 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:49,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:50:49,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:50:49,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:49,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:50:49,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:50:49,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:50:49,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:50:49,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:50:49,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:50:49,951 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:50:49,951 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:50:49,966 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:50:49,967 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,967 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:50:49,967 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:50:49,967 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:50:49,980 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:50:49,980 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:50:49,980 - src.models.random_forest_model - INFO -   n_estimators: 500
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   max_depth: 12
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   min_samples_split: 12
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:50:49,981 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:51:26,649 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:51:26,649 - src.models.random_forest_model - INFO -   - 트리 개수: 500
2025-06-24 12:51:26,649 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:51:26,649 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:51:26,649 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:51:26,649 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:51:26,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:51:26,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:26,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:51:26,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:51:26,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:51:26,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:51:26,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:51:26,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:51:26,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:51:26,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:26,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:51:26,933 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:51:26,934 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:51:26,934 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:51:26,934 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:51:26,934 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:51:26,934 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:51:26,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:51:26,934 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:51:26,938 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:51:26,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:51:26,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:51:26,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:51:28,175 - src.training - INFO -   precision: 0.0030526992287917736
2025-06-24 12:51:28,175 - src.training - INFO -   recall: 0.2111111111111111
2025-06-24 12:51:28,176 - src.training - INFO -   f1: 0.006018371872030409
2025-06-24 12:51:28,176 - src.training - INFO -   accuracy: 0.9147822938354304
2025-06-24 12:51:28,176 - src.training - INFO -   balanced_accuracy: 0.5633771896698438
2025-06-24 12:51:28,176 - src.training - INFO -   positive_samples: 270
2025-06-24 12:51:28,176 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:51:28,176 - src.training - INFO -   total_samples: 220940
2025-06-24 12:51:28,176 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:51:28,176 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:51:28,176 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:51:28,176 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:51:28,176 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:51:28,176 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:51:28,176 - src.training - INFO - 모델 학습 완료
2025-06-24 12:51:28,176 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0030526992287917736, 'recall': 0.2111111111111111, 'f1': 0.006018371872030409, 'accuracy': 0.9147822938354304, 'balanced_accuracy': 0.5633771896698438, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:51:28,176 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:28,176 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:28,176 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:28,176 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:28,194 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:51:28,194 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:51:28,645 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = random_forest
2025-06-24 12:51:30,444 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:51:30,444 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:51:30,444 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:51:30,444 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:51:30,445 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:51:30,445 - src.training - INFO - 교차 검증 시작
2025-06-24 12:51:30,445 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:51:30,461 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:51:30,901 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:51:30,901 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:51:30,901 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:51:30,901 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:51:30,901 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:51:30,901 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:51:30,901 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:51:30,901 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:51:30,901 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:51:31,087 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:51:31,087 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:51:31,087 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:51:31,087 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:51:32,394 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:51:33,420 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:51:33,421 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:51:33,426 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:51:33,458 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:51:33,458 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:51:33,458 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:51:33,458 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:51:34,675 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:51:34,932 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:51:34,932 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:51:35,092 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:51:35,093 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:51:35,133 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:51:35,133 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:51:35,133 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:51:35,133 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:51:35,133 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:51:35,133 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:35,133 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,182 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:51:35,182 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:51:35,182 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,182 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,182 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:51:35,182 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:51:35,182 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,240 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:51:35,240 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:51:35,240 - src.training - INFO - 모델 학습 시작
2025-06-24 12:51:35,352 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:51:35,352 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:51:35,352 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:51:35,352 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:51:35,352 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:51:35,352 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:51:35,352 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:51:35,352 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:51:35,352 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:51:35,352 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:51:35,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:51:35,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:35,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:51:35,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:51:35,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:51:35,540 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:51:35,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:51:35,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:51:35,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:51:35,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:35,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:51:35,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:51:35,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:35,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:51:35,761 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:51:35,775 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:51:35,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:51:35,803 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:51:35,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:51:35,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:51:35,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:51:35,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:51:35,835 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,835 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:51:35,835 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:51:35,835 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   n_estimators: 476
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   max_depth: 10
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:51:35,848 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:51:35,849 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:51:35,849 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:51:35,849 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:51:35,849 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:51:35,849 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:51:35,849 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:09,545 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:52:09,545 - src.models.random_forest_model - INFO -   - 트리 개수: 476
2025-06-24 12:52:09,545 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:52:09,545 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:52:09,545 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:52:09,545 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:52:09,545 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:09,545 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:09,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:09,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:09,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:09,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:09,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:09,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:09,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:09,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:09,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:52:09,823 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:52:09,824 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:52:09,824 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:52:09,824 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:52:09,824 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:09,824 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:09,824 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:52:09,824 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:52:09,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:52:09,832 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:52:09,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:52:09,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:52:11,067 - src.training - INFO -   precision: 0.0028951101589415476
2025-06-24 12:52:11,067 - src.training - INFO -   recall: 0.37037037037037035
2025-06-24 12:52:11,067 - src.training - INFO -   f1: 0.005745310390393841
2025-06-24 12:52:11,067 - src.training - INFO -   accuracy: 0.8433466099393501
2025-06-24 12:52:11,067 - src.training - INFO -   balanced_accuracy: 0.607147844359518
2025-06-24 12:52:11,067 - src.training - INFO -   positive_samples: 270
2025-06-24 12:52:11,067 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:52:11,067 - src.training - INFO -   total_samples: 220940
2025-06-24 12:52:11,067 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:52:11,067 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:52:11,067 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:52:11,067 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:52:11,068 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:52:11,068 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:52:11,068 - src.training - INFO - 모델 학습 완료
2025-06-24 12:52:11,068 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028951101589415476, 'recall': 0.37037037037037035, 'f1': 0.005745310390393841, 'accuracy': 0.8433466099393501, 'balanced_accuracy': 0.607147844359518, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:52:11,068 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:11,068 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:11,068 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:11,068 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:11,085 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:52:11,086 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:52:11,536 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = random_forest
2025-06-24 12:52:13,353 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:52:13,353 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:52:13,353 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:52:13,353 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:52:13,353 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:52:13,353 - src.training - INFO - 교차 검증 시작
2025-06-24 12:52:13,353 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:52:13,369 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:52:13,811 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:52:13,811 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:52:13,811 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:52:13,811 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:52:13,811 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:52:13,811 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:52:13,811 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:52:13,811 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:52:13,811 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:52:13,997 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:52:13,997 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:52:13,997 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:52:13,997 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:52:15,308 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:52:16,325 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:16,325 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:52:16,331 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:52:16,362 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:52:16,362 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:52:16,362 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:52:16,362 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:17,574 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:17,837 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:52:17,837 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:17,998 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:17,998 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:18,039 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:18,039 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:18,039 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:18,039 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:52:18,039 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:52:18,039 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:18,039 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,088 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:52:18,088 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:52:18,088 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,088 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,088 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:52:18,088 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:52:18,088 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,146 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:18,146 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:18,146 - src.training - INFO - 모델 학습 시작
2025-06-24 12:52:18,259 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:52:18,259 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:52:18,259 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:52:18,259 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:52:18,259 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:52:18,259 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:52:18,259 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:52:18,259 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:52:18,259 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:18,259 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:52:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:52:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:18,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:18,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:18,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:18,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:18,572 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:18,584 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:52:18,584 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:18,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:52:18,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:18,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:18,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:18,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:18,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:18,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:18,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:18,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:18,730 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:18,730 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:18,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:52:18,744 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,744 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:18,744 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:18,744 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   n_estimators: 225
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   max_depth: 9
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   min_samples_split: 10
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:52:18,757 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:18,758 - src.hyperparameter_tuning - ERROR - Trial 91 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:52:19,205 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = random_forest
2025-06-24 12:52:20,995 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:52:20,995 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:52:20,995 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:52:20,996 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:52:20,996 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:52:20,996 - src.training - INFO - 교차 검증 시작
2025-06-24 12:52:20,996 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:52:21,011 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:52:21,451 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:52:21,451 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:52:21,451 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:52:21,451 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:52:21,451 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:52:21,451 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:52:21,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:52:21,452 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:52:21,452 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:52:21,636 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:52:21,636 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:52:21,636 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:52:21,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:52:22,935 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:52:23,949 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:23,949 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:52:23,955 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:52:23,986 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:52:23,986 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:52:23,986 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:52:23,986 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:25,197 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:25,459 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:52:25,459 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:25,620 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:25,620 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:25,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:25,661 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:25,661 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:25,661 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:52:25,661 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:52:25,661 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:25,661 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:25,709 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:52:25,710 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:52:25,710 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:25,710 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:25,710 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:52:25,710 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:52:25,710 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:25,768 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:25,768 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:25,768 - src.training - INFO - 모델 학습 시작
2025-06-24 12:52:25,881 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:52:25,881 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:52:25,881 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:52:25,881 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:52:25,881 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:52:25,881 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:52:25,881 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:52:25,881 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:52:25,881 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:25,881 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:52:25,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:52:25,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:25,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:25,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:26,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:26,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:26,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:26,194 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:26,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:52:26,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:26,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:52:26,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:26,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:26,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:26,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:26,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:26,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:26,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:26,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:26,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:26,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:26,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:26,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:52:26,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:26,369 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:26,369 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:26,369 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   n_estimators: 68
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   max_depth: 4
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   min_samples_split: 2
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   min_samples_leaf: 4
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:52:26,382 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:26,383 - src.hyperparameter_tuning - ERROR - Trial 92 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:52:26,849 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = random_forest
2025-06-24 12:52:28,685 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:52:28,685 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:52:28,685 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:52:28,685 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:52:28,685 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:52:28,685 - src.training - INFO - 교차 검증 시작
2025-06-24 12:52:28,685 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:52:28,702 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:52:29,142 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:52:29,143 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:52:29,143 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:52:29,143 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:52:29,143 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:52:29,143 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:52:29,143 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:52:29,143 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:52:29,143 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:52:29,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:29,330 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:29,330 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:29,330 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:29,330 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:29,330 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:52:29,330 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:52:29,330 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:52:29,330 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:52:29,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:52:30,636 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:52:31,658 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:31,658 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:52:31,664 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:52:31,695 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:52:31,695 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:52:31,695 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:52:31,695 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:32,897 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:33,168 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:52:33,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:33,329 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:33,329 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:33,370 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:33,370 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:33,370 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:33,370 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:52:33,370 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:52:33,370 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:33,370 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:33,419 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:52:33,419 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:52:33,419 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:33,419 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:33,419 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:52:33,419 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:52:33,419 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:33,477 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:33,477 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:33,477 - src.training - INFO - 모델 학습 시작
2025-06-24 12:52:33,590 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:52:33,590 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:52:33,590 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:52:33,591 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:52:33,591 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:52:33,591 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:52:33,591 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:52:33,591 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:52:33,591 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:33,591 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:52:33,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:52:33,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:33,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:33,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:33,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:33,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:33,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:33,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:33,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:52:33,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:34,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:52:34,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:34,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:34,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:34,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:34,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:34,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:34,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:34,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:34,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:34,089 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:34,089 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:34,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:52:34,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:34,103 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:34,103 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:34,103 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:52:34,116 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:52:34,116 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:52:34,116 - src.models.random_forest_model - INFO -   n_estimators: 150
2025-06-24 12:52:34,116 - src.models.random_forest_model - INFO -   max_depth: 7
2025-06-24 12:52:34,116 - src.models.random_forest_model - INFO -   min_samples_split: 11
2025-06-24 12:52:34,116 - src.models.random_forest_model - INFO -   min_samples_leaf: 5
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:52:34,117 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:34,117 - src.hyperparameter_tuning - ERROR - Trial 93 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:52:34,580 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = random_forest
2025-06-24 12:52:36,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:52:36,541 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:52:36,541 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:52:36,541 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:52:36,541 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:52:36,541 - src.training - INFO - 교차 검증 시작
2025-06-24 12:52:36,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:52:36,557 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:52:37,034 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:52:37,034 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:52:37,034 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:52:37,034 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:52:37,034 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:52:37,034 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:52:37,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:52:37,034 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:52:37,034 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:52:37,203 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:52:37,203 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:52:37,203 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:52:37,203 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:52:38,625 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:52:39,741 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:39,741 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:52:39,747 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:52:39,779 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:52:39,780 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:52:39,780 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:52:39,780 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:41,106 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:41,386 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:52:41,386 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:41,555 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:41,555 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:41,599 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:41,599 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:41,599 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:41,599 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:52:41,599 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:52:41,599 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:41,599 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:41,652 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:52:41,652 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:52:41,652 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:41,652 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:41,652 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:52:41,652 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:52:41,652 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:41,720 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:41,720 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:41,720 - src.training - INFO - 모델 학습 시작
2025-06-24 12:52:41,836 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:52:41,837 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:52:41,837 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:52:41,837 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:52:41,837 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:52:41,837 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:52:41,837 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:52:41,837 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:52:41,837 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:41,837 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:52:41,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:52:41,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:41,837 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:41,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:41,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:42,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:42,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:42,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:42,219 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:52:42,219 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:42,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:52:42,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:42,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:42,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:42,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:42,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:42,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:42,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:42,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:42,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:42,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:42,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:42,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:52:42,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:42,381 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:42,381 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:42,381 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   n_estimators: 65
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   max_depth: 6
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   min_samples_split: 10
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:52:42,394 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:47,215 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:52:47,215 - src.models.random_forest_model - INFO -   - 트리 개수: 65
2025-06-24 12:52:47,215 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:52:47,215 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:52:47,215 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:52:47,215 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:52:47,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:47,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:47,216 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:47,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:47,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:47,261 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:47,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:47,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:47,293 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:47,293 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:47,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:52:47,333 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:52:47,333 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:52:47,333 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:52:47,333 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:52:47,333 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:47,333 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:47,333 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:52:47,333 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:52:47,336 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:52:47,340 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:52:47,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:52:47,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:52:48,122 - src.training - INFO -   precision: 0.002248407868250362
2025-06-24 12:52:48,122 - src.training - INFO -   recall: 0.7074074074074074
2025-06-24 12:52:48,122 - src.training - INFO -   f1: 0.004482568441310036
2025-06-24 12:52:48,122 - src.training - INFO -   accuracy: 0.6160179234181226
2025-06-24 12:52:48,122 - src.training - INFO -   balanced_accuracy: 0.6616567557724036
2025-06-24 12:52:48,122 - src.training - INFO -   positive_samples: 270
2025-06-24 12:52:48,122 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:52:48,122 - src.training - INFO -   total_samples: 220940
2025-06-24 12:52:48,122 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:52:48,123 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:52:48,123 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:52:48,123 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:52:48,123 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:52:48,123 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:52:48,123 - src.training - INFO - 모델 학습 완료
2025-06-24 12:52:48,123 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002248407868250362, 'recall': 0.7074074074074074, 'f1': 0.004482568441310036, 'accuracy': 0.6160179234181226, 'balanced_accuracy': 0.6616567557724036, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:52:48,123 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:48,123 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:48,123 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:48,123 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:48,141 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:52:48,141 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:52:48,585 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = random_forest
2025-06-24 12:52:50,379 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:52:50,379 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:52:50,379 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:52:50,379 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:52:50,379 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:52:50,379 - src.training - INFO - 교차 검증 시작
2025-06-24 12:52:50,379 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:52:50,396 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:52:50,842 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:52:50,842 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:52:50,842 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:52:50,842 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:52:50,842 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:52:50,842 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:52:50,843 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:52:50,843 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:52:50,843 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:52:51,032 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:52:51,032 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:52:51,032 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:52:51,032 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:52:52,394 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:52:53,517 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:53,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:52:53,526 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:52:53,558 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:52:53,558 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:52:53,558 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:52:53,558 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:52:54,905 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:52:55,189 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:52:55,189 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:55,359 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:55,359 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:52:55,402 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:52:55,402 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:55,402 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:52:55,402 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:52:55,402 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:52:55,402 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:55,402 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:52:55,455 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:52:55,455 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:52:55,455 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:55,455 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:55,455 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:52:55,455 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:52:55,455 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:55,521 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:55,521 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:52:55,521 - src.training - INFO - 모델 학습 시작
2025-06-24 12:52:55,629 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:52:55,630 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:52:55,630 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:52:55,630 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:52:55,630 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:52:55,630 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:52:55,630 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:52:55,630 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:52:55,630 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:55,630 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:52:55,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:52:55,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:55,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:55,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:55,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:55,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:55,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:55,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:56,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:52:56,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:56,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:52:56,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:56,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:52:56,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:56,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:52:56,088 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:52:56,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:52:56,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:52:56,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:52:56,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:52:56,156 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:52:56,156 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:52:56,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:52:56,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:56,171 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:52:56,171 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:52:56,171 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   n_estimators: 425
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   max_depth: 15
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   min_samples_split: 17
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   max_features: log2
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:52:56,183 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:28,429 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:53:28,430 - src.models.random_forest_model - INFO -   - 트리 개수: 425
2025-06-24 12:53:28,430 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:53:28,430 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:53:28,430 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:53:28,430 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:53:28,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:53:28,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:28,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:28,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:28,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:28,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:28,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:28,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:28,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:53:28,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:28,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:53:28,698 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:53:28,698 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:53:28,698 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:53:28,698 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:53:28,698 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:53:28,698 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:53:28,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:53:28,698 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:53:28,701 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:53:28,705 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:53:28,706 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:53:28,706 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:53:29,967 - src.training - INFO -   precision: 0.004303719643406086
2025-06-24 12:53:29,967 - src.training - INFO -   recall: 0.1037037037037037
2025-06-24 12:53:29,967 - src.training - INFO -   f1: 0.008264462809917356
2025-06-24 12:53:29,967 - src.training - INFO -   accuracy: 0.9695845025798859
2025-06-24 12:53:29,967 - src.training - INFO -   balanced_accuracy: 0.5371738258401602
2025-06-24 12:53:29,967 - src.training - INFO -   positive_samples: 270
2025-06-24 12:53:29,967 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:53:29,967 - src.training - INFO -   total_samples: 220940
2025-06-24 12:53:29,967 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:53:29,967 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:53:29,967 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:53:29,967 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:53:29,967 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:53:29,967 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:53:29,967 - src.training - INFO - 모델 학습 완료
2025-06-24 12:53:29,967 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.004303719643406086, 'recall': 0.1037037037037037, 'f1': 0.008264462809917356, 'accuracy': 0.9695845025798859, 'balanced_accuracy': 0.5371738258401602, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:53:29,967 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:29,967 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:29,967 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:29,968 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:29,985 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:53:29,985 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:53:30,442 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = random_forest
2025-06-24 12:53:32,459 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:53:32,459 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:53:32,459 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:53:32,459 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:53:32,459 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:53:32,459 - src.training - INFO - 교차 검증 시작
2025-06-24 12:53:32,459 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:53:32,476 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:53:32,953 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:53:32,953 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:53:32,953 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:53:32,953 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:53:32,953 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:53:32,953 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:53:32,953 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:53:32,953 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:53:32,953 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:53:33,126 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:53:33,126 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:53:33,126 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:53:33,126 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:53:34,566 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:53:35,691 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:53:35,691 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:53:35,698 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:53:35,731 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:53:35,731 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:53:35,731 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:53:35,731 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:37,078 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:53:37,362 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:53:37,362 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:53:37,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:53:37,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:53:37,575 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:53:37,575 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:53:37,575 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:53:37,575 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:53:37,575 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:53:37,575 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:37,575 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:53:37,628 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:53:37,628 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:53:37,628 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:37,628 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:37,628 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:53:37,628 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:53:37,628 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:37,695 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:53:37,695 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:53:37,695 - src.training - INFO - 모델 학습 시작
2025-06-24 12:53:37,804 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:53:37,804 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:53:37,804 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:53:37,804 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:53:37,804 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:53:37,804 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:53:37,804 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:53:37,804 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:53:37,804 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:53:37,804 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:53:37,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:53:37,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:37,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:37,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:37,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:38,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:38,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:38,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:38,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:53:38,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:38,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:53:38,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:38,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:53:38,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:38,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:38,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:38,279 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:38,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:38,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:38,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:38,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:53:38,331 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:38,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:53:38,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:38,346 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:53:38,346 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:38,346 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:53:38,358 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   n_estimators: 214
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   max_depth: 9
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   min_samples_split: 14
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   min_samples_leaf: 1
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:53:38,359 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:38,359 - src.hyperparameter_tuning - ERROR - Trial 96 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:53:38,829 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = random_forest
2025-06-24 12:53:40,785 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:53:40,785 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:53:40,785 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:53:40,785 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:53:40,785 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:53:40,785 - src.training - INFO - 교차 검증 시작
2025-06-24 12:53:40,785 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:53:40,802 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:53:41,278 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:53:41,278 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:53:41,278 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:53:41,278 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:53:41,278 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:53:41,278 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:53:41,278 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:53:41,278 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:53:41,278 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:53:41,450 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:53:41,450 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:53:41,450 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:53:41,450 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:53:42,889 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:53:44,015 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:53:44,015 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:53:44,024 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:53:44,056 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:53:44,057 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:53:44,057 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:53:44,057 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:45,401 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:53:45,688 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:53:45,688 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:53:45,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:53:45,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:53:45,901 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:53:45,901 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:53:45,901 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:53:45,901 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:53:45,901 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:53:45,901 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:45,901 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:53:45,954 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:53:45,955 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:53:45,955 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:45,955 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:45,955 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:53:45,955 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:53:45,955 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:46,023 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:53:46,023 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:53:46,024 - src.training - INFO - 모델 학습 시작
2025-06-24 12:53:46,132 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:53:46,132 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:53:46,132 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:53:46,132 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:53:46,132 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:53:46,132 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:53:46,132 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:53:46,132 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:53:46,132 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:53:46,132 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:53:46,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:53:46,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:46,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:46,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:46,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:46,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:46,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:46,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:46,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:53:46,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:46,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:53:46,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:46,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:53:46,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:46,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:46,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:46,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:46,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:46,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:46,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:46,656 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:53:46,656 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:46,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:53:46,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:46,670 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:53:46,670 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:46,670 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   n_estimators: 184
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   max_depth: 20
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   min_samples_split: 11
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   min_samples_leaf: 10
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:53:46,683 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:46,683 - src.hyperparameter_tuning - ERROR - Trial 97 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:53:47,151 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = random_forest
2025-06-24 12:53:49,136 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:53:49,136 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:53:49,136 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:53:49,136 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:53:49,136 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:53:49,136 - src.training - INFO - 교차 검증 시작
2025-06-24 12:53:49,136 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:53:49,153 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:53:49,630 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:53:49,630 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:53:49,630 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:53:49,630 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:53:49,630 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:53:49,630 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:53:49,630 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:53:49,630 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:53:49,630 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:53:49,802 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:49,802 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:49,802 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:49,802 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:49,802 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:49,802 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:53:49,802 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:53:49,803 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:53:49,803 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:53:49,803 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:53:51,235 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:53:52,357 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:53:52,357 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:53:52,366 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:53:52,398 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:53:52,399 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:53:52,399 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:53:52,399 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:53,750 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:53:54,034 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:53:54,034 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:53:54,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:53:54,203 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:53:54,257 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:53:54,257 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:53:54,257 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:53:54,258 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:53:54,258 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:53:54,258 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:54,258 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:53:54,311 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:53:54,311 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:53:54,311 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:54,311 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:54,311 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:53:54,311 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:53:54,311 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:54,380 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:53:54,380 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:53:54,380 - src.training - INFO - 모델 학습 시작
2025-06-24 12:53:54,489 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:53:54,489 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:53:54,489 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:53:54,489 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:53:54,489 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:53:54,489 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:53:54,489 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:53:54,489 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:53:54,489 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:53:54,489 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:53:54,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:53:54,489 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:54,490 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:54,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:54,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:54,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:54,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:54,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:54,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:53:54,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:54,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:53:54,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:54,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:53:54,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:54,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:53:54,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:53:54,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:53:54,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:53:54,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:53:55,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:53:55,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:53:55,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:53:55,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:53:55,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:55,027 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:53:55,027 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:53:55,027 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   n_estimators: 352
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   max_depth: 3
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   min_samples_split: 15
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   min_samples_leaf: 3
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   max_features: auto
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:53:55,039 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:53:55,040 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:53:55,040 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:53:55,040 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:53:55,040 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:55,040 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:53:55,040 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:53:55,040 - src.hyperparameter_tuning - ERROR - Trial 98 실패: The 'max_features' parameter of RandomForestClassifier must be an int in the range [1, inf), a float in the range (0.0, 1.0], a str among {'sqrt', 'log2'} or None. Got 'auto' instead.
2025-06-24 12:53:55,507 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = random_forest
2025-06-24 12:53:57,480 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:53:57,480 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:53:57,480 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:53:57,480 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:53:57,480 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:53:57,480 - src.training - INFO - 교차 검증 시작
2025-06-24 12:53:57,481 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:53:57,496 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:53:57,972 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:53:57,972 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:53:57,972 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:53:57,972 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:53:57,972 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:53:57,972 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:53:57,972 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:53:57,972 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:53:57,972 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:53:58,146 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:53:58,146 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:53:58,146 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:53:58,146 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:53:59,563 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:54:00,676 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:00,676 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:54:00,684 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:54:00,717 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:54:00,718 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:54:00,718 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:54:00,718 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:02,040 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:02,329 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:54:02,330 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:02,500 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:02,500 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:02,543 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:02,543 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:02,543 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:02,543 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:54:02,543 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:54:02,543 - src.training - INFO - [DEBUG] feature_columns: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:02,543 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:02,596 - src.training - INFO - [DEBUG] X_train shape: (1067012, 5), y_train shape: (1067012, 1)
2025-06-24 12:54:02,596 - src.training - INFO - [DEBUG] X_val shape: (266753, 5), y_val shape: (266753, 1)
2025-06-24 12:54:02,596 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:02,596 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:02,596 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:54:02,596 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 5), y_train_resampled shape: (1067012, 1)
2025-06-24 12:54:02,596 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:02,665 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:02,665 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:02,665 - src.training - INFO - 모델 학습 시작
2025-06-24 12:54:02,774 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:54:02,774 - src.training - INFO - 모델 타입: random_forest
2025-06-24 12:54:02,774 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:54:02,774 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:54:02,774 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:54:02,774 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:54:02,774 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:54:02,774 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:54:02,774 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:54:02,774 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:54:02,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 5)
2025-06-24 12:54:02,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:02,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:54:02,862 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:02,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:02,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:03,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:03,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:03,149 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 5)
2025-06-24 12:54:03,149 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:03,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 5), y shape: (883775, 1)
2025-06-24 12:54:03,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:03,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:54:03,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:03,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:54:03,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:03,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:03,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:03,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:03,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:03,293 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:54:03,293 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:03,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5), y shape: (220940, 1)
2025-06-24 12:54:03,308 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:03,308 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(883775, 5), y=(883775, 1)
2025-06-24 12:54:03,308 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:03,308 - src.models.random_forest_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 5), y=883775
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   n_estimators: 165
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   max_depth: 18
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   min_samples_split: 19
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   min_samples_leaf: 2
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   max_features: sqrt
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   bootstrap: True
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   oob_score: True
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   max_samples: 0.8
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   class_weight: balanced
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   n_jobs: 28
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   min_impurity_decrease: 0.0
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   min_weight_fraction_leaf: 0.0
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   max_leaf_nodes: None
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   ccp_alpha: 0.0
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO -   criterion: gini
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO - Random Forest 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO - 분류 모델 (RandomForestClassifier) 사용
2025-06-24 12:54:03,320 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:16,764 - src.models.random_forest_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:54:16,764 - src.models.random_forest_model - INFO -   - 트리 개수: 165
2025-06-24 12:54:16,764 - src.models.random_forest_model - INFO -   - 피처 개수: 5
2025-06-24 12:54:16,764 - src.models.random_forest_model - INFO -   - 클래스: [0. 1.]
2025-06-24 12:54:16,764 - src.models.random_forest_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:54:16,764 - src.models.random_forest_model - INFO - Random Forest 모델 예측 시작
2025-06-24 12:54:16,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 5)
2025-06-24 12:54:16,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:16,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:54:16,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:16,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:16,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:16,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:16,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:16,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 5)
2025-06-24 12:54:16,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:16,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 5)
2025-06-24 12:54:16,953 - src.models.random_forest_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:54:16,953 - src.models.random_forest_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:54:16,953 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:54:16,953 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:54:16,953 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:16,953 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:16,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:54:16,953 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:54:16,957 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:54:16,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:54:16,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0. 1.]
2025-06-24 12:54:16,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:54:18,172 - src.training - INFO -   precision: 0.002527646129541864
2025-06-24 12:54:18,172 - src.training - INFO -   recall: 0.02962962962962963
2025-06-24 12:54:18,172 - src.training - INFO -   f1: 0.004657933042212519
2025-06-24 12:54:18,172 - src.training - INFO -   accuracy: 0.9845252104643795
2025-06-24 12:54:18,172 - src.training - INFO -   balanced_accuracy: 0.5076615996065853
2025-06-24 12:54:18,172 - src.training - INFO -   positive_samples: 270
2025-06-24 12:54:18,172 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:54:18,172 - src.training - INFO -   total_samples: 220940
2025-06-24 12:54:18,172 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:54:18,172 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:54:18,172 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:54:18,172 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:54:18,174 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:54:18,174 - src.models.random_forest_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:54:18,174 - src.training - INFO - 모델 학습 완료
2025-06-24 12:54:18,174 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002527646129541864, 'recall': 0.02962962962962963, 'f1': 0.004657933042212519, 'accuracy': 0.9845252104643795, 'balanced_accuracy': 0.5076615996065853, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:54:18,174 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:18,174 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:18,174 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:18,174 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:18,191 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:54:18,191 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:54:18,632 - src.hyperparameter_tuning - WARNING - 유효하지 않은 best_score: -inf
2025-06-24 12:54:18,634 - src.hyperparameter_tuning - INFO - 최적화 완료!
2025-06-24 12:54:18,634 - src.hyperparameter_tuning - INFO -   - 최고 성능: 0.0000
2025-06-24 12:54:18,634 - src.hyperparameter_tuning - INFO -   - 최적 파라미터: {'n_estimators': 218, 'max_depth': 20, 'min_samples_split': 15, 'min_samples_leaf': 6, 'max_features': 'sqrt'}
2025-06-24 12:54:20,435 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:54:20,435 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:54:20,435 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:54:20,435 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:54:20,435 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:54:20,435 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:54:20,435 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:54:20,435 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:54:20,660 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:54:20,660 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:54:20,660 - src.preprocessing - INFO -   - 범주형 인코딩: onehot
2025-06-24 12:54:20,660 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:54:22,438 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:54:23,841 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 12:54:23,842 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:54:25,229 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 12:54:25,229 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:54:25,436 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:54:25,436 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:54:25,436 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:54:25,436 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex_여자', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:25,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:25,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:25,648 - src.feature_engineering - WARNING - 피처를 찾을 수 없습니다: sex
2025-06-24 12:54:25,648 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 5개
2025-06-24 12:54:25,702 - src.models.model_factory - INFO - 모델 타입 'random_forest'으로 모델을 생성합니다.
2025-06-24 12:54:25,702 - src.models.base_model - INFO - RANDOMFOREST 모델 초기화 완료
2025-06-24 12:54:25,702 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:54:25,702 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:54:25,702 - src.models.random_forest_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:54:25,702 - src.models.random_forest_model - INFO - Random Forest 모델 학습 시작
2025-06-24 12:54:25,702 - src.models.random_forest_model - INFO - 입력 데이터 형태: X=(1333765, 5), y=(1333765, 1)
2025-06-24 12:54:25,702 - src.models.random_forest_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:54:25,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (1333765, 5)
2025-06-24 12:54:25,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:25,702 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    5
Name: count, dtype: int64
2025-06-24 12:54:25,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:25,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:26,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:26,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:26,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:26,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (1333765, 5)
2025-06-24 12:54:26,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:26,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (1333765, 5)
2025-06-24 12:54:26,286 - src.models.random_forest_model - INFO - 전처리 후 데이터 형태: X=(1333765, 5), y=(1333765, 0)
2025-06-24 12:54:26,286 - src.models.random_forest_model - INFO - 사용 가능한 타겟 컬럼: []
2025-06-24 12:54:26,286 - src.models.random_forest_model - ERROR - y 데이터프레임에 컬럼이 없습니다! 타겟 컬럼 매칭을 확인하세요.
2025-06-24 12:54:26,287 - src.models.base_model - INFO - 모델이 models/best_tuned_model.joblib에 저장되었습니다.
2025-06-24 12:54:26,287 - src.hyperparameter_tuning - INFO - 최고 모델 저장 완료: models/best_tuned_model.joblib
2025-06-24 12:54:27,055 - src.hyperparameter_tuning - INFO - Study 저장 완료: models/optuna_study.pkl
2025-06-24 12:54:27,313 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2025-06-24 12:54:27,467 - __main__ - INFO - === 하이퍼파라미터 튜닝 완료 ===
2025-06-24 12:54:27,468 - __main__ - INFO - 최고 성능: 0.0000
2025-06-24 12:54:27,468 - __main__ - INFO - 최적 파라미터:
2025-06-24 12:54:27,468 - __main__ - INFO -   n_estimators: 218
2025-06-24 12:54:27,468 - __main__ - INFO -   max_depth: 20
2025-06-24 12:54:27,468 - __main__ - INFO -   min_samples_split: 15
2025-06-24 12:54:27,468 - __main__ - INFO -   min_samples_leaf: 6
2025-06-24 12:54:27,468 - __main__ - INFO -   max_features: sqrt

==================================================
튜닝 결과 요약
==================================================
모델 타입: random_forest
실험 타입: hyperparameter_tuning
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/790ace0ee64c4612af44c4a87c8509f4
최고 성능: 0.0
최적 파라미터: {'n_estimators': 218, 'max_depth': 20, 'min_samples_split': 15, 'min_samples_leaf': 6, 'max_features': 'sqrt'}
튜닝 시간: N/A
==================================================
2025-06-24 12:54:27,468 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_125427.txt에 저장되었습니다.
2025-06-24 12:54:27,468 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 12:54:27,468 - __main__ - INFO - MLflow Run ID: 790ace0ee64c4612af44c4a87c8509f4
2025-06-24 12:54:27,468 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/790ace0ee64c4612af44c4a87c8509f4
