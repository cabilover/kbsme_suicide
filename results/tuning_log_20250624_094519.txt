2025-06-24 09:45:19,544 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 09:45:19,544 - src.hyperparameter_tuning - INFO - 데이터 로드 중: data/processed/processed_data_with_features.csv
2025-06-24 09:45:21,207 - src.hyperparameter_tuning - INFO - 전체 데이터 로드: 1,569,071 행
2025-06-24 09:45:21,207 - src.hyperparameter_tuning - INFO - 모델 타입: lightgbm
2025-06-24 09:45:21,207 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 09:45:21,207 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 09:45:21,207 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed_data.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 3, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'f1_score', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'lightgbm', 'lightgbm': {'num_leaves': 31, 'learning_rate': 0.1, 'feature_fraction': 0.9, 'bagging_fraction': 0.8, 'bagging_freq': 5, 'min_data_in_leaf': 20, 'min_sum_hessian_in_leaf': '1e-3', 'lambda_l1': 0.1, 'lambda_l2': 0.1, 'num_threads': 28, 'verbose': -1, 'early_stopping_rounds': 10, 'max_cat_threshold': 32, 'cat_smooth': 10.0, 'cat_l2': 10.0, 'is_unbalance': True, 'scale_pos_weight': 1.0, 'class_weight': 'balanced', 'boosting_type': 'gbdt', 'objective': 'binary', 'metric': 'binary_logloss', 'max_depth': 6, 'min_gain_to_split': 0.0, 'min_child_samples': 20, 'bagging_seed': 42, 'feature_fraction_seed': 42, 'drop_seed': 42, 'data_random_seed': 42, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'scale_pos_weight': 1.0, 'is_unbalance': True}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 1, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 09:45:21,208 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 09:45:21,208 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 09:45:21,208 - __main__ - INFO - 하이퍼파라미터 최적화 실행 중...
2025-06-24 09:45:21,208 - src.hyperparameter_tuning - INFO - === 하이퍼파라미터 튜닝 시작 ===
2025-06-24 09:45:21,209 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = lightgbm
2025-06-24 09:45:23,168 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:45:23,168 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:45:23,168 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:45:23,169 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:45:23,169 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:45:23,169 - src.training - INFO - 교차 검증 시작
2025-06-24 09:45:23,169 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:45:23,186 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:45:23,644 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:45:23,644 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:45:23,644 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:45:23,644 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:45:23,644 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:45:23,644 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:45:23,644 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:45:23,644 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:45:23,644 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:45:23,782 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:45:23,782 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:45:23,782 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:45:23,782 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:45:24,915 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:45:25,798 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:25,798 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:45:25,802 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:45:25,827 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:45:25,827 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:45:25,828 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:45:25,828 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:26,882 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:27,314 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:45:27,314 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:27,446 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:27,446 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:27,514 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:27,514 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:27,515 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:27,515 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:45:27,515 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:27,515 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:27,573 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:45:27,573 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:45:27,573 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:27,573 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:27,573 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:45:27,573 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:45:27,573 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:27,629 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:27,629 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:27,629 - src.training - INFO - 모델 학습 시작
2025-06-24 09:45:27,746 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:45:27,746 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:45:27,746 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:45:27,746 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:45:27,746 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:45:27,746 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:45:27,746 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:45:27,746 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:45:27,746 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:27,747 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:45:27,747 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:45:27,747 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:45:27,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:45:27,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:27,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:27,820 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:27,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:27,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:27,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:28,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:28,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:28,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:45:28,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:45:28,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:28,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:28,202 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:28,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:28,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:28,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:28,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:28,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:28,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:28,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:45:28,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,375 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:28,375 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,375 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:45:28,387 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   n_estimators: 406
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   subsample: 0.8394633936788146
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:45:28,394 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:45:28,508 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:45:28,508 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03514259991794872})})
2025-06-24 09:45:28,508 - src.models.lightgbm_model - INFO -   - Best Iteration: 5
2025-06-24 09:45:28,508 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:45:28,509 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:45:28,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:28,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,509 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:28,541 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:28,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:28,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:28,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:28,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:28,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:28,685 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:28,685 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,689 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:45:28,692 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:45:28,692 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:45:28,692 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:45:28,692 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:45:28,692 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,692 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,692 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:45:28,692 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:45:28,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:45:28,706 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:45:28,710 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 0.00070915  0.00125197  0.00138111  0.00142456  0.00180575  0.00181403
  0.00149248  0.00233892  0.00248269  0.00808525  0.01090376  0.00351917
  0.00228372  0.00334537  0.0023806   0.00292894  0.00683208  0.01182935
  0.00141204  0.00190696  0.00151189  0.0021262   0.0053922   0.00229521
  0.04422853  0.01295786  0.00291744  0.01694322  0.00296241  0.00314432
  0.00315582  0.01105557  0.00167142  0.00252615  0.00111636  0.00360537
  0.00290908  0.00223866  0.00943589  0.00242126  0.00524843  0.00331433
  0.00297593  0.00392733  0.0016766   0.00340884  0.00436025  0.00320834
  0.00407751  0.00556871  0.00920375  0.01894879  0.00211596  0.00129542
  0.00220846  0.0117065   0.0082679   0.00579044  0.00319182  0.00364083
  0.01399392  0.0027589   0.00185748  0.0034244   0.0269682   0.00441179
  0.01347135  0.03147344  0.02227527  0.00379818  0.00299148  0.00159295
  0.00160137  0.00223509  0.01104602  0.02062422  0.01982148  0.02842334
  0.00553106  0.0109303   0.00285418  0.00135199  0.00331377  0.00129583
  0.00629424  0.00326147  0.00767552  0.00310618  0.00229212  0.01413467
  0.00530851  0.01105864  0.00433559  0.00810742  0.00338685  0.00315427
  0.00679128  0.02406051  0.01054117  0.00535839  0.00231342  0.02695578
  0.00348991  0.00144329  0.00754955  0.02003037  0.00337536  0.01061613
  0.00464528  0.00357371  0.00586254  0.00097259  0.01224384  0.00305046
  0.00415886  0.02394212  0.00444357  0.00260678  0.02360776  0.00353256
  0.01589028  0.0141519   0.0010244   0.00800161  0.00574142  0.00698701
  0.01105945  0.00577323  0.00224042  0.00155581  0.00229764  0.00288845
  0.00224506  0.00366692  0.0024959   0.02589454  0.0208911   0.00249045
  0.01470483  0.00416128  0.00309296  0.017288    0.0040598   0.01744379
  0.00290669  0.01427844  0.01258578  0.00277542  0.00338817  0.00470099
  0.00284678  0.00246198  0.00292554  0.00150039  0.00351369  0.0018075
  0.00508472  0.00243751  0.00386479  0.01162967  0.0035523   0.00269636
  0.0130187   0.00271644  0.00443207  0.00291038  0.01516301  0.01714542
  0.00314249  0.02171757  0.00286234  0.00388363  0.00271288  0.00485629
  0.00167835  0.00275122  0.00403232  0.00409534  0.01371616  0.00236676
  0.00445517  0.00258411  0.00262976  0.0034129   0.01072806  0.00620757
  0.03221173  0.01358655  0.02242343  0.01371888  0.00293792  0.00273055
  0.02720654  0.04088976  0.00269301  0.02384604  0.0458359   0.02585464
  0.00383913  0.01323019  0.01390617  0.01067387  0.00977448  0.0067651
  0.00350155  0.00858518  0.0039163   0.02045437  0.00537942  0.00303615
  0.00147682  0.00543565  0.00207915  0.00264627  0.01252324  0.00772448
  0.01431726  0.01621154  0.00388774  0.00581859  0.0082564   0.05471103
  0.00583586  0.00455566  0.00869732  0.00543731  0.00621314  0.01148707
  0.04370779  0.00683536  0.00771897  0.00723003  0.00135011  0.00308146
  0.00835261  0.00297998  0.04380441  0.01668383  0.00386083  0.00306959
  0.00789134  0.0034581   0.01060673  0.00353336  0.00870114  0.00204887
  0.00746516  0.00295901  0.00407266  0.04891376  0.01450113  0.0711899
  0.04110769  0.00778245  0.00144836  0.02728888  0.00550158  0.01717523
  0.00593959  0.0043232   0.00516801  0.00593324  0.00270297  0.00533681
  0.00421099  0.00505956  0.00349477  0.00123198  0.00340584  0.00522012
  0.00315912  0.01643523  0.0080737   0.00388258  0.0100078   0.0074068
  0.0038153   0.00810191  0.00129422  0.00994184  0.01005239  0.02019143
  0.02143269  0.01055122  0.00124424  0.04102957  0.03528372  0.0211159
  0.00346081  0.03937204  0.0010611   0.03186294  0.00347992  0.01118597
  0.00927034  0.03656031  0.01587326  0.01004571  0.0311526   0.00408527
  0.01207403  0.00235308  0.0554903   0.00699277  0.03329004  0.03175382
  0.00159926  0.0054727   0.00857369  0.01727594  0.00733349  0.00475394
  0.0013437   0.00028296  0.00890189  0.00164913  0.00561545  0.02394266
  0.01274985  0.00578487  0.01535653  0.00736805  0.03227099  0.00727843
  0.00371183  0.03211904  0.00498373  0.03544026  0.01676184  0.00565404
  0.00402881  0.0122178   0.03625887  0.01175064  0.01730393  0.01514167
  0.01300256  0.01151047  0.01164294  0.01033516  0.00533379  0.0028639
  0.02647851  0.00292324  0.00347514 -0.00110958  0.00253391  0.03524257
  0.00413879  0.00675819  0.03102235  0.0165873   0.00273328  0.01597733
  0.01255083  0.03113147  0.03058536  0.00047929  0.01760634  0.00334614
  0.03162189  0.00393418  0.01820692  0.00469494  0.00464288  0.01483062
  0.01329746  0.01970133  0.00401763  0.00118539  0.02342502  0.00765238
  0.03364369  0.03462146  0.00907461  0.0065847   0.00556543  0.00449272
  0.05288547  0.01155917  0.00879097  0.03689337  0.00985738  0.01860644
  0.01525899  0.03030187  0.01636808  0.01247544  0.00909435  0.00481041
  0.02545946  0.00373193  0.01184295  0.00594719  0.02115372  0.00277623
  0.00749953  0.01477256  0.00619962  0.01434201  0.01355949  0.01994001
  0.00438092  0.01549166  0.00217337  0.02161111  0.00465229  0.02762452
  0.00359273  0.00274968  0.04223606  0.01423846  0.01463918  0.00286038
  0.00605228  0.01081398  0.03065714  0.00803532  0.00710649  0.01517459
  0.00685293  0.00530193  0.03090207  0.01861793  0.00278889  0.01875638
  0.00569016  0.0033298   0.00204423  0.0242238   0.01815397  0.01388562
  0.00282483  0.00155656  0.00753726  0.01123845  0.00454969  0.00320257
  0.0088705   0.01830927  0.00132625  0.01127524  0.01741585  0.01449066
  0.02118148  0.04565663  0.00492474  0.03747376  0.00444739  0.00309391
  0.00140573  0.00932757  0.00624005  0.00753806  0.00230065  0.04368833
  0.01771236  0.00581669  0.00363975  0.00593294  0.03045782  0.00580409
  0.00603482  0.07107254  0.01260328  0.00383225  0.00757003  0.00764109
  0.06241232  0.01308442  0.00773228  0.03907811  0.00291152  0.01524714
  0.00722935  0.05474795  0.00121709  0.00613291  0.00499739  0.01057462
  0.05883678  0.01208058  0.00322485  0.03244549  0.00260933  0.07281655
  0.03507445  0.03331329  0.04617299  0.06074998  0.03593572  0.00374972
  0.01870097  0.00677952  0.02241521  0.00754298  0.0002661   0.00169966
  0.05152267  0.01039074  0.00827979  0.00553055  0.0053469   0.00426889
  0.00292229  0.00430354  0.00235266  0.00485718  0.00560888  0.01048072
  0.00769404  0.08332661  0.02044093  0.00265975  0.00654213  0.01340117
  0.0054193   0.00677671  0.02251209  0.01432477  0.00229106  0.00444404
  0.00486824  0.00805616  0.00504471  0.01034204  0.00770207  0.00129093
  0.03880751  0.01159006  0.0046168  -0.0013648   0.00482191  0.01856216
  0.01157333  0.00564885  0.02203569  0.01858036  0.00844938  0.01508653
  0.00394532  0.02254567  0.00597654  0.0086541   0.02643746  0.02494066
  0.00359915  0.00357881  0.03578021  0.0214101   0.045108    0.03644729
  0.02261962  0.03205172  0.00209505  0.00476481  0.00134623  0.02094432
  0.02927595  0.00409167  0.02922158  0.00591367  0.01635659  0.00437964
  0.00928284  0.03380997  0.00372926  0.00397475  0.07335342  0.04808821
  0.00338931  0.02872265  0.05963863  0.00587921  0.00467121  0.02711181
  0.00615871  0.04521736  0.01923238  0.00692861  0.01727945  0.03585185
  0.00073781  0.01184892  0.05477835  0.0033686   0.00868302  0.00372472
  0.01147239  0.01097454  0.00337533  0.00757405  0.00453599  0.03103299
  0.0041722   0.00652561  0.01307996  0.00757639  0.01705697  0.00344035
  0.01704451  0.00348386  0.01201108  0.0245161   0.03704488  0.02701519
  0.01464915  0.01996403  0.01103383  0.01427496  0.02855594  0.0275241
  0.01434942  0.02156452  0.01653825  0.03642566  0.00805871  0.00476955
  0.01767381  0.01362507  0.00889498  0.01330895  0.04268138  0.0128501
  0.04281146  0.00446632  0.0052104   0.00518679  0.04395494  0.04216161
  0.01450834  0.05137733  0.00117389  0.00614416  0.00803156  0.00541627
  0.01473441  0.00081804  0.01872838  0.01034017  0.00196743  0.004293
  0.00851224  0.01442695  0.07405817  0.05742084  0.00209658  0.01415818
  0.008215    0.02921581  0.00488117  0.00790241  0.0338423   0.0027465
  0.03664479  0.01379856  0.00708026  0.00505389  0.0031177   0.02452183
  0.00613747  0.00146533  0.00579116  0.01193896  0.01199546  0.0077836
  0.03100904  0.00432809  0.00463567  0.02958474  0.01526337  0.01681473
  0.05859105  0.01642651  0.00711162  0.02579032  0.00570535  0.0019659
  0.00978687  0.02345976  0.03329467  0.00358551 -0.00134844  0.00078298
  0.00214062  0.00799966  0.00671717  0.03133248  0.00792592  0.05609276
  0.02235869  0.00345989  0.03315511  0.00369705  0.01167148  0.00498352
  0.00730582  0.04015707  0.0098652   0.02799882  0.0113824   0.00337279
  0.01838172  0.01161498  0.03064918  0.00215325  0.00241267  0.00965134
  0.02797602  0.01451778  0.00469021  0.06311088  0.00371274  0.00259114
  0.02182302  0.04156527  0.01849122  0.07317762  0.02465761  0.03065605
  0.00291684  0.06347304  0.05025544  0.03253551  0.01056312  0.00674669
  0.00478133  0.02244989  0.00858185  0.01469523  0.00784486  0.01277945
  0.02092114  0.00835415  0.01504003  0.02232657  0.0218015   0.04107738
  0.02860622  0.03099709  0.03762529  0.00940648  0.01316249  0.01216022
  0.014059    0.03456447  0.0131388   0.02356325  0.02173856  0.01409018
  0.00400936  0.02200227  0.03748026  0.00393382  0.00347685  0.04351197
  0.00019702  0.02439268  0.02143537  0.01245664  0.04507773  0.06273785
  0.05651164  0.0334518   0.00807589  0.09350918  0.07173318  0.02787447
  0.00268033  0.01690102  0.00223815  0.00452173  0.00272029  0.00543279
  0.02805532  0.01053973  0.01213769  0.00344314  0.0182935   0.0155581
  0.0254465   0.00226938  0.00953885  0.01023143  0.01401855  0.00088214
  0.00215284  0.01361778  0.02061272  0.01246307  0.01179638  0.00260749
  0.04003349  0.03570804  0.00085653  0.00560316  0.00587484  0.01092413
  0.02986113  0.01029889  0.00290498  0.01400813  0.0161313   0.00590332
  0.02646552  0.00365627  0.0404243   0.00988977  0.02859866  0.01268996
  0.01063029  0.01073918  0.03418327  0.00466455  0.01009434]
2025-06-24 09:45:28,710 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:45:28,711 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:28,711 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:28,712 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:28,728 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:28,736 - src.training - INFO -   precision: 0.0
2025-06-24 09:45:28,736 - src.training - INFO -   recall: 0.0
2025-06-24 09:45:28,736 - src.training - INFO -   f1: 0.0
2025-06-24 09:45:28,736 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:45:28,736 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:45:28,736 - src.training - INFO -   positive_samples: 456
2025-06-24 09:45:28,736 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:45:28,736 - src.training - INFO -   total_samples: 368238
2025-06-24 09:45:28,736 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:45:28,736 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:45:28,736 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:45:28,736 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:45:28,736 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:45:28,736 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:45:28,736 - src.training - INFO - 모델 학습 완료
2025-06-24 09:45:28,736 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:45:28,736 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,736 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,736 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:28,736 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:28,755 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:45:28,755 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:45:29,143 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = lightgbm
2025-06-24 09:45:31,041 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:45:31,041 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:45:31,041 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:45:31,041 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:45:31,041 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:45:31,041 - src.training - INFO - 교차 검증 시작
2025-06-24 09:45:31,041 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:45:31,058 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:45:31,521 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:45:31,522 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:45:31,522 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:45:31,522 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:45:31,522 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:45:31,522 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:45:31,522 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:45:31,522 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:45:31,522 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:45:31,663 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:45:31,663 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:45:31,663 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:45:31,663 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:45:32,777 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:45:33,656 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:33,656 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:45:33,662 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:45:33,690 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:45:33,690 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:45:33,690 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:45:33,690 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:34,741 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:35,165 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:45:35,165 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:35,299 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:35,299 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:35,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:35,367 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:35,367 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:35,367 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:45:35,367 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:35,367 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:35,418 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:45:35,418 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:45:35,418 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:35,418 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:35,418 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:45:35,418 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:45:35,418 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:35,473 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:35,473 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:35,474 - src.training - INFO - 모델 학습 시작
2025-06-24 09:45:35,601 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:45:35,601 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:45:35,601 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:45:35,601 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:45:35,601 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:45:35,601 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:45:35,601 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:45:35,601 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:45:35,601 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:35,601 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:45:35,601 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:45:35,601 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:45:35,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:45:35,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:35,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:35,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:35,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:35,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:35,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:35,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:35,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:35,967 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:45:35,967 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:45:36,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:36,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:36,057 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:36,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:36,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:36,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:36,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:36,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:36,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:36,201 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:45:36,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,230 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:36,230 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,230 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:45:36,240 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:45:36,243 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   learning_rate: 0.010725209743171997
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   n_estimators: 621
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   subsample: 0.9879639408647978
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9329770563201687
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   reg_alpha: 4.329370014459266e-07
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO -   reg_lambda: 4.4734294104626844e-07
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:45:36,244 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:45:36,653 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:45:36,653 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513198283364333})})
2025-06-24 09:45:36,653 - src.models.lightgbm_model - INFO -   - Best Iteration: 79
2025-06-24 09:45:36,653 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:45:36,654 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:45:36,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:36,654 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,655 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:36,686 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:36,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:36,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:36,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:36,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:36,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:36,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:36,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,839 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:45:36,868 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:45:36,869 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:45:36,869 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:45:36,869 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:45:36,869 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,869 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:45:36,869 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:45:36,875 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:45:36,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:45:36,884 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00064437 0.00143375 0.00139778 ... 0.00127627 0.0024089  0.00261233]
2025-06-24 09:45:36,884 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:45:36,884 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:36,885 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:36,886 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:36,902 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:36,910 - src.training - INFO -   precision: 0.0
2025-06-24 09:45:36,910 - src.training - INFO -   recall: 0.0
2025-06-24 09:45:36,910 - src.training - INFO -   f1: 0.0
2025-06-24 09:45:36,910 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:45:36,910 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:45:36,910 - src.training - INFO -   positive_samples: 456
2025-06-24 09:45:36,910 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:45:36,910 - src.training - INFO -   total_samples: 368238
2025-06-24 09:45:36,910 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:45:36,910 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:45:36,910 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:45:36,910 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:45:36,910 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:45:36,910 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:45:36,910 - src.training - INFO - 모델 학습 완료
2025-06-24 09:45:36,910 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:45:36,910 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,910 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,910 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:36,910 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:36,929 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:45:36,929 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:45:37,314 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = lightgbm
2025-06-24 09:45:39,122 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:45:39,122 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:45:39,122 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:45:39,122 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:45:39,122 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:45:39,122 - src.training - INFO - 교차 검증 시작
2025-06-24 09:45:39,122 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:45:39,139 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:45:39,591 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:45:39,591 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:45:39,591 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:45:39,591 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:45:39,591 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:45:39,591 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:45:39,591 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:45:39,591 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:45:39,591 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:45:39,746 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:45:39,746 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:45:39,746 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:45:39,746 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:45:40,808 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:45:41,635 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:41,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:45:41,641 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:45:41,670 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:45:41,670 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:45:41,670 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:45:41,670 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:42,668 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:43,074 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:45:43,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:43,206 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:43,206 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:43,272 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:43,272 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:43,272 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:43,272 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:45:43,272 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:43,272 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:43,320 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:45:43,320 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:45:43,320 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:43,320 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:43,320 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:45:43,320 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:45:43,321 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:43,370 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:43,370 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:43,370 - src.training - INFO - 모델 학습 시작
2025-06-24 09:45:43,496 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:45:43,496 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:45:43,496 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:45:43,496 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:45:43,496 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:45:43,496 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:45:43,496 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:45:43,496 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:45:43,496 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:43,496 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:45:43,496 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:45:43,496 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:45:43,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:45:43,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:43,497 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:43,560 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:43,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:43,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:43,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:43,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:43,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:43,820 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:45:43,820 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:43,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:45:43,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:43,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:43,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:43,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:43,909 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:43,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:43,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:43,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:44,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:44,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:44,036 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:44,036 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:44,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:45:44,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:44,061 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:44,061 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:44,061 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:45:44,070 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:45:44,074 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   learning_rate: 0.04345454109729477
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   n_estimators: 339
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   subsample: 0.7164916560792167
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8447411578889518
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   reg_alpha: 4.258943089524393e-06
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9826980964985924e-05
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:45:44,075 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:45:44,218 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:45:44,218 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035133718667866874})})
2025-06-24 09:45:44,218 - src.models.lightgbm_model - INFO -   - Best Iteration: 14
2025-06-24 09:45:44,218 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:45:44,219 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:45:44,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:44,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:44,219 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:44,248 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:44,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:44,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:44,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:44,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:44,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:44,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:44,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:44,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:45:44,390 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:45:44,390 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:45:44,390 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:45:44,390 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:45:44,390 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:44,390 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:44,390 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:45:44,390 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:45:44,396 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:45:44,403 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:45:44,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00075488 0.00136634 0.00130681 ... 0.00607694 0.0177588  0.01575961]
2025-06-24 09:45:44,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:45:44,406 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:44,406 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:44,407 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:44,422 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:44,430 - src.training - INFO -   precision: 0.0
2025-06-24 09:45:44,430 - src.training - INFO -   recall: 0.0
2025-06-24 09:45:44,430 - src.training - INFO -   f1: 0.0
2025-06-24 09:45:44,430 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:45:44,430 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:45:44,430 - src.training - INFO -   positive_samples: 456
2025-06-24 09:45:44,430 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:45:44,430 - src.training - INFO -   total_samples: 368238
2025-06-24 09:45:44,430 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:45:44,430 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:45:44,430 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:45:44,430 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:45:44,430 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:45:44,430 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:45:44,430 - src.training - INFO - 모델 학습 완료
2025-06-24 09:45:44,430 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:45:44,431 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:44,431 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:44,431 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:44,431 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:44,450 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:45:44,450 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:45:44,841 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = lightgbm
2025-06-24 09:45:46,647 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:45:46,647 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:45:46,647 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:45:46,647 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:45:46,647 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:45:46,647 - src.training - INFO - 교차 검증 시작
2025-06-24 09:45:46,647 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:45:46,666 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:45:47,121 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:45:47,121 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:45:47,121 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:45:47,121 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:45:47,121 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:45:47,121 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:45:47,121 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:45:47,121 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:45:47,121 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:45:47,272 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:45:47,272 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:45:47,272 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:45:47,272 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:45:48,319 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:45:49,132 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:49,132 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:45:49,137 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:45:49,164 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:45:49,164 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:45:49,164 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:45:49,164 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:50,139 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:50,548 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:45:50,548 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:50,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:50,681 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:50,748 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:50,749 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:50,749 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:50,749 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:45:50,749 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:50,749 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:50,797 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:45:50,797 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:45:50,797 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:50,798 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:50,798 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:45:50,798 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:45:50,798 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:50,848 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:50,849 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:50,849 - src.training - INFO - 모델 학습 시작
2025-06-24 09:45:50,975 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:45:50,975 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:45:50,975 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:45:50,975 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:45:50,975 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:45:50,975 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:45:50,975 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:45:50,975 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:45:50,975 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:50,975 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:45:50,975 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:45:50,975 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:45:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:45:50,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:50,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:51,039 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:51,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:51,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:51,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:51,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:51,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:51,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:45:51,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:51,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:45:51,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:51,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:51,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:51,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:51,384 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:51,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:51,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:51,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:51,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:51,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:51,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:51,511 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:51,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:45:51,535 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:51,535 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:51,535 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:51,535 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:45:51,545 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   learning_rate: 0.019721610970574007
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   subsample: 0.8056937753654446
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.836965827544817
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0029369981104377003
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO -   reg_lambda: 3.425445902633376e-07
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:45:51,549 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:45:51,873 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:45:51,873 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035128826939948184})})
2025-06-24 09:45:51,873 - src.models.lightgbm_model - INFO -   - Best Iteration: 57
2025-06-24 09:45:51,874 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:45:51,874 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:45:51,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:51,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:51,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:51,907 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:51,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:51,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:51,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:52,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:52,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:52,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:52,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:52,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:45:52,061 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:45:52,061 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:45:52,061 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:45:52,061 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:45:52,061 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:52,061 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:52,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:45:52,061 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:45:52,068 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:45:52,075 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:45:52,077 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00056276 0.00157148 0.00146785 ... 0.00199071 0.00119527 0.00267887]
2025-06-24 09:45:52,077 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:45:52,077 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:52,078 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:52,079 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:52,094 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:52,101 - src.training - INFO -   precision: 0.0
2025-06-24 09:45:52,101 - src.training - INFO -   recall: 0.0
2025-06-24 09:45:52,101 - src.training - INFO -   f1: 0.0
2025-06-24 09:45:52,101 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:45:52,101 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:45:52,101 - src.training - INFO -   positive_samples: 456
2025-06-24 09:45:52,101 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:45:52,101 - src.training - INFO -   total_samples: 368238
2025-06-24 09:45:52,101 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:45:52,101 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:45:52,101 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:45:52,101 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:45:52,102 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:45:52,102 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:45:52,102 - src.training - INFO - 모델 학습 완료
2025-06-24 09:45:52,102 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:45:52,102 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:52,102 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:52,102 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:52,102 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:52,121 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:45:52,121 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:45:52,524 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = lightgbm
2025-06-24 09:45:54,346 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:45:54,346 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:45:54,346 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:45:54,346 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:45:54,346 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:45:54,346 - src.training - INFO - 교차 검증 시작
2025-06-24 09:45:54,346 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:45:54,364 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:45:54,827 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:45:54,828 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:45:54,828 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:45:54,828 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:45:54,828 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:45:54,828 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:45:54,828 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:45:54,828 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:45:54,828 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:45:54,981 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:54,981 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:54,981 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:45:54,981 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:45:54,981 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:54,982 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:45:54,982 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:45:54,982 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:45:54,982 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:45:54,982 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:45:56,050 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:45:56,876 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:56,876 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:45:56,881 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:45:56,908 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:45:56,908 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:45:56,908 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:45:56,908 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:45:57,905 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:45:58,310 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:45:58,310 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:58,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:58,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:45:58,507 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:45:58,507 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:58,507 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:45:58,507 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:45:58,507 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:58,507 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:58,564 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:45:58,564 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:45:58,564 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:58,564 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:58,564 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:45:58,564 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:45:58,564 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:58,612 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:58,612 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:45:58,612 - src.training - INFO - 모델 학습 시작
2025-06-24 09:45:58,739 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:45:58,739 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:45:58,739 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:45:58,739 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:45:58,739 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:45:58,739 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:45:58,739 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:45:58,740 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:45:58,740 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:58,740 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:45:58,740 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:45:58,740 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:45:58,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:45:58,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:58,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:58,805 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:58,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:58,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:58,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:58,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:59,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:59,063 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:45:59,063 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:45:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:59,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:59,151 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:59,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:59,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:59,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:59,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:59,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:59,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:59,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:45:59,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,302 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:45:59,302 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,303 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:45:59,313 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   learning_rate: 0.26690431824362526
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   subsample: 0.9233589392465844
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7218455076693483
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   reg_alpha: 0.014391207615728067
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO -   reg_lambda: 9.148975058772307e-05
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:45:59,317 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:45:59,404 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:45:59,404 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513983502959064})})
2025-06-24 09:45:59,404 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 09:45:59,404 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:45:59,404 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:45:59,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:45:59,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:45:59,434 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:45:59,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:45:59,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:45:59,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:45:59,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:45:59,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:45:59,565 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:45:59,565 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:45:59,576 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:45:59,577 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:45:59,577 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:45:59,577 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:45:59,577 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,577 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,577 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:45:59,577 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:45:59,584 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:45:59,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:45:59,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 7.21510585e-04  1.27086651e-03  1.36705079e-03  1.90631075e-03
  1.58805230e-03  3.36504329e-03  3.33959335e-03  3.57727384e-03
  3.49659857e-03  1.31702510e-03  2.44704194e-02  4.57033892e-03
  2.49850157e-03  4.88859737e-03  6.21239957e-02  2.66729291e-02
  2.00249502e-03  2.85019089e-03  1.05405542e-03  2.72959905e-03
  4.80125343e-03  5.43669767e-03  2.88675746e-03  8.41898429e-03
  2.77058743e-02  6.34732991e-03  2.21474665e-03 -2.18915237e-04
  2.53359537e-03  1.92337447e-02  2.24224013e-02  1.82910295e-03
  2.36038777e-02  1.68716358e-02  2.57773492e-03 -4.04257677e-04
  2.02021574e-03  3.89553229e-03  3.91767158e-03  5.83247751e-03
  4.98478165e-03  1.53611454e-02  2.36853992e-02  2.34663744e-03
  2.28108500e-03  2.74055606e-02  2.53278826e-03  2.51369887e-02
  2.25563507e-03  4.77783052e-02  4.83941242e-03  1.19365871e-03
  2.11252236e-03  3.31576302e-03  5.72994194e-03  3.41375151e-02
  5.09449770e-03  3.49938094e-02  2.39681604e-02  2.25131322e-03
  7.42591921e-03  2.68465238e-03  2.47305164e-03  2.46036046e-02
 -1.46191219e-03  2.25555864e-02  1.80279917e-03  3.77618597e-02
  2.75540101e-02  2.47935330e-02  4.49419868e-02  5.69400470e-02
  3.32565229e-02  3.08464999e-02  4.06953571e-03  2.66474791e-02
  1.69542112e-02  6.32187997e-03  5.33864793e-02  1.80118657e-02
  1.20591955e-03  1.16516098e-03  2.70414911e-03  5.01437339e-02
  4.81138957e-03  2.11794043e-02  4.85782190e-05  4.74571849e-02
  3.20894969e-02  5.38393152e-02  5.86904408e-03  2.43892680e-03
 -1.57873441e-03  1.84901516e-02  2.61699339e-02  2.92191873e-02
  2.74527061e-02  4.96762991e-02  5.71078639e-02  3.90880847e-02
  7.10962186e-02  2.44683784e-03  1.84647016e-02  1.96855201e-03
  1.23910136e-02  3.72520305e-02  1.31634281e-02  9.61748920e-03
  1.64572585e-02  8.71222856e-03  5.98103566e-02  3.68309575e-02
  4.92248703e-02  1.33152922e-02  6.25628672e-02  8.38739273e-04
  2.42138791e-03  4.64598365e-03  6.43443436e-03  3.40756040e-02
  3.63777835e-02  8.62459953e-03  6.47239820e-03  6.96359090e-03
  2.01050404e-02  6.09945505e-03  7.11951366e-02  2.85466734e-03
  1.57947802e-02  1.29157517e-03  6.76960783e-02  2.87896368e-02
  1.16079481e-01  9.07686445e-02  5.77303335e-03  6.25131918e-03
  5.74342856e-02  4.19312692e-02  6.71296108e-02  3.48420075e-02
 -1.55328448e-03  1.12358097e-01  1.79528391e-02  3.59124988e-03
  4.95678892e-02  1.08604862e-02  7.45144664e-04  2.35196463e-02
  7.99017657e-03  3.17027943e-02  3.25376281e-02  6.47446507e-02
  5.27465904e-02  1.31919237e-02  1.28395276e-02  3.43583652e-02
  5.38647652e-02  1.43351082e-02  4.04408577e-03  4.01873462e-02
  5.17200905e-02  4.59501583e-02  8.49953124e-03  2.70458967e-02
  5.60502094e-02  4.77011908e-02  9.62561230e-04  3.19342739e-02
  8.02124541e-03  7.92630165e-02  2.85818370e-02  6.55950545e-02
  5.85673596e-02  2.97380926e-02  8.74348324e-02  8.44089951e-02
  4.71537884e-03  2.87069053e-02  3.79760960e-02  3.08796136e-02
  2.74898805e-02  2.84299729e-02  3.94338139e-02  6.22586925e-03
  2.53080970e-02  4.78122964e-02  3.80024619e-02  2.51749119e-02
  3.95955277e-02  4.18750611e-02  1.64187999e-02]
2025-06-24 09:45:59,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:45:59,595 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:59,595 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:59,596 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:59,612 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:45:59,619 - src.training - INFO -   precision: 0.0
2025-06-24 09:45:59,619 - src.training - INFO -   recall: 0.0
2025-06-24 09:45:59,619 - src.training - INFO -   f1: 0.0
2025-06-24 09:45:59,619 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:45:59,619 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:45:59,619 - src.training - INFO -   positive_samples: 456
2025-06-24 09:45:59,619 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:45:59,619 - src.training - INFO -   total_samples: 368238
2025-06-24 09:45:59,619 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:45:59,619 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:45:59,619 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:45:59,619 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:45:59,620 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:45:59,620 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:45:59,620 - src.training - INFO - 모델 학습 완료
2025-06-24 09:45:59,620 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:45:59,620 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,620 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,620 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:45:59,620 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:45:59,640 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:45:59,640 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:00,042 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = lightgbm
2025-06-24 09:46:01,962 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:01,962 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:01,962 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:01,962 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:01,962 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:01,962 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:01,962 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:01,978 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:02,443 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:02,443 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:02,443 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:02,443 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:02,443 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:02,443 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:02,443 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:02,443 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:02,443 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:02,582 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:02,582 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:02,582 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:02,582 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:03,711 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:04,600 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:04,600 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:04,605 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:04,634 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:04,634 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:04,634 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:04,634 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:05,700 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:06,129 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:06,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:06,263 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:06,263 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:06,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:06,331 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:06,331 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:06,331 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:06,331 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:06,331 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:06,385 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:06,385 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:06,385 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:06,385 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:06,385 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:06,385 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:06,386 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:06,441 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:06,441 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:06,441 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:06,569 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:06,569 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:06,569 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:06,569 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:06,569 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:06,569 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:06,569 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:06,569 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:06,569 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:06,569 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:06,569 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:06,569 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:06,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:06,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:06,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:06,642 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:06,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:06,754 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:06,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:06,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:06,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:06,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:06,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:06,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:06,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:06,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:06,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:06,987 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:07,017 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:07,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:07,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:07,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:07,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:07,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:07,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:07,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:07,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:07,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:07,185 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:07,185 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:07,185 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:07,193 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   learning_rate: 0.011240768803005551
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:07,198 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   n_estimators: 166
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   subsample: 0.9637281608315128
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7035119926400067
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   reg_alpha: 6.388511557344611e-06
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0004793052550782129
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:07,199 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:07,554 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:07,554 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035128176079000165})})
2025-06-24 09:46:07,554 - src.models.lightgbm_model - INFO -   - Best Iteration: 70
2025-06-24 09:46:07,554 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:07,555 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:07,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:07,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:07,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:07,591 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:07,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:07,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:07,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:07,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:07,734 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:07,739 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:07,739 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:07,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:07,768 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:07,768 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:07,769 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:07,769 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:07,769 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:07,769 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:07,769 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:07,769 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:07,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:07,782 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:07,784 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0006556  0.00159007 0.00146353 ... 0.00193067 0.00253228 0.00280731]
2025-06-24 09:46:07,784 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:07,784 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:07,785 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:07,785 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:07,802 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:07,809 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:07,810 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:07,810 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:07,810 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:07,810 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:07,810 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:07,810 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:07,810 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:07,810 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:07,810 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:07,810 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:07,810 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:07,810 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:07,810 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:07,810 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:07,810 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:07,810 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:07,810 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:07,810 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:07,810 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:07,829 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:07,829 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:08,235 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = lightgbm
2025-06-24 09:46:10,133 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:10,133 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:10,133 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:10,133 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:10,133 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:10,133 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:10,133 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:10,150 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:10,601 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:10,601 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:10,601 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:10,601 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:10,601 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:10,601 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:10,601 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:10,601 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:10,601 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:10,753 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:10,753 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:10,753 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:10,753 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:11,809 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:12,630 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:12,630 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:12,635 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:12,663 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:12,663 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:12,663 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:12,663 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:13,652 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:14,060 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:14,060 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:14,192 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:14,192 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:14,259 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:14,260 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:14,260 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:14,260 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:14,260 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:14,260 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:14,308 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:14,308 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:14,308 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:14,308 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:14,308 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:14,308 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:14,308 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:14,357 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:14,357 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:14,357 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:14,484 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:14,484 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:14,484 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:14,484 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:14,484 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:14,484 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:14,484 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:14,484 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:14,484 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:14,485 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:14,485 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:14,485 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:14,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:14,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:14,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:14,549 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:14,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:14,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:14,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:14,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:14,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:14,808 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:14,808 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:14,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:14,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:14,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:14,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:14,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:14,896 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:14,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:14,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:14,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:14,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:15,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:15,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:15,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:15,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:15,048 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:15,048 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:15,048 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:15,048 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:15,059 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:15,063 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   learning_rate: 0.27051668818999286
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   subsample: 0.9100531293444458
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9757995766256756
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   reg_alpha: 0.002404915432737351
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9809253750493907
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:15,064 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:15,157 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:15,157 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512142702361728})})
2025-06-24 09:46:15,157 - src.models.lightgbm_model - INFO -   - Best Iteration: 5
2025-06-24 09:46:15,157 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:15,158 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:15,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:15,158 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:15,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:15,189 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:15,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:15,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:15,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:15,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:15,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:15,318 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:15,318 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:15,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:15,328 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:15,329 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:15,329 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:15,329 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:15,329 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:15,329 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:15,329 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:15,329 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:15,335 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:15,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:15,346 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 0.00038987  0.00178654  0.00150781  0.00135884  0.0011641   0.00051241
  0.00134752  0.00121837  0.00236418  0.00196581  0.00235607  0.00124014
  0.00080675  0.00044414  0.00056668  0.00206401  0.00073687  0.00272038
  0.0026823   0.00183826  0.00043073  0.000485    0.00077774  0.00051712
  0.00099184  0.00086102  0.00168521  0.00210209  0.00085942  0.00089313
  0.00180775  0.00212088  0.00115375  0.00139603  0.00156847  0.00147771
  0.0009474   0.00234436  0.00057139  0.00086412  0.00159181  0.00136734
  0.00149649  0.00223503  0.00196741  0.00116203  0.00086929  0.00211036
  0.00269443  0.00128617  0.00223291  0.00128457  0.00172607  0.00181246
  0.0026839   0.00157891  0.0028512   0.00224343  0.00182118  0.00190286
  0.00091016  0.00276952  0.00215123  0.00329948  0.00162274  0.00477668
  0.00639039  0.00975957  0.00249969  0.00177204  0.00242604  0.00216175
  0.00778978  0.0064484   0.00649577  0.00222692  0.00199875  0.01050066
  0.00380218  0.01611003 -0.00083803  0.00250684  0.00166529  0.0025857
  0.00120289  0.00488206  0.00262415  0.00253776  0.00544442  0.00471742
  0.00494864  0.0024239   0.00422734  0.00128928  0.00223761  0.00218847
  0.00385811  0.03360018  0.01619171  0.01078351  0.01621097  0.00646943
  0.00131307  0.01172948  0.00744174  0.00265208  0.00253376  0.00198723
  0.00224813  0.0034821   0.00099654  0.00295892  0.00298627  0.003279
  0.00350824  0.00403762  0.00589698  0.00491215  0.00455959  0.00643664
  0.00350583  0.02142727  0.00266019  0.00351084  0.01055219  0.01606916
  0.01648604  0.00285385  0.00503272  0.00351635  0.00370343  0.00218076
  0.0021972   0.00330219  0.01736745  0.00412412  0.00421891  0.00340763
  0.00516736  0.00338169  0.01018472  0.00217265  0.00278122  0.00278934
  0.01264284  0.0181682   0.00252724  0.00239943  0.00745322  0.00445086
  0.00333493  0.00450604  0.0036755   0.00137255  0.01337246  0.00304613
  0.02311329  0.0047422   0.00545201  0.01144663  0.00211638  0.00402571
  0.00428327  0.00261363  0.00625367  0.01701688  0.01468203  0.0322971
  0.003224    0.00349772  0.00518048  0.01312871  0.00314553  0.00452349
  0.01490968  0.01291996  0.02350511  0.01385833  0.00433861  0.00194448
  0.02286502  0.00684545  0.00475549  0.00604844  0.01949873  0.01164531
  0.01196719  0.00923639  0.00576615  0.00852659  0.01715919  0.00290227
  0.00256111  0.01571695  0.00307256  0.00504083  0.00680737  0.00402417
  0.01143628  0.01418006  0.01534644  0.02309594  0.00559844  0.0047148
  0.02049871  0.0191033   0.00308068  0.02387851  0.00547182  0.02984118
  0.00608407  0.01919743  0.04857477  0.00322135  0.01619641  0.01365093
  0.00211478 -0.00031333  0.02908835 -0.00086544  0.03713855  0.02694389
  0.02891263  0.02911223  0.03083951  0.00290978  0.01450498  0.00446116
  0.00308569  0.00204293  0.01715694  0.01765508  0.01696445  0.00369897
  0.00662113  0.02329752  0.0233651   0.00355819  0.00698999  0.00915351
  0.01370439  0.01065625  0.00283127  0.01039176  0.00298247  0.00760988
  0.00872079  0.00702806  0.00443305  0.00946823  0.02392839  0.0150912
  0.00700211  0.00782404  0.01911417  0.00881123  0.02034437  0.00475533
  0.00573408  0.01657243  0.02129752  0.01479758  0.01224462  0.00439058
  0.01449241  0.00619723  0.02816625  0.00395362  0.03991584  0.0084318
  0.00345116  0.01034743  0.00909924  0.00295654  0.0053187   0.01329597
  0.00545471  0.0122441   0.00361246  0.03658017  0.01591367  0.02425925
  0.02413087  0.00383071  0.03729261  0.09691545  0.04037541  0.02962507
  0.0326542   0.00572597  0.00484188  0.02178638  0.02462488  0.00671212
  0.04520124  0.00988461  0.00824137  0.00934852  0.02144469  0.00327827
  0.03823859  0.00345469  0.00566077  0.0176602   0.03928858  0.00947504
  0.02336539  0.0792752   0.04792328  0.017973    0.00160377  0.0147057
  0.01834895  0.02105676  0.00904307  0.00817769  0.01798111  0.06534768
  0.01015415  0.00425269  0.02607412  0.0062419   0.02914498  0.00833185
  0.0237144   0.02004728  0.01312198  0.03720072  0.00602018  0.02604899
  0.01122016  0.00790021 -0.00034993  0.00785733  0.03177901  0.01296076
  0.02017266  0.016946    0.03229242  0.03392318  0.01891457  0.00784594
  0.00725045  0.01154204  0.01167646  0.00273467  0.00725856  0.01933067
  0.0041619   0.00517329  0.03894178  0.03076983  0.01607606  0.0062028
  0.01377348  0.02482448  0.02237324  0.02409501  0.00829564  0.03878558
  0.03946112  0.00798318  0.02065802  0.00899962  0.05895778  0.01347766
  0.00582803  0.00749975  0.00400789  0.03057105  0.00673373  0.0206602
  0.01640307  0.0143839   0.0394633   0.01489685  0.01892018  0.03138194
  0.00662795  0.01967443  0.01800072  0.05663304  0.08826868  0.03212831
  0.04809371  0.00355659  0.03177931  0.03679667  0.02838276  0.00800665
  0.01392121  0.01602946  0.01007384  0.00518926  0.03846666  0.00283287
  0.00766215  0.0487452   0.01116935  0.01745442  0.03692236  0.02387588
  0.0193927   0.04533628  0.03490161  0.00694578  0.08470742  0.02279781
  0.01417769  0.01798505  0.00775885  0.00952697  0.00221298  0.02368332
  0.02891375  0.0036548   0.00910182  0.02539232  0.00715888  0.00117862
  0.02258103  0.00693253  0.03337796  0.05754353  0.02606899  0.01085098
  0.07932848  0.02481698  0.01167291  0.02378673  0.01358882  0.00860812
  0.0029383   0.00478019  0.04550703  0.04212059  0.00580755  0.02868714
  0.00651829  0.00634265  0.02567162  0.0303877   0.00865588  0.01259207
  0.0257576   0.0234893   0.02230267  0.03184982  0.00970723  0.00833796
  0.00232973  0.02300618  0.01465511  0.02059115  0.0335289   0.01406725
  0.00713658  0.01486975  0.01011524  0.00280916  0.0097734   0.00260847
  0.01362158  0.01777899  0.01912101  0.02511575  0.04867384  0.01093565
  0.07367056  0.02495355  0.02217364  0.02581689  0.01470182  0.00900052
  0.01015269  0.08964241  0.02529059  0.11762607  0.0246918   0.0434193
  0.03039866  0.01494655  0.06504695  0.01465026  0.027324    0.00430842
  0.02429028  0.00884152  0.01004138  0.02019943  0.01148172  0.02352743
  0.03928015  0.01748149  0.02492102  0.00251315  0.00899151  0.02712827
  0.01675187  0.01162566  0.11848064  0.08924791  0.12825511  0.03044841
  0.01622742  0.00032423  0.04912961  0.03648015  0.01910582  0.03282259
  0.03886343  0.00754466  0.03383925  0.00671569  0.11375264  0.02938919
  0.01860105  0.00886727  0.00992237  0.00904989  0.01461114  0.01532987
  0.00354201  0.00427309  0.02421431  0.00245139  0.02296575  0.01011893
  0.02282059  0.02160617  0.07255363  0.02431137  0.03467036  0.05254901
  0.0139439   0.07176914  0.01008499  0.002384    0.0041603   0.00994607
  0.01603717  0.02584782  0.01178552  0.01440667  0.0117936   0.03993164
  0.08211886  0.01940126  0.07272459  0.05341736  0.06345628  0.00906758
  0.02178357  0.05628101  0.05320578  0.00350274  0.03250893  0.01021414
  0.01037122  0.03802265  0.00513609  0.02669165  0.01024207  0.0110649
  0.0184418   0.01564065  0.03820714  0.0257773   0.01535265  0.00037691
  0.00743218  0.00313144  0.05092272  0.02391011  0.0245284   0.01001355
  0.01098951  0.02431245 -0.00029566  0.02658211  0.05562631  0.0142251
  0.03072904  0.00620433  0.01464297  0.0058984   0.02231513  0.07451086
  0.08528723  0.0183847   0.00981692  0.00318101  0.00390725  0.00596414
  0.00613684  0.0154978   0.05436333  0.02359199  0.03303425  0.03232791
  0.00978899  0.03910971  0.03594446  0.02343227  0.00938931  0.0286002
  0.00662948  0.00536784  0.01113634  0.01704973  0.03732619  0.04402949
  0.00456937  0.02933635  0.00965984  0.08008544  0.0098843   0.04436527
  0.04489325  0.03260664  0.02730994  0.02433526  0.02417818  0.04466168
  0.01393863  0.01319008  0.03973509  0.01914453  0.02231375  0.01747489
  0.0874141   0.01188378  0.03740543  0.04161393  0.013697    0.01071119
  0.02426664  0.08486207  0.02208317  0.07948665  0.05183321  0.01871937
  0.02577104  0.01755298  0.09237496  0.03627484  0.006811    0.05422888
  0.03979585  0.02272955  0.02375303  0.00322964  0.03848369  0.11610456
  0.02781517  0.0155593   0.03370668  0.02798311  0.00957113  0.03505564
  0.00713896  0.00518766  0.01431843  0.05959838  0.04772854  0.01871436
  0.03370842  0.02544121  0.01906775  0.02574523  0.02336648  0.0256419
  0.02055008  0.01749583  0.03879103  0.03308072  0.07985476  0.03574328
  0.00423236  0.03164794  0.09978406  0.13868065  0.14437003  0.01446038
  0.02466037  0.00701169  0.00601119  0.00867358  0.02391476  0.02060716
  0.02309812  0.01461332  0.02033867  0.01967266  0.03553801  0.03434437
  0.00204789  0.00655111  0.00574386  0.03837834  0.00881373  0.02510301
  0.04270677  0.02514814  0.03850705  0.01299266  0.03500377  0.00665205
  0.01175875  0.02443527  0.03033673  0.02200218]
2025-06-24 09:46:15,346 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:15,347 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:15,347 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:15,348 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:15,364 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:15,371 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:15,372 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:15,372 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:15,372 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:15,372 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:15,372 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:15,372 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:15,372 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:15,372 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:15,372 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:15,372 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:15,372 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:15,372 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:15,372 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:15,372 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:15,372 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:15,372 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:15,372 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:15,372 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:15,372 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:15,393 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:15,393 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:15,768 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = lightgbm
2025-06-24 09:46:17,561 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:17,561 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:17,561 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:17,561 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:17,561 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:17,561 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:17,561 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:17,578 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:18,036 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:18,037 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:18,037 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:18,037 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:18,037 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:18,037 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:18,037 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:18,037 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:18,037 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:18,193 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:18,193 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:18,193 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:18,193 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:19,259 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:20,140 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:20,140 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:20,145 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:20,173 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:20,173 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:20,173 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:20,173 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:21,230 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:21,664 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:21,664 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:21,798 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:21,798 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:21,867 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:21,867 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:21,867 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:21,867 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:21,867 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:21,867 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:21,921 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:21,921 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:21,921 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:21,921 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:21,921 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:21,921 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:21,921 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:21,976 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:21,976 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:21,976 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:22,103 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:22,103 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:22,103 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:22,103 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:22,103 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:22,103 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:22,103 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:22,103 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:22,103 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:22,103 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:22,103 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:22,103 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:22,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:22,103 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:22,104 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:22,176 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:22,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:22,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:22,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:22,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:22,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:22,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:22,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:22,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:22,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:22,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:22,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:22,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:22,553 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:22,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:22,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:22,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:22,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:22,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:22,694 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:22,694 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:22,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:22,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:22,719 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:22,719 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:22,719 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:22,728 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   n_estimators: 134
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   subsample: 0.7301321323053057
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7554709158757928
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   reg_alpha: 0.28749982347407854
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO -   reg_lambda: 1.6247252885719427e-05
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:22,732 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:23,263 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:23,264 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035117279667332475})})
2025-06-24 09:46:23,264 - src.models.lightgbm_model - INFO -   - Best Iteration: 130
2025-06-24 09:46:23,264 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:23,264 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:23,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:23,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:23,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:23,298 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:23,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:23,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:23,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:23,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:23,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:23,443 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:23,443 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:23,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:23,488 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:23,488 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:23,488 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:23,488 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:23,488 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:23,488 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:23,488 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:23,488 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:23,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:23,501 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:23,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00043766 0.00043568 0.00043949 ... 0.00190465 0.00190917 0.00433645]
2025-06-24 09:46:23,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:23,504 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:23,505 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:23,505 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:23,521 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:23,529 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:23,529 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:23,529 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:23,529 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:23,529 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:23,529 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:23,529 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:23,529 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:23,529 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:23,529 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:23,529 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:23,529 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:23,529 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:23,529 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:23,529 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:23,529 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:23,530 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:23,530 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:23,530 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:23,530 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:23,548 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:23,548 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:23,963 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = lightgbm
2025-06-24 09:46:25,886 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:25,886 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:25,886 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:25,886 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:25,886 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:25,886 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:25,886 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:25,903 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:26,363 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:26,363 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:26,363 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:26,363 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:26,363 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:26,363 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:26,363 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:26,363 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:26,363 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:26,498 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:26,498 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:26,498 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:26,498 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:26,498 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:26,499 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:26,499 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:26,499 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:26,499 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:26,499 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:27,645 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:28,531 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:28,531 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:28,537 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:28,565 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:28,565 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:28,565 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:28,565 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:29,604 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:30,037 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:30,037 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:30,171 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:30,171 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:30,240 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:30,240 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:30,240 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:30,240 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:30,240 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:30,240 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:30,289 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:30,289 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:30,289 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:30,289 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:30,289 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:30,289 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:30,289 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:30,346 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:30,346 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:30,346 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:30,474 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:30,474 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:30,474 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:30,474 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:30,474 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:30,474 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:30,474 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:30,474 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:30,474 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:30,474 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:30,474 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:30,474 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:30,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:30,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:30,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:30,547 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:30,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:30,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:30,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:30,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:30,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:30,836 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:30,836 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:30,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:30,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:30,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:30,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:30,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:30,920 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:30,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:30,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:31,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:31,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:31,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:31,063 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:31,063 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:31,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:31,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:31,089 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:31,089 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:31,089 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:31,097 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   learning_rate: 0.016149614799999188
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:31,101 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   n_estimators: 317
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   subsample: 0.9208787923016158
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6298202574719083
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   reg_alpha: 0.08916674715636537
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO -   reg_lambda: 6.143857495033091e-07
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:31,102 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:31,421 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:31,421 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512935746410237})})
2025-06-24 09:46:31,421 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:46:31,421 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:31,421 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:31,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:31,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:31,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:31,458 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:31,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:31,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:31,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:31,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:31,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:31,601 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:31,601 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:31,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:31,630 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:31,630 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:31,630 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:31,630 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:31,630 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:31,630 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:31,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:31,630 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:31,636 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:31,643 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:31,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00056452 0.00155738 0.00140648 ... 0.00475105 0.00156055 0.00242051]
2025-06-24 09:46:31,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:31,646 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:31,646 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:31,647 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:31,663 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:31,670 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:31,670 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:31,670 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:31,670 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:31,670 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:31,670 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:31,670 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:31,670 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:31,670 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:31,670 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:31,670 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:31,670 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:31,671 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:31,671 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:31,671 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:31,671 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:31,671 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:31,671 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:31,671 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:31,671 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:31,690 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:31,690 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:32,095 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = lightgbm
2025-06-24 09:46:33,928 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:33,928 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:33,928 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:33,928 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:33,928 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:33,928 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:33,928 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:33,945 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:34,397 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:34,397 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:34,397 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:34,397 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:34,397 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:34,397 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:34,397 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:34,397 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:34,397 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:34,547 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:34,547 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:34,548 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:34,548 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:34,548 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:34,548 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:34,548 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:34,548 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:34,548 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:34,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:35,617 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:36,442 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:36,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:36,448 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:36,475 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:36,475 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:36,475 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:36,475 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:37,466 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:37,875 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:37,875 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:38,007 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:38,007 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:38,073 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:38,074 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:38,074 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:38,074 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:38,074 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:38,074 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,122 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:38,122 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:38,122 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,122 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,122 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:38,122 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:38,122 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,172 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:38,172 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:38,172 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:38,298 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:38,299 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:38,299 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:38,299 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:38,299 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:38,299 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:38,299 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:38,299 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:38,299 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:38,299 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:38,299 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:38,299 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:38,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:38,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:38,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:38,362 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:38,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:38,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:38,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:38,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:38,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:38,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:38,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:38,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:38,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:38,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:38,679 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:38,707 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:38,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:38,755 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:38,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:38,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:38,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:38,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:38,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:38,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:38,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,858 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:38,858 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:38,858 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:38,868 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:38,872 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   n_estimators: 55
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   subsample: 0.8916028672163949
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:38,873 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:38,998 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:38,998 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03514174725906966})})
2025-06-24 09:46:38,998 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:46:38,998 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:38,998 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:38,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:38,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:38,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:39,030 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:39,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:39,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:39,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:39,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:39,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:39,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:39,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:39,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:39,172 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:39,172 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:39,172 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:39,172 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:39,172 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:39,172 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:39,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:39,172 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:39,178 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:39,185 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:39,187 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00049359 0.00162755 0.00132471 ... 0.00396037 0.0389316  0.01207309]
2025-06-24 09:46:39,187 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:39,188 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:39,188 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:39,189 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:39,204 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:39,211 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:39,211 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:39,211 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:39,212 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:39,212 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:39,212 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:39,212 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:39,212 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:39,212 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:39,212 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:39,212 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:39,212 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:39,212 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:39,212 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:39,212 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:39,212 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:39,212 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:39,212 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:39,212 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:39,212 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:39,231 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:39,231 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:39,618 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = lightgbm
2025-06-24 09:46:41,443 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:41,443 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:41,443 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:41,443 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:41,443 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:41,443 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:41,443 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:41,460 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:41,916 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:41,916 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:41,916 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:41,916 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:41,916 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:41,916 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:41,916 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:41,916 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:41,916 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:42,063 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:42,063 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:42,063 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:42,063 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:43,131 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:43,964 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:43,964 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:43,970 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:43,997 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:43,997 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:43,997 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:43,997 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:44,996 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:45,408 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:45,408 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:45,541 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:45,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:45,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:45,608 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:45,608 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:45,608 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:45,608 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:45,608 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:45,666 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:45,666 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:45,666 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:45,666 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:45,666 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:45,666 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:45,666 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:45,717 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:45,717 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:45,717 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:45,843 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:45,843 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:45,843 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:45,843 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:45,843 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:45,843 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:45,843 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:45,843 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:45,843 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:45,843 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:45,843 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:45,843 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:45,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:45,843 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:45,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:45,907 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:45,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:46,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:46,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:46,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:46,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:46,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:46,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:46,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:46,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:46,253 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:46,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:46,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:46,324 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:46,349 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:46,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:46,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:46,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:46,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,405 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:46,405 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,405 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:46,415 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:46,419 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   learning_rate: 0.09315744902122479
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   n_estimators: 901
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   subsample: 0.6071847502459278
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6061470949312417
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3686680646913267e-08
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO -   reg_lambda: 6.099006535330825
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:46,420 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:46,573 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:46,573 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512970175409729})})
2025-06-24 09:46:46,573 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:46:46,573 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:46,574 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:46,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:46,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,574 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:46,603 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:46,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:46,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:46,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:46,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:46,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:46,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:46,732 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:46,747 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:46,747 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:46,747 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:46,747 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:46,747 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,747 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,747 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:46,747 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:46,755 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:46,762 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:46,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00046538 0.00175917 0.00181341 ... 0.00255199 0.03524759 0.02368776]
2025-06-24 09:46:46,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:46,765 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:46,765 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:46,766 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:46,783 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:46,790 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:46,790 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:46,790 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:46,790 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:46,790 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:46,790 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:46,790 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:46,790 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:46,790 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:46,790 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:46,790 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:46,790 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:46,791 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:46,791 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:46,791 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:46,791 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:46,791 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,791 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,791 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:46,791 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:46,811 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:46,811 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:47,201 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = lightgbm
2025-06-24 09:46:49,035 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:49,035 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:49,035 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:49,035 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:49,035 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:49,035 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:49,035 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:49,053 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:49,503 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:49,503 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:49,503 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:49,503 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:49,503 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:49,503 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:49,503 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:49,504 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:49,504 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:49,656 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:49,657 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:49,657 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:49,657 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:49,657 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:49,657 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:49,657 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:49,657 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:49,657 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:49,657 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:50,712 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:51,532 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:51,532 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:51,537 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:51,565 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:51,565 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:51,565 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:51,565 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:52,549 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:52,959 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:46:52,959 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:53,090 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:53,091 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:46:53,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:46:53,158 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:53,158 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:46:53,158 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:46:53,158 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:53,158 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,205 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:46:53,205 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:46:53,205 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,205 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,205 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:46:53,205 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:46:53,205 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,255 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:53,255 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:46:53,255 - src.training - INFO - 모델 학습 시작
2025-06-24 09:46:53,382 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:46:53,382 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:46:53,382 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:46:53,382 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:46:53,383 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:46:53,383 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:46:53,383 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:46:53,383 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:46:53,383 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:53,383 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:46:53,383 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:46:53,383 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:46:53,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:46:53,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:53,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:53,447 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:53,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:53,540 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:53,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:53,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:53,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:53,706 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:46:53,706 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:53,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:46:53,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:53,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:53,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:53,793 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:53,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:53,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:53,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:53,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:53,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:53,920 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:53,920 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:53,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:46:53,943 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,943 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:46:53,943 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:53,943 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:46:53,954 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   learning_rate: 0.037348440879763224
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   n_estimators: 705
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   subsample: 0.8275682686623269
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9801238964661396
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   reg_alpha: 2.0076751494057687e-08
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO -   reg_lambda: 0.050437107744728454
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:46:53,958 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:46:54,177 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:46:54,178 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.0351242897056146})})
2025-06-24 09:46:54,178 - src.models.lightgbm_model - INFO -   - Best Iteration: 35
2025-06-24 09:46:54,178 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:46:54,178 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:46:54,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:46:54,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:54,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:46:54,210 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:46:54,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:46:54,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:46:54,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:46:54,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:46:54,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:46:54,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:46:54,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:54,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:46:54,361 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:46:54,361 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:46:54,362 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:46:54,362 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:46:54,362 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:54,362 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:46:54,362 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:46:54,362 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:46:54,368 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:46:54,375 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:46:54,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00051044 0.00156741 0.00150192 ... 0.01493445 0.02479601 0.00858229]
2025-06-24 09:46:54,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:46:54,377 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:54,378 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:54,378 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:54,394 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:46:54,401 - src.training - INFO -   precision: 0.0
2025-06-24 09:46:54,402 - src.training - INFO -   recall: 0.0
2025-06-24 09:46:54,402 - src.training - INFO -   f1: 0.0
2025-06-24 09:46:54,402 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:46:54,402 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:46:54,402 - src.training - INFO -   positive_samples: 456
2025-06-24 09:46:54,402 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:46:54,402 - src.training - INFO -   total_samples: 368238
2025-06-24 09:46:54,402 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:46:54,402 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:46:54,402 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:46:54,402 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:46:54,402 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:46:54,402 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:46:54,402 - src.training - INFO - 모델 학습 완료
2025-06-24 09:46:54,402 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:46:54,402 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:54,402 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:54,402 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:46:54,402 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:46:54,421 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:46:54,422 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:46:54,812 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = lightgbm
2025-06-24 09:46:56,729 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:46:56,729 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:46:56,729 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:46:56,729 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:46:56,729 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:46:56,729 - src.training - INFO - 교차 검증 시작
2025-06-24 09:46:56,729 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:46:56,747 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:46:57,211 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:46:57,211 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:46:57,211 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:46:57,211 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:46:57,211 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:46:57,211 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:46:57,211 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:46:57,211 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:46:57,211 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:46:57,348 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:46:57,348 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:46:57,348 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:46:57,348 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:46:58,474 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:46:59,374 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:46:59,374 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:46:59,377 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:46:59,406 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:46:59,406 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:46:59,406 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:46:59,406 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:00,471 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:00,916 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:00,916 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:01,053 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:01,053 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:01,124 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:01,124 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:01,124 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:01,124 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:01,124 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:01,124 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,184 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:01,184 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:01,184 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,184 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,184 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:01,184 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:01,184 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,240 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:01,240 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:01,240 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:01,368 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:01,369 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:01,369 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:01,369 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:01,369 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:01,369 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:01,369 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:01,369 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:01,369 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:01,369 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:01,369 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:01,369 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:01,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:01,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:01,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:01,442 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:01,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:01,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:01,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:01,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:01,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:01,737 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:01,737 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:01,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:01,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:01,790 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:01,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:01,820 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:01,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:01,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:01,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:01,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:01,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:01,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:01,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:01,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:01,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,990 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:01,990 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:01,990 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:01,999 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:02,003 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   learning_rate: 0.11614923191803554
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   n_estimators: 706
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   subsample: 0.9831484441888799
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.902800604671404
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   reg_alpha: 5.997698489764049e-07
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO -   reg_lambda: 0.012341345845574371
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:02,004 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:02,113 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:02,113 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035142127416078944})})
2025-06-24 09:47:02,113 - src.models.lightgbm_model - INFO -   - Best Iteration: 6
2025-06-24 09:47:02,113 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:02,113 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:02,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:02,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:02,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:02,148 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:02,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:02,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:02,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:02,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:02,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:02,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:02,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:02,294 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:02,298 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:02,298 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:02,298 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:02,298 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:02,298 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:02,298 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:02,298 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:02,298 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:02,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:02,311 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:02,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 6.82468781e-04  1.28932918e-03  1.21018970e-03  1.48574121e-03
  1.33487195e-03  1.52759789e-03  1.63157813e-03  1.90197128e-03
  8.33338040e-04  1.90532674e-03  1.73832041e-03  2.53536916e-03
  1.41401143e-03  7.61608262e-04  1.59248349e-03  2.42323648e-03
  1.46338046e-03  9.79174961e-04  2.22252591e-03  1.37672863e-03
  3.19177601e-03  2.56907341e-03  8.59886474e-03  1.30393988e-03
  2.57743596e-03  3.35073232e-03  2.98474718e-03  2.56173359e-03
  3.05327891e-03  4.01423247e-03  1.95634305e-03  2.89720446e-03
  3.98077474e-03  1.75110202e-03  6.11047013e-03  1.15502443e-02
  1.88951187e-03  2.48765946e-03  1.45576514e-03  3.20747838e-03
  3.52962599e-03  2.23667682e-03  2.36577985e-03  4.13953066e-02
  1.96320967e-02  3.96969965e-03  2.11509956e-02  2.08618605e-02
  1.83024151e-03  1.96688203e-02  8.22327595e-03  2.16805723e-03
  1.37727779e-02  1.53490462e-03  1.60663440e-03  2.60359027e-03
  2.99582227e-03  1.66289079e-03  2.80002311e-03  3.60252603e-03
  2.32155682e-03  1.22545157e-02  2.49491386e-03  4.72164696e-03
  2.70757051e-03  1.03446947e-02  1.45586811e-03  2.95033625e-03
  3.87749007e-03  1.70555926e-03  2.05116366e-03  1.83166080e-03
  2.70805477e-03  4.07169398e-03  4.57926227e-03  4.99884780e-03
  2.42318408e-03  3.88918574e-03  4.72810083e-03  1.20858698e-03
  2.18720924e-03  1.41805194e-02  2.11578363e-03  1.60778890e-03
  2.67106368e-03  1.33118586e-03  4.53803884e-03  1.28158734e-02
  3.87327300e-03  1.29747882e-02  2.13133363e-03  3.45368746e-03
  7.96882231e-03  1.94718342e-03  3.56634959e-03  4.09732224e-03
  2.42188249e-02  2.47614130e-03  1.90252207e-02  3.24243068e-02
  3.57389269e-02  3.75280782e-03  3.67773671e-03  2.75778974e-03
  2.32742435e-03  3.31237682e-03  1.07910989e-02  1.15197933e-02
  1.52439369e-03  1.12617007e-02  1.25204638e-03  3.80599836e-03
  3.39112889e-03  5.67489209e-04  1.05482105e-02  2.91449939e-03
  3.65210845e-03  2.29012042e-03  1.07432421e-02  1.32676812e-03
  4.88230030e-03  3.46526004e-03  8.52568741e-03  3.94449546e-03
  2.29850183e-03  1.44235383e-02  4.41376721e-03  1.12611372e-02
  4.49927707e-03  1.00323183e-02  3.75672550e-03  1.74795652e-02
  4.94801690e-02  1.08195774e-02  4.96977381e-02  5.01257572e-03
  9.62156831e-03  4.86014406e-03  1.38967816e-03  4.09285166e-03
  3.35702971e-02  8.61949752e-03  2.05297243e-02  1.24454203e-02
  1.50325731e-02  3.29102688e-03  4.62676489e-02 -4.90995752e-04
  1.91444496e-02  2.82023876e-02  4.35524548e-03  1.36156783e-02
  1.37146557e-02  3.42785248e-03 -1.27926495e-03  5.70718082e-03
  6.62222862e-03  6.39646888e-03  1.07520322e-02  2.94611918e-03
  2.84989821e-03  2.97332609e-03  3.39047884e-03  3.84287022e-03
  3.05842811e-03  4.30352000e-02  9.42050638e-03  2.70536912e-03
  1.49727854e-02  5.00991194e-03  8.48896381e-03  1.73720866e-02
  4.00510170e-03  1.77447217e-02  1.40778299e-02  2.97596450e-03
  1.22183874e-02  2.30756659e-03  1.29201596e-02  3.46960020e-03
  4.45413624e-03  5.48082028e-03  2.82565400e-03  3.38882333e-03
  2.22560173e-03  3.57563702e-03  3.49266787e-03  2.67277578e-03
  1.74562196e-03  2.03439507e-02  1.20065849e-02  4.08599199e-03
  1.33397451e-02  1.98593873e-03  1.62641978e-03  3.85478326e-03
  1.16331973e-02  2.14537931e-03  3.00933879e-03  1.02692663e-02
  1.04510099e-02  4.02471787e-02  9.25603174e-03  2.85128226e-03
  4.57068374e-03  3.77263824e-03  5.48579037e-03  1.62093972e-03
  3.30775730e-03  4.82441344e-03  4.81135927e-03  1.39053478e-02
  2.93374586e-03  2.34404460e-03  2.52653365e-03  9.24648891e-03
  2.54809353e-03  4.08624715e-03  1.16645344e-02  2.77180252e-02
  3.18934833e-02  1.47741191e-02  2.91903380e-02  1.60225000e-02
  8.86354326e-03  3.42892432e-03  1.10142300e-02  4.02574161e-02
  2.05142844e-02  2.61552518e-02  7.65518719e-02  1.11593852e-02
  1.56282802e-02  4.09143742e-03  7.55370156e-03  5.91151424e-03
  2.45256742e-03  1.70474748e-03  2.97139520e-02  9.79573603e-03
  1.24739197e-02  1.72061607e-02  3.53216625e-03  3.57148267e-03
  2.78768577e-03  2.64314575e-03  1.06273500e-02  1.32231976e-02
  2.21936235e-03  1.68857004e-02  1.43854078e-02  2.36311174e-04
  3.45272896e-03  2.70879863e-03  8.56743584e-02  4.06166704e-03
  2.05304697e-02  5.90524466e-03  6.79055436e-03  4.41982169e-03
  1.49729079e-02  3.80110858e-02  1.32612581e-02  3.98020221e-03
  8.53082049e-03  2.52444665e-03  1.83211891e-03  4.71226082e-03
  2.04371134e-03  2.39404009e-02  3.66666161e-03  9.38498601e-03
  4.34772413e-02  1.44940570e-02  1.71261426e-03  1.44797566e-02
  5.61136279e-03  1.55615421e-02  1.22856339e-02  1.76968243e-02
  1.07142598e-02  4.04164606e-03  1.42267940e-02  2.77214278e-03
  3.54532836e-03  3.50680460e-03  1.44469005e-03  4.12435656e-03
  3.65781583e-02  6.07222059e-02  1.72363640e-02  2.33911538e-02
  1.57000392e-02  1.29772964e-02  2.84692647e-02  7.30355154e-03
  1.85418633e-02  4.32707573e-03  8.29305579e-03  8.55193246e-03
  5.80795744e-03  2.98390693e-03  6.52708755e-03  6.15560258e-03
  1.55287507e-03  2.89682502e-03  1.55818202e-02  9.27796254e-03
  3.52666191e-03  3.95098174e-03  2.73209594e-02  3.21593904e-03
  1.86739935e-02  1.68491150e-02  6.66408530e-03  1.80725078e-02
  4.32181076e-03  2.05411581e-02 -1.83584744e-03  7.10782517e-03
  1.39253232e-02  1.68324595e-02  1.80312794e-02  1.98083028e-02
  2.88574993e-03  4.53909599e-03  5.51790957e-02  1.70255835e-02
  2.71491216e-02  1.86297295e-02  3.19383638e-03  5.07397132e-02
  2.37063433e-03  4.07740379e-02  1.79196570e-02  1.71050250e-02
  2.90348184e-03  3.84598147e-03  2.30670052e-02  6.21955780e-02
  1.60983602e-02  1.71378620e-02  3.29424688e-03  3.08868845e-02
  3.36177597e-03  4.72589944e-03  5.47635889e-02  1.73330469e-02
  5.26928059e-04  3.19587048e-02  2.22589322e-03  1.62057726e-02
  2.56364312e-02  2.31502755e-02  1.45809061e-02 -4.90115731e-04
  5.38230629e-03  1.58248855e-03 -1.51382944e-03  3.53002697e-03
  5.72154100e-03  2.22658970e-03  3.52724688e-03  2.90581953e-02
  9.85972762e-03  3.82486746e-03  2.42923075e-02  8.29149932e-03
  2.00061847e-02  2.71960263e-02  1.13558067e-02  1.87158502e-02
  3.31015962e-03  2.95508476e-02 -5.31609591e-04  6.50840595e-03
  3.39323355e-02  5.44738557e-03  5.75156725e-03  4.16534208e-02
  2.55953220e-03  1.78030402e-02  1.09244896e-02  3.12735409e-02
  3.15459156e-02  1.77624770e-02  9.81948188e-03  4.95719619e-03
  2.11934358e-02  7.83064546e-04  4.19561742e-02  2.86353778e-02
  2.67469454e-02  2.68745571e-02  7.27564797e-03  1.48489650e-02
  3.39465695e-03  3.12908126e-02  4.51441503e-03  2.17357292e-03
  2.60138888e-03  1.51710702e-02  3.28808862e-03  4.39017368e-03
  3.20752077e-03  5.97118015e-02  7.48378448e-03  7.02212073e-03
  3.11604226e-02  8.10345154e-03  4.85321595e-03  7.33830791e-03
  3.12228685e-02  1.44423637e-02  5.44140169e-03  1.67859316e-03
  1.94484885e-02  1.29018293e-02  9.49737666e-03  3.12634409e-02
  3.04197895e-03  3.18812129e-02  2.10255867e-02  3.14889047e-02
  2.23163037e-02  1.68502210e-02  2.30083916e-02  3.97150807e-03
  1.03050915e-02  1.09744508e-02  6.20631268e-03  2.21957019e-02
  5.30717941e-03  9.34221452e-03  1.46454007e-02  1.64664300e-02
  1.98133523e-02  4.70486848e-03  2.25774754e-02  2.61457819e-03
  4.00372578e-02  3.34118085e-02  8.68501997e-03  7.16604248e-03
  7.51704759e-03  3.18957462e-03  5.12645944e-03  2.87588255e-02
  8.63350387e-03  4.89661616e-02  1.34029844e-02  1.58620701e-02
  1.13180914e-02  3.05928261e-02  2.28074294e-02  3.42597222e-03
  1.04754984e-02  1.02370335e-02  2.59825311e-03  2.44222356e-02
  3.75793859e-03  2.56772357e-03  1.71691617e-02  1.69170838e-02
  2.14581765e-03  3.84514499e-03  1.52370934e-02  1.49916562e-02
  3.22204212e-02  1.23373582e-02  1.37261514e-02  4.87768078e-03
  1.79968678e-02  3.90377551e-03  2.18703237e-03  9.71619145e-03
  2.25366824e-02  5.82531535e-03  6.00976566e-03  1.34013865e-02
  2.31668020e-02  4.79593876e-03  3.96019783e-03  3.96551051e-02
  8.80800214e-03  1.81076674e-02  1.18653888e-02  1.02959904e-02
  5.69160265e-03  4.58049870e-03  7.32903353e-03  1.29303008e-02
  1.05529144e-03  3.07703370e-02  1.46249157e-02  3.83097768e-03
  4.98088829e-03  1.81875451e-02  1.14035263e-02  5.97616700e-03
  2.55129571e-02  1.52496883e-02  4.73125793e-03  3.81990258e-03
  2.85170473e-03  6.97772651e-03  2.25876215e-03  1.36921649e-02
  2.06235013e-03  6.11519435e-03  2.34467711e-02  2.27283446e-02
  1.09804062e-02  9.38378278e-03  1.56220456e-02  2.89771708e-03
  2.34244072e-03  1.16949552e-02  1.22506257e-02  4.56445065e-03
  3.25779573e-03  9.37733457e-03  5.06068027e-03  7.23006702e-04
  1.49964011e-03  1.86751922e-02  2.74765161e-02  2.54969773e-02
  1.85134050e-02  4.46995274e-02  4.85353373e-03  5.28599182e-02
  5.07720646e-03  1.37565124e-02  5.43956440e-03  2.82857752e-03
  1.52090816e-02  1.60394162e-02  4.08177656e-03  1.39847089e-03
  1.78153625e-02  8.41206678e-03  1.85734433e-03 -1.16733642e-03
  1.73149986e-02  4.38343158e-02  1.78612692e-02  3.60692843e-03
  3.09150781e-02  1.48685002e-02  3.40928745e-02  5.70063310e-03
  8.95390634e-02  3.10316256e-02  2.70753373e-02  1.51593772e-02
  3.27566134e-03  2.87380956e-02  3.22929555e-02  2.53942096e-02
  6.20616505e-02  1.27423887e-02  1.83675681e-02  6.53180130e-02
  2.60726343e-03  1.95688125e-02  1.48766036e-02  7.17007452e-03
  1.40713824e-02  5.84756210e-02  1.25573052e-03  2.66611390e-02
  4.92378978e-03  9.87059564e-03  1.16265946e-02  4.74612537e-02
  3.39545286e-02  1.42851075e-02  2.10789289e-03  2.06593770e-02
  1.38855920e-02  3.15032973e-02  2.75327760e-03  1.35788353e-02
  7.96332317e-02  3.98449089e-02  7.76194965e-02  7.68486702e-02
  5.87508192e-02  4.70687390e-03  3.53351362e-02  1.78437742e-02
  2.05742565e-03  3.75349047e-02  9.42563947e-03 -1.46070972e-03
  1.31468354e-02  6.63411865e-02  2.41533750e-02  4.52023175e-03
  7.48344893e-03  1.16681287e-02  3.46917812e-03  4.95716407e-03
  2.42882687e-03  1.85894695e-03  7.55890427e-03  9.38993412e-03
  1.02867042e-02  8.23983347e-03  2.77997495e-03  1.07701845e-01
  1.13765670e-02  2.65529270e-03  7.13017140e-03  2.52540020e-02
  1.07143009e-02  2.20708053e-03 -3.54664614e-04  1.28160760e-02
  5.40184940e-03  3.34107627e-04  8.21154023e-03  2.01304080e-02
  4.79910754e-03  8.59114049e-03  1.61215225e-02  5.66497956e-03
  1.64473255e-02  6.63980808e-03  3.44492406e-02  8.25175977e-03
  2.71987372e-03 -1.65249556e-03  2.72931659e-02  1.13604952e-02
  1.30051084e-02  4.51555152e-03  2.07430339e-02  8.22775349e-03
  6.26451692e-03  2.71463479e-02  2.30065278e-02  6.36764697e-03
  2.77586007e-03  1.49151499e-02  1.67793812e-02  8.33765849e-03
  2.26155510e-02  2.18764216e-02  1.37588066e-02  2.77551661e-02
  5.26951800e-02  3.48640528e-02  1.29731448e-02  9.24101056e-02
  4.68766915e-02  6.24502150e-03  2.76259913e-02  4.38287670e-03
  2.77096867e-02  3.78536145e-02  2.66356975e-02  2.21134730e-02
  3.67249883e-03  2.11157703e-03  1.99141346e-03  4.62060106e-03
  2.61038079e-03  2.56417184e-02  1.45214255e-03  1.82821283e-02
  2.17226507e-02  2.68746808e-03  2.91314607e-02  1.34038741e-02
  1.84688874e-02  3.36184058e-02  3.76812609e-03  8.99827051e-03
  2.39618242e-02  7.78498367e-02  7.18183726e-03  1.26244829e-02
  1.44618687e-02  5.33588415e-02  3.22192903e-03  1.06929011e-02
  3.46336040e-02  7.08900472e-02  6.34712033e-03  8.04875418e-03
  3.69764241e-02  4.78348171e-02  2.31147248e-02  3.92253028e-03
  3.85098546e-02  1.92226307e-02  1.74416837e-02  2.43623637e-02
  4.96133493e-02  6.34561695e-03  2.36709307e-03  8.68771393e-03
  7.83845323e-02  2.25679126e-03  8.54104996e-03  2.09758505e-04
  1.07675527e-02  1.18067020e-02  3.86964092e-03  1.67399115e-02
  2.34389852e-03  6.36482472e-03  3.01366157e-02  1.38041277e-03
  3.97626260e-03  7.11425866e-03  1.36883324e-02  1.91266407e-02
  1.60127678e-02  1.17564474e-02  3.49065966e-03  1.42145486e-02
  9.94993550e-03  2.07821641e-02  1.86994767e-02  3.16956464e-03
  2.92597999e-02  9.19542944e-03  1.42768367e-02  5.40151274e-03
  2.83558221e-02  1.08132473e-02  1.44153769e-02  1.56532136e-02
  2.73450828e-02  3.50062436e-03  2.15589513e-02  1.37692815e-02
  3.12774938e-02  2.94899028e-02  2.14611758e-02  1.56128300e-02
  2.28081426e-02  5.62556199e-03  1.39620871e-02  1.09388191e-02
  1.05013079e-02  3.50846905e-02  4.39669878e-02  2.31816318e-02
  1.95760467e-02  3.69962820e-02  1.31392390e-02  2.39740664e-03
  5.13567642e-03  4.54462656e-03  4.98866537e-02  4.29913909e-02
  1.35603432e-02  1.48156633e-02  5.02857169e-02  4.62599245e-03
  6.67195209e-03  8.16685859e-03  6.56712672e-03  6.58822410e-02
  4.38798101e-03  7.75122577e-03  6.04046767e-03  2.57615322e-03
  1.98321064e-03  1.50358781e-02  1.56827891e-03  1.31509453e-02
  2.06616115e-03  1.97840979e-03  1.97855463e-03  1.19022843e-02
  1.36351508e-02  7.83036525e-03  2.62145589e-03  1.86579356e-02
  5.19215531e-02  6.29959633e-03  3.63642706e-02  2.02409740e-03
  1.58846082e-02  2.90214219e-02  4.87778816e-03  7.62654352e-03
  2.24405011e-02  2.82226174e-03  3.30783185e-02  1.41343525e-02
  5.29555902e-03  4.89907650e-03  3.81096844e-03  2.97524536e-03
  2.37321582e-02  5.76285704e-03  1.61679825e-02  8.32857779e-03
  2.86399626e-02  1.60437916e-02  4.49591881e-03  1.78946138e-02
  1.39730692e-02  5.85473530e-02  4.59887735e-03  5.17466899e-03
  1.29715097e-02  1.18485587e-02  7.13248629e-03  2.64561892e-03
  2.50862254e-02  6.31894311e-03  1.98689478e-03  9.61830632e-03
  2.69423734e-02  2.10323688e-03  4.97821598e-03  1.45620354e-02
  2.26685243e-02  1.04959671e-02  4.25673148e-03  8.00131677e-03
 -1.35117951e-03  1.02364293e-02  8.53671430e-03  7.90209503e-03
  2.76043642e-03  2.14111076e-02  7.29365411e-03  2.79784956e-02
  2.14359770e-02  8.89613574e-03  5.62133532e-02  2.24001325e-02
  3.49306325e-03  3.65982638e-02  3.72433993e-03  1.20547299e-02
  4.15670434e-03  1.23864898e-02  7.86831638e-03  2.48718183e-03
  4.63272560e-02  9.69376167e-03  2.78600827e-02  4.44322173e-03
  1.17762545e-02  1.39904994e-02  4.25539187e-03  1.38237077e-02
  1.20003037e-02  1.18952893e-02  8.03416578e-03  3.02355036e-02
  5.67998818e-03  3.52298145e-03  1.36819821e-02  2.30117044e-02
  4.84465030e-03  2.80500908e-03  1.69713856e-02  2.50249096e-02
  6.09377461e-02  3.90661754e-03  2.51006624e-03  2.34660598e-02
  2.83898346e-02  7.18434777e-02  1.44721341e-02  3.60032464e-03
  3.72023240e-02  2.18330681e-03  3.05304220e-02  2.32610364e-02
  1.41539151e-02  7.32723281e-03  4.71565328e-03  4.77439425e-03
  1.41279368e-02  1.40322020e-03  3.10305533e-02  1.04327031e-02
  2.56940387e-02  2.70083547e-03  7.76301709e-03  1.25192917e-02
  1.54865892e-02  7.70568300e-03  1.53327589e-02  3.40074081e-02
  6.56929847e-02  2.26685928e-02  4.10505067e-02  3.26303603e-02
  9.22644644e-03  1.35579721e-02  6.81117681e-03  3.41411273e-02
  1.26920253e-02  8.94055661e-03  2.39979746e-02  1.60145340e-02
  4.57271894e-03  3.54134744e-02  5.84009407e-02  3.96518750e-03
  2.40659145e-03  3.04759958e-02  1.37482603e-02  2.36074760e-02
  2.07324969e-02  1.28365123e-02  5.38771790e-02  4.67457831e-02
  7.25261952e-02  3.43933512e-03  2.30905208e-02  1.03431180e-01
  7.32060343e-02  2.24871182e-02  5.53991569e-03  2.07780397e-02
  1.97165413e-02  1.17659104e-03  1.81362914e-02 -7.24431446e-04
  1.43425379e-02  9.30688576e-03  5.85215171e-03  2.71388796e-03
  6.05638041e-03  2.79145089e-02  2.97101634e-02  7.57432574e-03
  1.18905037e-02  5.61337010e-03  3.14411372e-03  1.00831840e-02
  1.42749840e-02  2.22450285e-02  2.05267634e-03  7.78791535e-03
 -1.01454457e-03  5.59887203e-03  7.12966568e-03  5.49585709e-03
  1.33757506e-02 -1.98425854e-03  2.34352797e-03  2.19104926e-02
  2.01986945e-02  2.00861128e-02  8.11465924e-03  1.25352643e-02
  1.08709761e-02  3.51057022e-02  2.02883181e-03  1.39393328e-02
  8.63837776e-03  6.36079841e-03  3.50400839e-02  5.75848747e-03
  3.96516792e-03  1.50234679e-03  1.87654144e-02  2.89410950e-02
  4.12467889e-03  2.25318607e-02  1.25827867e-02  8.13628039e-05
  4.10793271e-02  1.03377794e-02  4.87306912e-03  2.08287369e-02
  2.98171264e-02  1.40756686e-02  3.14832296e-02  3.15881281e-02
  7.87367224e-04  2.02854032e-03  1.05348408e-02  2.49582448e-03]
2025-06-24 09:47:02,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:02,317 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:02,317 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:02,318 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:02,334 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:02,342 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:02,342 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:02,342 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:02,342 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:02,342 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:02,342 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:02,342 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:02,342 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:02,342 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:02,342 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:02,342 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:02,342 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:02,342 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:02,342 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:02,342 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:02,342 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:02,342 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:02,342 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:02,342 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:02,342 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:02,362 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:02,362 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:02,785 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = lightgbm
2025-06-24 09:47:04,740 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:04,740 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:04,740 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:04,740 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:04,740 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:04,740 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:04,740 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:04,758 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:05,226 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:05,226 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:05,226 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:05,226 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:05,226 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:05,226 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:05,226 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:05,226 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:05,226 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:05,373 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:05,373 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:05,373 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:05,373 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:06,518 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:07,399 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:07,400 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:07,403 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:07,431 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:07,431 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:07,431 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:07,431 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:08,496 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:08,926 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:08,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:09,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:09,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:09,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:09,129 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:09,129 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:09,129 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:09,129 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:09,129 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,188 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:09,188 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:09,188 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,188 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,188 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:09,188 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:09,188 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,245 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:09,245 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:09,245 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:09,372 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:09,372 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:09,372 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:09,372 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:09,372 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:09,372 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:09,372 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:09,372 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:09,372 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:09,372 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:09,372 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:09,372 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:09,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:09,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:09,373 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:09,444 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:09,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:09,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:09,606 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:09,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:09,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:09,740 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:09,740 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:09,792 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:09,792 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,792 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:09,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:09,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:09,823 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:09,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:09,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:09,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:09,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:09,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:09,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:09,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:09,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:09,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,990 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:09,990 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:09,990 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:09,997 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   learning_rate: 0.07369477793265464
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   n_estimators: 493
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   subsample: 0.8579178144028043
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6684815593910434
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   reg_alpha: 9.86874546485378
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1101875524587999e-08
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:10,003 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:10,120 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:10,120 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513150933109822})})
2025-06-24 09:47:10,120 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 09:47:10,120 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:10,120 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:10,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:10,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:10,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:10,152 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:10,179 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:10,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:10,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:10,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:10,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:10,294 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:10,294 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:10,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:10,304 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:10,304 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:10,304 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:10,304 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:10,304 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:10,304 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:10,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:10,304 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:10,310 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:10,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:10,319 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00060341 0.0015068  0.00139595 ... 0.00289436 0.03406351 0.00852995]
2025-06-24 09:47:10,319 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:10,320 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:10,320 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:10,321 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:10,337 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:10,345 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:10,345 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:10,345 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:10,345 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:10,345 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:10,345 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:10,345 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:10,345 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:10,345 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:10,345 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:10,345 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:10,345 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:10,346 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:10,346 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:10,346 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:10,346 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:10,346 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:10,346 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:10,346 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:10,346 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:10,364 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:10,364 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:10,783 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = lightgbm
2025-06-24 09:47:12,706 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:12,706 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:12,706 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:12,706 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:12,706 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:12,706 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:12,706 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:12,723 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:13,189 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:13,189 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:13,189 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:13,189 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:13,189 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:13,189 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:13,189 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:13,189 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:13,189 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:13,329 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:13,329 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:13,329 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:13,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:14,458 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:15,327 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:15,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:15,333 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:15,361 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:15,361 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:15,361 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:15,361 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:16,413 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:16,841 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:16,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:16,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:16,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:17,043 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:17,043 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:17,043 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:17,044 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:17,044 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:17,044 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,102 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:17,102 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:17,102 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,102 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,102 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:17,102 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:17,102 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,158 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:17,158 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:17,158 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:17,275 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:17,275 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:17,275 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:17,275 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:17,275 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:17,275 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:17,275 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:17,275 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:17,275 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:17,275 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:17,275 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:17,275 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:17,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:17,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:17,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:17,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:17,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:17,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:17,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:17,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:17,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:17,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:17,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:17,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:17,739 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:17,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:17,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:17,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:17,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:17,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:17,857 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:17,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:17,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,884 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:17,884 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:17,884 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:17,891 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   learning_rate: 0.17646596150449262
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:17,896 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   n_estimators: 702
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   subsample: 0.7376022736475862
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8046295483602256
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   reg_alpha: 2.3549110805943098e-07
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO -   reg_lambda: 0.06760969294969883
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:17,897 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:18,006 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:18,006 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513639930854569})})
2025-06-24 09:47:18,006 - src.models.lightgbm_model - INFO -   - Best Iteration: 6
2025-06-24 09:47:18,006 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:18,008 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:18,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:18,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:18,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:18,039 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:18,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:18,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:18,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:18,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:18,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:18,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:18,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:18,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:18,192 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:18,192 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:18,193 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:18,193 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:18,193 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:18,193 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:18,193 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:18,193 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:18,198 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:18,205 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:18,207 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00055326 0.00130052 0.00118825 ... 0.0166009  0.01042702 0.0117118 ]
2025-06-24 09:47:18,207 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:18,208 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:18,209 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:18,209 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:18,226 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:18,233 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:18,233 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:18,233 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:18,233 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:18,234 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:18,234 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:18,234 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:18,234 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:18,234 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:18,234 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:18,234 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:18,234 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:18,234 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:18,234 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:18,234 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:18,234 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:18,234 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:18,234 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:18,234 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:18,234 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:18,253 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:18,253 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:18,654 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = lightgbm
2025-06-24 09:47:20,561 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:20,561 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:20,561 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:20,561 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:20,561 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:20,561 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:20,561 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:20,577 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:21,044 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:21,044 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:21,044 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:21,044 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:21,044 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:21,044 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:21,044 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:21,044 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:21,044 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:21,184 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:21,184 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:21,184 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:21,184 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:21,184 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:21,185 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:21,185 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:21,185 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:21,185 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:21,185 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:22,319 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:23,195 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:23,195 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:23,200 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:23,229 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:23,229 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:23,229 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:23,229 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:24,273 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:24,704 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:24,704 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:24,838 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:24,838 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:24,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:24,906 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:24,906 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:24,906 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:24,906 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:24,906 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:24,955 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:24,955 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:24,955 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:24,955 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:24,955 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:24,955 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:24,955 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:25,011 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:25,011 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:25,011 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:25,142 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:25,142 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:25,142 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:25,142 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:25,142 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:25,142 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:25,142 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:25,142 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:25,142 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:25,142 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:25,142 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:25,142 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:25,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:25,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:25,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:25,217 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:25,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:25,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:25,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:25,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:25,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:25,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:25,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:25,560 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:25,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:25,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:25,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:25,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:25,591 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:25,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:25,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:25,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:25,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:25,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:25,735 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:25,735 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:25,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:25,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:25,762 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:25,762 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:25,762 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:25,770 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   learning_rate: 0.026752568195150317
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:25,775 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   n_estimators: 997
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   subsample: 0.9967544619046032
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.896461276471979
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   reg_alpha: 8.925905274192813e-05
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009166238280651257
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:25,776 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:26,055 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:26,055 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513125454061847})})
2025-06-24 09:47:26,055 - src.models.lightgbm_model - INFO -   - Best Iteration: 50
2025-06-24 09:47:26,055 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:26,055 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:26,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:26,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:26,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:26,087 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:26,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:26,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:26,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:26,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:26,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:26,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:26,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:26,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:26,259 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:26,260 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:26,260 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:26,260 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:26,260 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:26,260 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:26,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:26,260 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:26,266 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:26,273 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:26,275 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0004985  0.00159856 0.00149106 ... 0.00116096 0.00298803 0.00324129]
2025-06-24 09:47:26,275 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:26,275 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:26,276 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:26,277 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:26,293 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:26,300 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:26,300 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:26,301 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:26,301 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:26,301 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:26,301 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:26,301 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:26,301 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:26,301 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:26,301 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:26,301 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:26,301 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:26,301 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:26,301 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:26,301 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:26,301 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:26,301 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:26,301 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:26,301 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:26,301 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:26,320 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:26,321 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:26,728 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = lightgbm
2025-06-24 09:47:28,636 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:28,637 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:28,637 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:28,637 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:28,637 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:28,637 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:28,637 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:28,653 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:29,120 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:29,120 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:29,120 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:29,120 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:29,120 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:29,120 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:29,120 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:29,120 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:29,120 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:29,256 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:29,256 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:29,256 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:29,256 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:29,257 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:29,257 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:29,257 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:29,257 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:29,257 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:29,257 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:30,390 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:31,280 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:31,280 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:31,285 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:31,313 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:31,313 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:31,313 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:31,313 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:32,370 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:32,806 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:32,806 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:32,939 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:32,940 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:33,008 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:33,008 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:33,008 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:33,008 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:33,008 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:33,008 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,067 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:33,067 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:33,067 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,067 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,067 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:33,067 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:33,067 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,124 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:33,124 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:33,124 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:33,242 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:33,242 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:33,242 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:33,242 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:33,242 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:33,242 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:33,242 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:33,242 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:33,242 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:33,242 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:33,242 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:33,242 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:33,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:33,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:33,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:33,316 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:33,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:33,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:33,478 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:33,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:33,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:33,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:33,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:33,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:33,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:33,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:33,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:33,690 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:33,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:33,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:33,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:33,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:33,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:33,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:33,832 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:33,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:33,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,858 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:33,859 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:33,859 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:33,866 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   learning_rate: 0.06988639938760517
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   n_estimators: 347
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   subsample: 0.769221734655711
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7657244060744415
2025-06-24 09:47:33,871 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:47:33,872 - src.models.lightgbm_model - INFO -   reg_alpha: 2.9167530407966635e-07
2025-06-24 09:47:33,872 - src.models.lightgbm_model - INFO -   reg_lambda: 0.4030789571311193
2025-06-24 09:47:33,872 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:33,872 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:33,872 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:34,002 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:34,002 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513146067568489})})
2025-06-24 09:47:34,003 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 09:47:34,003 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:34,003 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:34,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:34,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:34,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:34,036 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:34,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:34,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:34,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:34,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:34,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:34,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:34,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:34,184 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:34,190 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:34,191 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:34,191 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:34,191 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:34,191 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:34,191 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:34,191 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:34,191 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:34,197 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:34,204 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:34,206 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00063338 0.00144531 0.00127121 ... 0.03262244 0.01294901 0.00805249]
2025-06-24 09:47:34,206 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:34,207 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:34,207 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:34,208 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:34,224 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:34,232 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:34,232 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:34,232 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:34,232 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:34,232 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:34,232 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:34,232 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:34,232 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:34,232 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:34,232 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:34,232 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:34,232 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:34,232 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:34,232 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:34,232 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:34,232 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:34,232 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:34,232 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:34,232 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:34,232 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:34,252 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:34,252 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:34,672 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = lightgbm
2025-06-24 09:47:36,590 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:36,590 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:36,590 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:36,590 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:36,590 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:36,590 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:36,590 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:36,608 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:37,072 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:37,072 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:37,072 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:37,072 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:37,072 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:37,072 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:37,072 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:37,072 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:37,073 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:37,213 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:37,213 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:37,213 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:37,213 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:38,353 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:39,246 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:39,246 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:39,251 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:39,280 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:39,281 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:39,281 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:39,281 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:40,334 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:40,767 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:40,767 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:40,900 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:40,900 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:40,968 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:40,968 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:40,969 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:40,969 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:40,969 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:40,969 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,027 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:41,027 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:41,027 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,027 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,027 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:41,027 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:41,027 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,083 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:41,083 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:41,083 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:41,200 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:41,200 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:41,200 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:41,200 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:41,200 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:41,200 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:41,200 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:41,200 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:41,200 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:41,200 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:41,200 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:41,200 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:41,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:41,200 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:41,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:41,273 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:41,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:41,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:41,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:41,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:41,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:41,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:41,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:41,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:41,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:41,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:41,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:41,648 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:41,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:41,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:41,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:41,755 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:41,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:41,790 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:41,790 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:41,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:41,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,816 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:41,816 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:41,816 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:41,825 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   learning_rate: 0.15526074257939743
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   n_estimators: 600
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   subsample: 0.6732132011401761
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6721524828008189
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   reg_alpha: 9.14459959766754e-08
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO -   reg_lambda: 0.004840492100137957
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:41,830 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:41,941 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:41,941 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513584283643622})})
2025-06-24 09:47:41,941 - src.models.lightgbm_model - INFO -   - Best Iteration: 7
2025-06-24 09:47:41,941 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:41,941 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:41,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:41,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:41,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:41,974 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:42,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:42,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:42,054 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:42,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:42,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:42,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:42,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:42,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:42,125 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:42,125 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:42,126 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:42,126 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:42,126 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:42,126 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:42,126 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:42,126 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:42,131 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:42,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:42,140 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00050817 0.00168303 0.00148748 ... 0.0043058  0.03436467 0.00515196]
2025-06-24 09:47:42,140 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:42,141 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:42,142 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:42,142 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:42,158 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:42,166 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:42,166 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:42,166 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:42,166 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:42,166 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:42,166 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:42,166 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:42,166 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:42,166 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:42,166 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:42,166 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:42,166 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:42,166 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:42,167 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:42,167 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:42,167 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:42,167 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:42,167 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:42,167 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:42,167 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:42,187 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:42,187 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:42,603 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = lightgbm
2025-06-24 09:47:44,544 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:44,545 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:44,545 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:44,545 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:44,545 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:44,545 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:44,545 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:44,563 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:45,029 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:45,029 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:45,029 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:45,029 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:45,029 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:45,029 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:45,029 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:45,029 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:45,029 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:45,169 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:45,169 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:45,169 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:45,169 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:46,323 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:47,221 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:47,221 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:47,226 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:47,254 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:47,254 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:47,254 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:47,254 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:48,307 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:48,739 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:48,739 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:48,873 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:48,873 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:48,941 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:48,941 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:48,941 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:48,941 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:48,941 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:48,941 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:48,995 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:48,995 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:48,995 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:48,995 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:48,995 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:48,995 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:48,995 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:49,050 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:49,050 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:49,050 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:49,178 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:49,178 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:49,178 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:49,178 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:49,178 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:49,178 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:49,178 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:49,178 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:49,178 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:49,178 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:49,178 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:49,178 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:49,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:49,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:49,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:49,252 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:49,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:49,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:49,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:49,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:49,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:49,545 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:49,545 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:49,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:49,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:49,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:49,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:49,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:49,630 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:49,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:49,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:49,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:49,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:49,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:49,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:49,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:49,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:49,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:49,800 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:49,800 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:49,800 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:49,808 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   learning_rate: 0.05533525328002605
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:49,813 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   subsample: 0.8551318001092548
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9338003283396146
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00011115273434769104
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO -   reg_lambda: 2.6037259691414086e-06
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:49,814 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:49,962 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:49,963 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035135737250286916})})
2025-06-24 09:47:49,963 - src.models.lightgbm_model - INFO -   - Best Iteration: 17
2025-06-24 09:47:49,963 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:49,963 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:49,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:49,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:49,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:49,995 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:50,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:50,050 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:50,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:50,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:50,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:50,142 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:50,142 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:50,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:50,152 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:50,153 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:50,153 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:50,153 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:50,153 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:50,153 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:50,153 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:50,153 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:50,158 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:50,165 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:50,167 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00061112 0.00143698 0.00136244 ... 0.00856579 0.00701903 0.00353044]
2025-06-24 09:47:50,167 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:50,168 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:50,169 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:50,169 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:50,186 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:50,194 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:50,194 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:50,194 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:50,194 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:50,194 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:50,194 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:50,194 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:50,194 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:50,194 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:50,194 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:50,194 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:50,194 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:50,194 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:50,194 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:50,194 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:50,194 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:50,194 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:50,194 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:50,194 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:50,194 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:50,214 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:50,214 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:50,637 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = lightgbm
2025-06-24 09:47:52,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:47:52,541 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:47:52,541 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:47:52,541 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:47:52,541 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:47:52,541 - src.training - INFO - 교차 검증 시작
2025-06-24 09:47:52,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:47:52,559 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:47:53,023 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:47:53,023 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:47:53,023 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:47:53,023 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:47:53,023 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:47:53,023 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:47:53,023 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:47:53,023 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:47:53,023 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:47:53,162 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:47:53,162 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:47:53,162 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:47:53,162 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:47:54,317 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:47:55,209 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:55,210 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:47:55,215 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:47:55,245 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:47:55,245 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:47:55,245 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:47:55,245 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:47:56,305 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:47:56,742 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:47:56,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:56,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:56,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:47:56,944 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:47:56,944 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:56,944 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:47:56,944 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:47:56,944 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:56,944 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:56,996 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:47:56,996 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:47:56,996 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:56,996 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:56,996 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:47:56,996 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:47:56,996 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:57,052 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:57,052 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:47:57,052 - src.training - INFO - 모델 학습 시작
2025-06-24 09:47:57,186 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:47:57,186 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:47:57,186 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:47:57,186 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:47:57,186 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:47:57,186 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:47:57,186 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:47:57,186 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:47:57,186 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:57,186 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:47:57,186 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:47:57,186 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:47:57,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:47:57,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:57,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:57,259 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:57,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:57,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:57,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:57,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:57,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:57,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:47:57,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:57,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:47:57,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:57,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:57,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:57,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:57,639 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:57,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:57,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:57,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:57,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:57,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:57,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:57,782 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:57,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:47:57,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:57,808 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:47:57,808 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:57,808 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:47:57,816 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   learning_rate: 0.02877361180532123
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   n_estimators: 835
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   subsample: 0.9423652436238517
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8416634198004798
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   reg_alpha: 2.4662900352851794e-06
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO -   reg_lambda: 4.7203867760430046e-08
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:47:57,821 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:47:58,109 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:47:58,109 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512907874259635})})
2025-06-24 09:47:58,109 - src.models.lightgbm_model - INFO -   - Best Iteration: 50
2025-06-24 09:47:58,109 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:47:58,110 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:47:58,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:47:58,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:58,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:47:58,144 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:47:58,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:47:58,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:47:58,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:47:58,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:47:58,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:47:58,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:47:58,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:58,294 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:47:58,311 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:47:58,312 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:47:58,312 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:47:58,312 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:47:58,312 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:58,312 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:47:58,312 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:47:58,312 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:47:58,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:47:58,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:47:58,327 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0004816  0.00170654 0.00155963 ... 0.00132416 0.00318736 0.00337176]
2025-06-24 09:47:58,327 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:47:58,327 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:58,328 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:58,328 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:58,344 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:47:58,352 - src.training - INFO -   precision: 0.0
2025-06-24 09:47:58,352 - src.training - INFO -   recall: 0.0
2025-06-24 09:47:58,352 - src.training - INFO -   f1: 0.0
2025-06-24 09:47:58,352 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:47:58,352 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:47:58,352 - src.training - INFO -   positive_samples: 456
2025-06-24 09:47:58,352 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:47:58,352 - src.training - INFO -   total_samples: 368238
2025-06-24 09:47:58,352 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:47:58,352 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:47:58,352 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:47:58,352 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:47:58,352 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:47:58,352 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:47:58,352 - src.training - INFO - 모델 학습 완료
2025-06-24 09:47:58,352 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:47:58,352 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:58,352 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:58,352 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:47:58,352 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:47:58,373 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:47:58,373 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:47:58,787 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = lightgbm
2025-06-24 09:48:00,734 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:00,734 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:00,734 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:00,734 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:00,734 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:00,734 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:00,734 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:00,752 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:01,211 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:01,211 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:01,211 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:01,211 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:01,211 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:01,211 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:01,211 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:01,211 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:01,211 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:01,371 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:01,371 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:01,371 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:01,371 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:02,446 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:03,285 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:03,285 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:03,291 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:03,319 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:03,319 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:03,319 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:03,319 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:04,297 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:04,709 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:04,709 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:04,842 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:04,842 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:04,909 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:04,909 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:04,909 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:04,909 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:04,909 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:04,909 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:04,957 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:04,957 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:04,957 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:04,957 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:04,957 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:04,957 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:04,957 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:05,008 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:05,008 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:05,008 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:05,144 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:05,145 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:05,145 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:05,145 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:05,145 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:05,145 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:05,145 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:05,145 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:05,145 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:05,145 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:05,145 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:05,145 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:05,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:05,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:05,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:05,209 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:05,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:05,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:05,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:05,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:05,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:05,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:05,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:05,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:05,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:05,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:05,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:05,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:05,560 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:05,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:05,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:05,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:05,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:05,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:05,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:05,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:05,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:05,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:05,716 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:05,716 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:05,716 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:05,724 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   learning_rate: 0.16522729299476813
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:05,729 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   n_estimators: 224
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   subsample: 0.87408467479411
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7727431143998708
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1069451775532163e-08
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO -   reg_lambda: 5.845016122261629e-06
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:05,730 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:05,845 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:05,845 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513062295366103})})
2025-06-24 09:48:05,845 - src.models.lightgbm_model - INFO -   - Best Iteration: 7
2025-06-24 09:48:05,845 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:05,846 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:05,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:05,878 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:05,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:05,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:05,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:05,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:06,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:06,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:06,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:06,012 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:06,016 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:06,016 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:06,016 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:06,016 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:06,016 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:06,016 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:06,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:06,016 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:06,023 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:06,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:06,031 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00055168 0.00168097 0.00126597 ... 0.01504611 0.00580191 0.02641216]
2025-06-24 09:48:06,031 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:06,032 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:06,033 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:06,033 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:06,049 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:06,056 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:06,056 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:06,056 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:06,056 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:06,056 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:06,057 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:06,057 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:06,057 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:06,057 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:06,057 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:06,057 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:06,057 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:06,057 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:06,057 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:06,057 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:06,057 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:06,057 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:06,057 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:06,057 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:06,057 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:06,078 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:06,079 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:06,482 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = lightgbm
2025-06-24 09:48:08,290 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:08,290 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:08,290 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:08,290 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:08,290 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:08,290 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:08,290 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:08,308 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:08,762 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:08,762 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:08,762 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:08,762 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:08,762 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:08,762 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:08,762 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:08,762 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:08,762 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:08,917 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:08,917 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:08,917 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:08,917 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:09,986 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:10,812 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:10,812 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:10,817 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:10,844 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:10,844 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:10,844 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:10,844 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:11,829 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:12,242 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:12,243 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:12,375 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:12,375 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:12,442 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:12,442 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:12,442 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:12,442 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:12,442 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:12,442 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:12,490 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:12,490 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:12,490 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:12,490 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:12,490 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:12,490 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:12,490 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:12,541 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:12,541 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:12,541 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:12,659 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:12,659 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:12,659 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:12,659 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:12,659 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:12,659 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:12,659 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:12,659 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:12,659 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:12,659 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:12,659 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:12,659 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:12,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:12,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:12,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:12,724 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:12,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:12,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:12,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:12,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:12,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:12,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:12,985 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:13,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:13,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:13,074 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:13,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:13,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:13,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:13,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:13,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:13,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:13,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:13,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,229 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:13,229 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,229 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:13,237 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:13,242 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:13,242 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:13,242 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:13,242 - src.models.lightgbm_model - INFO -   learning_rate: 0.04529483298639887
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   n_estimators: 316
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   subsample: 0.6975620050707811
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8503251588841235
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   reg_alpha: 9.844852091987153e-07
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO -   reg_lambda: 4.797440969544924e-05
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:13,243 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:13,394 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:13,394 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513144111975639})})
2025-06-24 09:48:13,394 - src.models.lightgbm_model - INFO -   - Best Iteration: 16
2025-06-24 09:48:13,394 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:13,394 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:13,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:13,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:13,427 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:13,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:13,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:13,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:13,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:13,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:13,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:13,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:13,569 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:13,570 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:13,570 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:13,570 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:13,570 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,570 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:13,570 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:13,576 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:13,583 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:13,585 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0007073  0.0013696  0.00125656 ... 0.02563836 0.00775199 0.01264301]
2025-06-24 09:48:13,585 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:13,585 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:13,586 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:13,587 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:13,602 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:13,610 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:13,610 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:13,610 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:13,610 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:13,610 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:13,610 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:13,610 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:13,610 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:13,610 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:13,610 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:13,610 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:13,610 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:13,611 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:13,611 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:13,611 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:13,611 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:13,611 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,611 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,611 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:13,611 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:13,632 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:13,632 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:14,034 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = lightgbm
2025-06-24 09:48:15,864 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:15,865 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:15,865 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:15,865 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:15,865 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:15,865 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:15,865 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:15,882 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:16,338 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:16,338 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:16,338 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:16,338 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:16,338 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:16,338 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:16,338 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:16,338 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:16,338 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:16,498 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:16,498 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:16,498 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:16,498 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:16,498 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:16,498 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:16,498 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:16,498 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:16,498 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:16,499 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:17,563 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:18,386 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:18,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:18,392 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:18,419 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:18,419 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:18,419 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:18,419 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:19,396 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:19,808 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:19,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:19,942 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:19,942 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:20,009 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:20,009 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:20,009 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:20,009 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:20,009 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:20,009 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,057 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:20,058 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:20,058 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,058 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,058 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:20,058 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:20,058 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,108 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:20,108 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:20,108 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:20,225 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:20,225 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:20,225 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:20,225 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:20,225 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:20,225 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:20,225 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:20,225 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:20,225 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:20,225 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:20,225 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:20,225 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:20,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:20,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:20,226 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:20,290 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:20,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:20,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:20,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:20,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:20,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:20,551 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:20,551 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:20,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:20,639 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:20,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:20,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:20,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:20,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:20,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:20,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:20,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:20,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:20,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,796 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:20,796 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:20,796 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:20,804 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   learning_rate: 0.015410150189628657
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   n_estimators: 411
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   subsample: 0.6452606057786048
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8738445964974808
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1485400190421731e-05
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5162743738503278e-06
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:20,810 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:21,187 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:21,187 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512589519821124})})
2025-06-24 09:48:21,187 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:48:21,187 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:21,187 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:21,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:21,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:21,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:21,217 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:21,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:21,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:21,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:21,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:21,350 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:21,350 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:21,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:21,386 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:21,386 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:21,386 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:21,386 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:21,386 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:21,386 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:21,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:21,386 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:21,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:21,400 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:21,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00056918 0.00056536 0.00158952 ... 0.00185309 0.00251762 0.00295766]
2025-06-24 09:48:21,402 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:21,403 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:21,403 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:21,404 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:21,420 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:21,427 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:21,427 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:21,427 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:21,427 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:21,427 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:21,427 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:21,427 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:21,427 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:21,427 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:21,427 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:21,427 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:21,427 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:21,427 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:21,427 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:21,427 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:21,428 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:21,428 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:21,428 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:21,428 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:21,428 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:21,449 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:21,449 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:21,870 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = lightgbm
2025-06-24 09:48:23,846 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:23,846 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:23,846 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:23,846 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:23,847 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:23,847 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:23,847 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:23,864 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:24,335 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:24,335 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:24,335 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:24,335 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:24,335 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:24,335 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:24,335 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:24,335 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:24,335 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:24,476 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:24,476 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:24,476 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:24,476 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:25,621 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:26,512 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:26,512 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:26,517 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:26,545 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:26,545 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:26,545 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:26,545 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:27,530 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:27,924 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:27,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:28,058 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:28,058 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:28,125 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:28,125 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:28,125 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:28,125 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:28,125 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:28,125 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,172 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:28,172 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:28,173 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,173 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,173 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:28,173 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:28,173 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,223 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:28,223 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:28,223 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:28,355 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:28,355 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:28,355 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:28,355 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:28,355 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:28,355 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:28,355 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:28,355 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:28,355 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:28,355 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:28,355 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:28,355 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:28,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:28,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:28,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:28,419 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:28,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:28,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:28,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:28,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:28,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:28,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:28,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:28,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:28,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:28,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:28,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:28,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:28,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:28,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:28,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:28,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:28,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:28,899 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:28,899 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:28,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:28,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,923 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:28,923 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:28,923 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:28,932 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   learning_rate: 0.02960427890913426
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:28,937 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   n_estimators: 240
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   subsample: 0.7742544913880576
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9449923596722283
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   reg_alpha: 6.189776343666531e-08
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO -   reg_lambda: 2.0050009913357152e-05
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:28,938 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:29,240 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:29,240 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035130406655285856})})
2025-06-24 09:48:29,240 - src.models.lightgbm_model - INFO -   - Best Iteration: 50
2025-06-24 09:48:29,240 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:29,241 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:29,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:29,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:29,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:29,272 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:29,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:29,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:29,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:29,367 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:29,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:29,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:29,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:29,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:29,424 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:29,425 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:29,425 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:29,425 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:29,425 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:29,425 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:29,425 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:29,425 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:29,431 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:29,438 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:29,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00047237 0.00167972 0.00156483 ... 0.00196618 0.00308131 0.00339647]
2025-06-24 09:48:29,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:29,440 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:29,441 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:29,442 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:29,457 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:29,464 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:29,464 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:29,464 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:29,464 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:29,464 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:29,464 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:29,464 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:29,464 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:29,464 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:29,464 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:29,464 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:29,464 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:29,465 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:29,465 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:29,465 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:29,465 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:29,465 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:29,465 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:29,465 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:29,465 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:29,485 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:29,485 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:29,891 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = lightgbm
2025-06-24 09:48:31,798 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:31,799 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:31,799 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:31,799 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:31,799 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:31,799 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:31,799 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:31,816 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:32,288 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:32,288 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:32,288 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:32,288 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:32,288 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:32,288 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:32,288 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:32,288 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:32,288 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:32,430 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:32,430 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:32,430 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:32,430 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:33,568 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:34,455 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:34,455 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:34,459 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:34,487 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:34,487 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:34,487 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:34,487 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:35,556 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:35,995 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:35,995 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:36,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:36,132 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:36,201 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:36,201 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:36,201 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:36,201 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:36,201 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:36,201 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:36,250 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:36,251 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:36,251 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:36,251 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:36,251 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:36,251 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:36,251 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:36,306 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:36,306 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:36,306 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:36,426 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:36,426 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:36,426 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:36,426 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:36,426 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:36,426 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:36,426 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:36,426 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:36,426 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:36,426 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:36,426 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:36,426 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:36,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:36,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:36,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:36,500 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:36,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:36,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:36,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:36,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:36,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:36,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:36,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:36,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:36,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:36,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:36,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:36,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:36,876 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:36,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:36,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:36,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:36,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:37,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:37,018 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:37,018 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:37,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:37,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:37,045 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:37,045 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:37,045 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:37,053 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   learning_rate: 0.052772641594485394
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:37,058 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   subsample: 0.709790030543809
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7956578586822305
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   reg_alpha: 2.8089508266239516e-05
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00016743745517347003
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:37,059 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:37,186 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:37,186 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035136102254995444})})
2025-06-24 09:48:37,186 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:48:37,186 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:37,186 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:37,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:37,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:37,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:37,217 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:37,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:37,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:37,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:37,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:37,356 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:37,361 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:37,361 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:37,366 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:37,373 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:37,373 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:37,373 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:37,373 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:37,373 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:37,373 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:37,373 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:37,373 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:37,380 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:37,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:37,388 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00069716 0.00136359 0.00128904 ... 0.01647132 0.01404977 0.00959257]
2025-06-24 09:48:37,388 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:37,389 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:37,389 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:37,390 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:37,406 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:37,413 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:37,413 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:37,414 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:37,414 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:37,414 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:37,414 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:37,414 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:37,414 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:37,414 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:37,414 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:37,414 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:37,414 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:37,414 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:37,414 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:37,414 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:37,414 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:37,415 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:37,415 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:37,415 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:37,415 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:37,439 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:37,439 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:37,837 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = lightgbm
2025-06-24 09:48:39,696 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:39,696 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:39,696 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:39,696 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:39,696 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:39,696 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:39,696 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:39,714 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:40,173 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:40,173 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:40,173 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:40,173 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:40,173 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:40,173 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:40,173 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:40,173 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:40,173 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:40,330 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:40,330 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:40,330 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:40,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:41,409 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:42,248 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:42,248 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:42,253 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:42,281 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:42,281 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:42,281 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:42,281 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:43,284 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:43,697 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:43,697 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:43,829 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:43,829 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:43,896 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:43,896 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:43,896 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:43,896 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:43,896 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:43,896 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:43,944 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:43,945 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:43,945 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:43,945 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:43,945 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:43,945 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:43,945 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:43,995 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:43,995 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:43,996 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:44,125 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:44,125 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:44,125 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:44,125 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:44,125 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:44,125 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:44,125 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:44,125 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:44,125 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:44,125 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:44,125 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:44,125 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:44,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:44,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:44,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:44,190 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:44,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:44,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:44,332 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:44,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:44,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:44,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:44,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:44,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:44,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:44,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:44,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:44,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:44,542 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:44,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:44,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:44,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:44,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:44,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:44,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:44,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:44,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:44,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:44,698 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:44,698 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:44,698 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:44,707 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   learning_rate: 0.02043311211274545
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   n_estimators: 410
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   subsample: 0.765836702637975
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9367310980059825
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   reg_alpha: 2.467723761283515e-06
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0025526354515177084
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:44,713 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:45,171 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:45,171 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035109137252633635})})
2025-06-24 09:48:45,171 - src.models.lightgbm_model - INFO -   - Best Iteration: 119
2025-06-24 09:48:45,171 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:45,171 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:45,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:45,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:45,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:45,201 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:45,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:45,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:45,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:45,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:45,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:45,330 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:45,330 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:45,336 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:45,371 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:45,372 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:45,372 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:45,372 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:45,372 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:45,372 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:45,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:45,372 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:45,378 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:45,385 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:45,387 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00039162 0.0018685  0.00161646 ... 0.00182917 0.00420105 0.00486016]
2025-06-24 09:48:45,387 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:45,388 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:45,388 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:45,389 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:45,404 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:45,411 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:45,411 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:45,411 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:45,411 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:45,412 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:45,412 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:45,412 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:45,412 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:45,412 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:45,412 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:45,412 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:45,412 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:45,412 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:45,412 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:45,412 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:45,412 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:45,412 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:45,412 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:45,412 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:45,412 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:45,433 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:45,433 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:45,858 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = lightgbm
2025-06-24 09:48:47,718 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:47,718 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:47,718 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:47,718 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:47,718 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:47,718 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:47,718 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:47,737 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:48,196 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:48,196 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:48,196 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:48,196 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:48,196 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:48,196 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:48,196 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:48,196 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:48,196 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:48,350 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:48,350 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:48,350 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:48,350 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:49,427 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:50,266 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:50,266 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:50,272 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:50,299 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:50,299 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:50,299 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:50,299 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:51,303 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:51,714 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:51,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:51,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:51,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:51,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:51,915 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:51,915 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:51,915 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:51,915 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:51,915 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:51,963 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:51,963 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:51,963 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:51,963 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:51,963 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:51,963 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:51,963 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:52,013 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:52,013 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:52,013 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:52,142 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:52,142 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:52,142 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:52,142 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:52,142 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:52,142 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:52,142 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:52,142 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:52,142 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:52,142 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:52,142 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:52,142 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:52,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:52,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:52,142 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:52,206 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:52,253 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:52,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:52,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:52,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:52,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:52,468 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:48:52,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:52,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:48:52,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:52,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:52,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:52,529 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:52,558 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:52,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:52,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:52,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:52,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:52,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:52,687 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:52,687 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:52,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:48:52,712 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:52,712 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:52,712 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:52,712 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:48:52,721 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   learning_rate: 0.21063894305336445
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   n_estimators: 656
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   subsample: 0.822656444358238
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8094408985463093
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0005539202839193388
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO -   reg_lambda: 6.440889140440102e-06
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:48:52,727 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:48:52,831 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:48:52,831 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513637740753033})})
2025-06-24 09:48:52,831 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 09:48:52,831 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:48:52,831 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:48:52,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:48:52,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:52,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:52,861 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:52,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:52,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:48:52,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:48:52,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:48:52,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:48:52,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:48:52,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:52,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:48:52,998 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:48:52,999 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:48:52,999 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:48:52,999 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:48:52,999 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:52,999 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:52,999 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:48:52,999 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:48:53,006 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:48:53,012 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:48:53,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 6.26678304e-04  1.49213495e-03  1.22661977e-03  1.41791268e-03
  1.49382061e-03  1.89975084e-03  8.17971209e-04  2.02688600e-03
  1.62440233e-03  2.53042531e-03  1.34342307e-03  1.30252770e-03
  2.78159256e-03  1.25244820e-02  1.52685559e-03  2.92924393e-03
  3.00670577e-03  3.54723090e-03  1.57107180e-03  4.35091741e-03
  1.70845793e-03 -1.48021122e-04  1.96829997e-02  7.93688729e-04
  2.61659031e-03  2.02906664e-03  2.94852907e-03  3.69865131e-03
  2.22035955e-03  3.02679067e-03  7.73389359e-02  2.08871285e-02
  4.33083251e-03  3.09179947e-02  3.46846665e-03  2.90915903e-03
  1.74998989e-02  3.73560344e-03  2.85750049e-03  7.56736594e-04
  3.52649589e-03  2.50872416e-03 -3.91771864e-04  2.97506400e-03
  3.44748406e-03  1.79452138e-02  4.01277540e-03  4.41870564e-03
  4.81304163e-03  4.60999854e-03  5.21897187e-03  2.78377109e-03
  3.20657763e-03  5.56774819e-03  1.60222969e-04  3.45618595e-03
  2.19205261e-02  1.15427133e-02  1.04284443e-02  3.17771956e-03
  1.83661201e-02  2.11527572e-03  2.56874624e-03  2.10279393e-03
  3.58403732e-03  6.41899544e-02 -1.43231423e-03  8.61292525e-04
  3.03115543e-02  1.64360478e-02  3.40144724e-03  1.81463775e-03
  3.13876449e-03  1.88765686e-02  4.47676040e-03  3.07437207e-03
  1.82068380e-02  5.05569343e-04  1.95239640e-03  9.23673106e-04
  1.35921390e-02  4.20406831e-03  3.02307185e-03  5.53714290e-03
  1.84289985e-03  5.98585195e-03  3.71963390e-03  9.10518827e-03
  1.83611667e-03  1.95359539e-03  2.06149054e-03  4.44355463e-03
  2.27457273e-02  2.44453828e-02  2.77967535e-02  7.15764629e-03
  3.27560425e-03  4.30788634e-02  1.26039936e-02  1.28374345e-02
  1.17268739e-02  5.14036066e-02  1.81603177e-03  6.48480694e-03
  2.08664806e-02  2.80788321e-03  5.08641304e-04  4.36838245e-02
  1.51343086e-02  4.61525303e-02  1.44137251e-02  1.97877936e-02
  1.11823201e-02  6.65728525e-03  6.16327356e-03  2.72424905e-03
  4.45667550e-03  2.77178933e-03  1.76291107e-03  2.22809373e-03
  1.64198593e-02  3.87522496e-03  4.64707761e-03  3.06521536e-03
  2.57372543e-02  2.87502342e-02  3.94971457e-03  1.20977214e-02
  2.61215272e-02  1.30453758e-02  1.31908486e-02  1.97363818e-02
  1.57161817e-03  2.59760431e-03  3.38154497e-03  1.64549774e-02
  1.71709101e-03  3.94665270e-02  2.20027464e-03  1.40573216e-02
  4.90143135e-03  2.59711388e-03  2.37745333e-03  1.97152310e-03
  2.20767319e-02  5.78831015e-03  3.94459965e-03  2.03453551e-02
  2.17496568e-02  1.74798140e-02  3.72043489e-03  2.54685174e-03
  1.69215408e-02  2.58361271e-02  1.98532711e-03  3.97345772e-03
  6.50578953e-03  3.19557642e-03  6.73587020e-03  5.52265214e-03
  4.28140037e-03  2.24335998e-02  3.20608721e-03  2.16281600e-03
  2.31319602e-02  3.56395242e-03  1.80809950e-02  2.56847717e-02
  3.91935012e-02  5.08740751e-02  2.16514351e-02  1.62795232e-03
  2.37188440e-03  2.31520451e-02  5.51345916e-02  2.19398922e-02
  1.59633098e-02  5.93458683e-02  1.47383651e-02  4.92888465e-02
  6.14679347e-02  2.55296144e-02  3.81910625e-03  1.45087762e-02
  4.05913491e-03  8.32644520e-04  1.57992341e-02  4.46453722e-03
  3.04062574e-02  4.56417847e-03  1.54514077e-02  3.77455923e-03
  2.64933098e-03  2.40631140e-03  2.11122352e-02  1.83460352e-02
  2.79773458e-02  1.85393077e-03  1.15226284e-02  6.67937953e-02
  6.71397327e-03  8.57446578e-03  7.14180043e-03  8.86272291e-03
  7.68398562e-02  2.54171324e-02  2.54688929e-02  9.18109620e-03
  1.19250735e-03  6.19734831e-03 -2.09880988e-04  1.53929163e-02
  2.95497910e-03  5.91633491e-03  7.18197293e-02  1.76552815e-03
  2.17013429e-02  1.80116650e-03  1.01403250e-02  2.47460935e-03
  1.71376766e-03  2.04152137e-02  1.08462479e-04  3.84928235e-04
  6.87697311e-04  2.82319999e-03  2.00898174e-03  4.57500629e-03
  6.27860716e-02  8.03085819e-02  2.41183076e-02  2.72680339e-03
  7.20885346e-02  6.38180801e-02  1.65717906e-02  1.36621362e-02
  2.19118365e-03  7.18363340e-03  2.68237112e-02  2.12609989e-03
  2.52292617e-03  1.55275768e-02  3.41254495e-03  2.18837862e-03
  3.46915238e-03  7.07134805e-03  6.23918148e-03  5.10054813e-03
  9.85009160e-03 -1.62145509e-03  8.49095507e-03  5.66975948e-03
  2.68571563e-02  2.62552721e-02  1.69492503e-02  2.76368619e-03
  5.30736159e-03  2.39954589e-02  2.99551700e-02  4.56385668e-02
  4.31934060e-03  4.63603960e-02  3.73891976e-03  1.34176545e-02
  1.45545705e-02  1.18913439e-02  4.46199521e-02  1.68889270e-02
  2.76964516e-02  5.51040468e-03  3.67242704e-03  7.10379729e-02
  1.18308327e-02  2.45382973e-03  4.82488640e-02  2.87896493e-02
  1.63040441e-02  1.57791492e-02  2.83831091e-02 -1.31321100e-03
  2.10461358e-02  2.29601141e-03  2.61418083e-03  3.88750699e-02
  2.59400859e-02  9.98409398e-03  5.20435681e-02  1.20895762e-03
  1.03215625e-03  2.63408262e-02  4.57838740e-02  9.79210570e-03
  1.51869403e-02  6.11169495e-03  1.92761714e-03  1.39116263e-02
  5.24645201e-02  2.08989936e-02  2.47869796e-02  4.54419976e-02
 -2.75613982e-03  3.90982502e-02  4.77249204e-02  6.85032868e-03
  4.69461789e-03  1.48318288e-02  4.26131547e-03  2.80015698e-03
  1.82125141e-03  7.22778837e-03  5.59856007e-03  6.15767218e-03
  2.95145889e-02  2.46440321e-02  2.89823578e-02  6.51461331e-02
  1.97055559e-02  3.96843619e-02 -1.05192995e-03  2.08493281e-02
  3.26610928e-03  6.97250893e-02  5.08235902e-03  2.81495854e-03
  1.11972288e-02  2.03330374e-02  2.00352507e-03  3.87764325e-03
  1.69086141e-02  3.01848764e-02  2.78534039e-03  4.03661563e-02
  1.04674001e-02  5.08720793e-04  2.10427182e-02  4.09030163e-02
  3.00814658e-02  1.59997801e-02  7.83916347e-03  6.39706021e-03
  9.57984968e-03  1.45430051e-02  2.89086646e-03  4.47338569e-03
  7.20186960e-02  1.57370973e-02  1.38456420e-02  1.32366687e-02
  3.08979098e-02  3.99184408e-02  2.50914332e-02  9.18321584e-03
  6.80546653e-04  1.45322224e-02  2.03451247e-03  1.01210398e-02
  2.86017905e-03  8.30191926e-03  3.02569984e-02  3.05723351e-02
  6.04266389e-03  1.56814404e-02  1.83067503e-02  1.69989241e-02
  1.43337397e-02  6.29497745e-03  3.58472974e-03  2.06707639e-02
  1.38357583e-02  2.81877652e-02  3.06529254e-02  3.33167745e-04
  4.07044264e-03  4.06488261e-03  2.12617774e-02  1.03305604e-02
  3.74277323e-02  1.41493365e-03  7.00631555e-04  2.75799694e-02
  3.87508261e-03  7.64698428e-03  2.06516805e-03  2.20200782e-03
  5.54869885e-03  1.22411902e-03  4.91225552e-03  2.35443460e-02
  4.15342561e-02  3.96687933e-02  2.77441449e-02  2.81778206e-02
  3.38044664e-03  2.52284589e-02  9.71543529e-03  4.27829058e-03
  1.58344549e-02  5.83738527e-04  1.11363955e-02  4.59403082e-03
  3.90328790e-02  5.02426106e-03  5.46657496e-02  3.97417312e-03
  1.39833844e-02  1.31776478e-02  2.60049309e-02  2.44064270e-02
  1.18107478e-02  1.11622352e-02  5.26549154e-02  3.03329063e-02
  4.44200810e-02  1.14562278e-01  2.83938146e-02  1.06678956e-02
  3.17754121e-03  1.43851811e-02  1.15101216e-01  2.21627075e-02
  1.86668531e-03  2.06658624e-02  1.88031828e-02  2.32228217e-02
  3.09109729e-02  1.43120311e-03  1.85750697e-02  4.66004290e-03
  3.30431540e-02  3.26269092e-03  4.70876279e-02  5.04317700e-02
  2.43610172e-02  2.36033513e-02  1.52210811e-02  3.77965674e-02
  2.32857041e-02  8.16186382e-02  2.86047511e-02  2.74117460e-02
  6.68367993e-02  8.35365455e-02  1.39340317e-02  3.67499563e-02
  1.42864781e-02  1.68405442e-02  3.25650826e-03  3.48760703e-02
  1.17067890e-02  6.47296814e-03 -8.45085611e-04  3.12633551e-03
  8.37517545e-02  2.55006111e-02  2.32054525e-02  7.43323324e-03
  5.60111417e-03  6.33612837e-03  6.53321348e-03  4.00141159e-03
  4.33654593e-03  2.85521393e-03  1.37659128e-03  1.56804288e-03
  7.79260672e-03  1.16468593e-01  9.56740043e-03  5.78021249e-03
  2.70685340e-02  2.07637004e-03  1.90901134e-02  3.99577925e-04
  1.44522636e-02  2.63177489e-02  6.25637516e-03  2.85637316e-03
  7.67418298e-03 -1.56969460e-03  6.63699179e-02  1.23711011e-02
  1.07537220e-02  3.20509979e-05 -1.99781612e-04  5.96672771e-04
  1.71625113e-02  4.59829583e-02  2.57746507e-02  3.85024492e-03
  3.21783325e-02  2.46196591e-02  2.73304993e-02  1.02851155e-02
  4.72839065e-02  7.44104943e-03 -6.28414396e-04  4.71377277e-03
  4.99381355e-02  3.50417781e-02  1.24471528e-02  4.29749046e-02
  2.73850399e-02  4.76777568e-02  4.18439760e-03  3.71340516e-03
  2.11858695e-02  4.25372514e-03  2.05434389e-03  3.20324836e-02
  1.25989359e-02  3.23248132e-02  1.38312496e-02  8.27136494e-03
  3.02700864e-02  5.18242985e-03  2.34520181e-02  6.87026781e-02
  7.41177488e-02  2.03893575e-02  4.57204472e-02  9.45871502e-02
  1.09321615e-02  5.55988954e-03  3.37602396e-03  7.89390524e-03
  4.26576300e-02  5.54419091e-02  1.95566743e-02  5.30294583e-02
  3.23353555e-02  6.56049263e-03  3.74633157e-02  5.49999120e-02
  3.01625067e-02  2.51143782e-02  2.28350665e-02  6.57495815e-02
  1.04091592e-02  1.08001493e-02  1.01207135e-03 -1.68106024e-04
  2.11249376e-02  3.13040900e-02  1.52699898e-02  5.75135442e-03
  1.79814652e-02  3.40082351e-02  2.72146544e-02  4.27510709e-03
  1.49576718e-02  1.43041310e-02  3.95554003e-02  2.53175668e-02
  5.14238109e-03  5.46172030e-03  8.33028865e-03  1.14091226e-02
  5.89700168e-03  1.42939297e-02  2.62373722e-02  4.02670226e-02
  3.73758472e-02  3.22051366e-02  1.52287309e-02  1.37847969e-02
  7.09143296e-03  2.96280105e-02  2.55206960e-02  3.94468755e-02
  5.65546373e-02  9.81703503e-03  1.88277529e-02  6.71876142e-02
  7.63942454e-02  2.88574166e-03  6.05255256e-02  7.20770347e-03
  1.01770085e-02  4.92555808e-03  1.00820662e-03  9.04387962e-04
  2.74205902e-03  1.90921658e-03  2.13743674e-02  6.98280069e-03
  3.67211287e-02  6.76722553e-02  2.92094181e-04  7.85689633e-02
  7.19482408e-03  2.68766960e-02  4.39280562e-02  4.76316726e-02
  5.21011157e-02  3.90349085e-02  4.52389121e-02  1.22138705e-02
  1.96886935e-03  3.24951636e-02  8.52877140e-03  8.30880777e-03
  3.90394068e-03  4.51924032e-03  2.55315945e-02  1.24470090e-02
  3.42170263e-02  7.76862182e-02  2.60804396e-02  3.13699388e-02
  9.24622210e-03  4.74835084e-02  2.60526396e-02  5.64740184e-03
  5.79791117e-03  2.81088101e-02  7.21815946e-02 -2.47360343e-03
  2.31724628e-03  2.74998368e-02  9.69187675e-04  1.58103036e-02
  3.65234214e-03  7.14196354e-03  9.88039132e-02  3.27585112e-02
  4.12346576e-03  6.92526234e-02  1.19253237e-02  2.66331721e-03
  9.11765265e-03  3.58624844e-03  4.80037775e-02  4.94551926e-03
  4.07780968e-03  4.05765814e-02  3.44788998e-03  9.91573802e-03
  5.21366774e-02  2.97732217e-02  2.65783529e-02  3.36519979e-03
  1.72085426e-02  9.20067316e-02  6.41831959e-02  3.18202910e-02
  5.15357178e-03  4.80570802e-03  2.37482566e-02  1.78974012e-02
  1.10399982e-02  9.90383069e-02  4.54404586e-03  3.10381145e-02
  2.39720251e-02  4.60741099e-02  6.09337840e-02  3.74432308e-02
  6.13758728e-03  4.28258321e-03 -1.79996675e-04  4.08050027e-02
  2.42981348e-02  1.46145683e-02  1.54684108e-02  4.23454737e-02
  2.84237388e-02  1.63258399e-02  6.27395585e-02  2.96723038e-02
  2.32709913e-02  2.67973127e-02  2.25401672e-02  8.85117631e-03
  1.42663932e-02  2.82252560e-02  5.59670671e-03  4.20606682e-02
  2.92898283e-02  5.53980464e-03  4.59754070e-02  2.28165614e-02
  3.67527065e-02  5.82162094e-02  4.35586305e-02  7.81913374e-02
  2.23504254e-02  1.15046919e-01  1.14993612e-01  1.25084255e-02
  1.57601357e-02  3.47981882e-02  6.92228792e-03  1.12731367e-02
  2.87100322e-03  4.54019284e-03  5.17123916e-03  1.53717749e-02
  2.61513425e-02  2.03156427e-02  2.03197966e-02  3.69639867e-02
  1.24167681e-03  2.14399862e-02  9.33432714e-04  3.43297593e-02
  2.10071265e-02  1.78392224e-02  1.34526463e-02  8.10843149e-03
  5.67874183e-02  1.60975105e-02  4.92541085e-02  2.00541201e-03
  4.21251019e-02  2.63175456e-02  1.92608959e-02  1.87296545e-02
  3.47697392e-02  1.44379171e-03  6.14559621e-02  7.43509287e-03
  3.41561079e-02  1.64368341e-02  1.66270695e-02  8.16913717e-04
  7.79246766e-03]
2025-06-24 09:48:53,016 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:48:53,017 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:53,017 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:53,018 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:53,033 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:48:53,040 - src.training - INFO -   precision: 0.0
2025-06-24 09:48:53,040 - src.training - INFO -   recall: 0.0
2025-06-24 09:48:53,041 - src.training - INFO -   f1: 0.0
2025-06-24 09:48:53,041 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:48:53,041 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:48:53,041 - src.training - INFO -   positive_samples: 456
2025-06-24 09:48:53,041 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:48:53,041 - src.training - INFO -   total_samples: 368238
2025-06-24 09:48:53,041 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:48:53,041 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:48:53,041 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:48:53,041 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:48:53,041 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:48:53,041 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:48:53,041 - src.training - INFO - 모델 학습 완료
2025-06-24 09:48:53,041 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:48:53,041 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:53,041 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:53,041 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:53,041 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:53,062 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:48:53,063 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:48:53,468 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = lightgbm
2025-06-24 09:48:55,347 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:48:55,347 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:48:55,358 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:48:55,358 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:48:55,358 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:48:55,359 - src.training - INFO - 교차 검증 시작
2025-06-24 09:48:55,359 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:48:55,376 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:48:55,840 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:48:55,840 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:48:55,840 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:48:55,840 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:48:55,840 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:48:55,840 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:48:55,840 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:48:55,840 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:48:55,840 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:48:55,995 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:48:55,995 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:48:55,995 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:48:55,995 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:48:57,081 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:48:57,925 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:57,925 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:48:57,930 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:48:57,958 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:48:57,958 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:48:57,958 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:48:57,958 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:48:58,953 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:48:59,362 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:48:59,362 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:59,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:59,504 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:48:59,576 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:48:59,576 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:59,576 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:48:59,576 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:48:59,576 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:59,576 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:48:59,624 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:48:59,624 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:48:59,624 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:59,624 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:59,625 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:48:59,625 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:48:59,625 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:48:59,676 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:59,676 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:48:59,676 - src.training - INFO - 모델 학습 시작
2025-06-24 09:48:59,805 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:48:59,805 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:48:59,805 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:48:59,805 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:48:59,805 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:48:59,805 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:48:59,805 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:48:59,805 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:48:59,805 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:48:59,805 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:48:59,805 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:48:59,805 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:48:59,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:48:59,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:48:59,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:48:59,869 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:48:59,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:48:59,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:00,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:00,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:00,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:00,133 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:00,133 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:00,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:00,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:00,222 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:00,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:00,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:00,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:00,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:00,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:00,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:00,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:00,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,376 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:00,376 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,376 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:00,384 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   learning_rate: 0.0804852149570703
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   subsample: 0.6346522194487378
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9964125388085947
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   reg_alpha: 8.253969505781612e-08
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO -   reg_lambda: 1.119023035815797e-07
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:00,390 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:00,532 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:00,532 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512996847985937})})
2025-06-24 09:49:00,532 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 09:49:00,532 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:00,533 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:00,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:00,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:00,563 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:00,586 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:00,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:00,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:00,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:00,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:00,694 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:00,694 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:00,707 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:00,708 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:00,708 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:00,708 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:00,708 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,708 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:00,708 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:00,714 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:00,721 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:00,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00055677 0.00167847 0.00146966 ... 0.00785761 0.00290061 0.01297854]
2025-06-24 09:49:00,723 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:00,724 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:00,724 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:00,725 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:00,741 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:00,748 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:00,748 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:00,748 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:00,748 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:00,748 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:00,748 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:00,748 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:00,748 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:00,748 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:00,748 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:00,748 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:00,748 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:00,749 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:00,749 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:00,749 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:00,749 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:00,749 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,749 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,749 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:00,749 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:00,769 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:00,769 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:01,186 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = lightgbm
2025-06-24 09:49:03,047 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:03,047 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:03,047 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:03,047 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:03,048 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:03,048 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:03,048 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:03,066 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:03,524 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:03,524 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:03,524 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:03,524 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:03,524 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:03,524 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:03,524 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:03,524 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:03,524 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:03,680 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:03,680 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:03,680 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:03,680 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:04,759 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:05,600 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:05,600 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:05,606 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:05,633 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:05,633 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:05,633 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:05,633 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:06,620 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:07,035 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:07,036 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:07,169 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:07,169 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:07,236 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:07,236 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:07,237 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:07,237 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:07,237 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:07,237 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:07,285 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:07,285 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:07,285 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:07,285 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:07,285 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:07,285 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:07,285 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:07,335 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:07,335 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:07,335 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:07,466 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:07,466 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:07,466 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:07,466 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:07,466 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:07,466 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:07,466 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:07,466 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:07,466 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:07,466 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:07,467 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:07,467 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:07,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:07,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:07,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:07,531 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:07,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:07,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:07,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:07,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:07,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:07,795 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:07,795 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:07,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:07,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:07,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:07,855 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:07,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:07,884 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:07,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:07,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:07,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:07,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:08,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:08,014 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:08,014 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:08,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:08,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:08,040 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:08,040 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:08,040 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:08,049 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   learning_rate: 0.12404094717085312
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:08,054 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   n_estimators: 782
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   subsample: 0.6724055367984789
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8740038680959015
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0343558782044228e-06
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO -   reg_lambda: 0.33132712190213737
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:08,055 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:08,163 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:08,163 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513911621599486})})
2025-06-24 09:49:08,163 - src.models.lightgbm_model - INFO -   - Best Iteration: 6
2025-06-24 09:49:08,163 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:08,165 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:08,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:08,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:08,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:08,194 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:08,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:08,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:08,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:08,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:08,319 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:08,324 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:08,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:08,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:08,336 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:08,337 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:08,337 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:08,337 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:08,337 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:08,337 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:08,337 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:08,337 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:08,345 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:08,352 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:08,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00065856 0.00129646 0.00121304 ... 0.01190462 0.0042569  0.03982833]
2025-06-24 09:49:08,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:08,355 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:08,356 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:08,356 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:08,373 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:08,381 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:08,381 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:08,381 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:08,381 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:08,381 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:08,381 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:08,381 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:08,381 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:08,381 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:08,381 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:08,381 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:08,381 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:08,381 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:08,381 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:08,381 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:08,381 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:08,381 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:08,381 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:08,381 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:08,381 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:08,402 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:08,402 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:08,824 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = lightgbm
2025-06-24 09:49:10,743 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:10,743 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:10,743 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:10,743 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:10,743 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:10,743 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:10,743 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:10,761 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:11,230 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:11,230 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:11,230 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:11,230 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:11,230 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:11,230 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:11,230 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:11,230 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:11,230 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:11,370 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:11,370 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:11,370 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:11,370 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:11,370 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:11,371 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:11,371 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:11,371 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:11,371 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:11,371 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:12,501 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:13,388 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:13,389 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:13,394 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:13,422 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:13,422 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:13,422 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:13,422 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:14,476 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:14,908 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:14,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:15,043 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:15,043 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:15,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:15,111 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:15,112 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:15,112 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:15,112 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:15,112 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,161 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:15,161 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:15,161 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,161 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,161 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:15,161 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:15,161 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,217 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:15,217 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:15,217 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:15,345 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:15,345 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:15,345 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:15,345 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:15,345 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:15,345 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:15,345 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:15,346 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:15,346 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:15,346 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:15,346 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:15,346 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:15,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:15,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:15,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:15,419 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:15,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:15,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:15,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:15,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:15,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:15,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:15,714 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:15,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:15,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:15,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:15,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:15,799 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:15,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:15,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:15,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:15,906 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:15,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:15,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:15,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:15,966 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:15,966 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,966 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:15,966 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:15,966 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:15,974 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   learning_rate: 0.021604981364913005
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   n_estimators: 515
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   subsample: 0.7969902083314745
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7309448291222742
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   reg_alpha: 4.867051057937844e-08
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO -   reg_lambda: 3.374072614356822e-07
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:15,980 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:16,216 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:16,216 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035129289508210614})})
2025-06-24 09:49:16,216 - src.models.lightgbm_model - INFO -   - Best Iteration: 39
2025-06-24 09:49:16,216 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:16,217 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:16,217 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:16,217 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:16,217 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:16,249 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:16,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:16,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:16,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:16,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:16,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:16,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:16,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:16,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:16,418 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:16,418 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:16,418 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:16,418 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:16,418 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:16,418 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:16,418 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:16,418 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:16,424 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:16,431 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:16,433 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00065656 0.00149204 0.00134655 ... 0.00764407 0.0024138  0.00255764]
2025-06-24 09:49:16,433 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:16,433 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:16,434 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:16,435 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:16,451 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:16,459 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:16,459 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:16,459 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:16,459 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:16,459 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:16,459 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:16,459 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:16,459 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:16,459 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:16,459 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:16,459 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:16,459 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:16,460 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:16,460 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:16,460 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:16,460 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:16,460 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:16,460 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:16,460 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:16,460 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:16,480 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:16,480 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:16,886 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = lightgbm
2025-06-24 09:49:18,846 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:18,846 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:18,846 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:18,846 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:18,846 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:18,846 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:18,846 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:18,862 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:19,330 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:19,330 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:19,330 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:19,330 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:19,330 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:19,330 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:19,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:19,330 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:19,330 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:19,471 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:19,471 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:19,471 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:19,471 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:20,597 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:21,468 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:21,468 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:21,473 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:21,501 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:21,501 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:21,501 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:21,501 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:22,546 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:22,986 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:22,986 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:23,122 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:23,122 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:23,190 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:23,190 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:23,190 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:23,190 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:23,190 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:23,190 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:23,239 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:23,240 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:23,240 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:23,240 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:23,240 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:23,240 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:23,240 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:23,295 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:23,295 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:23,295 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:23,412 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:23,413 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:23,413 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:23,413 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:23,413 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:23,413 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:23,413 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:23,413 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:23,413 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:23,413 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:23,413 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:23,413 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:23,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:23,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:23,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:23,486 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:23,540 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:23,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:23,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:23,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:23,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:23,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:23,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:23,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:23,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:23,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:23,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:23,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:23,862 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:23,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:23,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:23,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:23,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:24,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:24,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:24,009 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:24,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:24,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:24,046 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:24,046 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:24,046 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:24,054 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:24,060 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:24,060 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   learning_rate: 0.04035286091031472
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   n_estimators: 457
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   subsample: 0.8044792631641183
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8696839799381978
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   reg_alpha: 2.938419320810259e-06
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO -   reg_lambda: 1.474108753561657e-08
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:24,061 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:24,300 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:24,301 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512970023631174})})
2025-06-24 09:49:24,301 - src.models.lightgbm_model - INFO -   - Best Iteration: 36
2025-06-24 09:49:24,301 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:24,301 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:24,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:24,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:24,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:24,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:24,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:24,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:24,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:24,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:24,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:24,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:24,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:24,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:24,480 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:24,481 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:24,481 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:24,481 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:24,481 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:24,481 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:24,481 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:24,481 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:24,487 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:24,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:24,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00048508 0.00166114 0.00144875 ... 0.00201447 0.00322616 0.00382866]
2025-06-24 09:49:24,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:24,496 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:24,497 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:24,497 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:24,513 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:24,520 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:24,520 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:24,520 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:24,520 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:24,520 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:24,520 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:24,520 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:24,520 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:24,520 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:24,520 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:24,520 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:24,520 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:24,521 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:24,521 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:24,521 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:24,521 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:24,521 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:24,521 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:24,521 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:24,521 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:24,543 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:24,543 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:24,954 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = lightgbm
2025-06-24 09:49:26,880 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:26,880 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:26,880 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:26,880 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:26,880 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:26,880 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:26,880 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:26,896 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:27,362 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:27,362 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:27,362 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:27,362 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:27,362 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:27,362 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:27,362 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:27,362 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:27,362 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:27,501 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:27,501 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:27,501 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:27,501 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:28,654 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:29,551 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:29,552 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:29,557 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:29,585 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:29,585 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:29,585 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:29,585 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:30,624 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:31,065 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:31,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:31,201 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:31,201 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:31,269 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:31,270 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:31,270 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:31,270 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:31,270 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:31,270 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:31,319 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:31,320 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:31,320 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:31,320 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:31,320 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:31,320 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:31,320 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:31,376 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:31,376 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:31,376 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:31,506 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:31,506 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:31,506 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:31,506 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:31,506 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:31,506 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:31,506 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:31,506 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:31,506 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:31,506 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:31,506 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:31,506 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:31,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:31,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:31,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:31,579 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:31,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:31,692 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:31,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:31,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:31,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:31,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:31,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:31,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:31,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:31,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:31,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:31,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:31,958 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:31,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:32,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:32,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:32,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:32,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:32,100 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:32,100 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:32,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:32,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:32,126 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:32,126 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:32,126 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:32,135 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   learning_rate: 0.013637410036364993
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   n_estimators: 358
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   subsample: 0.8349337395484048
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.831861212497879
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   reg_alpha: 0.001834620070516215
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO -   reg_lambda: 6.362585398085402e-07
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:32,139 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:32,467 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:32,467 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035132586383390084})})
2025-06-24 09:49:32,467 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:49:32,467 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:32,468 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:32,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:32,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:32,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:32,499 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:32,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:32,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:32,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:32,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:32,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:32,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:32,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:32,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:32,678 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:32,678 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:32,678 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:32,679 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:32,679 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:32,679 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:32,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:32,679 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:32,684 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:32,691 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:32,693 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00062672 0.00144793 0.0013889  ... 0.00101229 0.00162413 0.00231569]
2025-06-24 09:49:32,693 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:32,694 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:32,695 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:32,695 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:32,712 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:32,720 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:32,720 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:32,720 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:32,720 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:32,720 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:32,720 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:32,720 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:32,720 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:32,720 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:32,720 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:32,720 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:32,720 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:32,720 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:32,720 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:32,720 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:32,720 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:32,720 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:32,720 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:32,720 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:32,720 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:32,741 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:32,741 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:33,168 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = lightgbm
2025-06-24 09:49:35,102 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:35,102 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:35,102 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:35,102 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:35,102 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:35,102 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:35,102 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:35,120 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:35,586 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:35,586 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:35,586 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:35,586 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:35,586 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:35,586 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:35,586 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:35,586 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:35,586 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:35,729 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:35,729 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:35,729 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:35,729 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:36,867 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:37,753 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:37,753 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:37,758 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:37,786 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:37,786 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:37,786 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:37,786 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:38,847 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:39,281 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:39,281 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:39,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:39,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:39,485 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:39,485 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:39,485 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:39,485 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:39,485 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:39,485 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:39,535 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:39,535 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:39,535 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:39,535 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:39,535 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:39,535 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:39,535 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:39,592 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:39,592 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:39,592 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:39,728 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:39,728 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:39,728 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:39,728 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:39,728 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:39,728 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:39,728 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:39,728 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:39,728 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:39,728 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:39,728 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:39,728 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:39,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:39,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:39,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:39,802 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:39,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:39,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:39,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:40,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:40,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:40,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:40,093 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:40,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:40,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:40,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:40,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:40,147 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:40,177 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:40,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:40,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:40,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:40,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:40,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:40,320 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:40,320 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:40,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:40,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:40,348 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:40,348 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:40,348 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:40,356 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   learning_rate: 0.010358238324974577
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   n_estimators: 269
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   subsample: 0.9392065580983905
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7242608165537173
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   reg_alpha: 0.07671535159777253
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO -   reg_lambda: 9.281031668514603e-05
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:40,362 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:40,766 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:40,766 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513319014567112})})
2025-06-24 09:49:40,766 - src.models.lightgbm_model - INFO -   - Best Iteration: 80
2025-06-24 09:49:40,766 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:40,767 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:40,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:40,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:40,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:40,799 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:40,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:40,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:40,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:40,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:40,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:40,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:40,945 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:40,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:40,979 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:40,980 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:40,980 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:40,980 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:40,980 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:40,980 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:40,980 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:40,980 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:40,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:40,993 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:40,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00065288 0.00143318 0.00139848 ... 0.00122109 0.00239026 0.00251847]
2025-06-24 09:49:40,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:40,996 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:40,997 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:40,997 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:41,013 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:41,020 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:41,020 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:41,020 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:41,020 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:41,020 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:41,020 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:41,020 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:41,021 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:41,021 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:41,021 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:41,021 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:41,021 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:41,021 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:41,021 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:41,021 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:41,021 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:41,021 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:41,021 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:41,021 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:41,021 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:41,042 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:41,042 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:41,468 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = lightgbm
2025-06-24 09:49:43,424 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:43,424 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:43,424 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:43,424 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:43,424 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:43,424 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:43,424 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:43,442 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:43,888 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:43,888 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:43,888 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:43,888 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:43,888 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:43,888 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:43,888 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:43,888 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:43,888 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:44,047 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:44,047 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:44,047 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:44,047 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:45,100 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:45,911 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:45,911 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:45,917 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:45,944 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:45,944 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:45,944 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:45,944 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:46,960 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:47,372 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:47,372 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:47,505 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:47,505 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:47,574 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:47,574 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:47,574 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:47,574 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:47,574 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:47,574 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:47,624 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:47,625 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:47,625 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:47,625 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:47,625 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:47,625 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:47,625 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:47,678 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:47,678 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:47,678 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:47,816 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:47,816 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:47,816 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:47,817 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:47,817 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:47,817 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:47,817 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:47,817 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:47,817 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:47,817 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:47,817 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:47,817 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:47,817 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:47,887 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:47,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:48,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:48,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:48,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:48,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:48,203 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:48,203 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:48,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:48,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:48,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:48,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:48,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:48,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:48,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:48,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:48,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:48,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:48,469 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:48,469 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:48,469 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:48,469 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:48,477 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:48,482 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:48,482 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:48,482 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:48,482 - src.models.lightgbm_model - INFO -   learning_rate: 0.018528024944816653
2025-06-24 09:49:48,482 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   subsample: 0.7403423161145642
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.694494095260054
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009311170494905974
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO -   reg_lambda: 1.439483740775924e-07
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:48,483 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:48,835 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:48,835 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035125319734799376})})
2025-06-24 09:49:48,835 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:49:48,835 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:48,836 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:48,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:48,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:48,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:48,867 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:48,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:48,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:48,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:48,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:49,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:49,013 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:49,013 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:49,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:49,042 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:49,043 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:49,043 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:49,043 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:49,043 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:49,043 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:49,043 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:49,043 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:49,049 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:49,056 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:49,058 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0005002  0.00166655 0.0015204  ... 0.00196754 0.0011567  0.00256354]
2025-06-24 09:49:49,058 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:49,059 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:49,059 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:49,060 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:49,077 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:49,085 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:49,085 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:49,085 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:49,085 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:49,085 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:49,085 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:49,085 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:49,085 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:49,085 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:49,085 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:49,085 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:49,085 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:49,085 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:49,085 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:49,085 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:49,085 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:49,085 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:49,085 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:49,085 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:49,085 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:49,106 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:49,106 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:49,533 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = lightgbm
2025-06-24 09:49:51,449 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:51,449 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:51,449 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:51,449 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:51,449 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:51,449 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:51,449 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:51,466 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:49:51,933 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:49:51,933 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:49:51,933 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:49:51,933 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:49:51,933 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:49:51,933 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:49:51,933 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:49:51,933 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:49:51,933 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:49:52,072 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:52,073 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:52,073 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:49:52,073 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:49:52,073 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:52,073 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:49:52,073 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:49:52,073 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:49:52,073 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:49:52,073 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:49:53,220 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:49:54,107 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:54,107 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:49:54,113 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:49:54,141 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:49:54,141 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:49:54,141 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:49:54,141 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:49:55,192 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:49:55,627 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:49:55,627 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:55,761 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:55,761 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:49:55,830 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:49:55,830 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:55,830 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:49:55,830 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:49:55,830 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:55,830 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:55,879 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:49:55,880 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:49:55,880 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:55,880 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:55,880 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:49:55,880 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:49:55,880 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:55,936 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:55,936 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:49:55,936 - src.training - INFO - 모델 학습 시작
2025-06-24 09:49:56,073 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:49:56,073 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:49:56,073 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:49:56,073 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:49:56,073 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:49:56,073 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:49:56,073 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:49:56,074 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:49:56,074 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:56,074 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:49:56,074 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:49:56,074 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:49:56,074 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:49:56,074 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:56,074 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:56,147 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:56,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:56,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:56,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:56,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:56,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:56,441 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:49:56,441 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:56,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:49:56,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:56,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:56,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:56,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:56,526 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:56,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:56,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:56,606 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:56,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:56,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:56,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:56,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:56,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:49:56,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:56,698 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:49:56,698 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:56,698 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:49:56,705 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   learning_rate: 0.012603140096888722
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   n_estimators: 537
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   subsample: 0.887059385340847
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.814690263795279
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0007257356330429975
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0006511272157627004
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:49:56,711 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:49:57,058 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:49:57,058 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513198046685931})})
2025-06-24 09:49:57,058 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:49:57,058 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:49:57,058 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:49:57,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:49:57,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:57,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:49:57,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:49:57,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:49:57,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:49:57,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:49:57,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:49:57,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:49:57,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:49:57,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:57,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:49:57,265 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:49:57,265 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:49:57,265 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:49:57,265 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:49:57,265 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:57,265 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:49:57,265 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:49:57,265 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:49:57,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:49:57,278 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:49:57,280 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00066313 0.0014556  0.00141883 ... 0.00127071 0.00234482 0.00272873]
2025-06-24 09:49:57,280 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:49:57,281 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:57,281 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:57,282 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:57,298 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:49:57,306 - src.training - INFO -   precision: 0.0
2025-06-24 09:49:57,306 - src.training - INFO -   recall: 0.0
2025-06-24 09:49:57,306 - src.training - INFO -   f1: 0.0
2025-06-24 09:49:57,306 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:49:57,306 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:49:57,306 - src.training - INFO -   positive_samples: 456
2025-06-24 09:49:57,306 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:49:57,306 - src.training - INFO -   total_samples: 368238
2025-06-24 09:49:57,306 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:49:57,306 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:49:57,306 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:49:57,306 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:49:57,306 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:49:57,306 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:49:57,306 - src.training - INFO - 모델 학습 완료
2025-06-24 09:49:57,306 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:49:57,306 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:57,306 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:57,306 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:49:57,306 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:49:57,328 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:49:57,328 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:49:57,752 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = lightgbm
2025-06-24 09:49:59,728 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:49:59,728 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:49:59,728 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:49:59,728 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:49:59,728 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:49:59,728 - src.training - INFO - 교차 검증 시작
2025-06-24 09:49:59,728 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:49:59,746 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:00,225 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:00,225 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:00,225 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:00,225 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:00,225 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:00,225 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:00,225 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:00,225 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:00,225 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:00,385 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:00,385 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:00,385 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:00,385 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:00,385 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:00,385 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:00,385 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:00,385 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:00,385 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:00,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:01,482 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:02,317 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:02,317 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:02,322 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:02,349 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:02,349 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:02,349 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:02,349 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:03,354 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:03,768 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:03,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:03,901 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:03,901 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:03,969 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:03,969 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:03,969 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:03,969 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:03,969 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:03,969 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,018 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:04,018 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:04,018 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,018 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,018 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:04,018 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:04,018 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,068 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:04,068 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:04,068 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:04,186 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:04,186 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:04,186 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:04,186 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:04,186 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:04,186 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:04,186 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:04,186 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:04,186 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:04,186 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:04,186 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:04,186 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:04,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:04,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:04,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:04,251 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:04,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:04,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:04,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:04,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:04,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:04,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:04,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:04,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:04,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:04,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:04,572 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:04,600 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:04,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:04,648 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:04,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:04,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:04,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:04,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:04,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:04,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:04,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,754 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:04,754 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:04,754 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:04,764 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   learning_rate: 0.010078636987766579
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:50:04,768 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   n_estimators: 207
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   subsample: 0.9593052727074797
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9586658642491094
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   reg_alpha: 4.2693203841762886e-05
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO -   reg_lambda: 2.556230835595068e-05
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:04,769 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:05,169 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:05,169 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035132527275554014})})
2025-06-24 09:50:05,169 - src.models.lightgbm_model - INFO -   - Best Iteration: 81
2025-06-24 09:50:05,169 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:05,170 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:05,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:05,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:05,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:05,199 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:05,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:05,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:05,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:05,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:05,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:05,329 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:05,329 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:05,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:05,364 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:05,365 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:05,365 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:05,365 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:05,365 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:05,365 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:05,365 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:05,365 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:05,371 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:05,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:05,379 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00065487 0.00144917 0.00140057 ... 0.00123672 0.00243973 0.00249183]
2025-06-24 09:50:05,379 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:05,380 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:05,381 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:05,381 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:05,397 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:05,404 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:05,404 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:05,404 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:05,404 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:05,404 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:05,404 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:05,404 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:05,404 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:05,404 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:05,404 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:05,404 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:05,404 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:05,405 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:05,405 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:05,405 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:05,405 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:05,405 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:05,405 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:05,405 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:05,405 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:05,425 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:05,425 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:05,837 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = lightgbm
2025-06-24 09:50:07,752 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:07,752 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:07,752 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:07,753 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:07,753 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:07,753 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:07,753 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:07,771 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:08,228 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:08,228 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:08,228 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:08,228 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:08,228 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:08,228 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:08,228 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:08,228 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:08,228 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:08,385 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:08,385 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:08,385 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:08,385 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:09,460 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:10,295 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:10,295 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:10,301 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:10,328 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:10,328 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:10,328 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:10,328 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:11,301 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:11,710 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:11,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:11,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:11,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:11,911 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:11,911 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:11,911 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:11,911 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:11,911 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:11,911 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:11,959 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:11,959 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:11,959 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:11,959 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:11,959 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:11,959 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:11,959 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:12,009 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:12,009 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:12,009 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:12,140 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:12,140 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:12,140 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:12,140 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:12,140 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:12,140 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:12,140 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:12,140 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:12,140 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:12,140 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:12,140 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:12,140 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:12,140 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:12,140 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:12,140 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:12,203 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:12,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:12,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:12,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:12,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:12,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:12,463 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:12,464 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:12,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:12,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:12,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:12,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:12,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:12,554 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:12,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:12,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:12,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:12,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:12,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:12,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:12,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:12,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:12,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:12,709 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:12,709 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:12,709 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:12,716 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   learning_rate: 0.02487519724197392
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   n_estimators: 638
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   subsample: 0.7985560215507382
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7512759811523114
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   reg_alpha: 0.024900590270190155
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8961556446893008e-06
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:12,722 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:13,070 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:13,070 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035118078783563794})})
2025-06-24 09:50:13,070 - src.models.lightgbm_model - INFO -   - Best Iteration: 62
2025-06-24 09:50:13,070 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:13,070 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:13,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:13,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:13,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:13,101 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:13,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:13,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:13,176 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:13,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:13,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:13,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:13,235 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:13,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:13,269 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:13,269 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:13,269 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:13,269 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:13,269 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:13,269 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:13,269 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:13,269 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:13,275 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:13,282 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:13,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00038427 0.00039236 0.00037439 ... 0.00081525 0.00300896 0.00389379]
2025-06-24 09:50:13,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:13,286 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:13,286 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:13,287 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:13,302 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:13,310 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:13,310 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:13,310 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:13,310 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:13,310 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:13,310 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:13,310 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:13,310 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:13,310 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:13,310 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:13,310 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:13,310 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:13,311 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:13,311 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:13,311 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:13,311 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:13,311 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:13,311 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:13,311 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:13,311 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:13,332 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:13,332 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:13,731 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = lightgbm
2025-06-24 09:50:15,544 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:15,544 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:15,545 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:15,545 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:15,545 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:15,545 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:15,545 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:15,563 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:16,032 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:16,032 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:16,032 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:16,032 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:16,032 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:16,032 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:16,032 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:16,032 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:16,032 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:16,173 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:16,173 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:16,173 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:16,173 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:17,311 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:18,200 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:18,200 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:18,204 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:18,232 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:18,232 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:18,232 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:18,232 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:19,204 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:19,611 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:19,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:19,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:19,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:19,808 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:19,808 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:19,809 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:19,809 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:19,809 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:19,809 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:19,856 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:19,857 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:19,857 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:19,857 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:19,857 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:19,857 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:19,857 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:19,907 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:19,907 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:19,908 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:20,039 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:20,040 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:20,040 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:20,040 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:20,040 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:20,040 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:20,040 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:20,040 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:20,040 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:20,040 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:20,040 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:20,040 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:20,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:20,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:20,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:20,103 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:20,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:20,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:20,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:20,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:20,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:20,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:20,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:20,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:20,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:20,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:20,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:20,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:20,455 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:20,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:20,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:20,547 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:20,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:20,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:20,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:20,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:20,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:20,607 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:20,607 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:20,607 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:20,615 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   learning_rate: 0.01569833488957703
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   n_estimators: 283
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   subsample: 0.7125680491414248
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.784145332591274
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   reg_alpha: 0.766447656094571
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO -   reg_lambda: 6.133310095468243e-06
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:20,621 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:20,969 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:20,969 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512996318616691})})
2025-06-24 09:50:20,969 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:50:20,969 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:20,970 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:20,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:20,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:20,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:20,999 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:21,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:21,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:21,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:21,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:21,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:21,130 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:21,130 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:21,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:21,162 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:21,162 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:21,162 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:21,162 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:21,162 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:21,162 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:21,162 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:21,162 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:21,168 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:21,175 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:21,177 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00057883 0.0015477  0.00139971 ... 0.00242676 0.00238789 0.0027831 ]
2025-06-24 09:50:21,177 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:21,178 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:21,179 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:21,179 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:21,195 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:21,202 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:21,202 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:21,202 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:21,202 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:21,202 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:21,202 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:21,202 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:21,202 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:21,202 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:21,202 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:21,202 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:21,202 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:21,203 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:21,203 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:21,203 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:21,203 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:21,203 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:21,203 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:21,203 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:21,203 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:21,224 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:21,224 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:21,635 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = lightgbm
2025-06-24 09:50:23,543 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:23,544 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:23,544 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:23,544 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:23,544 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:23,544 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:23,544 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:23,562 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:24,016 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:24,017 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:24,017 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:24,017 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:24,017 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:24,017 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:24,017 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:24,017 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:24,017 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:24,180 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:24,180 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:24,180 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:24,180 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:25,246 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:26,086 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:26,087 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:26,092 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:26,119 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:26,119 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:26,119 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:26,120 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:27,130 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:27,542 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:27,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:27,675 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:27,675 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:27,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:27,742 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:27,742 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:27,742 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:27,742 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:27,742 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:27,793 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:27,793 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:27,793 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:27,793 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:27,793 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:27,793 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:27,793 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:27,843 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:27,843 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:27,843 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:27,978 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:27,978 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:27,978 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:27,978 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:27,978 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:27,979 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:27,979 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:27,979 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:27,979 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:27,979 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:27,979 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:27,979 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:27,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:27,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:27,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:28,043 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:28,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:28,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:28,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:28,234 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:28,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:28,306 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:28,306 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:28,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:28,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:28,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:28,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:28,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:28,398 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:28,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:28,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:28,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:28,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:28,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:28,527 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:28,527 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:28,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:28,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:28,553 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:28,553 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:28,553 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:28,561 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   learning_rate: 0.032767807118294565
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   n_estimators: 150
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   subsample: 0.9178842372107386
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8277442294773829
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0037264473202334634
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO -   reg_lambda: 4.218833317145971e-08
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:28,567 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:28,800 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:28,800 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512923427112019})})
2025-06-24 09:50:28,800 - src.models.lightgbm_model - INFO -   - Best Iteration: 36
2025-06-24 09:50:28,800 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:28,800 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:28,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:28,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:28,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:28,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:28,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:28,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:28,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:28,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:28,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:28,961 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:28,961 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:28,967 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:28,983 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:28,984 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:28,984 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:28,984 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:28,984 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:28,984 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:28,984 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:28,984 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:28,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:28,996 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:28,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00055764 0.00153937 0.00140304 ... 0.00404454 0.00273337 0.00295153]
2025-06-24 09:50:28,998 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:28,999 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:29,000 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:29,000 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:29,015 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:29,022 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:29,022 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:29,022 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:29,022 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:29,022 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:29,022 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:29,022 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:29,022 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:29,022 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:29,022 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:29,022 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:29,022 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:29,023 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:29,023 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:29,023 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:29,023 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:29,023 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:29,023 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:29,023 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:29,023 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:29,044 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:29,044 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:29,451 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = lightgbm
2025-06-24 09:50:31,299 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:31,299 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:31,299 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:31,299 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:31,299 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:31,299 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:31,299 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:31,317 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:31,782 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:31,782 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:31,782 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:31,782 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:31,782 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:31,782 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:31,782 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:31,782 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:31,782 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:31,926 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:31,927 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:31,927 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:31,927 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:31,927 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:31,927 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:31,927 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:31,927 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:31,927 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:31,927 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:33,054 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:33,941 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:33,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:33,946 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:33,977 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:33,977 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:33,977 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:33,977 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:35,037 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:35,475 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:35,476 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:35,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:35,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:35,680 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:35,680 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:35,680 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:35,680 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:35,680 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:35,680 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:35,732 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:35,732 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:35,732 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:35,732 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:35,732 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:35,732 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:35,732 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:35,787 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:35,788 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:35,788 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:35,923 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:35,923 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:35,923 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:35,923 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:35,923 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:35,923 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:35,923 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:35,923 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:35,923 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:35,923 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:35,923 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:35,923 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:35,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:35,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:35,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:35,997 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:36,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:36,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:36,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:36,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:36,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:36,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:36,288 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:36,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:36,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:36,373 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:36,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:36,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:36,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:36,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:36,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:36,515 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:36,515 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:36,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,542 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:36,542 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,542 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:36,550 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   learning_rate: 0.246113868759451
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   n_estimators: 376
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   subsample: 0.7569340813632006
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9165276790317524
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   reg_alpha: 3.2547826967952095e-07
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO -   reg_lambda: 9.914717715029425
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:36,556 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:36,643 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:36,643 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03514031960860333})})
2025-06-24 09:50:36,643 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 09:50:36,643 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:36,644 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:36,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:36,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:36,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:36,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:36,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:36,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:36,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:36,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:36,817 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:36,817 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:36,826 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:36,827 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:36,827 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:36,827 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:36,827 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,827 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:36,827 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:36,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:36,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:36,842 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 7.50233486e-04  1.26328484e-03  1.35197686e-03  1.85705339e-03
  1.56358560e-03  3.20215829e-03  3.17869077e-03  3.40718174e-03
  3.49166656e-03  1.40350286e-03  2.26635361e-02  4.32151567e-03
  2.38880617e-03  4.61498345e-03  5.76814246e-02  2.47519865e-02
  1.94574541e-03  2.72741020e-03  1.17652654e-03  2.60838974e-03
  4.51867309e-03  5.11244164e-03  2.76112842e-03  7.87037171e-03
  2.56650957e-02  5.96008836e-03  2.13364165e-03 -1.27957665e-05
  2.57769810e-03  1.81522798e-02  2.08648807e-02  1.78585966e-03
  2.18501840e-02  1.57388412e-02  2.46835504e-03 -9.04182137e-05
  1.94777631e-03  3.70064952e-03  3.85396202e-03  5.48534027e-03
  4.70367547e-03  1.43460101e-02  2.20159309e-02  2.24877147e-03
  2.26579957e-03  2.56673739e-02  2.42497596e-03  2.33356879e-02
  2.24233205e-03  4.42133643e-02  4.57100634e-03  1.19209112e-03
  2.21540264e-03  3.14844097e-03  5.38284371e-03  3.15776156e-02
  4.78907517e-03  3.23672091e-02  2.21925783e-02  2.16735988e-03
  6.95603778e-03  2.56501067e-03  2.36533866e-03  2.27863468e-02
 -1.06568697e-03  2.09876914e-02  1.82476970e-03  3.51164657e-02
  2.55250610e-02  2.29633094e-02  4.19085845e-02  5.29720586e-02
  3.09483637e-02  2.87260690e-02  3.99399673e-03  2.47285190e-02
  1.58175485e-02  5.93662084e-03  4.95172108e-02  1.67928173e-02
  1.31656124e-03  1.26346815e-03  2.58492223e-03  4.65052342e-02
  4.54378973e-03  1.98119895e-02  3.27144136e-04  4.40565758e-02
  2.97789602e-02  4.99347731e-02  5.51905849e-03  2.53129708e-03
 -9.88415972e-04  1.72338472e-02  2.42487971e-02  2.74105088e-02
  2.54214662e-02  4.59911942e-02  5.30341758e-02  3.62277462e-02
  6.58542525e-02  2.43174233e-03  1.72103796e-02  1.99071246e-03
  1.15882176e-02  3.45917488e-02  1.23004657e-02  9.15068704e-03
  1.52825064e-02  8.14077378e-03  5.53405100e-02  3.42294534e-02
  4.54819227e-02  1.24405004e-02  5.79310038e-02  9.62472992e-04
  2.40827481e-03  4.44648499e-03  6.17468215e-03  3.15967931e-02
  3.38402018e-02  8.18625592e-03  6.07541448e-03  6.65463117e-03
  1.87724306e-02  5.97318532e-03  6.58338269e-02  2.72371587e-03
  1.49132954e-02  1.38003534e-03  6.27976238e-02  2.69436378e-02
  1.07412213e-01  8.40729578e-02  5.67219015e-03  6.11322002e-03
  5.33351710e-02  3.88494615e-02  6.22752811e-02  3.23694540e-02
 -9.64948455e-04  1.03895248e-01  1.66615891e-02  3.55296686e-03
  4.58139923e-02  1.02035782e-02  8.49500941e-04  2.18499881e-02
  7.83512693e-03  2.95156624e-02  3.03394506e-02  6.00502271e-02
  4.89867530e-02  1.24317767e-02  1.19308078e-02  3.17734405e-02
  4.99582406e-02  1.33098905e-02  3.97052921e-03  3.72267392e-02
  4.79248337e-02  4.24622936e-02  8.07092980e-03  2.51089398e-02
  5.20589071e-02  4.41900942e-02  9.72507547e-04  2.97830946e-02
  7.62989993e-03  7.35055856e-02  2.65252384e-02  6.08218766e-02
  5.42876188e-02  2.76551183e-02  8.10206796e-02  7.81300334e-02
  4.69692140e-03  2.66405645e-02  3.51251391e-02  2.88909965e-02
  2.56974086e-02  2.63852037e-02  3.67109721e-02  6.08975250e-03
  2.35781853e-02  4.42770358e-02  3.52236865e-02  2.34553745e-02
  3.66952250e-02  3.90299563e-02  1.53212788e-02]
2025-06-24 09:50:36,842 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:36,843 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:36,843 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:36,844 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:36,860 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:36,868 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:36,868 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:36,868 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:36,868 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:36,868 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:36,868 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:36,868 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:36,868 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:36,868 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:36,868 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:36,868 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:36,868 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:36,869 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:36,869 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:36,869 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:36,869 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:36,869 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,869 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,869 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:36,869 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:36,889 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:36,889 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:37,304 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = lightgbm
2025-06-24 09:50:39,226 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:39,227 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:39,227 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:39,227 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:39,227 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:39,227 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:39,227 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:39,243 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:39,709 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:39,710 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:39,710 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:39,710 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:39,710 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:39,710 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:39,710 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:39,710 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:39,710 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:39,855 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:39,855 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:39,855 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:39,855 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:40,996 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:41,879 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:41,879 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:41,885 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:41,912 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:41,912 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:41,912 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:41,912 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:42,923 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:43,361 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:43,361 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:43,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:43,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:43,566 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:43,566 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:43,566 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:43,566 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:43,566 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:43,566 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:43,615 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:43,615 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:43,615 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:43,615 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:43,615 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:43,615 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:43,615 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:43,671 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:43,671 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:43,671 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:43,806 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:43,806 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:43,806 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:43,806 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:43,806 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:43,807 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:43,807 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:43,807 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:43,807 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:43,807 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:43,807 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:43,807 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:43,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:43,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:43,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:43,880 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:43,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:43,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:44,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:44,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:44,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:44,181 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:44,181 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:44,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:44,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:44,265 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:44,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:44,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:44,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:44,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:44,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:44,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:44,410 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:44,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,436 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:44,436 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,436 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:44,443 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   learning_rate: 0.2986164631467998
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   n_estimators: 446
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   subsample: 0.8551720469993793
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6327085885569078
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   reg_alpha: 7.703681668328675e-06
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO -   reg_lambda: 6.634521545517012e-07
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:44,450 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:44,542 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:44,542 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513960055779354})})
2025-06-24 09:50:44,542 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 09:50:44,542 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:44,542 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:44,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:44,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:44,574 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:44,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:44,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:44,655 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:44,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:44,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:44,717 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:44,717 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:44,726 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:44,726 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:44,726 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:44,726 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:44,726 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,726 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:44,727 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:44,732 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:44,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:44,742 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 0.00067918  0.0012818   0.00138941  0.00197827  0.0016222   0.00361032
  0.00358185  0.00383051  0.00344622  0.00115271  0.02722333  0.00494411
  0.0026673   0.00530019  0.06880043  0.0295811   0.00208588  0.0030343
  0.0008298   0.00291385  0.00523165  0.00592812  0.00307521  0.00925004
  0.03080965  0.00693224  0.00233783 -0.00056572  0.00241687  0.02077684
  0.02476572  0.00189189  0.02628031  0.0185696   0.00274395 -0.00094572
  0.00213219  0.00418658  0.0039654   0.00635621  0.0054078   0.01687964
  0.02620389  0.0024974   0.00228067  0.02995693  0.00269724  0.02786267
  0.0022522   0.05319411  0.00524261  0.00119542  0.00189769  0.0035705
  0.0062562   0.03803901  0.00555974  0.03899705  0.02667587  0.00237874
  0.00813643  0.00286714  0.00263883  0.02737233 -0.00212904  0.02491473
  0.00174556  0.04172972  0.03063974  0.02758145  0.04944595  0.06286956
  0.03671445  0.03401808  0.0041353   0.02955263  0.01865724  0.00690376
  0.05922335  0.01984056  0.0009997   0.00098281  0.00288538  0.05563571
  0.00521381  0.02320239 -0.00043908  0.05257699  0.03558141  0.05972999
  0.00639712  0.00223527 -0.00260211  0.02037567  0.02909121  0.03185505
  0.03054524  0.05526638  0.06322874  0.04342013  0.07902469  0.00244187
  0.0203472   0.00190676  0.01359181  0.04126037  0.014456    0.01026675
  0.01824337  0.00957812  0.06659591  0.04074119  0.05493344  0.0146259
  0.0695785   0.0006176   0.0024134   0.00492656  0.00678119  0.0378286
  0.04018119  0.00924636  0.00707217  0.007388    0.02209085  0.00620766
  0.07934197  0.00305378  0.01705493  0.00112424  0.07507499  0.03150546
  0.12920705  0.10088891  0.00584246  0.00637757  0.06359394  0.04660113
  0.07444121  0.038564   -0.00257364  0.12520166  0.01991665  0.00360019
  0.05528803  0.01183008  0.00056224  0.02604269  0.00810372  0.03497612
  0.03581023  0.07182077  0.05839716  0.01429349  0.01422499  0.03830058
  0.05975847  0.01589827  0.00410683  0.0446771   0.05746223  0.05126965
  0.00910643  0.02997425  0.06204542  0.05301929  0.00094887  0.03513519
  0.00857132  0.08793847  0.03169268  0.07279537  0.06503259  0.03286845
  0.09711856  0.09391922  0.00465914  0.03183261  0.04231896  0.03380641
  0.03013958  0.03152278  0.04350263  0.0063491   0.02789732  0.0531723
  0.04221107  0.02774831  0.04398867  0.04610827  0.01806296]
2025-06-24 09:50:44,742 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:44,742 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:44,743 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:44,743 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:44,760 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:44,768 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:44,768 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:44,768 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:44,768 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:44,768 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:44,768 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:44,768 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:44,768 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:44,768 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:44,768 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:44,768 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:44,768 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:44,768 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:44,768 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:44,768 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:44,768 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:44,768 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,768 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,768 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:44,768 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:44,789 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:44,789 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:45,201 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = lightgbm
2025-06-24 09:50:47,125 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:47,125 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:47,125 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:47,125 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:47,125 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:47,125 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:47,125 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:47,142 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:47,611 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:47,611 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:47,611 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:47,611 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:47,611 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:47,611 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:47,611 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:47,611 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:47,611 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:47,753 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:47,753 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:47,753 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:47,753 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:48,903 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:49,797 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:49,797 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:49,802 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:49,830 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:49,830 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:49,830 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:49,830 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:50,885 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:51,318 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:51,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:51,454 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:51,454 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:51,523 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:51,523 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:51,523 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:51,523 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:51,523 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:51,523 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:51,573 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:51,573 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:51,573 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:51,573 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:51,573 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:51,573 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:51,573 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:51,628 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:51,628 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:51,628 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:51,762 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:51,763 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:51,763 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:51,763 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:51,763 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:51,763 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:51,763 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:51,763 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:51,763 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:51,763 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:51,763 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:51,763 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:51,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:51,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:51,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:51,836 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:51,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:51,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:51,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:52,054 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:52,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:52,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:50:52,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:50:52,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:52,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:52,216 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:52,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:52,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:52,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:52,324 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:52,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:52,358 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:52,358 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:50:52,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,385 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:52,385 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,385 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:50:52,393 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   learning_rate: 0.09793882584456802
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   n_estimators: 123
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   subsample: 0.9640586492533287
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435146090531931
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   reg_alpha: 0.012306593994534086
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003273769666730943
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:50:52,399 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:50:52,503 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:50:52,504 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513870146512441})})
2025-06-24 09:50:52,504 - src.models.lightgbm_model - INFO -   - Best Iteration: 8
2025-06-24 09:50:52,504 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:50:52,504 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:50:52,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:50:52,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:52,536 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:52,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:52,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:52,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:52,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:50:52,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:50:52,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:50:52,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:50:52,692 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:50:52,692 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:50:52,692 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:50:52,692 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:50:52,692 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,692 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,692 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:50:52,692 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:50:52,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:50:52,705 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:50:52,707 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00066555 0.00146457 0.00131551 ... 0.00306378 0.00986033 0.00335861]
2025-06-24 09:50:52,707 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:50:52,708 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:52,708 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:52,709 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:52,725 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:50:52,733 - src.training - INFO -   precision: 0.0
2025-06-24 09:50:52,733 - src.training - INFO -   recall: 0.0
2025-06-24 09:50:52,733 - src.training - INFO -   f1: 0.0
2025-06-24 09:50:52,733 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:50:52,733 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:50:52,733 - src.training - INFO -   positive_samples: 456
2025-06-24 09:50:52,733 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:50:52,733 - src.training - INFO -   total_samples: 368238
2025-06-24 09:50:52,733 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:50:52,733 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:50:52,733 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:50:52,733 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:50:52,733 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:50:52,733 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:50:52,733 - src.training - INFO - 모델 학습 완료
2025-06-24 09:50:52,734 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:50:52,734 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,734 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,734 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:52,734 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:52,754 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:50:52,754 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:50:53,183 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = lightgbm
2025-06-24 09:50:55,101 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:50:55,101 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:50:55,101 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:50:55,101 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:50:55,101 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:50:55,101 - src.training - INFO - 교차 검증 시작
2025-06-24 09:50:55,101 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:50:55,119 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:50:55,586 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:50:55,586 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:50:55,586 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:50:55,586 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:50:55,586 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:50:55,586 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:50:55,586 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:50:55,586 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:50:55,586 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:50:55,729 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:50:55,729 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:50:55,729 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:50:55,729 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:50:56,853 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:50:57,743 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:57,743 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:50:57,748 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:50:57,777 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:50:57,777 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:50:57,777 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:50:57,777 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:50:58,811 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:50:59,244 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:50:59,244 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:59,379 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:59,379 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:50:59,448 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:50:59,448 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:59,448 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:50:59,448 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:50:59,448 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:59,448 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:50:59,498 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:50:59,498 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:50:59,498 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:59,498 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:59,498 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:50:59,498 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:50:59,498 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:50:59,555 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:59,555 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:50:59,555 - src.training - INFO - 모델 학습 시작
2025-06-24 09:50:59,696 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:50:59,696 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:50:59,696 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:50:59,696 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:50:59,696 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:50:59,696 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:50:59,696 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:50:59,696 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:50:59,696 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:50:59,696 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:50:59,696 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:50:59,696 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:50:59,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:50:59,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:50:59,696 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:50:59,770 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:50:59,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:50:59,878 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:50:59,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:50:59,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:00,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:00,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:00,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:00,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:00,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:00,151 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:00,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:00,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:00,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:00,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:00,291 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:00,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:00,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:00,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,322 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:00,322 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,322 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:00,330 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   learning_rate: 0.13733093633534701
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:00,335 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   n_estimators: 87
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   subsample: 0.8965101815345152
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6091730541587009
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   reg_alpha: 0.4907237459022601
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO -   reg_lambda: 6.576001803087445e-05
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:00,336 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:00,444 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:00,444 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513647176245424})})
2025-06-24 09:51:00,444 - src.models.lightgbm_model - INFO -   - Best Iteration: 7
2025-06-24 09:51:00,444 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:00,445 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:00,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:00,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:00,477 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:00,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:00,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:00,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:00,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:00,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:00,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:00,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:00,629 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:00,630 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:00,630 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:00,630 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:00,630 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,630 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:00,630 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:00,635 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:00,642 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:00,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00058277 0.00149023 0.00129033 ... 0.00671701 0.00602962 0.01661093]
2025-06-24 09:51:00,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:00,645 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:00,645 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:00,646 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:00,662 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:00,670 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:00,670 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:00,670 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:00,670 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:00,670 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:00,670 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:00,670 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:00,670 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:00,670 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:00,670 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:00,670 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:00,670 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:00,670 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:00,670 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:00,670 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:00,670 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:00,670 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,670 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,670 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:00,670 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:00,692 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:00,692 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:01,107 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = lightgbm
2025-06-24 09:51:03,033 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:03,033 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:03,033 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:03,033 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:03,033 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:03,033 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:03,033 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:03,049 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:03,515 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:03,515 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:03,515 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:03,515 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:03,515 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:03,515 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:03,515 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:03,515 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:03,515 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:03,658 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:03,658 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:03,658 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:03,658 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:03,658 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:03,658 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:03,658 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:03,658 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:03,658 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:03,659 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:04,802 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:05,698 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:05,698 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:05,703 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:05,731 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:05,731 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:05,731 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:05,731 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:06,783 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:07,215 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:07,215 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:07,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:07,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:07,419 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:07,419 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:07,419 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:07,419 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:07,419 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:07,419 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:07,471 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:07,471 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:07,471 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:07,471 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:07,471 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:07,471 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:07,471 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:07,527 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:07,527 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:07,527 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:07,663 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:07,663 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:07,663 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:07,663 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:07,663 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:07,663 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:07,663 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:07,663 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:07,663 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:07,663 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:07,663 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:07,663 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:07,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:07,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:07,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:07,737 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:07,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:07,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:07,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:07,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:08,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:08,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:08,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:08,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:08,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:08,113 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:08,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:08,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:08,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:08,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:08,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:08,255 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:08,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:08,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,282 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:08,282 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,282 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:08,290 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   learning_rate: 0.21326734344408033
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   n_estimators: 539
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   subsample: 0.9673242456454179
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7044942853722713
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   reg_alpha: 0.059174749853088904
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02588182777279751
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:08,295 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:08,377 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:08,377 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035141547432815515})})
2025-06-24 09:51:08,377 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 09:51:08,377 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:08,378 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:08,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:08,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:08,411 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:08,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:08,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:08,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:08,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:08,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:08,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:08,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:08,567 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:08,567 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:08,567 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:08,567 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:08,567 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,567 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,567 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:08,567 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:08,573 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:08,580 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:08,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 0.00079718  0.00125064  0.0013275   0.00186675  0.00161245  0.00303233
  0.003012    0.00355743  0.00331002  0.00150584  0.01989638  0.0009561
  0.00221707  0.00349648  0.05055694  0.01832152  0.02169396  0.0019436
  0.00262095  0.00133039  0.00241623  0.00324218  0.00407156  0.00468767
  0.00265017  0.0063174   0.0224313   0.00466207  0.00200484  0.00027856
  0.00259505  0.0296932   0.01836989  0.00180506  0.01908112  0.0077449
  0.00229488  0.00244744  0.0018349   0.00381173  0.00370098  0.00425068
  0.00357334  0.00653795  0.01934646  0.00209572  0.00221654  0.02281551
  0.00225464  0.02046668  0.00219621  0.03855801  0.00456593  0.00118895
  0.00220408  0.00492198  0.02762078  0.00430588  0.028305    0.0193867
  0.00203406  0.00663265  0.00237599  0.00219673  0.0200028   0.00160233
  0.01847631  0.00183437  0.03086592  0.02230995  0.02006778  0.03698605
  0.04657299  0.02934377  0.02741806  0.00382233  0.02167362  0.01398921
  0.00464173  0.04333543  0.01483432  0.00145173  0.00138449  0.00239589
  0.04058296  0.00343479  0.01969366  0.00280928  0.03861288  0.02609429
  0.04369726  0.0042799   0.00471926  0.00334564 -0.00018588  0.01521649
  0.02120402  0.0244229   0.03660545  0.03899872  0.04650001  0.02768788
  0.05750142  0.01519616  0.00199382  0.01029478  0.03033648  0.0361483
  0.01091198  0.01045522  0.01274031  0.00655172  0.0197414   0.04824438
  0.02994552  0.03956783  0.01103332  0.05056086  0.00112367  0.00235565
  0.00410619  0.00571198  0.02764865  0.02975999  0.00313227  0.004762
  0.01230561  0.00568439  0.05334272  0.00251616  0.01343135  0.0014855
  0.05496042  0.02392144  0.09362071  0.07339633  0.00542357  0.00580574
  0.04676083  0.0299597   0.05450779  0.02841078 -0.00016555  0.09045613
  0.01393534  0.00344016  0.03919704  0.00913145  0.00098926  0.01918701
  0.00746006  0.02810228  0.05254427  0.04295734  0.01105697  0.01049447
  0.02768889  0.0437176   0.0116895   0.00380199  0.03252437  0.00507725
  0.03756731  0.0369512   0.02202382  0.0456549   0.03860333  0.00098979
  0.07765902  0.0232511   0.00328395  0.04956815  0.07078132  0.06813887
  0.00457846  0.02335103  0.02993473  0.0227762   0.03231989  0.0057854
  0.02079279  0.03865744  0.04778453  0.02068637  0.03208054  0.00738306
  0.01851413]
2025-06-24 09:51:08,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:08,583 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:08,584 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:08,584 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:08,601 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:08,608 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:08,608 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:08,609 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:08,609 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:08,609 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:08,609 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:08,609 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:08,609 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:08,609 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:08,609 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:08,609 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:08,609 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:08,609 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:08,609 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:08,609 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:08,609 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:08,609 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,609 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,609 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:08,609 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:08,629 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:08,629 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:09,047 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = lightgbm
2025-06-24 09:51:11,015 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:11,015 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:11,015 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:11,015 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:11,015 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:11,015 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:11,015 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:11,031 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:11,494 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:11,494 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:11,494 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:11,494 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:11,494 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:11,494 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:11,494 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:11,494 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:11,494 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:11,634 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:11,634 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:11,634 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:11,634 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:12,768 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:13,652 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:13,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:13,658 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:13,686 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:13,686 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:13,686 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:13,686 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:14,746 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:15,182 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:15,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:15,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:15,318 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:15,387 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:15,387 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:15,387 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:15,387 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:15,387 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:15,387 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:15,439 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:15,439 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:15,439 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:15,439 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:15,439 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:15,439 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:15,439 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:15,494 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:15,494 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:15,494 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:15,629 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:15,629 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:15,629 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:15,629 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:15,629 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:15,629 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:15,629 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:15,629 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:15,629 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:15,629 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:15,629 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:15,629 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:15,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:15,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:15,629 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:15,703 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:15,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:15,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:15,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:15,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:15,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:15,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:15,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:16,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:16,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:16,083 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:16,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:16,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:16,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:16,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:16,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:16,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:16,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,251 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:16,251 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,251 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:16,258 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   learning_rate: 0.05625048885017797
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   n_estimators: 651
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   subsample: 0.9936644823981703
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6776465721915215
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00018101280841052082
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO -   reg_lambda: 2.2021620859017483
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:16,264 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:16,397 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:16,397 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512763495893405})})
2025-06-24 09:51:16,397 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:51:16,397 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:16,397 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:16,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:16,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:16,429 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:16,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:16,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:16,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:16,540 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:16,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:16,574 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:16,574 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:16,585 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:16,586 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:16,586 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:16,586 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:16,586 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,586 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,586 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:16,586 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:16,592 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:16,599 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:16,600 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00066852 0.00144523 0.0013782  ... 0.0042831  0.00846299 0.00679378]
2025-06-24 09:51:16,601 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:16,601 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:16,602 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:16,602 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:16,619 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:16,627 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:16,627 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:16,627 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:16,627 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:16,627 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:16,627 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:16,627 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:16,627 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:16,627 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:16,627 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:16,627 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:16,627 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:16,627 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:16,627 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:16,627 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:16,627 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:16,627 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,627 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,627 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:16,627 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:16,648 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:16,648 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:17,074 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = lightgbm
2025-06-24 09:51:18,991 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:18,991 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:18,991 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:18,991 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:18,991 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:18,991 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:18,991 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:19,009 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:19,476 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:19,476 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:19,476 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:19,476 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:19,476 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:19,476 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:19,476 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:19,476 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:19,476 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:19,622 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:19,622 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:19,622 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:19,622 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:20,748 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:21,635 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:21,635 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:21,639 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:21,667 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:21,667 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:21,667 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:21,667 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:22,729 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:23,168 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:23,168 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:23,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:23,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:23,372 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:23,372 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:23,372 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:23,372 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:23,372 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:23,372 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:23,421 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:23,421 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:23,421 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:23,421 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:23,421 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:23,421 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:23,421 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:23,479 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:23,479 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:23,479 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:23,610 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:23,610 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:23,610 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:23,610 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:23,610 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:23,610 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:23,610 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:23,611 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:23,611 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:23,611 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:23,611 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:23,611 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:23,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:23,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:23,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:23,684 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:23,740 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:23,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:23,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:23,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:23,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:23,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:23,979 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:24,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:24,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:24,061 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:24,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:24,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:24,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:24,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:24,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:24,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:24,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:24,230 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,230 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:24,230 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,230 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:24,239 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   learning_rate: 0.08474924091905767
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   n_estimators: 179
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   subsample: 0.9332399755244474
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6557272282328251
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0012292771784949972
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0023872846722201887
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:24,244 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:24,380 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:24,380 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513763104359215})})
2025-06-24 09:51:24,380 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:51:24,380 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:24,382 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:24,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:24,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:24,416 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:24,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:24,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:24,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:24,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:24,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:24,559 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:24,559 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:24,572 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:24,572 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:24,572 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:24,572 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:24,572 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,572 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:24,572 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:24,578 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:24,585 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:24,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00056199 0.00151649 0.0013014  ... 0.02090783 0.01726615 0.00946701]
2025-06-24 09:51:24,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:24,587 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:24,588 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:24,588 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:24,605 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:24,613 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:24,613 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:24,613 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:24,613 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:24,613 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:24,613 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:24,613 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:24,613 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:24,613 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:24,613 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:24,613 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:24,613 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:24,613 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:24,613 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:24,613 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:24,613 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:24,613 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,613 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,613 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:24,613 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:24,634 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:24,634 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:25,061 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = lightgbm
2025-06-24 09:51:26,997 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:26,998 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:26,998 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:26,998 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:26,998 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:26,998 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:26,998 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:27,016 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:27,482 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:27,482 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:27,482 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:27,482 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:27,482 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:27,482 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:27,482 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:27,482 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:27,482 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:27,622 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:27,622 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:27,622 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:27,622 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:27,622 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:27,622 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:27,622 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:27,622 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:27,622 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:27,623 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:28,740 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:29,596 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:29,596 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:29,602 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:29,630 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:29,630 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:29,630 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:29,630 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:30,647 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:31,086 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:31,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:31,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:31,221 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:31,289 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:31,290 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:31,290 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:31,290 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:31,290 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:31,290 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:31,339 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:31,339 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:31,339 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:31,339 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:31,339 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:31,339 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:31,339 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:31,394 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:31,394 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:31,394 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:31,527 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:31,527 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:31,528 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:31,528 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:31,528 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:31,528 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:31,528 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:31,528 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:31,528 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:31,528 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:31,528 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:31,528 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:31,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:31,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:31,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:31,602 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:31,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:31,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:31,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:31,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:31,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:31,904 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:31,904 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:31,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:31,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:31,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:31,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:31,958 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:31,988 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:32,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:32,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:32,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:32,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:32,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:32,130 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:32,130 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:32,156 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:32,156 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:32,156 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:32,156 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:32,156 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:32,165 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   learning_rate: 0.012214781803232549
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   n_estimators: 319
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   subsample: 0.9011353546076427
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8923112812273108
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   reg_alpha: 1.819220639207179e-07
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5563198677214068e-05
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:32,170 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:32,708 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:32,708 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.0351225552306937})})
2025-06-24 09:51:32,708 - src.models.lightgbm_model - INFO -   - Best Iteration: 108
2025-06-24 09:51:32,708 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:32,709 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:32,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:32,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:32,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:32,742 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:32,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:32,799 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:32,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:32,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:32,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:32,892 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:32,892 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:32,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:32,942 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:32,943 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:32,943 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:32,943 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:32,943 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:32,943 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:32,943 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:32,943 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:32,949 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:32,956 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:32,959 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00042211 0.00041672 0.0004098  ... 0.00071915 0.00315338 0.00408066]
2025-06-24 09:51:32,959 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:32,960 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:32,960 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:32,961 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:32,977 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:32,984 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:32,984 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:32,984 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:32,984 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:32,984 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:32,984 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:32,984 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:32,984 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:32,984 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:32,984 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:32,984 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:32,984 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:32,985 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:32,985 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:32,985 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:32,985 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:32,985 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:32,985 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:32,985 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:32,985 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:33,005 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:33,006 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:33,432 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = lightgbm
2025-06-24 09:51:35,386 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:35,386 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:35,386 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:35,386 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:35,386 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:35,386 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:35,386 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:35,404 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:35,871 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:35,871 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:35,871 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:35,871 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:35,871 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:35,871 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:35,871 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:35,871 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:35,871 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:36,008 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:36,008 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:36,008 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:36,008 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:37,144 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:38,032 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:38,032 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:38,036 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:38,064 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:38,064 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:38,064 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:38,064 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:39,128 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:39,545 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:39,545 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:39,679 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:39,679 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:39,745 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:39,745 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:39,745 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:39,745 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:39,745 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:39,745 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:39,799 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:39,799 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:39,799 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:39,799 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:39,799 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:39,799 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:39,799 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:39,847 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:39,847 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:39,847 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:39,961 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:39,961 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:39,961 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:39,961 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:39,961 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:39,961 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:39,961 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:39,961 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:39,961 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:39,961 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:39,961 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:39,961 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:39,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:39,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:39,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:40,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:40,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:40,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:40,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:40,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:40,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:40,287 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:40,287 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:40,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:40,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:40,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:40,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:40,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:40,376 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:40,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:40,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:40,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:40,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:40,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:40,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:40,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:40,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:40,526 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:40,526 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:40,526 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:40,526 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:40,535 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   learning_rate: 0.03507645979363265
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   n_estimators: 761
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   subsample: 0.9824694942087706
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7417033228523667
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   reg_alpha: 0.004366446105347352
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO -   reg_lambda: 2.675638978946855e-07
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:40,540 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:40,779 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:40,779 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035128446341181646})})
2025-06-24 09:51:40,779 - src.models.lightgbm_model - INFO -   - Best Iteration: 39
2025-06-24 09:51:40,779 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:40,780 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:40,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:40,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:40,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:40,809 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:40,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:40,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:40,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:40,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:40,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:40,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:40,941 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:40,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:40,962 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:40,963 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:40,963 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:40,963 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:40,963 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:40,963 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:40,963 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:40,963 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:40,969 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:40,977 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:40,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00048925 0.00172714 0.00153781 ... 0.00180213 0.00318027 0.00293137]
2025-06-24 09:51:40,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:40,980 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:40,980 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:40,981 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:40,996 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:41,004 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:41,004 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:41,004 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:41,004 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:41,004 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:41,004 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:41,004 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:41,004 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:41,004 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:41,004 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:41,004 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:41,004 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:41,004 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:41,004 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:41,004 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:41,004 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:41,004 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:41,004 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:41,004 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:41,004 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:41,025 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:41,025 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:41,446 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = lightgbm
2025-06-24 09:51:43,320 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:43,320 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:43,322 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:43,322 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:43,322 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:43,322 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:43,322 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:43,340 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:43,791 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:43,791 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:43,791 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:43,791 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:43,791 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:43,791 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:43,791 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:43,791 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:43,791 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:43,955 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:43,955 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:43,955 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:43,955 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:43,956 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:43,956 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:43,956 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:43,956 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:43,956 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:43,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:45,023 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:45,898 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:45,898 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:45,903 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:45,935 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:45,935 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:45,935 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:45,935 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:46,945 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:47,363 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:47,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:47,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:47,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:47,565 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:47,565 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:47,565 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:47,565 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:47,565 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:47,565 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:47,616 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:47,616 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:47,616 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:47,616 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:47,616 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:47,616 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:47,616 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:47,666 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:47,666 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:47,666 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:47,802 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:47,802 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:47,802 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:47,802 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:47,802 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:47,802 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:47,802 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:47,802 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:47,802 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:47,802 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:47,802 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:47,802 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:47,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:47,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:47,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:47,865 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:47,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:47,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:48,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:48,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:48,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:48,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:48,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:48,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:48,185 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:48,215 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:48,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:48,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:48,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:48,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:48,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:48,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:48,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:48,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,370 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:48,370 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,370 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:48,379 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   learning_rate: 0.06459184368410763
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   n_estimators: 384
2025-06-24 09:51:48,384 - src.models.lightgbm_model - INFO -   subsample: 0.8774992037260307
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.702163125786101
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO -   reg_alpha: 2.160303535766916e-08
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1500879799835756e-06
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:48,385 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:48,523 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:48,523 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.0351305539709006})})
2025-06-24 09:51:48,523 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:51:48,523 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:48,525 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:48,556 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:48,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:48,606 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:48,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:48,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:48,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:48,688 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:48,689 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:48,704 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:48,704 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:48,704 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:48,704 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:48,704 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,704 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,704 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:48,704 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:48,710 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:48,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:48,719 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00062115 0.00153381 0.0014516  ... 0.0048086  0.01022068 0.01323608]
2025-06-24 09:51:48,719 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:48,720 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:48,720 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:48,721 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:48,736 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:48,743 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:48,743 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:48,743 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:48,743 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:48,743 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:48,743 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:48,743 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:48,743 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:48,743 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:48,743 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:48,743 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:48,743 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:48,744 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:48,744 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:48,744 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:48,744 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:48,744 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,744 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,744 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:48,744 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:48,765 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:48,765 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:49,182 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = lightgbm
2025-06-24 09:51:51,073 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:51,074 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:51,074 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:51,074 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:51,074 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:51,074 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:51,074 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:51,091 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:51,556 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:51,557 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:51,557 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:51,557 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:51,557 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:51,557 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:51,557 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:51,557 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:51,557 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:51,713 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:51,713 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:51,714 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:51,714 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:51,714 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:51,714 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:51,714 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:51,714 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:51,714 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:51,714 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:51:52,798 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:51:53,685 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:53,685 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:51:53,691 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:51:53,719 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:51:53,719 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:51:53,719 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:51:53,719 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:54,776 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:51:55,213 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:51:55,213 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:55,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:55,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:51:55,419 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:51:55,419 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:55,419 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:51:55,419 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:51:55,419 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:55,419 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:55,477 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:51:55,478 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:51:55,478 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:55,478 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:55,478 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:51:55,478 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:51:55,478 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:55,533 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:55,533 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:51:55,533 - src.training - INFO - 모델 학습 시작
2025-06-24 09:51:55,651 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:51:55,651 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:51:55,651 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:51:55,651 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:51:55,651 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:51:55,651 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:51:55,651 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:51:55,651 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:51:55,651 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:55,651 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:51:55,651 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:51:55,651 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:51:55,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:51:55,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:55,651 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:55,725 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:55,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:55,835 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:55,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:55,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:56,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:56,016 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:51:56,016 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:51:56,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:56,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:56,101 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:56,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:56,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:56,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:56,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:56,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:56,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:56,246 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:51:56,271 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,271 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:51:56,271 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,271 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:51:56,280 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   learning_rate: 0.10017283165371263
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   n_estimators: 73
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   subsample: 0.8373072645672719
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8564848185348581
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   reg_alpha: 6.266565809920671
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO -   reg_lambda: 0.2714317924622672
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:51:56,284 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:51:56,419 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:51:56,419 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035138098167075124})})
2025-06-24 09:51:56,419 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 09:51:56,419 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:51:56,421 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:51:56,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:51:56,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,421 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:51:56,452 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:51:56,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:51:56,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:51:56,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:51:56,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:51:56,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:51:56,598 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:51:56,598 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:51:56,608 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:51:56,608 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:51:56,608 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:51:56,608 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:51:56,608 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,608 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,608 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:51:56,608 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:51:56,614 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:51:56,621 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:51:56,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00053468 0.0015375  0.00125682 ... 0.01280625 0.0362526  0.01429465]
2025-06-24 09:51:56,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:51:56,624 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:56,624 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:56,625 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:56,642 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:51:56,649 - src.training - INFO -   precision: 0.0
2025-06-24 09:51:56,649 - src.training - INFO -   recall: 0.0
2025-06-24 09:51:56,649 - src.training - INFO -   f1: 0.0
2025-06-24 09:51:56,649 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:51:56,649 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:51:56,649 - src.training - INFO -   positive_samples: 456
2025-06-24 09:51:56,649 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:51:56,649 - src.training - INFO -   total_samples: 368238
2025-06-24 09:51:56,650 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:51:56,650 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:51:56,650 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:51:56,650 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:51:56,650 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:51:56,650 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:51:56,650 - src.training - INFO - 모델 학습 완료
2025-06-24 09:51:56,650 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:51:56,650 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,650 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,650 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:51:56,650 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:51:56,669 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:51:56,669 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:51:57,097 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = lightgbm
2025-06-24 09:51:59,048 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:51:59,048 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:51:59,048 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:51:59,048 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:51:59,048 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:51:59,048 - src.training - INFO - 교차 검증 시작
2025-06-24 09:51:59,048 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:51:59,066 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:51:59,534 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:51:59,534 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:51:59,534 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:51:59,534 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:51:59,534 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:51:59,534 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:51:59,534 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:51:59,534 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:51:59,534 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:51:59,672 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:51:59,672 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:51:59,672 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:51:59,672 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:00,808 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:01,693 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:01,693 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:01,699 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:01,727 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:01,727 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:01,727 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:01,728 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:02,780 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:03,227 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:03,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:03,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:03,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:03,432 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:03,432 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:03,432 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:03,432 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:03,432 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:03,432 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:03,491 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:03,491 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:03,491 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:03,491 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:03,491 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:03,491 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:03,491 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:03,546 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:03,547 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:03,547 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:03,663 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:03,664 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:03,664 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:03,664 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:03,664 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:03,664 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:03,664 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:03,664 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:03,664 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:03,664 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:03,664 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:03,664 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:03,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:03,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:03,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:03,737 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:03,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:03,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:03,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:03,953 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:04,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:04,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:04,029 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:04,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:04,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:04,114 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:04,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:04,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:04,194 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:04,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:04,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:04,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:04,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:04,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,284 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:04,284 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,284 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:04,293 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:04,297 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   learning_rate: 0.19354396033060667
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   n_estimators: 461
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   subsample: 0.8193951276727495
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7785557445809279
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00027869312762492945
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00013688798527848386
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:04,298 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:04,396 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:04,396 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035135862161370046})})
2025-06-24 09:52:04,396 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 09:52:04,396 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:04,397 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:04,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:04,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:04,432 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:04,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:04,488 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:04,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:04,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:04,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:04,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:04,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,584 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:04,587 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:04,587 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:04,587 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:04,587 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:04,587 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,587 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:04,587 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:04,593 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:04,600 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:04,604 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 6.02900740e-04  1.28202608e-03  1.42039699e-03  1.49014439e-03
  1.66794273e-03  8.58772870e-04  1.98614094e-03  1.61009730e-03
  2.35943148e-03  1.35177349e-03  1.65320460e-03  1.09158048e-03
  1.84290491e-03  2.82302218e-03  2.21894856e-03  1.94797557e-04
  2.59223910e-03  9.46121987e-04  1.69545617e-03  1.85456881e-03
  3.14314247e-03  2.88021610e-03  2.59021456e-03  3.38464048e-03
  2.43246388e-03  3.80711778e-03  1.52957182e-03  5.50382391e-03
  1.82030996e-02  1.17946310e-02  2.55557443e-03  1.89147439e-03
  2.51854413e-03  3.63787598e-03  2.80680715e-03  2.23469564e-03
  4.15276494e-02  3.78866292e-03  3.57155675e-02  4.13397466e-03
  2.89867095e-03  1.48337121e-03  1.99598666e-03  7.15978701e-04
  3.27466321e-03  1.51823349e-03  2.89314731e-03  7.31261808e-03
  3.31544652e-03  3.40709289e-03  2.14734652e-03  2.65996197e-03
  3.84206358e-03  4.01986192e-03  4.77898606e-03  1.13546523e-03
  4.81769345e-03  7.17876592e-03  2.51761499e-03  5.32969307e-03
  2.32740336e-03  3.92628582e-03  6.25935979e-03  2.58315153e-03
  1.11353389e-02  6.74052047e-03  2.94916980e-02  3.01889210e-03
  2.26955792e-03  4.46657840e-03  3.55813158e-03  3.31942260e-03
  4.04410110e-03  1.72295201e-03  9.79220461e-03  1.49624560e-02
  1.61096118e-02  4.23394412e-03  5.23827354e-03  9.50783983e-03
  2.84838793e-03  1.76405789e-02  1.46619255e-02  2.28264397e-03
  2.28869597e-03  3.88119047e-03  1.29457788e-03  5.21298313e-02
  1.42548871e-02  2.94432239e-03  3.67500772e-02  2.51249288e-02
  5.81519043e-03  3.99125907e-03  1.51215687e-02  3.56895986e-03
  1.39125913e-02  1.40873877e-02  3.35280108e-03  1.74517751e-02
  8.13818241e-03  2.00787366e-03  2.40749169e-03  3.22172985e-03
  4.21324211e-03  5.29943101e-03  5.99677479e-03  2.45998123e-03
  4.08539847e-03  4.59756535e-03  8.63702614e-03  8.64504880e-03
  2.19404604e-03  7.28883451e-03  1.77294565e-03  2.23368669e-03
  1.43599573e-03  4.36475774e-03  4.32232462e-03  3.43377586e-03
  4.25023037e-03  5.80971269e-03  5.38343741e-03  3.86335041e-02
  8.91226115e-03  3.47853524e-03  3.75935652e-02  6.61302196e-03
  3.17800475e-03  9.91495123e-05  2.44435426e-03  1.78135109e-03
  2.05588835e-03  1.11800394e-02  4.92174457e-02  3.48261969e-03
  6.19791348e-03  1.94044488e-02  2.81144656e-03  1.88217993e-02
  2.89276959e-03  3.46989151e-04  2.77381452e-02  2.55547045e-03
  5.32656558e-02  5.04920639e-03  1.51946751e-02  2.65598589e-03
  7.30755432e-03  2.67058959e-03  2.67356177e-03  5.20363034e-04
  1.42880986e-03  3.76068412e-03  3.08943921e-03  2.34283907e-02
  1.05503060e-02  1.74527461e-02  1.45361807e-02  3.99349173e-03
  4.29804267e-03  2.67810396e-02  6.02783463e-03  3.21066658e-02
  3.90450094e-02  2.05117820e-02  3.19916617e-03  4.76394911e-03
  3.00321590e-03  1.70264708e-02  1.59510837e-03  4.08949043e-03
  5.70082900e-03  2.02936515e-03 -2.85642946e-03  2.12889167e-03
  1.52401705e-03  3.93960157e-03  1.96647472e-03  5.49350600e-03
  1.00396742e-03  5.96882534e-03  7.88914923e-04  5.80090486e-03
  4.64371643e-03  2.14427306e-03  2.10775260e-02  5.33731417e-03
  1.68125181e-02  3.99699770e-03  1.11604628e-02  2.16603668e-02
  2.17554322e-02  1.11615845e-02  3.49425752e-03  1.55242239e-02
  2.23632562e-03  3.83128399e-03  6.55352924e-03  4.73630205e-03
  4.07797248e-03  2.10881036e-02  2.48976128e-02  1.15070958e-02
  5.38305968e-03  2.10484563e-03  4.99860350e-03  4.07544005e-02
  4.85503555e-02  2.01735305e-02  4.08318134e-02  1.08332135e-02
  4.56274166e-03  1.68309730e-02  1.49958345e-02  3.98668121e-02
  4.11975249e-03  6.18146954e-03  5.46392663e-02  3.93806762e-02
  2.05140898e-02  2.67507776e-02  2.62114420e-02  1.56971138e-03
  5.14558247e-03  8.06553130e-03  4.97775382e-03  3.70762338e-03
  4.64538940e-03  1.61412832e-02  4.48627676e-03  3.21130566e-03
  3.96611758e-03  1.98675854e-02  7.15760286e-03  1.76221240e-02
  1.67892988e-02  2.15509930e-03  5.21981868e-03  8.52577611e-02
  1.12944515e-02  1.95523181e-02  8.78759538e-03  8.95330909e-03
  1.17396706e-02  6.11978458e-02  2.14396450e-02  2.14771760e-02
  8.70677355e-03 -1.96885754e-03  6.14923648e-03  1.19537436e-02
  4.86493161e-03  4.43285954e-03  3.62583359e-02  1.53169658e-02
  2.26917123e-02  2.02135594e-02  4.12449622e-03 -2.95800765e-04
  2.88026350e-02  6.83012616e-03  1.07964135e-02  3.56620554e-03
  2.84995403e-03  1.87301954e-03  1.84707595e-03  4.77849036e-02
  4.37916373e-02  3.94969988e-03  2.52077880e-02  4.38680476e-02
  4.86604788e-02  9.89059779e-03  1.05916993e-02  4.06000147e-03
  7.36114806e-03  1.03354222e-02 -2.72064461e-04  7.10938999e-03
  5.85532998e-03  3.79740435e-02  9.85392936e-03  3.55438697e-03
  3.87301898e-03  5.53999326e-03  6.41825961e-03  2.91701679e-03
  5.40730689e-03  9.32147479e-03  5.46629284e-03  1.83470491e-02
  3.42982167e-02  4.06859625e-02  3.96823085e-02  2.81907462e-03
  1.02374237e-02  4.29448864e-03  4.99677139e-03  2.64694567e-02
  2.89302402e-02  2.63215653e-02  4.51950047e-02  3.75840086e-03
  6.11045111e-03  1.11970636e-02  3.78909965e-02  7.58425587e-03
  1.67642106e-02  2.81139679e-02  6.49265978e-02  5.11012919e-03
  4.05809971e-03  3.29644732e-03  2.26732574e-02  5.42667350e-03
 -1.01462781e-03  2.89899938e-02  9.48900346e-03  2.18457323e-02
  2.76204941e-02  2.81201737e-02  1.05174262e-02  2.06203182e-03
  1.63212972e-03  5.28958602e-03  7.62987316e-03  4.43033540e-02
  1.47757045e-02  1.55001565e-02  2.45246991e-03  2.22389820e-02
  1.75685738e-02  2.80035301e-02  1.19523148e-02  2.94537047e-03
  4.44513277e-03  6.12391360e-02  5.20831903e-03  2.20606356e-03
  4.71843774e-02  4.80604946e-03  3.67551792e-03  2.42753561e-02
  1.36258116e-02  9.01678638e-03  3.30261176e-02  1.46937421e-03
  8.70672286e-03  8.10140923e-03  2.55775454e-03  2.69539800e-02
  5.77847298e-02  7.09224024e-03  5.56809725e-03  7.98675653e-03
  2.24515471e-03  1.98806891e-02  2.78146017e-02  8.43421933e-04
  3.61744809e-03  3.46147870e-02  3.80338240e-02  3.10139085e-03
  8.86588619e-03  7.39141012e-03  2.48673507e-02  5.23270247e-03
  6.52649628e-03  4.64741651e-02  9.12364638e-03  6.82566616e-03
  3.34329208e-03  4.49044788e-03  2.05963425e-02  2.30043799e-02
  2.11303501e-02  1.31103435e-02  4.05409300e-05  1.13950086e-02
  4.94512074e-02  3.69152789e-04  1.50929492e-02  5.86703566e-03
  1.93994495e-03  9.59968009e-03  2.36611983e-02  1.28949305e-02
  2.07018917e-02  6.44730824e-03  8.86767571e-03  3.06314547e-03
  5.89903280e-03  4.75560403e-03  2.26531394e-03  6.05924996e-03
  3.42057371e-02  4.29308730e-03  3.97507465e-02  2.95760837e-02
  2.86436518e-02  1.12703395e-02  6.31143810e-03  2.16899348e-02
  2.69040273e-02  2.11287911e-02  4.85477919e-03  6.21920606e-03
  2.86010974e-02  3.23930573e-03  1.99201058e-03  1.16987891e-02
  4.68031530e-03  4.75001646e-02  2.88519225e-02  4.83632433e-03
  8.83317527e-03  1.01654240e-02  7.72299257e-03 -2.25224931e-03
  6.51084523e-03  2.24138218e-02  2.68747476e-03  2.12173080e-03
  4.96834144e-03  1.46364064e-02  6.95230803e-03  5.55343556e-03
  1.23372380e-02  4.46815572e-02  1.96003036e-02  5.14200609e-02
  3.34404957e-03  2.83849587e-02  3.36743160e-03  7.74686205e-03
 -1.09737887e-05  1.12518846e-02  1.63419952e-03  1.42658621e-02
  8.66317711e-03  2.18408903e-02  4.50349444e-03  7.85457846e-03
  7.20230883e-03  5.11770721e-02  7.11610972e-03  2.92877291e-02
  5.25657195e-03  4.48143727e-03  3.22296535e-02  3.37505927e-02
  1.21635024e-01  3.04154551e-02  5.88478509e-03  2.64611217e-03
  2.28513402e-02  7.16397815e-02  4.05118863e-03  1.67561522e-02
  4.09483358e-02  1.50846537e-03  2.09069532e-02  6.99871336e-03
  4.59001939e-02  1.22603933e-03  2.58104228e-02  3.34927560e-03
  3.25335710e-03  3.99276881e-03  4.00878185e-02  3.00917978e-02
  1.48601416e-02  2.40368484e-03  2.52151447e-02  6.17711375e-02
  2.33353939e-02  2.54283575e-02  6.87376308e-02  3.57919439e-02
  2.27606477e-02  3.46061773e-03  6.00423230e-03  4.13376738e-02
  1.06200534e-02  3.11389629e-03  9.54118725e-02  2.13209112e-02
  7.29633956e-03  1.04943193e-02  3.22781011e-03  6.25254589e-03
  3.91225876e-03  2.93741131e-03  3.86673603e-03  5.83358217e-03
  3.73895802e-03  1.32397967e-02  9.58253033e-03  1.40065626e-01
  5.54594269e-03  3.32869201e-03  2.00237574e-02  3.11865857e-03
  1.86708198e-03  2.44405646e-02  2.55132400e-02  1.30133803e-03
  6.26081993e-03  8.17097587e-03  7.42274138e-03  2.61279413e-02
  8.82202403e-03 -6.56386365e-04  4.29492089e-02  1.66140943e-03
  1.23844291e-02  6.12890597e-03  7.67513395e-03  6.22924811e-03
  3.10977397e-03  6.96248626e-03  2.11096405e-02  2.02708891e-02
  1.95190852e-03  2.87797249e-02  1.00662621e-02  3.27376676e-02
  6.32479975e-02  4.34729098e-02  2.21807477e-02  5.83956570e-03
  4.22918528e-02  9.44537870e-03  1.56855220e-02  9.39400754e-03
  7.84513211e-03  2.13957978e-03  1.96278206e-03  3.32157935e-03
  2.88001517e-03  1.94432721e-03  2.68093567e-02  7.76805278e-03
  1.36441024e-03  1.64283876e-02  1.07508120e-02 -1.33550239e-03
  2.53576054e-02  6.07174046e-03  1.88354889e-02  2.61129669e-02
  2.27541677e-03  8.37112271e-02  7.63993061e-03  2.31921818e-02
  5.59754829e-02  1.11540422e-02  4.34990961e-02  9.41717279e-02
  1.01502284e-02  6.20218408e-03  1.52539052e-02  4.98760372e-02
  6.27605089e-02  2.62224269e-03  3.55127451e-02  3.01365049e-02
  2.67227367e-02  2.85738210e-02  3.92052514e-03  4.34169810e-02
  2.65947132e-02  1.59721785e-03  8.26052188e-03  9.60639981e-03
  1.84387175e-02  1.18742269e-02  2.72483411e-02  2.91000841e-03
 -6.74841221e-04  4.55609720e-02  6.08134197e-04  7.04748085e-03
  6.43277961e-03  2.12013578e-02  1.58022463e-02  2.49605734e-02
  7.20263540e-03  3.78558651e-03  6.33530758e-03  2.21496109e-02
  2.30169368e-02  2.74258455e-02  2.43764930e-02  3.44024768e-02
  2.59352526e-02  1.52707396e-02  3.01838608e-03  1.27529796e-02
  4.92865895e-02  1.58364836e-02  2.02801414e-03  4.90916716e-03
  3.97986168e-02  5.85297082e-04  3.40521075e-02  1.53591882e-02
  2.82894697e-02  2.30840415e-03  1.83478660e-02  2.03708014e-03
  1.37987730e-02  1.53179066e-02  1.19607526e-02  1.98991440e-02
  2.71134424e-03  3.69938740e-03  4.38197358e-02  3.23774606e-02
  1.67138361e-02  5.65197748e-03  2.64271538e-03  1.58944014e-03
  5.90006516e-03  6.34523652e-02  3.14238801e-02  2.17138043e-02
  2.51837111e-03  5.49381652e-02  1.02189688e-02  1.16690179e-02
  6.48173689e-03  1.43645170e-02  3.69593891e-04  2.43050912e-03
  2.87219852e-02  5.83893285e-03  2.74705158e-02  4.52388729e-02
  1.12091832e-03  6.65289040e-02  1.08659742e-02  3.39172801e-03
  3.17171345e-03  4.12448962e-03  1.85620490e-02  6.77798329e-03
  4.23438446e-02  6.54900999e-03  1.01190615e-02  3.45944694e-02
  2.51932116e-02  3.01605730e-03  1.27053108e-03  1.54898699e-02
  2.17806273e-02  1.68674924e-02  8.45750456e-03  1.91814254e-02
  8.50363096e-03  7.71939795e-03  1.89221146e-02  2.35206947e-02
  1.00146891e-02  1.25049792e-02  2.00358919e-02  8.02799200e-02
  1.24668494e-02  2.15381388e-02  9.88895495e-03  7.46946140e-03
  3.30369212e-02  7.92503178e-03  1.66758560e-02  2.14165721e-02
  1.82697449e-02  2.71604572e-02  1.20911787e-02  6.70177314e-02
  8.80416145e-03  1.98467099e-02  2.62327505e-03  4.57324185e-03
  1.45853575e-02  4.82466511e-03  4.46492019e-02  5.17776486e-03
  1.12347547e-02  7.97469386e-02  4.14188110e-03  4.80875221e-02
  3.49840022e-03  4.41273838e-02  3.76621039e-03  1.64959442e-02
  2.16296181e-03  2.56174060e-03  3.77418471e-02  2.68580193e-02
  2.18472618e-02  1.85770384e-02  2.20999022e-02  2.06571323e-02
  4.49015114e-02  1.55805623e-02  1.53445977e-02  6.59188344e-02
  8.90647626e-03  1.41302919e-02  4.72700118e-03  2.72705258e-02
  3.08908768e-02  3.26559261e-03  2.80168764e-03  8.08598128e-03
  1.00924161e-01  4.76329196e-02  1.56660302e-03  3.14323380e-03
  1.73551055e-02  7.42652066e-03  7.45802726e-02  9.10809354e-04
  8.09743316e-03  1.46884690e-02  1.14317181e-02  2.27795069e-03
  8.13478772e-03  2.11373194e-02  4.24049489e-02  7.96830167e-03
  2.99760244e-03  2.90653119e-03  9.48254503e-04  1.18073888e-02
  5.29773522e-02  9.70164767e-03  2.11526409e-02  1.93015420e-03
  2.07257612e-02  3.09221541e-02  5.25663288e-02  3.93079513e-02
  2.98499036e-02  5.79898523e-02  5.48678953e-02  8.19484535e-03
  9.40910428e-04  3.04916935e-02  2.27421928e-02  3.11534943e-02
  3.29842995e-03  4.93533581e-02  2.20760327e-02  3.30366080e-02
  2.10227575e-02  4.28455342e-02  3.36809289e-02  6.88537545e-02
  7.33908593e-02  8.72077460e-02  1.00002745e-01  1.76171462e-02
  1.45944446e-02  6.27803761e-03  1.02583429e-02  2.61241058e-02
  2.17492218e-02  5.18794308e-03  1.49070793e-02  3.72360036e-02
  2.31534276e-02  2.70628478e-02  7.34372724e-03  1.74319647e-02
  2.25537916e-02  1.85683477e-02  3.94797641e-03  3.99751085e-02
  1.79841585e-02  9.69259892e-03  9.74738902e-04  3.60632847e-02
  1.87853667e-02  9.87873848e-04  1.16839854e-02  2.64719215e-02
  3.21354016e-02 -4.30459469e-04  1.55423993e-02  4.57151256e-02
  4.36678227e-03  4.79343528e-03  2.81754906e-02 -1.18280287e-04
  4.79372906e-02  8.34451831e-03  1.93625283e-02  5.87119499e-02
  1.49701399e-02  4.89144762e-03  5.26353017e-02  7.56082515e-03
  1.25120343e-02  7.77697074e-04  7.22973559e-03]
2025-06-24 09:52:04,604 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:04,605 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:04,606 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:04,606 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:04,623 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:04,630 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:04,630 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:04,630 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:04,630 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:04,630 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:04,631 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:04,631 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:04,631 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:04,631 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:04,631 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:04,631 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:04,631 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:04,631 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:04,631 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:04,631 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:04,631 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:04,631 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,631 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,631 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:04,631 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:04,650 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:04,650 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:05,074 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = lightgbm
2025-06-24 09:52:06,998 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:06,998 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:06,998 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:06,998 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:06,998 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:06,998 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:06,998 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:07,016 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:07,479 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:07,479 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:07,479 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:07,479 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:07,479 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:07,480 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:07,480 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:07,480 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:07,480 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:07,632 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:07,632 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:07,632 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:07,632 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:08,757 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:09,642 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:09,642 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:09,647 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:09,676 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:09,676 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:09,676 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:09,676 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:10,733 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:11,164 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:11,164 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:11,299 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:11,300 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:11,369 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:11,369 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:11,369 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:11,369 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:11,369 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:11,369 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:11,418 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:11,418 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:11,418 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:11,418 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:11,418 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:11,418 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:11,418 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:11,474 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:11,474 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:11,474 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:11,607 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:11,608 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:11,608 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:11,608 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:11,608 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:11,608 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:11,608 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:11,608 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:11,608 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:11,608 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:11,608 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:11,608 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:11,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:11,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:11,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:11,681 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:11,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:11,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:11,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:11,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:11,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:11,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:11,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:12,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:12,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:12,066 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:12,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:12,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:12,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:12,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:12,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:12,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:12,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:12,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,235 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:12,235 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,235 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:12,245 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   learning_rate: 0.0142443614712617
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:12,249 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   n_estimators: 129
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   subsample: 0.9746128038451177
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.718946577832295
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   reg_alpha: 4.407538220944994e-06
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO -   reg_lambda: 0.13079007377001461
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:12,250 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:12,613 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:12,613 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512861333947547})})
2025-06-24 09:52:12,613 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:52:12,613 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:12,615 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:12,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:12,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:12,649 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:12,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:12,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:12,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:12,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:12,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:12,795 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:12,795 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:12,827 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:12,828 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:12,828 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:12,828 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:12,828 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,828 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:12,828 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:12,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:12,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:12,842 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00059789 0.00159071 0.00145558 ... 0.00190815 0.00259277 0.00293518]
2025-06-24 09:52:12,843 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:12,843 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:12,844 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:12,844 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:12,861 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:12,869 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:12,869 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:12,869 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:12,869 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:12,869 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:12,869 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:12,869 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:12,869 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:12,869 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:12,869 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:12,869 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:12,869 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:12,869 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:12,869 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:12,869 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:12,869 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:12,869 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,869 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,869 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:12,869 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:12,890 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:12,890 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:13,316 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = lightgbm
2025-06-24 09:52:15,290 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:15,290 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:15,290 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:15,290 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:15,290 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:15,291 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:15,291 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:15,308 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:15,774 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:15,774 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:15,774 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:15,774 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:15,774 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:15,774 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:15,774 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:15,774 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:15,774 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:15,918 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:15,918 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:15,918 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:15,918 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:17,045 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:17,930 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:17,930 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:17,936 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:17,963 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:17,963 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:17,964 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:17,964 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:19,021 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:19,453 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:19,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:19,588 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:19,589 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:19,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:19,657 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:19,657 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:19,657 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:19,657 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:19,657 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:19,706 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:19,706 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:19,707 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:19,707 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:19,707 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:19,707 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:19,707 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:19,762 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:19,762 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:19,762 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:19,892 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:19,892 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:19,892 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:19,893 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:19,893 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:19,893 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:19,893 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:19,893 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:19,893 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:19,893 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:19,893 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:19,893 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:19,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:19,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:19,893 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:19,965 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:20,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:20,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:20,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:20,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:20,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:20,259 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:20,259 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:20,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:20,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:20,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:20,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:20,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:20,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:20,368 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:20,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:20,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:20,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:20,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:20,486 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:20,486 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:20,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:20,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:20,512 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:20,512 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:20,512 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:20,522 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   learning_rate: 0.018456661428192748
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   n_estimators: 181
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   subsample: 0.9509603298852387
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911039091967015
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   reg_alpha: 7.612892550570312e-07
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO -   reg_lambda: 4.173453381060882e-06
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:20,526 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:20,905 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:20,905 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035128153015028425})})
2025-06-24 09:52:20,905 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:52:20,905 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:20,906 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:20,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:20,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:20,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:20,941 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:20,968 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:20,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:21,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:21,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:21,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:21,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:21,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:21,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:21,123 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:21,123 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:21,123 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:21,123 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:21,123 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:21,124 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:21,124 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:21,124 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:21,130 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:21,137 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:21,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00052528 0.00164657 0.00148245 ... 0.00131769 0.00195506 0.00250547]
2025-06-24 09:52:21,139 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:21,140 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:21,140 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:21,141 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:21,158 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:21,165 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:21,165 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:21,165 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:21,165 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:21,166 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:21,166 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:21,166 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:21,166 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:21,166 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:21,166 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:21,166 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:21,166 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:21,166 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:21,166 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:21,166 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:21,166 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:21,166 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:21,166 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:21,166 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:21,166 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:21,187 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:21,187 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:21,614 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = lightgbm
2025-06-24 09:52:23,528 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:23,528 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:23,528 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:23,528 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:23,528 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:23,528 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:23,528 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:23,546 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:24,012 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:24,012 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:24,012 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:24,012 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:24,013 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:24,013 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:24,013 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:24,013 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:24,013 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:24,160 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:24,160 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:24,160 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:24,160 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:25,287 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:26,173 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:26,173 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:26,178 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:26,206 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:26,206 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:26,206 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:26,206 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:27,252 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:27,695 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:27,695 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:27,831 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:27,831 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:27,900 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:27,900 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:27,900 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:27,900 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:27,900 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:27,900 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:27,950 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:27,950 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:27,950 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:27,950 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:27,950 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:27,950 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:27,950 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:28,007 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:28,007 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:28,007 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:28,138 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:28,138 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:28,138 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:28,138 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:28,138 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:28,138 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:28,138 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:28,138 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:28,138 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:28,138 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:28,138 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:28,138 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:28,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:28,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:28,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:28,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:28,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:28,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:28,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:28,428 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:28,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:28,505 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:28,505 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:28,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:28,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:28,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:28,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:28,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:28,590 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:28,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:28,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:28,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:28,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:28,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:28,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:28,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:28,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:28,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:28,758 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:28,758 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:28,758 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:28,768 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   learning_rate: 0.023387567111245493
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   n_estimators: 253
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   subsample: 0.9226975130375475
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6611933706717418
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5680490521396752e-08
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO -   reg_lambda: 0.008010451217063149
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:28,772 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:29,168 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:29,168 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035119686238103645})})
2025-06-24 09:52:29,168 - src.models.lightgbm_model - INFO -   - Best Iteration: 67
2025-06-24 09:52:29,168 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:29,170 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:29,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:29,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:29,180 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:29,211 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:29,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:29,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:29,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:29,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:29,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:29,359 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:29,359 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:29,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:29,395 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:29,395 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:29,395 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:29,395 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:29,395 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:29,395 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:29,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:29,395 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:29,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:29,408 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:29,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00038657 0.00040462 0.00037556 ... 0.00140033 0.00331425 0.00504824]
2025-06-24 09:52:29,411 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:29,412 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:29,412 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:29,413 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:29,428 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:29,436 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:29,436 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:29,436 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:29,436 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:29,436 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:29,436 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:29,436 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:29,436 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:29,436 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:29,436 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:29,436 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:29,436 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:29,436 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:29,436 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:29,436 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:29,436 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:29,436 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:29,436 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:29,436 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:29,437 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:29,457 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:29,457 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:29,884 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = lightgbm
2025-06-24 09:52:31,797 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:31,797 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:31,797 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:31,797 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:31,797 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:31,797 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:31,797 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:31,815 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:32,280 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:32,280 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:32,280 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:32,280 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:32,280 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:32,280 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:32,280 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:32,280 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:32,280 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:32,423 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:32,423 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:32,423 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:32,423 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:33,552 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:34,441 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:34,441 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:34,447 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:34,475 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:34,475 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:34,475 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:34,475 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:35,531 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:35,981 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:35,981 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:36,119 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:36,119 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:36,189 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:36,189 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:36,189 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:36,189 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:36,189 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:36,189 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:36,239 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:36,239 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:36,239 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:36,239 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:36,239 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:36,239 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:36,239 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:36,295 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:36,295 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:36,295 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:36,429 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:36,429 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:36,429 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:36,429 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:36,429 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:36,429 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:36,429 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:36,429 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:36,429 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:36,429 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:36,429 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:36,429 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:36,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:36,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:36,430 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:36,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:36,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:36,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:36,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:36,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:36,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:36,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:36,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:36,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:36,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:36,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:36,856 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:36,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:36,887 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:36,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:36,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:36,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:36,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:37,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:37,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:37,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:37,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:37,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:37,057 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:37,057 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:37,057 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:37,068 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   learning_rate: 0.017930539769372034
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:37,072 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   n_estimators: 292
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   subsample: 0.7831255552496368
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7589517267440986
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   reg_alpha: 3.771141225353274e-05
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO -   reg_lambda: 0.000530203372836347
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:37,073 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:37,393 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:37,393 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512653049012874})})
2025-06-24 09:52:37,393 - src.models.lightgbm_model - INFO -   - Best Iteration: 67
2025-06-24 09:52:37,393 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:37,395 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:37,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:37,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:37,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:37,426 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:37,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:37,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:37,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:37,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:37,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:37,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:37,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:37,578 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:37,606 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:37,607 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:37,607 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:37,607 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:37,607 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:37,607 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:37,607 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:37,607 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:37,613 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:37,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:37,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00053914 0.0016126  0.00149449 ... 0.00307926 0.00270779 0.00287482]
2025-06-24 09:52:37,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:37,623 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:37,623 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:37,624 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:37,640 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:37,648 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:37,648 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:37,648 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:37,648 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:37,648 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:37,648 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:37,648 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:37,648 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:37,648 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:37,648 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:37,648 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:37,648 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:37,649 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:37,649 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:37,649 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:37,649 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:37,649 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:37,649 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:37,649 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:37,649 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:37,670 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:37,670 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:38,099 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = lightgbm
2025-06-24 09:52:40,003 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:40,003 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:40,003 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:40,003 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:40,003 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:40,003 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:40,003 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:40,021 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:40,485 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:40,485 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:40,485 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:40,485 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:40,485 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:40,485 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:40,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:40,485 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:40,485 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:40,623 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:40,623 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:40,623 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:40,623 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:41,749 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:42,636 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:42,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:42,641 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:42,669 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:42,669 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:42,669 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:42,669 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:43,718 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:44,154 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:44,155 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:44,295 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:44,295 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:44,364 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:44,364 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:44,364 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:44,364 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:44,364 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:44,364 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:44,423 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:44,423 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:44,423 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:44,423 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:44,423 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:44,423 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:44,423 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:44,479 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:44,479 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:44,479 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:44,597 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:44,597 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:44,597 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:44,597 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:44,597 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:44,597 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:44,597 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:44,597 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:44,597 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:44,597 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:44,597 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:44,597 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:44,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:44,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:44,597 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:44,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:44,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:44,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:44,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:44,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:44,950 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:44,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:44,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:45,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:45,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:45,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:45,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:45,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:45,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:45,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:45,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:45,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:45,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:45,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,214 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:45,214 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,214 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:45,224 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   learning_rate: 0.011437207024077016
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:45,228 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   n_estimators: 51
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   subsample: 0.9988910626470648
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7955253543847626
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   reg_alpha: 3.9245291180279974e-07
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO -   reg_lambda: 0.001413477088598793
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:45,229 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:45,463 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:45,464 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513278679041889})})
2025-06-24 09:52:45,464 - src.models.lightgbm_model - INFO -   - Best Iteration: 51
2025-06-24 09:52:45,464 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:45,464 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:45,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:45,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:45,495 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:45,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:45,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:45,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:45,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:45,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:45,638 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:45,638 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,643 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:45,666 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:45,667 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:45,667 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:45,667 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:45,667 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,667 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,667 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:45,667 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:45,674 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:45,681 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:45,683 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00072389 0.00072208 0.00071979 ... 0.00128048 0.00136489 0.00234633]
2025-06-24 09:52:45,683 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:45,684 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:45,684 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:45,685 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:45,700 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:45,707 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:45,707 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:45,707 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:45,707 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:45,707 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:45,708 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:45,708 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:45,708 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:45,708 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:45,708 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:45,708 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:45,708 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:45,708 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:45,708 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:45,708 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:45,708 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:45,708 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,708 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,708 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:45,708 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:45,734 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:45,734 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:46,157 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = lightgbm
2025-06-24 09:52:48,051 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:48,051 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:48,051 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:48,051 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:48,051 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:48,051 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:48,051 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:48,069 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:48,533 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:48,533 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:48,533 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:48,533 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:48,533 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:48,533 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:48,533 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:48,533 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:48,533 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:48,668 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:48,669 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:48,669 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:48,669 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:48,669 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:48,669 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:48,669 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:48,669 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:48,669 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:48,669 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:49,806 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:50,688 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:50,688 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:50,693 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:50,721 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:50,721 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:50,721 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:50,721 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:51,781 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:52,219 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:52:52,219 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:52,356 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:52,356 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:52:52,425 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:52:52,425 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:52,425 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:52:52,425 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:52:52,425 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:52,425 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:52,483 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:52:52,483 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:52:52,483 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:52,483 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:52,483 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:52:52,483 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:52:52,483 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:52,539 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:52,539 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:52:52,539 - src.training - INFO - 모델 학습 시작
2025-06-24 09:52:52,656 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:52:52,657 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:52:52,657 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:52:52,657 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:52:52,657 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:52:52,657 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:52:52,657 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:52:52,657 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:52:52,657 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:52,657 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:52:52,657 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:52:52,657 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:52:52,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:52:52,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:52,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:52,730 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:52,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:52,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:52,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:52,946 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:53,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:53,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:52:53,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:52:53,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:53,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:53,107 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:53,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:53,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:53,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:53,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:53,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:53,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:53,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:52:53,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,274 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:52:53,274 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,274 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:52:53,283 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   learning_rate: 0.153186769078403
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:52:53,287 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   n_estimators: 620
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   subsample: 0.7475015634023295
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9150280338924608
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1809416753112032e-07
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3713683152159453e-05
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:52:53,288 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:52:53,400 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:52:53,400 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513536805718805})})
2025-06-24 09:52:53,400 - src.models.lightgbm_model - INFO -   - Best Iteration: 6
2025-06-24 09:52:53,400 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:52:53,401 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:52:53,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:52:53,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:52:53,433 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:52:53,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:52:53,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:52:53,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:52:53,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:52:53,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:52:53,576 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:52:53,577 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:52:53,589 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:52:53,589 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:52:53,589 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:52:53,589 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:52:53,589 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,589 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,589 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:52:53,589 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:52:53,595 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:52:53,602 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:52:53,604 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0005736  0.00152563 0.00136475 ... 0.00237602 0.01084222 0.00267221]
2025-06-24 09:52:53,604 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:52:53,605 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:53,606 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:53,606 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:53,622 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:52:53,630 - src.training - INFO -   precision: 0.0
2025-06-24 09:52:53,630 - src.training - INFO -   recall: 0.0
2025-06-24 09:52:53,630 - src.training - INFO -   f1: 0.0
2025-06-24 09:52:53,630 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:52:53,630 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:52:53,630 - src.training - INFO -   positive_samples: 456
2025-06-24 09:52:53,630 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:52:53,630 - src.training - INFO -   total_samples: 368238
2025-06-24 09:52:53,630 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:52:53,630 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:52:53,630 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:52:53,630 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:52:53,630 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:52:53,630 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:52:53,630 - src.training - INFO - 모델 학습 완료
2025-06-24 09:52:53,630 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:52:53,630 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,630 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,630 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:52:53,630 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:52:53,650 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:52:53,650 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:52:54,080 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = lightgbm
2025-06-24 09:52:55,988 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:52:55,988 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:52:55,988 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:52:55,988 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:52:55,988 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:52:55,988 - src.training - INFO - 교차 검증 시작
2025-06-24 09:52:55,988 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:52:56,006 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:52:56,467 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:52:56,468 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:52:56,468 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:52:56,468 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:52:56,468 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:52:56,468 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:52:56,468 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:52:56,468 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:52:56,468 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:52:56,607 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:56,608 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:56,608 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:52:56,608 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:52:56,608 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:56,608 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:52:56,608 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:52:56,608 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:52:56,608 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:52:56,608 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:52:57,741 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:52:58,632 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:52:58,632 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:52:58,637 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:52:58,665 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:52:58,665 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:52:58,665 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:52:58,665 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:52:59,720 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:00,173 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:00,173 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:00,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:00,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:00,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:00,378 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:00,378 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:00,378 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:00,378 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:00,378 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:00,428 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:00,428 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:00,428 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:00,428 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:00,428 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:00,428 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:00,428 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:00,485 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:00,485 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:00,485 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:00,618 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:00,618 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:00,618 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:00,618 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:00,618 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:00,618 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:00,618 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:00,618 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:00,618 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:00,618 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:00,618 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:00,618 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:00,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:00,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:00,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:00,692 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:00,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:00,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:00,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:00,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:00,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:00,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:00,993 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:01,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:01,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:01,076 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:01,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:01,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:01,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:01,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:01,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:01,220 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:01,220 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:01,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,246 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:01,246 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,246 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:01,255 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   learning_rate: 0.04252092888793017
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   n_estimators: 555
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   subsample: 0.9111812059161246
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6841855639649754
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   reg_alpha: 1.469469291873918e-06
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO -   reg_lambda: 1.362640689879042
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:01,260 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:01,477 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:01,477 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512939143527204})})
2025-06-24 09:53:01,477 - src.models.lightgbm_model - INFO -   - Best Iteration: 36
2025-06-24 09:53:01,477 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:01,479 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:01,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:01,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:01,514 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:01,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:01,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:01,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:01,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:01,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:01,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:01,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,668 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:01,681 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:01,681 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:01,681 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:01,681 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:01,681 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,681 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,681 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:01,681 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:01,687 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:01,694 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:01,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00048397 0.00168351 0.0014472  ... 0.0019934  0.00316274 0.0032102 ]
2025-06-24 09:53:01,696 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:01,697 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:01,697 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:01,698 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:01,714 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:01,722 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:01,722 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:01,722 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:01,722 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:01,722 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:01,722 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:01,722 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:01,722 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:01,722 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:01,722 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:01,722 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:01,722 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:01,722 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:01,722 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:01,722 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:01,722 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:01,722 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,723 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,723 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:01,723 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:01,743 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:01,743 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:02,173 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = lightgbm
2025-06-24 09:53:04,095 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:04,095 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:04,095 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:04,095 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:04,095 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:04,095 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:04,095 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:04,111 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:04,579 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:04,579 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:04,579 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:04,579 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:04,579 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:04,579 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:04,579 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:04,579 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:04,579 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:04,721 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:04,721 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:04,721 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:04,721 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:05,867 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:06,749 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:06,749 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:06,753 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:06,781 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:06,781 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:06,781 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:06,781 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:07,828 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:08,267 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:08,267 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:08,401 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:08,401 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:08,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:08,470 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:08,470 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:08,470 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:08,470 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:08,470 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:08,519 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:08,519 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:08,519 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:08,519 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:08,519 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:08,519 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:08,519 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:08,575 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:08,575 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:08,575 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:08,706 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:08,706 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:08,706 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:08,706 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:08,706 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:08,706 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:08,706 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:08,706 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:08,706 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:08,706 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:08,706 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:08,706 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:08,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:08,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:08,706 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:08,780 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:08,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:08,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:08,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:08,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:09,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:09,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:09,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:09,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:09,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:09,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:09,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:09,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:09,157 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:09,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:09,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:09,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:09,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:09,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:09,301 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:09,301 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:09,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:09,327 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:09,327 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:09,327 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:09,327 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:09,337 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   learning_rate: 0.01121632525249422
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:09,341 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   n_estimators: 506
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   subsample: 0.7239428053703661
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7096617144525774
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   reg_alpha: 1.2539835065528851e-05
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO -   reg_lambda: 3.479924777807695e-08
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:09,342 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:09,752 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:09,752 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513287443309242})})
2025-06-24 09:53:09,752 - src.models.lightgbm_model - INFO -   - Best Iteration: 79
2025-06-24 09:53:09,752 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:09,754 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:09,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:09,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:09,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:09,785 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:09,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:09,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:09,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:09,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:09,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:09,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:09,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:09,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:09,964 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:09,964 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:09,964 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:09,964 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:09,964 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:09,964 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:09,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:09,964 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:09,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:09,977 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:09,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00063921 0.00148144 0.00140527 ... 0.00128159 0.00243072 0.00274934]
2025-06-24 09:53:09,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:09,980 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:09,980 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:09,981 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:09,998 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:10,006 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:10,006 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:10,006 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:10,006 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:10,006 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:10,006 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:10,006 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:10,006 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:10,006 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:10,006 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:10,006 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:10,006 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:10,006 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:10,006 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:10,006 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:10,006 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:10,006 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:10,006 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:10,006 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:10,006 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:10,027 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:10,027 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:10,456 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = lightgbm
2025-06-24 09:53:12,402 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:12,402 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:12,402 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:12,402 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:12,402 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:12,402 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:12,402 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:12,420 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:12,885 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:12,885 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:12,885 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:12,885 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:12,885 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:12,885 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:12,885 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:12,885 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:12,885 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:13,021 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:13,021 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:13,021 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:13,021 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:14,153 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:15,031 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:15,031 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:15,036 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:15,064 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:15,064 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:15,064 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:15,064 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:16,138 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:16,578 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:16,578 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:16,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:16,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:16,784 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:16,784 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:16,785 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:16,785 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:16,785 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:16,785 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:16,843 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:16,843 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:16,843 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:16,843 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:16,843 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:16,843 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:16,843 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:16,899 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:16,899 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:16,899 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:17,018 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:17,018 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:17,018 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:17,018 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:17,018 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:17,018 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:17,018 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:17,018 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:17,018 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:17,018 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:17,018 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:17,018 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:17,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:17,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,018 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:17,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:17,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:17,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:17,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:17,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:17,386 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:17,386 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:17,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:17,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,440 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:17,471 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:17,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:17,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:17,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:17,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:17,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:17,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:17,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:17,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,638 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:17,638 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,638 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:17,648 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   learning_rate: 0.24384133830368773
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:17,652 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   n_estimators: 335
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   subsample: 0.8683523300707465
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8857996984773274
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   reg_alpha: 4.439663032964412e-08
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02341800942228853
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:17,653 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:17,746 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:17,746 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513444787687373})})
2025-06-24 09:53:17,746 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 09:53:17,746 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:17,746 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:17,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:17,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:17,778 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:17,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:17,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:17,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:17,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:17,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:17,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:17,920 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:17,929 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:17,929 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:17,929 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:17,929 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:17,929 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,929 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,929 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:17,929 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:17,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:17,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:17,944 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 7.53265744e-04  1.29999108e-03  1.12034019e-03  1.28341664e-03
  1.35606909e-03  1.55543716e-03  1.73711764e-03  1.55785463e-03
  1.53571998e-03  2.22111701e-03  1.91676853e-03  2.76659896e-03
  1.62844927e-03  3.34371502e-03  1.74514090e-03  9.41253936e-04
  2.24629755e-02  9.28490385e-04  1.60433956e-03  4.76784420e-03
  1.84006847e-03  1.90019409e-03  6.90557419e-04  1.96201007e-03
  4.95372792e-02  2.07336636e-02  6.52866292e-03  2.41899087e-02
  5.57243309e-03  1.93648571e-03  8.70208310e-04  2.71093288e-03
  6.03940926e-03  2.38555042e-03  5.11294416e-04  4.69289321e-03
  1.51914555e-03  1.31970826e-03  5.07394176e-03  6.18182457e-03
  4.02738154e-03  7.10132800e-03  1.17455680e-03  1.72003874e-03
  2.32988433e-03 -4.72687321e-05 -5.74830942e-04  1.17269613e-02
  2.06376304e-02  4.45716431e-03  1.45398814e-02  2.16583866e-02
  1.64775479e-02  1.08790277e-03  1.61307096e-02  5.37723568e-03
  4.00697740e-03  1.33364295e-02  2.14982151e-03  1.92967625e-02
  1.06457039e-02  3.52297802e-03  1.66437266e-03  8.89925488e-04
  5.55246032e-03  9.80065437e-03  1.88073578e-02  1.78188351e-02
  1.49399723e-02  3.59631912e-02  1.76692081e-02  4.38862852e-02
  4.49679326e-03  5.19138455e-03  8.32295077e-04  1.30320810e-02
  1.32363168e-03  1.28524301e-02  1.41588329e-02  1.81853697e-03
  6.40740624e-03  5.60634033e-03  5.80077603e-03  1.39702775e-03
  6.85980215e-03  5.72407403e-03  4.35647955e-03  2.22225834e-02
  2.09415543e-03  6.33034987e-03  6.09462097e-03  1.15773343e-02
  2.56615875e-02  2.26731527e-02  6.16997097e-02  7.26610276e-02
  5.74534275e-02  2.44887664e-02 -6.48227013e-04  4.13691726e-04
  4.52587288e-03  5.56504712e-03  4.95565564e-03  2.30517590e-02
  5.81889055e-04  3.96975113e-03  1.30517982e-02 -1.20664803e-04
  1.24740073e-03  1.11605893e-03  4.56994116e-02  5.48210271e-03
  1.34933212e-02  5.66483820e-03  3.24118605e-02  2.13723471e-03
  3.58570231e-02  1.27145364e-02  5.07763394e-03  8.23860382e-04
  5.66953701e-03  1.66240833e-03  1.61277635e-03  8.11710439e-04
  1.38262453e-02  6.11280533e-03  3.05806403e-02  4.16387844e-02
  1.14581182e-02  2.23665204e-02  3.96888367e-03  5.67065920e-02
  3.45621505e-02  8.31427617e-04  2.84583942e-02  3.11436131e-02
  1.10190997e-02  1.13134448e-02  1.61892542e-02  1.34356908e-02
  6.14761438e-03  8.49725880e-03  2.19424079e-02  5.47949237e-02
  1.66154087e-03  3.35369810e-02  4.52779023e-02  1.20810184e-02
  5.42673615e-02  9.99085023e-04  4.21880395e-02  5.36518852e-03
  2.32314007e-02  1.39105172e-02  2.57349835e-02  9.98846581e-03
  8.20199021e-03  7.31516075e-04  2.19050046e-03  1.53348323e-02
  1.10130062e-02  1.07086577e-02  1.49737138e-02  1.91712484e-03
  4.70667532e-03  2.67878110e-03  1.49021109e-02  1.60587479e-03
 -1.96895753e-04  1.30155066e-02  6.29424028e-02  1.77454391e-02
  9.00091332e-04  1.07145036e-01  1.20874477e-02  8.40212877e-02
  9.18381967e-03  9.81162320e-03  5.76859406e-03  5.18553763e-03
  5.22294476e-02  1.13125773e-02  6.24248832e-02  1.43643223e-02
  1.92202898e-02  3.82891734e-03  4.15621459e-02  1.00747708e-02
  4.46824247e-03  2.79408747e-02  1.43312546e-03  1.59620191e-03
  1.00473521e-02  2.97049003e-02  5.96222638e-02  5.07676648e-03
  4.86609460e-02  1.19405765e-02  1.20365868e-02  1.03199685e-02
  5.13526435e-03  3.36885358e-02  1.21869742e-02  1.99196627e-02
  4.75736357e-02  4.22861555e-02  7.67303063e-03  2.50382115e-02
  1.04788648e-02  5.23028437e-02  4.99936799e-02  5.42447230e-03
  1.37352926e-02  6.50646489e-02  2.71634341e-02  2.91451000e-03
  3.25911663e-02  1.94463131e-02  1.10882562e-02  6.65691537e-02
  6.68450796e-03  2.60267341e-02  1.16129884e-03  5.99058620e-02
  6.32059548e-04  5.66607294e-02  2.88325683e-02  1.05290068e-02
  6.96158581e-02  1.03961994e-02  1.75418765e-02  2.65556937e-02
  5.42360484e-03  1.04695955e-02  1.34348234e-02  1.53205521e-02
  2.49648154e-02  4.20504266e-02  3.64985154e-02  4.63044437e-03
  1.48733438e-02  8.25233602e-03  4.38336059e-02  4.94306885e-03
  2.01100682e-02  3.85037343e-02  2.25034361e-02  3.37156904e-02
  9.73487403e-04]
2025-06-24 09:53:17,944 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:17,945 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:17,946 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:17,946 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:17,963 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:17,971 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:17,971 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:17,971 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:17,971 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:17,971 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:17,971 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:17,971 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:17,971 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:17,971 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:17,971 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:17,971 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:17,971 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:17,971 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:17,971 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:17,971 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:17,971 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:17,971 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,971 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,971 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:17,971 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:17,991 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:17,991 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:18,417 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = lightgbm
2025-06-24 09:53:20,390 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:20,390 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:20,390 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:20,390 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:20,390 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:20,390 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:20,390 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:20,408 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:20,873 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:20,873 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:20,873 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:20,873 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:20,873 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:20,874 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:20,874 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:20,874 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:20,874 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:21,011 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:21,011 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:21,011 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:21,011 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:22,143 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:23,025 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:23,025 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:23,030 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:23,058 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:23,058 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:23,058 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:23,058 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:24,112 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:24,562 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:24,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:24,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:24,699 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:24,767 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:24,768 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:24,768 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:24,768 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:24,768 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:24,768 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:24,826 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:24,826 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:24,826 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:24,826 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:24,826 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:24,826 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:24,826 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:24,882 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:24,882 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:24,882 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:24,999 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:24,999 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:24,999 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:24,999 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:24,999 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:24,999 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:24,999 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:24,999 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:24,999 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:24,999 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:24,999 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:24,999 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:24,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:24,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:25,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:25,074 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:25,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:25,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:25,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:25,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:25,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:25,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:25,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:25,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:25,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:25,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:25,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:25,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:25,450 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:25,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:25,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:25,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:25,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:25,586 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:25,590 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:25,590 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:25,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:25,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:25,616 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:25,616 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:25,616 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:25,625 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   learning_rate: 0.013791386929805163
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   n_estimators: 693
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   subsample: 0.6055182468435556
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7421066057531389
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   reg_alpha: 0.028410855500270112
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00020704799608554415
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:25,630 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:25,961 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:25,961 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513235705821214})})
2025-06-24 09:53:25,962 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:53:25,962 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:25,962 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:25,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:25,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:25,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:25,995 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:26,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:26,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:26,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:26,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:26,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:26,157 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:26,157 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:26,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:26,188 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:26,188 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:26,188 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:26,188 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:26,188 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:26,188 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:26,188 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:26,188 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:26,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:26,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:26,203 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00063116 0.0014654  0.00140736 ... 0.00093038 0.00153334 0.00239277]
2025-06-24 09:53:26,203 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:26,204 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:26,204 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:26,205 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:26,221 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:26,228 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:26,228 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:26,228 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:26,228 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:26,228 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:26,228 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:26,228 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:26,228 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:26,228 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:26,228 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:26,228 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:26,228 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:26,229 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:26,229 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:26,229 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:26,229 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:26,229 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:26,229 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:26,229 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:26,229 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:26,249 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:26,249 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:26,668 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = lightgbm
2025-06-24 09:53:28,488 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:28,488 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:28,488 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:28,488 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:28,488 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:28,488 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:28,488 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:28,505 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:28,963 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:28,963 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:28,963 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:28,963 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:28,963 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:28,963 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:28,963 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:28,963 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:28,963 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:29,129 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:29,129 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:29,129 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:29,129 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:30,177 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:31,023 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:31,023 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:31,029 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:31,057 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:31,058 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:31,058 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:31,058 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:32,092 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:32,536 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:32,536 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:32,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:32,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:32,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:32,743 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:32,743 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:32,743 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:32,743 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:32,743 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:32,792 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:32,792 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:32,792 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:32,792 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:32,792 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:32,792 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:32,792 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:32,849 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:32,849 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:32,849 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:32,981 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:32,981 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:32,981 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:32,981 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:32,981 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:32,981 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:32,981 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:32,981 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:32,981 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:32,981 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:32,981 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:32,981 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:32,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:32,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:32,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:33,055 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:33,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:33,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:33,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:33,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:33,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:33,353 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:33,353 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:33,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:33,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:33,435 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:33,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:33,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:33,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:33,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:33,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:33,579 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:33,579 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:33,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,604 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:33,604 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,604 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:33,613 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   learning_rate: 0.29607121667659375
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   n_estimators: 571
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   subsample: 0.9492180121271596
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9835831542773467
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   reg_alpha: 0.1889918707742379
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6510572184077662
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:33,618 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:33,721 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:33,721 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512743252851693})})
2025-06-24 09:53:33,721 - src.models.lightgbm_model - INFO -   - Best Iteration: 4
2025-06-24 09:53:33,721 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:33,723 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:33,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:33,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:33,755 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:33,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:33,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:33,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:33,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:33,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:33,899 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:33,899 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:33,909 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:33,909 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:33,909 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:33,909 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:33,909 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,909 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,909 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:33,909 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:33,915 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:33,922 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:33,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 3.79685589e-04  1.77914128e-03  1.32154829e-03  1.10521142e-03
  1.30142368e-03  5.10473235e-04  1.48880577e-03  1.38295318e-03
  1.72908317e-03  2.15682052e-03  1.39007556e-03  6.44624816e-04
  1.91785482e-03  1.12513633e-03  2.00476642e-03  5.41990946e-04
  1.59929006e-03  6.85613330e-04  3.55656546e-04  1.10110729e-03
  1.61275762e-03  1.73982720e-03  1.28744169e-03  1.25592397e-03
  1.87061484e-03  2.55619096e-03  1.43106407e-03  1.71579815e-03
  2.35820836e-03  1.75901666e-03  3.18491751e-03  1.56280440e-03
  1.36842177e-03  1.62323058e-03  1.70514265e-03  3.40005704e-03
  1.90213255e-03  2.13419170e-03  2.68697860e-03  2.04575494e-03
  1.53480990e-02  2.82113018e-03  4.30452478e-03  6.94106443e-04
  2.59838639e-03  2.31636691e-03  4.21060657e-03  9.52283669e-03
  4.35010926e-03  2.05096793e-03  2.76364759e-03  2.40069492e-02
  2.47118360e-03  2.71849631e-03  5.51144366e-03 -4.32635166e-04
 -1.13762890e-03  1.69108706e-03  2.53216191e-03  2.97289923e-03
  2.38939890e-03  2.07468141e-03  2.60533518e-03  2.11406708e-03
  3.57346798e-03  5.47524593e-03  1.98048260e-03  2.59517347e-03
  6.18430358e-02  2.98590527e-02  4.32187819e-03  1.99779314e-02
  4.69701354e-03  4.27629372e-03  2.43344784e-02  2.99200310e-02
  5.96629800e-03  3.78926299e-03  1.96882882e-03  2.50270131e-03
  1.46809422e-03  1.07646637e-04  3.05445880e-03  2.50373046e-03
 -4.91555350e-04  4.93239932e-03  2.05688304e-03  5.50554088e-03
  5.69158281e-03  2.81472327e-03  2.58586957e-03  1.73445420e-02
  1.79543002e-03  5.48219472e-03  1.46857560e-02  1.38418899e-02
  2.97282650e-02  3.48308258e-02  2.47781989e-02  3.13484964e-03
 -1.94812667e-05  2.83866379e-03  1.58475865e-03  4.29010767e-03
  4.71784502e-03  1.57916544e-03  1.77322616e-03  3.18426203e-03
  6.58854379e-04  4.82500931e-03  4.82369760e-03  5.25274665e-03
  3.56241340e-03  1.02044402e-02  6.25234052e-03  8.38240042e-03
  2.10283237e-02  3.66826598e-03  6.06112157e-03  2.34039595e-03
  4.16961806e-03  1.34548882e-03  3.03051827e-03  7.22337506e-04
  7.22696880e-03  2.81418140e-03  5.75050300e-03  1.15574907e-02
  2.86028206e-03  2.14868004e-03  2.15813222e-03  4.09731503e-03
  9.64731657e-03  4.71558739e-02  2.02041427e-02  3.30520110e-03
  2.87327009e-02  2.57377140e-02  4.44010325e-03  1.05751346e-02
  1.23300704e-02  2.33922583e-02  1.39726776e-02  1.05849510e-02
  2.00758449e-02 -1.18167767e-03  2.53922222e-02  1.68501803e-03
  1.79747082e-03  2.37065392e-03  5.73831962e-03  2.64632369e-03
 -9.16738448e-04  1.72930087e-02  4.39596026e-03  1.97235651e-02
  2.28845356e-03  9.96044376e-03  5.34911367e-03  1.77001486e-02
  3.28467163e-03  1.85804991e-03  2.58699080e-03  3.88064979e-03
  1.48263763e-02  5.66978539e-04  4.84052705e-03  2.12875406e-02
  4.76323803e-03  9.38897712e-03  5.72133589e-03  5.93131834e-03
  2.96703353e-02  1.19126544e-02  5.29508951e-02  3.74954050e-03
  1.13051630e-02  1.35695046e-02  6.08220707e-02  1.05567200e-02
  3.56889697e-02  1.42123175e-02  1.15804200e-02  2.91592489e-02
  2.46654247e-02 -7.80057206e-04  2.71612801e-02  5.90737782e-03
 -1.01937232e-03  4.20979563e-02  3.61611215e-02  3.09613371e-02
  5.95209602e-04  3.85207462e-02  1.89404374e-02  9.61908551e-03
  2.56694241e-03  1.16030752e-02  6.48182264e-03  2.45624039e-02
  1.18910386e-02  5.24702799e-04  9.09548734e-04  2.38334646e-03
  2.61379967e-02  1.09556172e-02  1.09316767e-02  3.55906008e-03
  3.01603985e-03  1.75707504e-02  1.25067276e-02  5.12256669e-03
  1.30926032e-02  1.16482271e-02  1.08272356e-02  1.97522147e-02
  3.96232245e-03  4.96455461e-03  1.01623296e-02  2.22447907e-03
  1.10483001e-02  1.34292793e-02  3.07299424e-03  7.88618752e-03
  4.66858209e-03  1.85649122e-02  2.31605269e-02  1.15423746e-02
  2.95652956e-03  1.22844859e-02  1.13121118e-02  3.38557862e-03
  1.85862783e-03  9.77539117e-03  1.95429741e-03  2.18491953e-02
  7.67039251e-03  4.01236590e-03  6.60056954e-02  4.91317859e-03
  3.10661857e-03  2.83063416e-02  5.27780841e-03  3.03866867e-03
  8.59819543e-03  1.32517462e-02  2.79970298e-03  1.20772762e-02
  2.32944208e-03  2.86211870e-03  2.43062474e-02  2.01380770e-03
  2.24782492e-02  1.21654486e-02  1.42323017e-02  5.40012874e-02
  1.61767523e-02  3.55581821e-02  2.15964011e-02  3.49055551e-02
  4.08270645e-03  6.98986094e-03  3.65886988e-03  1.65975796e-02
  4.97916319e-03  9.95158591e-03  9.68837556e-03  3.46771772e-03
  4.98598181e-03  4.06908397e-03  1.38410031e-02  3.51401565e-02
  2.22251751e-02  4.27754428e-02  2.59934263e-02  2.41849446e-02
  8.67700600e-04  1.60402317e-02  4.77018681e-03  1.76272777e-02
  6.68107509e-02  9.99909585e-02  3.79822443e-02  1.15454404e-02
  1.67615937e-02  2.80840371e-02  3.02714278e-02  1.23868927e-02
  2.12537559e-03 -6.83409833e-04  2.61903729e-02  1.64298444e-02
  5.71552333e-03  1.12646328e-02  1.15292597e-02  2.22311282e-02
  2.37539740e-03  1.23778124e-03  2.28871550e-02  2.94193289e-02
  4.03586730e-02  7.41759829e-03  1.51980871e-02  4.60213262e-02
  3.61315063e-02  1.73545503e-02  4.59757418e-02  8.57942691e-03
  1.76719895e-03  6.13459481e-03  1.68349536e-02  7.82224735e-03
  5.89890455e-02  3.08342990e-02  1.35789982e-02  3.41703341e-02
  2.14393678e-02 -7.07350355e-04  3.72809738e-02  4.97903303e-03
  1.45357624e-03  2.15751477e-03  7.73866087e-03  1.20860673e-02
  1.43986316e-03 -6.95990255e-04  1.66193872e-02  5.99266800e-02
  1.11474717e-02  2.35300656e-02  5.77776643e-02  7.06769828e-03
  2.87361018e-02  3.15886406e-02  3.51055646e-02  2.20226166e-02
  1.87067253e-02  2.61093132e-03  5.55043025e-03  8.15054349e-03
  5.67785006e-03  2.06898491e-02  9.79856154e-03  2.22758868e-03
  1.73306098e-02  2.34354935e-02  1.42960926e-02 -9.23687232e-04
  1.88204113e-02  2.42642181e-03  1.95253196e-03  1.00398184e-02
  5.70685746e-03  2.14111367e-02  1.32826256e-02  1.67855342e-02
  1.11714122e-02  2.31844674e-02  2.00214274e-02  1.26078831e-02
  1.12624392e-02  1.60965760e-02  2.37664542e-02  1.56463403e-03
  1.88659958e-02  3.53418233e-03  5.70554576e-03  2.40765372e-02
  5.03263776e-02  2.26015496e-02  4.25888471e-02  1.91382104e-02
  1.73300679e-02  5.32018585e-03  7.63440018e-02  4.55011414e-03
 -2.46300765e-04  3.93341686e-02  8.93535281e-03  3.53911700e-02
 -4.67614828e-04  1.97914398e-02  2.13388015e-02  2.13612018e-02
  2.29441900e-02  7.04410095e-03  4.03546648e-03  4.54819809e-03
  1.28768082e-02  1.07771594e-03  2.74197096e-02  1.59734432e-02
  7.47664911e-03  3.59256102e-03  3.34717268e-02  2.50839604e-02
  1.59765916e-02  3.99917279e-02  1.36521644e-02  1.62280409e-02
  1.79159436e-02  7.27408317e-03  5.76371213e-02  2.75884155e-02
  5.56490867e-03  4.42207858e-02  1.54138821e-02  4.09860207e-02
  5.21179292e-03  1.71142729e-02  7.45270858e-03  4.95093212e-03
  6.88369246e-03  2.71464026e-02  3.03998037e-03  3.80373941e-02
  1.60332830e-02  5.13185336e-02  5.58133168e-03  5.23573344e-03
  7.42416092e-03  3.17379783e-02  4.54855496e-03  7.89760722e-02
  5.91271546e-03  3.11771321e-02  1.03593212e-02  1.26658706e-02
  2.15525655e-02  3.28933112e-03  4.82148936e-03  3.40125438e-03
  1.62519814e-02  3.22982083e-03  1.38647031e-02  2.07076209e-03
  2.28709896e-03  3.32217563e-02  3.19113311e-02  1.23293772e-02
  4.20831595e-02  1.83792530e-03  1.29591243e-02  3.77079315e-03
  3.63777921e-02  3.37376142e-02  1.75703453e-02  8.29944644e-03
  1.20700234e-02  2.02372224e-02  5.48366641e-03  8.16590845e-02
  1.43162172e-02  2.68459570e-02  1.51263600e-02  1.84054616e-03
  1.64171303e-03  4.41114674e-02  1.01435262e-02  1.15748441e-02
  3.46518590e-02  6.50432882e-03  2.26382052e-02  2.64394519e-03
  7.18138433e-03  2.65663773e-03  2.99890701e-03  1.41335944e-02
  4.79716890e-02  7.87609974e-03  6.90454441e-03  2.43309567e-02
  3.64003492e-03  3.77647723e-02  3.06443337e-02  1.40151550e-02
  7.16284275e-03  9.42902278e-03  6.87386759e-03  7.50656098e-03
  4.49596567e-03  2.58513445e-02  2.79123081e-02  1.40998804e-02
  6.51905595e-04  3.39094079e-02  6.99842893e-04  1.79506749e-02
  9.33713596e-03  2.28931600e-02  6.99511187e-03  1.14913130e-02
  7.90261053e-03  4.87722592e-03  1.42112248e-02  4.21822390e-03
  1.26534675e-02  1.79224438e-02  3.93284753e-02  9.43893480e-03
  2.19624800e-03  9.51499883e-03  1.21447154e-02  1.17153729e-02
  5.69104094e-03  5.69798972e-03  2.95476411e-03  2.32207072e-03
  3.32430288e-03  1.05519930e-02  1.07444442e-02  4.46995889e-03
  2.09827393e-02  1.07153398e-02  1.86361988e-02  2.26731770e-02
  1.10863528e-02  5.09949119e-02  2.09706982e-02  1.89188585e-02
  1.48598532e-02  1.99497003e-02  8.81317671e-04  1.95225154e-03
  2.88119792e-02  4.99545604e-03  2.47004954e-02  7.42987980e-02
  6.87149483e-03  1.55694684e-02  6.88510099e-03  1.41087772e-01
  1.96603733e-02  2.03533839e-02  1.07746744e-01  4.88254475e-02
  6.93951617e-03  1.05377542e-03  6.36167799e-02  1.75464048e-02
  2.08148095e-02  8.48690899e-03  2.95186807e-02  6.00741113e-03
  1.91562325e-02  1.09054374e-02  1.11217743e-02  2.79514987e-02
  8.97001156e-02  3.43428846e-02  2.19575120e-02  2.83318497e-02
  6.56997740e-03  2.39963897e-02  1.62630126e-02  3.94565980e-02
  2.52274727e-02  1.11501029e-02  1.27401621e-01  3.05815108e-02
  4.30855258e-02  8.48039312e-02  9.53252813e-02  1.25300753e-02
  2.57130143e-02  8.94251010e-03  2.73479737e-04  4.46533758e-02
  5.13775086e-03  2.10000927e-02  1.84928971e-02  2.88422259e-03
  1.25796520e-02  9.65022656e-02  2.61621419e-02  1.15396937e-02
  7.87170909e-03  1.88384953e-02  1.87777911e-02  2.74652690e-03
  3.48576178e-02  1.49750730e-02  1.62697041e-03  1.80308180e-03
  8.57959255e-03  3.83569290e-02  1.57831393e-01  5.24676468e-03
  2.00714173e-02  5.72966937e-03  1.54041221e-02  1.41604763e-02
  1.69153140e-02  2.35701420e-02  1.05374616e-02 -2.57914420e-03
  3.97064407e-02  1.84002904e-02  6.28799195e-03  1.84689565e-02
  4.97977031e-02  2.10837101e-02  4.40252562e-03  2.11597741e-02
  1.57226702e-02  2.99374731e-02  1.61311679e-02  8.03804235e-03
  4.62809318e-02  2.89627004e-02  3.64565214e-02  2.68554351e-02
  4.14972724e-02  1.58934739e-02  2.04452707e-02  4.67944797e-02
  2.72381824e-02  4.68026738e-03  1.73619508e-03  1.93240734e-03
  9.56804978e-03  2.43659284e-02  2.18036108e-02  2.03675843e-03
  3.40897641e-02  4.41140570e-02  1.05552765e-02  2.49232470e-02
  2.37026314e-02  1.05730880e-01  5.63377037e-02  7.11096174e-02
  2.08082356e-03  9.40805467e-02  4.92766493e-02  1.37118973e-02
  7.03616065e-02  4.87059151e-02  1.71930768e-02  7.06940271e-03
  3.78293999e-02  2.78984985e-02  3.87686757e-02  1.21674936e-02
  2.10280041e-02  3.56432996e-03  9.96611732e-03  1.52069300e-02
  3.01039366e-03 -2.56179079e-03  1.01090221e-02  1.56770857e-02
  3.55026946e-02  1.32934070e-02  2.36570469e-02  1.15725222e-02
  5.53598086e-03  2.73842723e-03  7.29022410e-03  8.69151581e-03
  6.35364053e-03  4.15146132e-02  3.80998585e-02  2.40977663e-02
  2.66506851e-02  4.84391244e-02 -4.18248489e-04  5.14650721e-03
  1.53338960e-02  1.15214999e-02  5.24807154e-02  3.29311113e-02
  2.56724236e-02  8.76465075e-03  3.00592014e-02  2.66962696e-02
  8.70229866e-03  8.23158428e-02  6.14679591e-02  5.86540890e-02
  1.40144244e-02 -7.00943443e-04  1.13640946e-02  5.91397108e-03
  7.94155742e-05  7.82451159e-04  1.29963461e-03  1.99323469e-02
  1.63364338e-02  2.30969409e-02  1.56771370e-02  1.27084659e-02
  1.00880376e-01  2.41146198e-02  3.57919165e-02  4.18130821e-02
  2.53028848e-02  4.69216364e-02  1.68781018e-02  4.66088904e-03
  3.46306462e-02  2.66972101e-02  1.05096921e-02  4.81117532e-03
  1.51323040e-02  3.38112977e-03  2.41303137e-03  1.83977603e-02
  3.18686513e-02  9.21268590e-03  2.63777214e-02  4.05233532e-02
  9.53218803e-02  1.26252365e-02  1.96147888e-02  4.07433362e-02
  2.56160693e-02  8.29685292e-02  1.22909326e-02  8.88950989e-03
  1.37954186e-02  4.52188307e-03  7.23637171e-03  8.35571764e-02
  3.71110129e-02  5.52201457e-02  1.90429535e-02  5.55109967e-03
  1.44700570e-02  5.77722409e-02  6.19171285e-03  1.39873723e-02
  5.24125663e-02  8.18286797e-02  3.02489212e-02  3.46762307e-02
  4.34370750e-02  8.23983955e-02  2.27274022e-02  5.74551148e-03
  5.44533229e-02  1.33065661e-02  4.34826557e-02  3.42519490e-03
  6.02463872e-03  2.30166255e-02  4.28848992e-02  9.63620308e-02
  2.30999273e-02  7.39592986e-03  7.34714447e-03  1.88877545e-03
  3.59314599e-02  3.31327164e-03  2.58916141e-03  2.98084831e-02
  1.97380064e-02  2.32943672e-02  3.11081195e-02  3.64109369e-02
  1.87624313e-02  7.19873774e-03  3.55482790e-02  2.58938111e-02
  4.99505831e-02  3.19934769e-02  3.55004146e-02  1.09663206e-02
  4.13652317e-03  6.80720478e-02  1.89462817e-02  1.56944392e-02
  4.45464458e-02  7.53608419e-03  2.64822255e-02  4.92357957e-02
  6.13784164e-02  9.62430212e-02  1.57785808e-01  8.99790885e-02
  1.09380895e-02  7.16030768e-03  2.93090672e-02  4.01538144e-02
  5.98014873e-03  5.83895152e-03  2.25110653e-02  6.68820753e-03
  1.65042699e-02  5.16237236e-02  7.23156724e-03  2.75739200e-02
  3.74287431e-03  1.33972771e-03  1.49571639e-02  1.50421713e-02
  2.77618489e-02  3.16923939e-02  1.47291445e-03 -5.31869648e-04
  1.51729590e-02  1.59447488e-02  3.44393765e-02  3.72130944e-03
  3.47992405e-02  3.67912541e-02  4.63603523e-03  4.48121854e-03
  5.95432459e-02  7.40497804e-04  2.84207263e-02  5.95411462e-03
  3.95083156e-02  3.88142601e-02  1.03835896e-02  5.38482260e-02
  2.00942595e-02  4.77462180e-02  3.19679138e-02  3.48490147e-02
  2.12486266e-02  5.90531968e-03 -2.35691344e-04  2.21341132e-02]
2025-06-24 09:53:33,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:33,927 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:33,928 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:33,928 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:33,945 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:33,953 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:33,953 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:33,953 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:33,953 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:33,953 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:33,953 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:33,953 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:33,953 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:33,953 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:33,953 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:33,953 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:33,953 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:33,953 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:33,953 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:33,953 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:33,953 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:33,953 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,953 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,953 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:33,953 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:33,974 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:33,974 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:34,395 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = lightgbm
2025-06-24 09:53:36,317 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:36,317 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:36,317 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:36,317 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:36,317 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:36,317 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:36,317 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:36,335 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:36,807 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:36,807 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:36,807 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:36,807 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:36,807 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:36,807 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:36,807 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:36,807 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:36,807 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:36,955 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:36,955 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:36,955 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:36,955 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:38,073 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:38,954 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:38,954 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:38,958 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:38,986 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:38,986 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:38,986 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:38,986 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:40,027 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:40,471 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:40,471 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:40,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:40,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:40,678 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:40,678 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:40,678 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:40,678 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:40,678 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:40,678 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:40,727 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:40,727 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:40,727 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:40,727 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:40,727 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:40,727 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:40,727 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:40,782 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:40,782 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:40,782 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:40,915 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:40,915 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:40,915 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:40,915 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:40,915 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:40,915 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:40,915 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:40,915 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:40,915 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:40,915 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:40,915 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:40,915 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:40,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:40,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:40,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:40,988 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:41,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:41,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:41,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:41,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:41,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:41,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:41,289 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:41,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:41,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:41,372 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:41,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:41,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:41,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:41,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:41,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:41,517 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:41,517 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:41,542 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,542 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:41,542 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,542 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:41,552 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   learning_rate: 0.27145131192063576
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:41,556 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   n_estimators: 441
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   subsample: 0.8388888202790384
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9679527386504253
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0032641441634054954
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO -   reg_lambda: 3.55409111214763e-05
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:41,557 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:41,650 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:41,650 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03514067544057179})})
2025-06-24 09:53:41,650 - src.models.lightgbm_model - INFO -   - Best Iteration: 2
2025-06-24 09:53:41,650 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:41,652 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:41,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:41,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,653 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:41,684 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:41,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:41,739 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:41,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:41,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:41,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:41,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:41,827 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,833 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:41,838 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:41,838 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:41,838 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:41,838 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:41,838 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,838 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,838 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:41,838 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:41,844 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:41,851 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:41,854 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 7.15331253e-04  1.27256600e-03  1.37038887e-03  1.91565131e-03
  1.59197099e-03  3.39923487e-03  3.37335137e-03  3.61404437e-03
  3.49367040e-03  1.29586958e-03  2.48641631e-02  1.23032081e-02
  2.52259513e-03  4.05576218e-03  6.30886977e-02  2.70915364e-02
  2.01347418e-03  2.87561143e-03  1.02467867e-03  2.75614956e-03
  3.73208187e-03  4.86309674e-03  5.50618205e-03  2.91280094e-03
  7.64629293e-03  2.81515766e-02  5.53934575e-03  2.23252612e-03
 -2.66237107e-04  2.52052796e-03  1.94628976e-02  2.27607978e-02
  1.83712819e-03  2.39875234e-02  1.72775078e-02  2.60169827e-03
 -4.87673145e-04  2.03616121e-03  3.93772468e-03  3.92818336e-03
  5.01572230e-03  4.15358505e-03  1.57412846e-02  2.42922918e-02
  2.36814384e-03  2.35857270e-03  2.77787978e-02  2.55636744e-03
  2.55294297e-02  2.33268920e-03  4.85564647e-02  4.89768480e-03
  1.19404288e-03  2.08601500e-03  3.35232401e-03  1.66234090e-02
  3.46959478e-02  1.59803237e-02  2.43565319e-02  2.26971564e-03
  7.52825543e-03  2.71081873e-03  2.49671163e-03  2.49996172e-02
 -1.56334590e-03  2.28962520e-02  1.87213877e-03  3.83357721e-02
  2.79971253e-02  2.51935528e-02  5.71570710e-02  6.93595308e-02
  3.37465540e-02  3.12954738e-02  4.08263465e-03  2.70656529e-02
  8.30759763e-03  5.51346225e-03  5.42282115e-02  9.38327039e-03
  1.17912996e-03  1.14141829e-03  2.73026606e-03  5.09354884e-02
  3.97723906e-03  2.14636890e-02  1.41104719e-02 -2.71227161e-05
  4.81962672e-02  3.25925826e-02  5.46887620e-02  5.05291182e-03
  1.32229349e-02  9.84382082e-03  9.86970432e-03  2.65894699e-02
  4.11664173e-02  3.55754002e-02  5.00053922e-02  5.79923801e-02
  3.92367964e-02  7.22380165e-02  2.69190940e-03  2.20547547e-03
  1.26407345e-02  3.78304278e-02  1.33505213e-02  9.70480466e-03
  1.58215075e-02  1.87635199e-02  6.07856960e-02  3.73959149e-02
  5.00435163e-02  1.35049726e-02  6.35724611e-02  8.09435651e-04
  2.66602590e-03  1.55827468e-02  1.73068088e-02  1.59160835e-02
  3.69281167e-02  8.76214183e-03  5.66654471e-03  7.07283618e-03
  3.69234687e-02  6.02974123e-03  5.29474045e-02  2.88334852e-03
  1.58902364e-02  1.26998608e-03  6.87609758e-02  2.91864532e-02
  1.17968640e-01  9.22266072e-02  5.69775860e-03  6.18419252e-03
  5.83243627e-02  6.81848579e-02  3.53793476e-02  1.14204472e-01
  1.23069125e-02  3.59620072e-03  4.94962124e-02  1.10019135e-02
  7.96466013e-04  2.39589551e-02  1.95757482e-02  3.30128234e-02
  6.56740190e-02  5.34715593e-02  1.33541656e-02  1.30383113e-02
  5.47146455e-02  9.52371631e-03  4.05675115e-03  3.56602921e-02
  1.54025096e-02  5.25918095e-02  4.67130162e-02  8.63494287e-03
  2.73306187e-02  5.69167073e-02  4.84664967e-02  9.60488447e-04
  3.23991905e-02  3.10446754e-02  8.14850894e-03  8.05148308e-02
  2.88927254e-02  6.66334177e-02  5.71812512e-02  5.94885872e-02
  3.02353252e-02  8.88307309e-02  8.57775901e-02  4.62208584e-03
  2.90199243e-02  3.13071661e-02  2.77845749e-02  2.87382741e-02
  3.99319857e-02  6.15830903e-03  2.56830170e-02  4.85832363e-02
  3.87683195e-02  2.55475629e-02  3.13346326e-02  4.24899326e-02
  1.68169573e-02  1.25483652e-02]
2025-06-24 09:53:41,854 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:41,854 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:41,855 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:41,856 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:41,872 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:41,880 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:41,880 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:41,880 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:41,880 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:41,880 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:41,880 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:41,880 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:41,880 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:41,880 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:41,880 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:41,880 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:41,880 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:41,880 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:41,880 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:41,880 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:41,880 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:41,880 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,880 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,880 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:41,880 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:41,901 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:41,901 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:42,329 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = lightgbm
2025-06-24 09:53:44,266 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:44,266 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:44,266 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:44,266 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:44,266 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:44,266 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:44,266 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:44,284 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:44,752 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:44,752 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:44,752 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:44,752 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:44,752 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:44,752 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:44,752 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:44,752 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:44,752 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:44,894 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:44,894 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:44,894 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:44,894 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:46,008 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:46,834 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:46,834 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:46,839 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:46,868 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:46,868 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:46,868 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:46,868 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:47,835 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:48,238 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:48,238 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:48,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:48,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:48,432 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:48,432 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:48,432 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:48,432 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:48,432 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:48,432 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:48,479 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:48,479 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:48,479 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:48,479 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:48,479 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:48,479 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:48,480 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:48,529 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:48,529 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:48,529 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:48,660 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:48,660 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:48,660 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:48,660 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:48,660 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:48,660 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:48,660 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:48,660 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:48,660 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:48,660 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:48,660 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:48,660 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:48,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:48,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:48,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:48,724 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:48,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:48,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:48,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:48,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:48,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:48,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:48,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:49,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:49,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:49,074 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:49,098 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:49,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:49,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:49,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:49,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:49,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:49,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:49,229 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,229 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:49,229 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,229 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:49,239 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   learning_rate: 0.18507739953392208
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   n_estimators: 501
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   subsample: 0.9255363949136147
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9478516979033457
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0016453016635939743
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO -   reg_lambda: 3.889292533372911
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:49,243 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:49,357 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:49,357 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035117341885718384})})
2025-06-24 09:53:49,357 - src.models.lightgbm_model - INFO -   - Best Iteration: 12
2025-06-24 09:53:49,357 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:49,359 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:49,359 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:49,359 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,359 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:49,389 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:49,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:49,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:49,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:49,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:49,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:49,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:49,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:49,536 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:49,536 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:49,536 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:49,536 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:49,536 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,536 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,536 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:49,536 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:49,543 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:49,550 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:49,552 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00040264 0.00164746 0.00143042 ... 0.00465298 0.0160004  0.01206179]
2025-06-24 09:53:49,552 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:49,553 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:49,553 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:49,554 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:49,570 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:49,577 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:49,578 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:49,578 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:49,578 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:49,578 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:49,578 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:49,578 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:49,578 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:49,578 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:49,578 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:49,578 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:49,578 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:49,578 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:49,578 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:49,578 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:49,578 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:49,578 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,578 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,578 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:49,578 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:49,600 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:49,600 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:50,002 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = lightgbm
2025-06-24 09:53:51,782 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:51,783 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:51,783 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:51,783 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:51,783 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:51,783 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:51,783 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:51,802 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:52,243 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:52,243 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:52,243 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:52,243 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:52,243 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:52,243 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:52,243 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:52,243 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:52,243 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:52,404 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:52,404 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:52,404 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:52,404 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:52,404 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:52,404 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:52,405 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:52,405 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:52,405 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:52,405 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:53:53,441 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:53:54,261 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:54,261 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:53:54,266 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:53:54,294 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:53:54,294 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:53:54,294 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:53:54,294 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:55,263 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:53:55,673 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:53:55,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:55,802 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:55,802 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:53:55,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:53:55,871 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:55,871 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:53:55,871 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:53:55,871 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:55,871 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:55,928 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:53:55,928 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:53:55,928 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:55,928 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:55,928 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:53:55,928 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:53:55,928 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:55,977 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:55,977 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:53:55,977 - src.training - INFO - 모델 학습 시작
2025-06-24 09:53:56,091 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:53:56,091 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:53:56,091 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:53:56,092 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:53:56,092 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:53:56,092 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:53:56,092 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:53:56,092 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:53:56,092 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:56,092 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:53:56,092 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:53:56,092 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:53:56,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:53:56,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:56,092 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:56,154 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:56,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:56,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:56,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:56,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:56,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:56,411 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:53:56,411 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:56,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:53:56,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:56,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:56,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:56,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:56,504 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:56,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:56,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:56,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:56,599 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:56,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:56,636 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:56,636 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:56,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:53:56,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:56,660 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:53:56,660 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:56,660 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:53:56,669 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:53:56,673 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   learning_rate: 0.12954824612423743
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   n_estimators: 98
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   subsample: 0.8112141622588307
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9260449527056052
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009995808450449633
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO -   reg_lambda: 0.10706547190904596
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:53:56,674 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:53:56,806 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:53:56,806 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.0351129565343115})})
2025-06-24 09:53:56,806 - src.models.lightgbm_model - INFO -   - Best Iteration: 14
2025-06-24 09:53:56,806 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:53:56,808 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:53:56,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:53:56,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:56,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:53:56,839 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:53:56,862 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:53:56,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:53:56,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:53:56,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:53:56,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:53:56,969 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:53:56,969 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:56,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:53:56,982 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:53:56,982 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:53:56,982 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:53:56,982 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:53:56,982 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:56,982 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:53:56,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:53:56,982 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:53:56,989 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:53:56,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:53:56,997 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00038013 0.00046992 0.00035508 ... 0.01394154 0.0338242  0.00502804]
2025-06-24 09:53:56,997 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:53:56,998 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:56,998 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:56,999 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:57,015 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:53:57,022 - src.training - INFO -   precision: 0.0
2025-06-24 09:53:57,022 - src.training - INFO -   recall: 0.0
2025-06-24 09:53:57,022 - src.training - INFO -   f1: 0.0
2025-06-24 09:53:57,022 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:53:57,022 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:53:57,022 - src.training - INFO -   positive_samples: 456
2025-06-24 09:53:57,022 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:53:57,022 - src.training - INFO -   total_samples: 368238
2025-06-24 09:53:57,022 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:53:57,022 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:53:57,022 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:53:57,022 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:53:57,022 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:53:57,022 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:53:57,022 - src.training - INFO - 모델 학습 완료
2025-06-24 09:53:57,022 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:53:57,022 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:57,022 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:57,022 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:53:57,022 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:53:57,042 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:53:57,042 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:53:57,456 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = lightgbm
2025-06-24 09:53:59,302 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:53:59,302 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:53:59,302 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:53:59,302 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:53:59,302 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:53:59,302 - src.training - INFO - 교차 검증 시작
2025-06-24 09:53:59,302 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:53:59,321 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:53:59,775 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:53:59,775 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:53:59,775 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:53:59,775 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:53:59,775 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:53:59,775 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:53:59,775 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:53:59,775 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:53:59,775 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:53:59,942 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:53:59,942 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:53:59,942 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:53:59,942 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:01,058 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:01,946 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:01,947 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:01,952 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:01,980 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:01,980 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:01,980 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:01,980 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:03,020 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:03,454 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:03,454 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:03,593 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:03,593 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:03,662 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:03,662 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:03,662 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:03,662 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:03,662 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:03,662 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:03,712 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:03,712 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:03,712 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:03,712 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:03,712 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:03,712 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:03,712 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:03,768 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:03,768 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:03,768 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:03,898 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:03,898 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:03,898 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:03,898 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:03,898 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:03,898 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:03,898 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:03,898 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:03,898 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:03,898 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:03,898 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:03,898 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:03,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:03,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:03,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:03,972 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:04,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:04,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:04,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:04,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:04,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:04,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:04,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:04,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:04,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:04,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:04,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:04,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:04,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:04,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:04,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:04,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:04,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:04,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:04,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:04,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:04,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:04,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:04,522 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:04,522 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:04,522 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:04,531 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   learning_rate: 0.015953931804349637
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   n_estimators: 415
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   subsample: 0.9789455694045592
2025-06-24 09:54:04,535 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9991613164008715
2025-06-24 09:54:04,536 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:54:04,536 - src.models.lightgbm_model - INFO -   reg_alpha: 6.456208343096671e-05
2025-06-24 09:54:04,536 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1200870633038303e-07
2025-06-24 09:54:04,536 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:04,536 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:04,536 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:04,887 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:04,887 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035120112528498094})})
2025-06-24 09:54:04,887 - src.models.lightgbm_model - INFO -   - Best Iteration: 73
2025-06-24 09:54:04,887 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:04,889 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:04,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:04,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:04,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:04,922 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:04,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:04,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:05,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:05,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:05,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:05,074 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:05,074 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:05,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:05,111 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:05,111 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:05,111 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:05,111 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:05,111 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:05,111 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:05,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:05,111 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:05,118 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:05,125 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:05,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00051282 0.0005217  0.00052688 ... 0.00159955 0.00299961 0.00393832]
2025-06-24 09:54:05,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:05,128 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:05,128 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:05,129 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:05,145 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:05,152 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:05,152 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:05,152 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:05,152 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:05,152 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:05,152 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:05,152 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:05,152 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:05,152 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:05,152 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:05,152 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:05,152 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:05,153 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:05,153 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:05,153 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:05,153 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:05,153 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:05,153 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:05,153 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:05,153 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:05,173 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:05,173 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:05,586 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = lightgbm
2025-06-24 09:54:07,498 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:07,498 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:07,498 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:07,498 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:07,498 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:07,498 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:07,498 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:07,516 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:07,986 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:07,986 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:07,986 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:07,986 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:07,986 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:07,986 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:07,986 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:07,986 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:07,986 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:08,128 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:08,128 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:08,128 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:08,128 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:09,249 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:10,129 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:10,129 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:10,135 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:10,163 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:10,163 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:10,163 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:10,163 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:11,200 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:11,618 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:11,618 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:11,753 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:11,753 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:11,820 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:11,820 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:11,820 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:11,820 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:11,820 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:11,820 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:11,869 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:11,869 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:11,869 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:11,869 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:11,869 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:11,869 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:11,869 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:11,920 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:11,920 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:11,920 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:12,052 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:12,052 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:12,052 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:12,052 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:12,052 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:12,052 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:12,052 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:12,052 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:12,052 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:12,052 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:12,052 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:12,052 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:12,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:12,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:12,116 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:12,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:12,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:12,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:12,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:12,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:12,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:12,379 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:12,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:12,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:12,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:12,468 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:12,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:12,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:12,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:12,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:12,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:12,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:12,597 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:12,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:12,622 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:12,622 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:12,622 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:12,632 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:12,636 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:12,636 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:12,636 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:12,636 - src.models.lightgbm_model - INFO -   learning_rate: 0.11087159867996219
2025-06-24 09:54:12,636 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:12,636 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   n_estimators: 679
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   subsample: 0.9403050846328712
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9758227150453681
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0131157393738157e-08
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO -   reg_lambda: 0.8523746549601214
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:12,637 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:12,769 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:12,769 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035112392185549166})})
2025-06-24 09:54:12,769 - src.models.lightgbm_model - INFO -   - Best Iteration: 14
2025-06-24 09:54:12,769 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:12,771 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:12,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:12,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:12,801 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:12,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:12,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:12,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:12,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:12,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:12,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:12,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:12,950 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:12,950 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:12,950 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:12,950 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:12,950 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:12,950 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:12,950 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:12,950 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:12,957 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:12,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:12,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00041391 0.00039222 0.00172708 ... 0.01412618 0.00401081 0.00768178]
2025-06-24 09:54:12,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:12,966 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:12,967 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:12,967 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:12,983 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:12,990 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:12,990 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:12,990 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:12,990 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:12,990 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:12,990 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:12,990 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:12,990 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:12,990 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:12,990 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:12,990 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:12,990 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:12,991 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:12,991 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:12,991 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:12,991 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:12,991 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,991 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:12,991 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:12,991 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:13,013 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:13,013 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:13,423 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = lightgbm
2025-06-24 09:54:15,243 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:15,244 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:15,244 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:15,244 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:15,244 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:15,244 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:15,244 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:15,262 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:15,721 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:15,722 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:15,722 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:15,722 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:15,722 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:15,722 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:15,722 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:15,722 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:15,722 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:15,889 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:15,889 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:15,889 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:15,889 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:16,938 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:17,809 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:17,809 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:17,812 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:17,840 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:17,840 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:17,840 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:17,840 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:18,884 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:19,328 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:19,328 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:19,465 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:19,465 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:19,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:19,534 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:19,534 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:19,534 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:19,534 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:19,534 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:19,584 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:19,584 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:19,584 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:19,584 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:19,584 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:19,584 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:19,584 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:19,640 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:19,640 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:19,640 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:19,773 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:19,773 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:19,773 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:19,773 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:19,773 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:19,773 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:19,773 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:19,773 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:19,773 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:19,773 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:19,773 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:19,773 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:19,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:19,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:19,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:19,846 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:19,901 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:19,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:20,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:20,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:20,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:20,148 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:20,148 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:20,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:20,201 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,202 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:20,232 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:20,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:20,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:20,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:20,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:20,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:20,376 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:20,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,401 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:20,401 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,401 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:20,410 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   learning_rate: 0.22703332024128894
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:20,414 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   n_estimators: 738
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   subsample: 0.682593228121369
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8224029138278149
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   reg_alpha: 6.007326216970683e-06
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO -   reg_lambda: 7.268356621597371e-08
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:20,415 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:20,514 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:20,514 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.0351385509716339})})
2025-06-24 09:54:20,514 - src.models.lightgbm_model - INFO -   - Best Iteration: 5
2025-06-24 09:54:20,514 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:20,516 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:20,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:20,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:20,549 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:20,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:20,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:20,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:20,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:20,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:20,694 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:20,694 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,701 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:20,706 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:20,706 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:20,706 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:20,706 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:20,707 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,707 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,707 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:20,707 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:20,712 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:20,719 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:20,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [ 5.32088759e-04  1.58781244e-03  1.31379012e-03  1.16747797e-03
  1.60353866e-03  1.68535463e-03  1.93745095e-03  1.12477053e-03
  2.25399894e-03  2.31719521e-03  2.58791123e-03  6.78400911e-04
  1.98328292e-03  2.68689355e-03  1.45868282e-03  1.44150029e-03
  1.24929393e-03  1.74985081e-03  1.27108268e-03  2.12959508e-03
  3.29152186e-03  2.40031109e-03  2.46350737e-03  3.02080584e-03
  1.60499498e-03  1.33871020e-02  1.42027669e-03  2.93181522e-03
  3.80708561e-03  2.95760957e-03  4.37999395e-03  1.70241531e-03
  4.80595551e-03  1.97829636e-03  2.14474108e-02  4.90963384e-04
  1.11251752e-02  1.30566420e-03  2.04362730e-03  1.89834597e-03
  2.08376310e-03  3.29441697e-03  4.47204322e-03  7.23598717e-03
  3.74379681e-03  4.73837311e-03  1.40289616e-02  8.17092621e-02
  2.30290969e-02  4.78430737e-03  2.68524846e-02  3.99489451e-03
  3.24407937e-03  3.26572752e-03  1.81864756e-02  3.49482146e-03
  2.02286937e-03  1.94830957e-02  2.54148391e-03  9.97512656e-04
  2.23225827e-03  2.81720274e-03  3.40988451e-03  3.03942553e-03
  5.07228540e-03  3.18343673e-03 -6.96985821e-04  4.09440224e-03
  2.48212705e-03  1.56502688e-03  1.39560608e-03  3.61793663e-03
  6.96527116e-03  1.89765465e-02  2.63630907e-03  4.31679685e-03
  4.94406014e-03  2.73422338e-03  5.73723011e-03  5.08676983e-03
  6.83446961e-03  3.18187593e-03  4.66544740e-03  2.45893007e-03
  1.76365967e-02  1.83166678e-03  6.29452859e-03  3.16073831e-02
  1.05126050e-02  2.76614688e-02  4.52630610e-03  5.71403312e-03
  4.60230920e-03  8.75042082e-03  4.81712494e-03  3.39079161e-03
  1.75418898e-03  1.92740219e-02  2.74033134e-03  1.30531897e-02
  2.37817920e-03  3.22683457e-03  5.25430459e-02 -8.53964084e-04
  1.58004873e-03  5.59081341e-02  1.84051221e-02  3.10939034e-03
  3.95184892e-03  1.94200540e-03  3.76578861e-03  2.97022136e-03
  3.49945872e-03  3.09077066e-03  2.05888984e-02  3.56074687e-03
  3.43492425e-03  1.92338572e-03  1.45228747e-02  3.10101196e-03
  2.91272072e-03  2.09228107e-02  3.18633185e-03  1.41069599e-02
  4.32379274e-03  1.51898382e-02  3.33695880e-03  6.56813971e-03
  4.26561052e-03  1.09990349e-02  8.33976801e-03  2.30580546e-04
  2.33581490e-03  2.72313574e-02  6.03683764e-03  3.42108747e-02
  1.96267370e-02  5.97758588e-02  8.75970092e-03  3.31303666e-03
  5.65974418e-02  3.29581241e-03  5.23395726e-03  1.37422867e-02
  6.11438425e-03  3.82873375e-03  6.76579780e-02  3.41327611e-03
  1.80713408e-02  5.28123783e-03  4.54351382e-03  1.59348376e-02
  3.93154604e-02  2.22848350e-04  2.75685837e-03  2.27823110e-03
  1.06645624e-03  8.11151009e-02  1.48494124e-02  3.83070899e-02
  9.45410118e-03  4.23730409e-02  2.84436119e-03  2.51093991e-02
  7.30191158e-03  6.94648449e-03  1.02389939e-02  4.26839690e-03
  8.99700502e-03  3.57936655e-03  2.64535213e-03  2.50643526e-03
  7.09641792e-03  4.65070996e-03  1.16039434e-02  2.39725717e-02
  3.70109703e-02  9.68022611e-04  3.17562335e-04  1.22728873e-02
  4.79702212e-03  5.44654698e-03  1.43814936e-02  3.26647789e-02
  2.96105084e-02  5.19349866e-03  3.01696901e-02  2.00751509e-03
  2.20177278e-02  1.87537914e-03  3.54501092e-03  5.65190194e-03
  1.01731492e-02  1.44730136e-02  1.95923073e-03  4.13512067e-02
  2.94857322e-03  1.55115914e-02  1.97035835e-03  3.17827348e-03
  6.69299273e-03  3.31558980e-02  1.20761174e-02  3.56118764e-03
  4.36801337e-03  2.26681881e-02  3.28033660e-02  3.14415948e-03
  1.84987398e-02  2.39679888e-03  9.27349039e-03  1.88569730e-02
  3.79605557e-02  6.09273611e-03  4.39911751e-03  7.26861725e-03
  2.10380018e-02  7.80002884e-03  2.09250018e-03  6.79741252e-03
  2.12593127e-02  2.40830049e-03  6.36449340e-03  3.30925792e-03
  1.81936752e-03  1.58939060e-02  6.16618492e-02  4.13490178e-02
  6.72903264e-02  3.17761063e-02  5.19539534e-02  5.70754624e-03
  3.43149045e-02  2.96050468e-03  6.75981916e-02  3.33423200e-02
  1.17610839e-03  5.76284100e-02  3.54643230e-02  3.97223490e-02
  4.06232961e-02  3.52373650e-02  6.71799570e-04  2.17200416e-02
  3.72297862e-03  3.26525270e-03  2.07857436e-02  5.06849091e-03
  3.46271687e-02  6.39833282e-02  5.02791172e-03  1.32063968e-02
  7.31780314e-03  4.19547119e-03  2.77503793e-03  2.28718344e-02
  2.36004707e-03  3.58534087e-02  1.84690891e-02  1.78204723e-03
  8.03886755e-03  1.77280866e-03  8.72877268e-03  4.49209377e-02
  1.46444493e-02  6.56419437e-03  8.42729213e-03  1.42756528e-02
  3.72802490e-03  3.79509584e-03  1.10808509e-02  2.70017519e-02
  4.83063275e-03 -7.75653483e-04  2.18917727e-02  3.15662534e-03
  1.44682441e-03  4.79525776e-02 -2.57454597e-04  2.27999342e-02
  7.23888228e-03  3.68998601e-03  7.06261297e-03  2.74877617e-02
  2.85325765e-02  3.77180197e-03  1.59383054e-02 -1.69320574e-04
  3.46543095e-03  2.02197915e-03  4.92730551e-03  5.86342495e-02
  1.35595332e-01  8.23696399e-03  2.08181763e-02  1.44845902e-02
  1.18657113e-01  4.54249237e-02  6.74195046e-02  1.21066306e-02
  5.46171989e-03  4.50995520e-02  6.74225347e-03  4.09414451e-03
  1.98882515e-02  6.48960161e-03  1.44203990e-03  1.74845842e-02
  2.82778537e-03  6.67736550e-03  3.98013974e-03 -4.14242246e-04
  2.18058231e-03 -1.17979589e-03  7.02830045e-03  7.53484973e-03
  5.45359035e-03  1.18019153e-02 -4.58675864e-03  7.48166591e-03
  1.00790669e-02  2.73676057e-02  2.61902871e-02  1.25134686e-02
  2.38665235e-03 -2.76995916e-03  1.85194524e-02  4.27668359e-02
  1.61296483e-02  6.44432756e-02  3.33090606e-03  1.05583390e-02
  1.11992909e-02  8.57076706e-02  5.82986293e-02  1.40020417e-02
  4.34071229e-02  1.46090573e-02  3.12684634e-02  8.31611266e-02
  6.27855345e-03  4.41230917e-03  2.85571842e-02  2.02791943e-02
  2.23080667e-02  6.54475944e-02  9.47059400e-03  4.01080654e-03
  3.65331416e-03  1.50296391e-02 -7.64487908e-04  2.20661683e-03
  5.98905077e-03  8.44550602e-02  9.10662374e-03  3.81247249e-02
  1.84771080e-02  3.56677856e-02  5.06875921e-02  5.27444531e-03
 -2.68875406e-04  2.75434119e-02  1.96993954e-02  4.61243339e-02
  3.00575624e-02  3.24649634e-02  5.19710846e-03  3.09678403e-03
  8.14434574e-03  2.86528122e-02  3.42586443e-02  3.64110010e-02
  4.22553006e-02  1.62980950e-02  6.09979076e-03  3.54178089e-02
  3.56672474e-02  2.78887632e-02  1.16542275e-02  1.25464984e-02
  3.74724430e-03  1.00416012e-02  2.31381643e-02  4.66126681e-03
  6.87922849e-03  6.08530633e-03  7.40978912e-02  2.11555050e-02
  2.48142466e-02  3.10240874e-02  5.69462485e-02  2.04426691e-03
  1.47140602e-02 -5.15402726e-04  2.30109587e-02  3.41926999e-03
  6.97834045e-02  9.05836824e-03  3.41487549e-03  6.61322144e-02
  4.11232580e-03  4.15529891e-03  2.20021910e-02 -2.39050405e-03
  1.53682005e-02  2.95716192e-02  4.08389921e-03  1.43628739e-02
  3.48492645e-02  4.23940241e-02  7.59141426e-03  5.23338025e-02
  2.53096793e-02  1.67316100e-02  3.16491747e-02  1.20000117e-02
  8.28641693e-03  7.08390813e-03  3.53845401e-02  1.04560405e-02
  7.22174173e-02  1.12069718e-02  5.96347165e-03  2.68308365e-02
  4.38159210e-02  8.67368030e-03  3.71876877e-02  1.53419741e-02
  3.85099148e-02  1.85706651e-02  1.98013108e-02  4.01462096e-03
  4.51495466e-03  1.86435908e-02  2.25243676e-03  1.23389674e-02
  2.41188839e-02  9.79988540e-03  4.75282515e-02  3.34750881e-02
  4.47819865e-03  5.51587075e-02  1.03369375e-02  1.33755935e-02
  8.89726834e-03  8.25591414e-03  5.22950641e-02  1.14729020e-02
  7.29205726e-02  5.89924902e-02  1.58712345e-02  1.65554028e-02
  2.99698211e-03  3.27465948e-02  7.83680934e-03  7.44392403e-03
  3.71178199e-02  8.31247868e-03  2.96544360e-03  2.33027080e-02
  1.36861751e-02  6.73173826e-03  9.18730778e-03  6.70315984e-03
  1.11473525e-02  2.26450226e-02 -3.24525535e-04  8.24481206e-02
  4.31675995e-02  6.37533743e-03  1.60811498e-02  2.43563007e-02
  4.49286639e-03  1.79100772e-02  2.95047188e-03  5.81004304e-03
  2.99699377e-03  1.17502555e-02  1.29572775e-03  4.59081917e-03
  6.72705405e-03  8.55240035e-03 -3.83599810e-04  1.52491311e-02
  5.00412013e-03  3.31672772e-02  5.85792640e-02  3.56228346e-03
  5.77695705e-02  3.43970790e-03  6.51635270e-02  2.59247744e-02
  1.68524477e-02  1.00199531e-02 -4.54133584e-03  1.94934998e-02
  8.12456362e-02  2.67490019e-02  3.15062718e-02  4.77963521e-02
  1.85203879e-02  1.17975300e-01  1.40942866e-02  6.26923152e-03
  9.91028927e-03  1.10805309e-01  3.64985134e-02 -1.66957032e-03
  2.13288254e-03  8.20902704e-04  1.52213818e-03  2.08450207e-02
  1.05568074e-02  6.16284632e-03  6.09270730e-02  5.88159195e-02
  2.11482440e-02  3.07706252e-02  3.25666516e-02  3.40047113e-02
  6.32047691e-02  2.22370574e-02  1.18844916e-02  6.49063431e-02
  8.51219587e-02  3.98050012e-02  6.61393192e-03  1.64717628e-02
  1.58253669e-02  8.47928631e-04  2.11287115e-02  2.81253950e-02
  9.85578386e-03  3.40865273e-02 -3.76846784e-03 -1.42910925e-02
  1.19092239e-01  2.14056249e-02  2.41317182e-02  8.22074267e-03
  7.01616479e-04  4.21775587e-03  1.50449686e-03  1.11433476e-03
  4.63874487e-04  2.71518300e-03  2.16783257e-03  1.66962841e-03
  8.36823290e-03  3.00041049e-02  1.35541837e-01  8.78481844e-03
  2.34516320e-02  2.93623817e-02 -1.85599238e-03  2.81826887e-03
  1.78002649e-02  5.51835894e-03  7.45303376e-03  1.69420508e-03
  2.93926780e-02 -4.51968770e-03  7.50159304e-02  1.45796871e-02
  7.90245913e-03  3.83673937e-02  3.02981390e-02  8.43954970e-03
  8.04309228e-03  1.97114198e-02  5.09550691e-03  4.96486984e-03
  1.81549294e-02  7.17821781e-03  2.29689170e-03  5.07230992e-03
  5.90855827e-02  2.95064902e-02  2.34962182e-02  4.06911497e-02
 -4.05247953e-04  5.31918374e-02  2.39204355e-02  4.02749774e-02
  3.35606806e-02  1.90696721e-02  2.19601943e-02  5.64332726e-02
  3.96217005e-02  2.61965762e-02  7.21185021e-02  2.47970752e-03
  1.83707462e-02  2.20010162e-02  2.69416341e-03  2.14940147e-03
  1.52331625e-03  3.83382759e-03 -3.63073530e-04  1.89558549e-02
  1.94618803e-03  1.53786440e-03  3.47471059e-02  3.59437218e-02
  3.60093215e-03  7.31519282e-02  3.77582725e-02  2.55788964e-02
  2.77065827e-02  5.61533012e-03  8.41538972e-03  3.22814844e-02
 -3.70359351e-03  8.66607670e-02  6.93760153e-03  2.07396873e-02
  5.49279722e-02 -7.69911533e-04  3.34348632e-02  7.10611694e-02
  9.64454752e-02  2.88158576e-02  2.38040292e-02  1.84448855e-02
  1.79749093e-02  8.00855172e-03  1.73244490e-02  4.97848306e-02
  5.17205928e-02  5.22376327e-02  5.15018709e-02  9.49260834e-03
  3.08917700e-02  3.08558115e-02  5.21808246e-03  3.21116534e-02
  1.00904223e-01  2.38029023e-02  6.99846420e-02  1.34897787e-02
  4.44504663e-03  1.68417655e-03  2.08318563e-02 -3.29452532e-03
  5.50738448e-02  9.03749306e-03  8.20629307e-02  3.00858385e-02
  3.75728776e-02  2.91533356e-03  3.49945565e-02  1.17811870e-02
  4.40381253e-03  3.67232883e-03  1.22332448e-02  3.76573662e-02
  2.94413117e-02  8.37724117e-03  1.11754672e-02  1.48545523e-03
  3.22317024e-02  4.95225632e-02  5.03163503e-02  4.47501914e-02
  6.78497581e-03  3.68375386e-03  2.62781781e-02  7.52451862e-03
  1.27162033e-02  2.09860813e-03  3.52601668e-03  1.68754776e-02
  1.33666636e-02  2.06010352e-02  5.35619449e-03  1.90212065e-02
  3.82412425e-02  5.07621707e-02  3.61784438e-02  5.81234061e-02
  3.81376639e-02  5.63757063e-02  5.97364206e-02  3.59955937e-02
  2.03478014e-02  1.91201877e-02  2.33196030e-03  3.64626449e-02
  1.65770509e-02  4.72713090e-02  5.87979013e-02  6.70733061e-02
  3.93916580e-02  2.85124633e-02  2.74906841e-03  2.39990678e-02
  8.12490825e-03  1.56061699e-02 -1.28623223e-03  6.69133880e-02
  5.96538161e-02  3.42413396e-03  8.16356221e-02  8.65203216e-03
  1.24918204e-02 -2.10807817e-03  3.15403122e-02  1.25541649e-02
  2.68232281e-03  2.83842163e-02  2.43730002e-03  3.15764239e-03
  2.93502017e-03  8.06943026e-03  1.91444911e-03  4.20549813e-03
  3.86449438e-03  3.94195504e-02  1.33277404e-02  1.89775031e-02
  2.93951112e-02  9.98294251e-02 -3.68155301e-03  3.97081536e-02
  3.16297941e-02  9.71645215e-02  2.78870801e-03  2.48695239e-02
  3.86783460e-03  3.06267402e-02  1.82288519e-03  5.75194874e-02
  2.31143984e-03  6.75025103e-03  7.41834039e-02  2.70020745e-02
  2.98242058e-03  3.87283164e-02  1.64256726e-02  4.02200358e-02
  1.63754568e-03  4.18253538e-02  4.10213026e-02  3.55374799e-03
  3.52300760e-02  1.92633156e-02  2.24438067e-03  5.89369730e-02
  1.46615031e-02  3.91814505e-02  1.06970046e-01  1.41219436e-02
  2.60618665e-02  1.45140128e-02  1.34272126e-02  2.23323537e-02
  2.47144655e-02  2.01020648e-02  2.02483770e-02  2.49764023e-02
  2.78924763e-03  1.28625154e-02  1.35129757e-02  1.41402390e-02
  8.84629963e-02  1.49123353e-03  3.20330105e-02 -7.35194814e-03
  9.01811104e-03  5.92614314e-02  4.43056220e-03  4.53694740e-03
  2.60540388e-02  6.97649257e-03  3.02348686e-02  5.72277020e-03
  1.31418477e-02  6.19274640e-03  9.78957997e-02  3.41651092e-03
  4.95833841e-02  3.91446547e-03  6.71110954e-02  2.33463682e-03
  2.18297155e-03  3.12406541e-03  6.03043504e-02  3.45589826e-03
  4.28408493e-02  3.10171259e-02  3.75335226e-03  2.59121430e-02
 -8.01015672e-04  5.58396770e-02  7.84749053e-03  3.48482444e-02
  1.42283288e-02  4.06697119e-03  3.31012572e-03  7.78556893e-03
  5.16852308e-02  1.27004771e-02  1.90841565e-02  4.87072277e-02
  4.62021458e-02  3.76815332e-03  1.65508736e-02  1.58246560e-02
  2.46685914e-02  2.00362893e-03  9.89960807e-03  9.36483273e-02
  1.61324669e-02  3.77798506e-02  5.78901841e-02 -2.07995353e-03
  2.55314462e-03  1.62911276e-02  7.72254516e-03  9.65657828e-02
  1.12086847e-02  6.59117814e-02  5.50058132e-02  6.39293264e-02
  3.36339765e-02  3.45239679e-03 -4.91793533e-03  2.47298866e-02
  3.29188910e-03  1.43809822e-02  5.66373089e-03  2.38527556e-02
  2.18832467e-03  2.63390022e-02  3.46688122e-03  1.16841452e-02
  3.30668089e-02  9.24538048e-02  4.11734149e-03  4.96923963e-02
  2.95138959e-02  2.21164628e-02  2.05246207e-02  1.07175678e-02
  3.97465581e-02  3.10592156e-03  2.81362669e-02  3.26678303e-02
  3.60917960e-02  2.47414905e-02  5.21458099e-03  1.72264166e-02
  1.84937422e-02  2.54421668e-02  3.55864978e-02 -1.66365953e-03
  3.08111149e-03  3.56035244e-02  2.93197532e-02  3.95927725e-02
  6.49831042e-02  7.23899295e-02 -1.53457131e-03  8.65129293e-02
  3.56218198e-02  5.48063580e-02  1.87214921e-02  2.20884514e-03
  1.10460990e-02  1.50891337e-01  1.12289500e-01  1.74989708e-02
  1.02071445e-02  2.63371298e-02  3.94464604e-02  3.43106708e-02
  1.37582602e-03  3.50549168e-02  1.97987213e-02  8.94722612e-03
  3.05269774e-03  4.91881636e-02  3.19487908e-02  1.26038982e-02
  7.32279139e-03  2.96190012e-03  2.14734592e-02  2.58414080e-02
  1.98995000e-02  4.06611064e-03  1.35601995e-05  2.61924506e-03
  5.56171465e-02  6.43742960e-03  3.10581238e-03  1.37447905e-02
  7.35885056e-04  5.88259842e-02  2.24246326e-02  1.83162625e-02
  5.24818487e-03  7.39180309e-03  6.73434718e-02  1.70088494e-02
  6.96572638e-02  5.15356939e-03  2.88879204e-03  4.96324125e-03
  3.25945304e-02  2.08391349e-02  2.65058926e-02  4.56947024e-05
  8.34358282e-03  7.23303825e-02  9.65935970e-03  3.64729773e-02
  1.68047240e-02  1.70097657e-02  7.37130508e-04  8.80099791e-03]
2025-06-24 09:54:20,724 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:20,725 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:20,725 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:20,726 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:20,742 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:20,749 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:20,749 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:20,749 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:20,749 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:20,749 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:20,749 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:20,749 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:20,750 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:20,750 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:20,750 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:20,750 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:20,750 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:20,750 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:20,750 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:20,750 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:20,750 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:20,750 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,750 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,750 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:20,750 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:20,770 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:20,770 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:21,193 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = lightgbm
2025-06-24 09:54:23,109 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:23,109 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:23,109 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:23,109 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:23,109 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:23,109 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:23,109 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:23,126 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:23,599 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:23,599 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:23,599 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:23,599 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:23,599 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:23,599 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:23,599 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:23,599 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:23,599 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:23,745 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:23,745 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:23,745 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:23,745 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:24,863 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:25,737 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:25,737 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:25,743 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:25,771 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:25,771 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:25,771 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:25,771 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:26,807 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:27,248 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:27,248 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:27,385 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:27,385 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:27,454 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:27,454 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:27,454 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:27,454 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:27,454 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:27,454 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:27,503 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:27,504 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:27,504 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:27,504 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:27,504 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:27,504 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:27,504 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:27,559 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:27,559 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:27,559 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:27,691 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:27,691 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:27,691 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:27,691 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:27,691 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:27,691 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:27,691 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:27,691 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:27,691 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:27,691 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:27,691 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:27,691 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:27,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:27,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:27,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:27,765 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:27,820 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:27,878 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:27,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:27,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:28,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:28,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:28,062 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:28,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:28,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:28,146 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:28,172 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:28,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:28,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:28,253 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:28,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:28,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:28,290 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:28,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,316 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:28,316 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,316 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:28,326 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   learning_rate: 0.04990710888816552
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   n_estimators: 609
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   subsample: 0.848270830948627
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.850598430172833
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0004951275409578349
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47820930095863e-06
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:28,331 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:28,474 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:28,474 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513636184579259})})
2025-06-24 09:54:28,474 - src.models.lightgbm_model - INFO -   - Best Iteration: 13
2025-06-24 09:54:28,474 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:28,475 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:28,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:28,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:28,507 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:28,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:28,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:28,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:28,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:28,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:28,652 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:28,652 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:28,666 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:28,666 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:28,667 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:28,667 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:28,667 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,667 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,667 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:28,667 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:28,672 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:28,680 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:28,681 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00071437 0.00135512 0.00128437 ... 0.01027706 0.0157698  0.00910471]
2025-06-24 09:54:28,681 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:28,682 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:28,683 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:28,683 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:28,700 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:28,708 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:28,708 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:28,708 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:28,708 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:28,708 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:28,708 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:28,708 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:28,708 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:28,708 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:28,708 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:28,708 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:28,708 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:28,708 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:28,708 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:28,708 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:28,708 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:28,708 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,708 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,708 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:28,708 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:28,729 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:28,729 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:29,155 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = lightgbm
2025-06-24 09:54:31,079 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:31,079 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:31,079 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:31,079 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:31,079 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:31,079 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:31,079 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:31,095 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:31,565 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:31,565 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:31,565 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:31,565 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:31,565 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:31,565 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:31,565 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:31,565 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:31,565 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:31,710 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:31,711 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:31,711 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:31,711 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:31,711 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:31,711 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:31,711 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:31,711 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:31,711 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:31,711 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:32,827 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:33,697 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:33,697 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:33,700 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:33,728 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:33,728 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:33,728 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:33,728 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:34,773 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:35,207 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:35,207 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:35,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:35,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:35,411 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:35,411 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:35,411 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:35,411 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:35,411 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:35,411 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:35,461 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:35,461 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:35,461 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:35,461 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:35,461 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:35,461 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:35,461 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:35,517 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:35,517 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:35,517 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:35,648 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:35,648 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:35,648 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:35,648 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:35,648 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:35,648 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:35,648 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:35,648 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:35,648 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:35,648 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:35,648 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:35,648 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:35,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:35,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:35,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:35,722 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:35,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:35,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:35,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:35,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:35,999 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:36,014 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:36,014 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:36,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:36,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,068 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:36,098 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:36,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:36,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:36,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:36,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:36,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:36,242 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:36,242 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:36,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,268 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:36,268 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,268 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:36,277 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   learning_rate: 0.15916881726677745
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   n_estimators: 998
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   subsample: 0.9530544650204105
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8647144776940237
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6010135879554323e-06
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0999472666734155e-05
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:36,282 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:36,401 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:36,402 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035135503547791706})})
2025-06-24 09:54:36,402 - src.models.lightgbm_model - INFO -   - Best Iteration: 7
2025-06-24 09:54:36,402 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:36,403 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:36,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:36,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:36,435 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:36,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:36,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:36,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:36,545 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:36,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:36,588 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:36,588 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:36,603 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:36,603 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:36,603 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:36,603 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:36,603 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,603 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,603 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:36,603 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:36,610 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:36,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:36,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00049838 0.00165766 0.00145786 ... 0.00437699 0.03380096 0.00452993]
2025-06-24 09:54:36,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:36,619 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:36,620 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:36,620 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:36,636 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:36,644 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:36,644 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:36,644 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:36,644 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:36,644 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:36,644 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:36,644 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:36,644 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:36,644 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:36,644 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:36,644 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:36,644 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:36,645 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:36,645 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:36,645 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:36,645 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:36,645 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,645 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,645 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:36,645 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:36,668 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:36,668 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:37,097 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = lightgbm
2025-06-24 09:54:39,001 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:39,001 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:39,001 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:39,001 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:39,001 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:39,001 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:39,001 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:39,019 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:39,485 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:39,485 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:39,485 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:39,485 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:39,485 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:39,485 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:39,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:39,485 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:39,485 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:39,628 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:39,628 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:39,628 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:39,628 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:40,738 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:41,606 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:41,606 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:41,610 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:41,638 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:41,638 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:41,638 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:41,638 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:42,673 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:43,111 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:43,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:43,245 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:43,246 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:43,314 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:43,314 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:43,314 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:43,314 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:43,314 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:43,314 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:43,363 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:43,364 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:43,364 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:43,364 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:43,364 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:43,364 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:43,364 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:43,420 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:43,420 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:43,420 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:43,552 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:43,552 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:43,552 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:43,552 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:43,552 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:43,552 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:43,552 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:43,552 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:43,552 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:43,552 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:43,552 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:43,552 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:43,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:43,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:43,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:43,626 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:43,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:43,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:43,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:43,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:43,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:43,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:43,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:43,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:43,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:43,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:43,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:43,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:44,003 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:44,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:44,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:44,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:44,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:44,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:44,146 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:44,146 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:44,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:44,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:44,172 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:44,172 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:44,172 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:44,181 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   learning_rate: 0.020914360188651566
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   n_estimators: 220
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   subsample: 0.7847861042114909
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6157716992226357
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   reg_alpha: 2.2119025375971438e-05
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO -   reg_lambda: 2.5581389759662644e-08
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:44,186 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:44,555 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:44,555 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512799706896072})})
2025-06-24 09:54:44,555 - src.models.lightgbm_model - INFO -   - Best Iteration: 65
2025-06-24 09:54:44,555 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:44,557 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:44,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:44,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:44,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:44,589 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:44,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:44,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:44,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:44,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:44,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:44,741 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:44,741 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:44,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:44,775 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:44,775 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:44,776 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:44,776 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:44,776 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:44,776 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:44,776 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:44,776 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:44,782 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:44,789 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:44,791 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00049936 0.00049329 0.00169115 ... 0.00199524 0.00267837 0.00334448]
2025-06-24 09:54:44,791 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:44,792 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:44,793 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:44,793 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:44,810 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:44,817 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:44,817 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:44,817 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:44,817 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:44,817 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:44,817 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:44,817 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:44,817 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:44,817 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:44,817 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:44,818 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:44,818 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:44,818 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:44,818 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:44,818 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:44,818 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:44,818 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:44,818 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:44,818 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:44,818 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:44,839 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:44,839 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:45,263 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = lightgbm
2025-06-24 09:54:47,191 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:47,191 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:47,192 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:47,192 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:47,192 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:47,192 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:47,192 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:47,211 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:47,660 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:47,660 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:47,660 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:47,660 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:47,660 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:47,660 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:47,660 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:47,660 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:47,660 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:47,823 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:47,823 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:47,823 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:47,823 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:48,848 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:49,655 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:49,655 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:49,660 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:49,686 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:49,687 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:49,687 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:49,687 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:50,655 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:51,052 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:51,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:51,183 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:51,183 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:51,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:51,251 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:51,251 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:51,251 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:51,251 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:51,251 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:51,298 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:51,298 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:51,298 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:51,298 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:51,298 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:51,298 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:51,298 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:51,347 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:51,347 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:51,347 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:51,474 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:51,474 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:51,474 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:51,474 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:51,474 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:51,474 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:51,474 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:51,474 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:51,474 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:51,474 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:51,474 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:51,474 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:51,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:51,474 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:51,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:51,537 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:51,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:51,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:51,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:51,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:51,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:51,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:51,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:51,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:51,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:51,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:51,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:51,860 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:51,888 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:51,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:51,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:51,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:51,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:52,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:52,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:52,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:52,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:52,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:52,039 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:52,039 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:52,039 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:52,049 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   learning_rate: 0.010957129865736666
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   subsample: 0.6564142001008275
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8397815212987682
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   reg_alpha: 3.0126779680525884
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO -   reg_lambda: 6.874100189958323e-05
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:52,054 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:54:52,581 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:54:52,581 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03511347968925713})})
2025-06-24 09:54:52,581 - src.models.lightgbm_model - INFO -   - Best Iteration: 146
2025-06-24 09:54:52,581 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:54:52,583 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:54:52,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:52,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:52,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:52,613 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:52,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:52,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:52,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:52,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:52,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:52,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:52,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:52,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:54:52,794 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:54:52,794 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:54:52,794 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:54:52,794 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:54:52,794 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:52,794 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:52,794 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:54:52,794 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:54:52,800 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:54:52,807 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:54:52,809 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00051129 0.00051456 0.00163497 ... 0.00449884 0.00331423 0.00344643]
2025-06-24 09:54:52,809 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:54:52,810 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:52,810 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:52,811 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:52,827 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:54:52,834 - src.training - INFO -   precision: 0.0
2025-06-24 09:54:52,834 - src.training - INFO -   recall: 0.0
2025-06-24 09:54:52,834 - src.training - INFO -   f1: 0.0
2025-06-24 09:54:52,834 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:54:52,834 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:54:52,834 - src.training - INFO -   positive_samples: 456
2025-06-24 09:54:52,834 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:54:52,834 - src.training - INFO -   total_samples: 368238
2025-06-24 09:54:52,834 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:54:52,834 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:54:52,834 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:54:52,834 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:54:52,834 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:54:52,834 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:54:52,834 - src.training - INFO - 모델 학습 완료
2025-06-24 09:54:52,834 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:54:52,834 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:52,834 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:52,834 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:52,834 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:52,855 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:54:52,856 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:54:53,270 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = lightgbm
2025-06-24 09:54:55,039 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:54:55,039 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:54:55,039 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:54:55,039 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:54:55,039 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:54:55,039 - src.training - INFO - 교차 검증 시작
2025-06-24 09:54:55,039 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:54:55,057 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:54:55,499 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:54:55,499 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:54:55,499 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:54:55,499 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:54:55,499 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:54:55,499 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:54:55,499 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:54:55,499 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:54:55,499 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:54:55,662 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:54:55,662 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:54:55,662 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:54:55,662 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:54:56,695 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:54:57,505 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:57,505 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:54:57,511 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:54:57,537 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:54:57,537 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:54:57,537 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:54:57,537 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:54:58,501 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:54:58,910 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:54:58,910 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:59,045 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:59,045 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:54:59,113 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:54:59,113 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:59,113 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:54:59,113 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:54:59,113 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:59,113 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,164 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:54:59,164 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:54:59,164 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,164 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,164 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:54:59,164 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:54:59,164 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,215 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:59,215 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:54:59,215 - src.training - INFO - 모델 학습 시작
2025-06-24 09:54:59,350 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:54:59,350 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:54:59,350 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:54:59,350 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:54:59,350 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:54:59,350 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:54:59,350 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:54:59,350 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:54:59,350 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:59,350 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:54:59,350 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:54:59,351 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:54:59,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:54:59,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:59,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:59,414 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:59,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:59,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:59,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:59,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:59,663 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:59,678 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:54:59,678 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:59,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:54:59,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:54:59,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:59,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:54:59,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:54:59,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:54:59,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:54:59,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:54:59,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:54:59,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:54:59,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:54:59,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:54:59,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:54:59,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,921 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:54:59,921 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:54:59,921 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:54:59,929 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   learning_rate: 0.012872128435596708
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   n_estimators: 108
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   subsample: 0.701870451203659
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7329492683995666
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   reg_alpha: 0.2817736475166566
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO -   reg_lambda: 6.653037142606319e-07
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:54:59,935 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:55:00,568 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:55:00,568 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03511977397794106})})
2025-06-24 09:55:00,568 - src.models.lightgbm_model - INFO -   - Best Iteration: 108
2025-06-24 09:55:00,568 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:55:00,570 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:55:00,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:00,570 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:00,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:00,602 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:00,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:00,651 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:00,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:00,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:00,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:00,735 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:00,735 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:00,743 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:55:00,783 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:55:00,784 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:55:00,784 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:55:00,784 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:55:00,784 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:00,784 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:00,784 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:55:00,784 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:55:00,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:55:00,797 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:55:00,799 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00045017 0.00045335 0.00044799 ... 0.00231002 0.00310532 0.00412255]
2025-06-24 09:55:00,799 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:55:00,800 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:00,800 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:00,801 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:00,817 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:00,824 - src.training - INFO -   precision: 0.0
2025-06-24 09:55:00,824 - src.training - INFO -   recall: 0.0
2025-06-24 09:55:00,824 - src.training - INFO -   f1: 0.0
2025-06-24 09:55:00,824 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:55:00,824 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:55:00,824 - src.training - INFO -   positive_samples: 456
2025-06-24 09:55:00,824 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:55:00,824 - src.training - INFO -   total_samples: 368238
2025-06-24 09:55:00,824 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:55:00,824 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:55:00,824 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:55:00,824 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:55:00,825 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:55:00,825 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:55:00,825 - src.training - INFO - 모델 학습 완료
2025-06-24 09:55:00,825 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:55:00,825 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:00,825 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:00,825 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:00,825 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:00,847 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:55:00,847 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:55:01,271 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = lightgbm
2025-06-24 09:55:03,097 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:55:03,097 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:55:03,097 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:55:03,097 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:55:03,097 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:55:03,097 - src.training - INFO - 교차 검증 시작
2025-06-24 09:55:03,097 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:55:03,114 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:55:03,572 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:55:03,573 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:55:03,573 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:55:03,573 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:55:03,573 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:55:03,573 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:55:03,573 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:55:03,573 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:55:03,573 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:55:03,737 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:55:03,737 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:55:03,737 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:55:03,737 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:55:04,791 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:55:05,615 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:05,615 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:55:05,620 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:55:05,647 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:55:05,647 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:55:05,647 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:55:05,647 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:06,640 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:07,060 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:55:07,060 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:07,194 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:07,194 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:07,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:07,261 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:07,261 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:07,261 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:55:07,261 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:07,262 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:07,310 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:55:07,310 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:55:07,310 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:07,310 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:07,310 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:55:07,310 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:55:07,310 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:07,362 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:07,362 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:07,362 - src.training - INFO - 모델 학습 시작
2025-06-24 09:55:07,494 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:55:07,494 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:55:07,494 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:55:07,494 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:55:07,494 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:55:07,494 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:55:07,494 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:55:07,494 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:55:07,494 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:07,494 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:55:07,494 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:55:07,494 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:55:07,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:55:07,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:07,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:07,559 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:07,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:07,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:07,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:07,751 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:07,809 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:07,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:55:07,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:07,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:55:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:07,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:07,912 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:07,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:07,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:07,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:08,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:08,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:08,043 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:08,043 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:08,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:55:08,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:08,067 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:08,067 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:08,067 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:55:08,077 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   learning_rate: 0.014541973687489567
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   n_estimators: 188
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   subsample: 0.759421050732034
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7654101279240798
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   reg_alpha: 0.01722905276111146
2025-06-24 09:55:08,082 - src.models.lightgbm_model - INFO -   reg_lambda: 1.263937240496527e-06
2025-06-24 09:55:08,083 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:55:08,083 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:55:08,083 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:55:08,566 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:55:08,566 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.035112276740248034})})
2025-06-24 09:55:08,566 - src.models.lightgbm_model - INFO -   - Best Iteration: 133
2025-06-24 09:55:08,566 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:55:08,568 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:55:08,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:08,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:08,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:08,598 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:08,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:08,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:08,669 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:08,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:08,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:08,728 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:08,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:08,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:55:08,775 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:55:08,775 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:55:08,775 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:55:08,775 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:55:08,775 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:08,775 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:08,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:55:08,775 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:55:08,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:55:08,788 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:55:08,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00045297 0.00045686 0.00181305 ... 0.00295025 0.00377961 0.00393108]
2025-06-24 09:55:08,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:55:08,791 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:08,791 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:08,792 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:08,807 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:08,814 - src.training - INFO -   precision: 0.0
2025-06-24 09:55:08,814 - src.training - INFO -   recall: 0.0
2025-06-24 09:55:08,814 - src.training - INFO -   f1: 0.0
2025-06-24 09:55:08,814 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:55:08,815 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:55:08,815 - src.training - INFO -   positive_samples: 456
2025-06-24 09:55:08,815 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:55:08,815 - src.training - INFO -   total_samples: 368238
2025-06-24 09:55:08,815 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:55:08,815 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:55:08,815 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:55:08,815 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:55:08,815 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:55:08,815 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:55:08,815 - src.training - INFO - 모델 학습 완료
2025-06-24 09:55:08,815 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:55:08,815 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:08,815 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:08,815 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:08,815 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:08,836 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:55:08,836 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:55:09,248 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = lightgbm
2025-06-24 09:55:11,097 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:55:11,097 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:55:11,097 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:55:11,097 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:55:11,097 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:55:11,097 - src.training - INFO - 교차 검증 시작
2025-06-24 09:55:11,097 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:55:11,115 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:55:11,584 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:55:11,584 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:55:11,584 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:55:11,584 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:55:11,584 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:55:11,584 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:55:11,584 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:55:11,584 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:55:11,584 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:55:11,728 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:55:11,728 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:55:11,728 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:55:11,728 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:55:12,835 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:55:13,698 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:13,698 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:55:13,702 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:55:13,730 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:55:13,730 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:55:13,730 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:55:13,730 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:14,754 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:15,195 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:55:15,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:15,332 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:15,332 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:15,401 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:15,401 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:15,402 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:15,402 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:55:15,402 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:15,402 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:15,451 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:55:15,451 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:55:15,452 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:15,452 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:15,452 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:55:15,452 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:55:15,452 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:15,508 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:15,508 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:15,508 - src.training - INFO - 모델 학습 시작
2025-06-24 09:55:15,664 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:55:15,665 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:55:15,665 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:55:15,665 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:55:15,665 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:55:15,665 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:55:15,665 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:55:15,665 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:55:15,665 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:15,665 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:55:15,665 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:55:15,665 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:55:15,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:55:15,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:15,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:15,736 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:15,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:15,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:15,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:15,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:15,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:16,002 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:55:16,002 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:55:16,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:16,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,062 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:16,091 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:16,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:16,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:16,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:16,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:16,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:16,223 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:16,224 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:55:16,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,249 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:16,249 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,249 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:55:16,259 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   learning_rate: 0.010049681564965829
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:55:16,263 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   n_estimators: 472
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   subsample: 0.7277245828295967
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7166438037926771
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   reg_alpha: 0.006492067438794327
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47045623771009e-05
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:55:16,264 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:55:16,691 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:55:16,691 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03513324524348855})})
2025-06-24 09:55:16,692 - src.models.lightgbm_model - INFO -   - Best Iteration: 82
2025-06-24 09:55:16,692 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:55:16,693 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:55:16,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:16,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:16,723 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:16,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:16,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:16,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:16,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:16,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:16,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:16,856 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:55:16,896 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:55:16,897 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:55:16,897 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:55:16,897 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:55:16,897 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,897 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,897 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:55:16,897 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:55:16,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:55:16,910 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:55:16,912 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00065238 0.00144427 0.00139466 ... 0.00122861 0.00237089 0.00260808]
2025-06-24 09:55:16,912 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:55:16,913 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:16,913 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:16,914 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:16,930 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:16,938 - src.training - INFO -   precision: 0.0
2025-06-24 09:55:16,938 - src.training - INFO -   recall: 0.0
2025-06-24 09:55:16,938 - src.training - INFO -   f1: 0.0
2025-06-24 09:55:16,938 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:55:16,938 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:55:16,938 - src.training - INFO -   positive_samples: 456
2025-06-24 09:55:16,938 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:55:16,938 - src.training - INFO -   total_samples: 368238
2025-06-24 09:55:16,938 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:55:16,938 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:55:16,938 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:55:16,938 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:55:16,939 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:55:16,939 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:55:16,939 - src.training - INFO - 모델 학습 완료
2025-06-24 09:55:16,939 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:55:16,939 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,939 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,939 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:16,939 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:16,961 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:55:16,961 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:55:17,361 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = lightgbm
2025-06-24 09:55:19,120 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:55:19,121 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:55:19,121 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:55:19,121 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:55:19,121 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:55:19,121 - src.training - INFO - 교차 검증 시작
2025-06-24 09:55:19,121 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:55:19,139 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:55:19,598 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:55:19,598 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:55:19,598 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:55:19,598 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:55:19,598 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:55:19,598 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:55:19,598 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:55:19,598 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:55:19,598 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:55:19,764 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:55:19,764 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:55:19,764 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:55:19,764 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:55:20,797 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:55:21,645 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:21,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:55:21,650 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:55:21,678 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:55:21,678 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:55:21,678 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:55:21,678 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:22,641 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:23,040 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:55:23,040 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:23,173 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:23,173 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:23,241 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:23,241 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:23,241 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:23,241 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:55:23,242 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:23,242 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:23,289 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:55:23,289 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:55:23,289 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:23,289 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:23,289 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:55:23,289 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:55:23,289 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:23,338 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:23,338 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:23,338 - src.training - INFO - 모델 학습 시작
2025-06-24 09:55:23,471 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:55:23,471 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:55:23,471 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:55:23,471 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:55:23,471 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:55:23,471 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:55:23,471 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:55:23,471 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:55:23,471 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:23,471 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:55:23,471 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:55:23,471 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:55:23,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:55:23,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:23,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:23,535 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:23,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:23,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:23,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:23,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:23,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:23,792 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:55:23,792 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:23,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:55:23,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:23,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:23,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:23,854 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:23,882 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:23,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:23,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:23,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:23,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:24,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:24,011 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:24,011 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:24,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:55:24,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:24,038 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:24,038 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:24,038 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:55:24,048 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   learning_rate: 0.028490465891437326
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:55:24,052 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   n_estimators: 365
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   subsample: 0.6254706923605511
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7925475288364967
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   reg_alpha: 0.05495560517360351
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO -   reg_lambda: 3.551282729015529
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:55:24,053 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:55:24,329 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:55:24,329 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03512911602847293})})
2025-06-24 09:55:24,329 - src.models.lightgbm_model - INFO -   - Best Iteration: 49
2025-06-24 09:55:24,329 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:55:24,331 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:55:24,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:24,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:24,332 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:24,362 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:24,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:24,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:24,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:24,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:24,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:24,491 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:24,491 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:24,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:55:24,518 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:55:24,518 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:55:24,518 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:55:24,518 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:55:24,518 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:24,518 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:24,518 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:55:24,518 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:55:24,525 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:55:24,531 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:55:24,533 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.0004866  0.00171615 0.00157054 ... 0.00131531 0.00316545 0.00351069]
2025-06-24 09:55:24,533 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:55:24,534 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:24,535 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:24,535 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:24,551 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:24,559 - src.training - INFO -   precision: 0.0
2025-06-24 09:55:24,559 - src.training - INFO -   recall: 0.0
2025-06-24 09:55:24,559 - src.training - INFO -   f1: 0.0
2025-06-24 09:55:24,559 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:55:24,559 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:55:24,559 - src.training - INFO -   positive_samples: 456
2025-06-24 09:55:24,559 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:55:24,559 - src.training - INFO -   total_samples: 368238
2025-06-24 09:55:24,559 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:55:24,559 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:55:24,559 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:55:24,559 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:55:24,559 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:55:24,559 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:55:24,559 - src.training - INFO - 모델 학습 완료
2025-06-24 09:55:24,560 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:55:24,560 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:24,560 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:24,560 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:24,560 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:24,581 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:55:24,581 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:55:25,004 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = lightgbm
2025-06-24 09:55:26,927 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:55:26,927 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 09:55:26,927 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 09:55:26,927 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 09:55:26,927 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 09:55:26,927 - src.training - INFO - 교차 검증 시작
2025-06-24 09:55:26,927 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:55:26,943 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 3개 폴드로 분할
2025-06-24 09:55:27,415 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:55:27,415 - src.splits - INFO -   - 훈련 데이터: 889,176 행 (152,625개 ID)
2025-06-24 09:55:27,415 - src.splits - INFO -   - 검증 데이터: 444,589 행 (76,313개 ID)
2025-06-24 09:55:27,415 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:55:27,415 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:55:27,415 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:55:27,415 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:55:27,415 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:55:27,415 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:55:27,569 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:27,570 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:27,570 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:55:27,570 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:55:27,570 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:27,570 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:55:27,570 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:55:27,570 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:55:27,570 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:55:27,570 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:55:28,696 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:55:29,564 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:29,564 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:55:29,569 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:55:29,598 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:55:29,598 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:55:29,598 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:55:29,598 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:55:30,633 - src.preprocessing - INFO - 데이터 변환 완료: (889176, 33)
2025-06-24 09:55:31,067 - src.preprocessing - INFO - 데이터 변환 완료: (444589, 33)
2025-06-24 09:55:31,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:31,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:31,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:55:31,271 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:55:31,271 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:31,271 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:55:31,271 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:55:31,271 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:31,271 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:31,321 - src.training - INFO - [DEBUG] X_train shape: (889176, 6), y_train shape: (889176, 1)
2025-06-24 09:55:31,321 - src.training - INFO - [DEBUG] X_val shape: (444589, 6), y_val shape: (444589, 1)
2025-06-24 09:55:31,321 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:31,321 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:31,321 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:55:31,321 - src.training - INFO - [DEBUG] X_train_resampled shape: (889176, 6), y_train_resampled shape: (889176, 1)
2025-06-24 09:55:31,321 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:31,376 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:31,376 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 735631, (1.0,): 846}
2025-06-24 09:55:31,376 - src.training - INFO - 모델 학습 시작
2025-06-24 09:55:31,507 - src.training - INFO - 결측 타겟 제거: train 889176->736477, val 444589->368238
2025-06-24 09:55:31,507 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:55:31,507 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:55:31,507 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:55:31,507 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:55:31,507 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:55:31,507 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:55:31,507 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:55:31,507 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:31,507 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:55:31,507 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(368238, 6), y_val=(368238, 1)
2025-06-24 09:55:31,507 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:55:31,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (736477, 6)
2025-06-24 09:55:31,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:31,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:31,581 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:31,636 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:31,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:31,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:31,799 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:31,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:31,877 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (736477, 6)
2025-06-24 09:55:31,877 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:31,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (736477, 6), y shape: (736477, 1)
2025-06-24 09:55:31,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:31,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:31,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:31,930 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:31,960 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:31,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:32,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:32,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:32,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:32,098 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:32,104 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:32,104 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:32,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6), y shape: (368238, 1)
2025-06-24 09:55:32,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:32,130 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(736477, 6), y=(736477, 1)
2025-06-24 09:55:32,130 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:32,130 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:55:32,139 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(736477, 6), y=736477
2025-06-24 09:55:32,143 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(368238, 6), y_val=368238
2025-06-24 09:55:32,143 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:55:32,143 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:55:32,143 - src.models.lightgbm_model - INFO -   learning_rate: 0.012115236479030286
2025-06-24 09:55:32,143 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   subsample: 0.9118267599058681
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6687523762556236
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6345515759655802
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO -   reg_lambda: 7.166551603900752e-06
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:55:32,144 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:55:32,702 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:55:32,702 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.03511857228927407})})
2025-06-24 09:55:32,702 - src.models.lightgbm_model - INFO -   - Best Iteration: 130
2025-06-24 09:55:32,703 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:55:32,704 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:55:32,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (368238, 6)
2025-06-24 09:55:32,704 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:32,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:55:32,736 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:55:32,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:55:32,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:55:32,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:55:32,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:55:32,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:55:32,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (368238, 6)
2025-06-24 09:55:32,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:32,888 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (368238, 6)
2025-06-24 09:55:32,935 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:55:32,935 - src.models.lightgbm_model - INFO - 예측 완료: (368238, 1)
2025-06-24 09:55:32,935 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:55:32,935 - src.training - INFO - y_true shape: (368238, 1), y_pred shape: (368238, 1)
2025-06-24 09:55:32,935 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:32,935 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:55:32,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:55:32,935 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:55:32,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 368238
2025-06-24 09:55:32,949 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 09:55:32,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.00042606 0.00042401 0.00042796 ... 0.00228185 0.00316574 0.00445518]
2025-06-24 09:55:32,951 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:55:32,952 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:32,952 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:32,953 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:32,969 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:55:32,976 - src.training - INFO -   precision: 0.0
2025-06-24 09:55:32,976 - src.training - INFO -   recall: 0.0
2025-06-24 09:55:32,976 - src.training - INFO -   f1: 0.0
2025-06-24 09:55:32,976 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:55:32,976 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:55:32,976 - src.training - INFO -   positive_samples: 456
2025-06-24 09:55:32,976 - src.training - INFO -   negative_samples: 367782
2025-06-24 09:55:32,976 - src.training - INFO -   total_samples: 368238
2025-06-24 09:55:32,976 - src.training - INFO -   positive_ratio: 0.0012383295586006877
2025-06-24 09:55:32,976 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:55:32,976 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:55:32,976 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:55:32,977 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:55:32,977 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:55:32,977 - src.training - INFO - 모델 학습 완료
2025-06-24 09:55:32,977 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 456, 'negative_samples': 367782, 'total_samples': 368238, 'positive_ratio': 0.0012383295586006877, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:55:32,977 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:32,977 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:32,977 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:55:32,977 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:55:32,997 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:55:32,997 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:55:33,416 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = lightgbm
