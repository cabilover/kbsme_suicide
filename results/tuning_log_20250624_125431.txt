2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO - 전달받은 데이터 사용: (1333765, 33)
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO - 모델 타입: catboost
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed/processed_data_with_features.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 5, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'pr_auc', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'metrics': {'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy', 'pr_auc'], 'regression_metrics': ['mae', 'rmse', 'r2'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2', 'pr_auc']}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'catboost', 'catboost': {'iterations': 100, 'depth': 6, 'learning_rate': 0.1, 'l2_leaf_reg': 3, 'loss_function': 'Logloss', 'eval_metric': 'Logloss', 'cat_features': [], 'cat_l2': 10.0, 'cat_smooth': 10.0, 'max_cat_threshold': 32, 'one_hot_max_size': 10, 'random_strength': 1, 'bagging_temperature': 1, 'border_count': 254, 'feature_border_type': 'GreedyLogSum', 'early_stopping_rounds': 10, 'verbose': False, 'auto_class_weights': 'Balanced', 'scale_pos_weight': 1.0, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}, 'boosting_type': 'Plain', 'bootstrap_type': 'Bernoulli', 'subsample': 0.8, 'rsm': 0.8, 'leaf_estimation_method': 'Newton', 'random_seed': 42, 'bootstrap_seed': 42, 'min_data_in_leaf': 1, 'max_leaves': 31, 'grow_policy': 'SymmetricTree', 'min_fold_size': 1, 'leaf_estimation_iterations': 1, 'fold_permutation_block': 1, 'leaf_estimation_backtracking': 'AnyImprovement', 'best_model_min_trees': 1, 'model_shrink_rate': 0, 'model_shrink_mode': 'Constant', 'langevin': False, 'diffusion_temperature': 10000, 'posterior_sampling': False, 'boost_from_average': True, 'allow_const_label': False, 'score_function': 'Cosine', 'monotone_constraints': '', 'penalties_coefficient': 1, 'first_feature_use_penalties': 0, 'model_size_reg': 0.5, 'per_float_feature_quantization': '', 'eval_fraction': 0, 'fixed_binary_splits': None, 'ignored_features': None, 'train_dir': None, 'name': 'experiment', 'prediction_type': 'Probability', 'fold_len_multiplier': 2, 'has_time': False, 'allow_writing_files': False, 'save_snapshot': False, 'snapshot_file': None, 'snapshot_interval': 600, 'gradient_iterations': 1, 'sampling_unit': 'Object', 'mvs_reg': 0.1, 'thread_count': 28}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weights': 'Balanced', 'auto_class_weights': 'Balanced', 'scale_pos_weight': 1.0}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 100, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 12:54:31,056 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 12:54:31,080 - __main__ - INFO - MLflow Run 시작: 3a32a0ce14174b7b8eb7e7f54c2d7ded
2025-06-24 12:54:31,083 - __main__ - INFO - 튜닝 파라미터 로깅 완료: 6개 파라미터
2025-06-24 12:54:31,083 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 최적화 시작
2025-06-24 12:54:31,087 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = catboost
2025-06-24 12:54:32,886 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:54:32,886 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:54:32,886 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:54:32,886 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:54:32,886 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:54:32,887 - src.training - INFO - 교차 검증 시작
2025-06-24 12:54:32,887 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:54:32,904 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:54:33,348 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:54:33,349 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:54:33,349 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:54:33,349 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:54:33,349 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:54:33,349 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:54:33,349 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:54:33,349 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:54:33,349 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:54:33,540 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:54:33,540 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:54:33,540 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:54:33,540 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:54:34,851 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:54:35,868 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:35,869 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:54:35,873 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:54:35,903 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:54:35,903 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:54:35,903 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:54:35,903 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:37,128 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:37,380 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:54:37,380 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:37,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:37,538 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:37,579 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:37,579 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:37,579 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:37,579 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:54:37,579 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:37,579 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:37,636 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:54:37,636 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:54:37,636 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:37,636 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:37,636 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:54:37,636 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:54:37,636 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:37,695 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:37,695 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:37,695 - src.training - INFO - 모델 학습 시작
2025-06-24 12:54:37,822 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:54:37,822 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:54:37,822 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:54:37,822 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:54:37,822 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:54:37,822 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:54:37,823 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:54:37,823 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:54:37,823 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:54:37,823 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:54:37,823 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:54:37,823 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:54:37,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:54:37,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:37,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:37,900 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:37,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:38,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:38,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:38,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:38,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:38,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:54:38,237 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:38,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:54:38,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:38,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:54:38,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:38,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:38,328 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:38,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:38,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:38,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:38,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:38,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:38,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:54:38,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:38,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:54:38,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:38,424 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:54:38,424 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:38,424 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:54:38,424 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:54:38,424 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:54:38,435 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   iterations: 218
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.968793330444372
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   random_strength: 0.13066739238053282
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   bagging_temperature: 0.2403950683025824
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   border_count: 66
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:54:38,439 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:38,440 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:54:38,440 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:38,440 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:54:39,800 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:54:39,800 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:54:39,800 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:54:39,800 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:54:39,800 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:54:39,801 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:54:39,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:54:39,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:39,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:39,819 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:39,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:39,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:39,866 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:39,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:39,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:39,903 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:54:39,903 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:39,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:54:39,933 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:54:39,934 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:54:39,934 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:54:39,934 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:54:39,934 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:39,934 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:39,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:54:39,934 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:54:39,937 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:54:39,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:54:39,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:54:39,941 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:54:40,730 - src.training - INFO -   precision: 0.0
2025-06-24 12:54:40,730 - src.training - INFO -   recall: 0.0
2025-06-24 12:54:40,730 - src.training - INFO -   f1: 0.0
2025-06-24 12:54:40,730 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:54:40,730 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:54:40,730 - src.training - INFO -   positive_samples: 270
2025-06-24 12:54:40,730 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:54:40,730 - src.training - INFO -   total_samples: 220940
2025-06-24 12:54:40,730 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:54:40,730 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:54:40,730 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:54:40,730 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:54:40,730 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:54:40,730 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:54:40,730 - src.training - INFO - 모델 학습 완료
2025-06-24 12:54:40,730 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:54:40,730 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:40,730 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:40,730 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:40,730 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:40,750 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:54:40,751 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:54:41,176 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = catboost
2025-06-24 12:54:42,971 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:54:42,971 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:54:42,971 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:54:42,971 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:54:42,971 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:54:42,971 - src.training - INFO - 교차 검증 시작
2025-06-24 12:54:42,971 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:54:42,988 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:54:43,431 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:54:43,431 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:54:43,431 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:54:43,431 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:54:43,431 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:54:43,431 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:54:43,431 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:54:43,431 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:54:43,431 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:54:43,621 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:54:43,621 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:54:43,621 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:54:43,621 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:54:44,948 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:54:45,973 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:45,973 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:54:45,981 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:54:46,012 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:54:46,012 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:54:46,012 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:54:46,012 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:47,261 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:47,510 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:54:47,510 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:47,669 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:47,669 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:47,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:47,710 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:47,710 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:47,710 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:54:47,710 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:47,710 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:47,767 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:54:47,767 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:54:47,767 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:47,767 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:47,767 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:54:47,767 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:54:47,767 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:47,826 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:47,826 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:47,826 - src.training - INFO - 모델 학습 시작
2025-06-24 12:54:47,953 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:54:47,954 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:54:47,954 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:54:47,954 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:54:47,954 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:54:47,954 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:54:47,954 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:54:47,954 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:54:47,954 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:54:47,954 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:54:47,954 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:54:47,954 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:54:47,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:54:47,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:47,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:48,032 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:48,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:48,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:48,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:48,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:48,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:48,353 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:54:48,353 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:48,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:54:48,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:48,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:54:48,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:48,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:48,441 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:48,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:48,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:48,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:48,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:48,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:48,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:54:48,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:48,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:54:48,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:48,538 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:54:48,538 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:48,538 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:54:48,538 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:54:48,538 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:54:48,551 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   iterations: 440
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   learning_rate: 0.11114989443094977
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0485387725194617
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   random_strength: 0.26587543983272705
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   bagging_temperature: 0.8491983767203796
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   border_count: 249
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:48,555 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:54:49,829 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:54:49,830 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:54:49,830 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:54:49,830 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:54:49,830 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:54:49,830 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:54:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:54:49,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:49,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:49,849 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:49,865 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:49,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:49,898 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:49,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:49,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:49,935 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:54:49,936 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:49,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:54:49,965 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:54:49,966 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:54:49,966 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:54:49,966 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:54:49,966 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:49,966 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:49,966 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:54:49,966 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:54:49,969 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:54:49,973 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:54:49,973 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:54:49,973 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:54:50,860 - src.training - INFO -   precision: 0.0
2025-06-24 12:54:50,860 - src.training - INFO -   recall: 0.0
2025-06-24 12:54:50,860 - src.training - INFO -   f1: 0.0
2025-06-24 12:54:50,860 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:54:50,860 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:54:50,860 - src.training - INFO -   positive_samples: 270
2025-06-24 12:54:50,860 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:54:50,860 - src.training - INFO -   total_samples: 220940
2025-06-24 12:54:50,860 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:54:50,860 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:54:50,860 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:54:50,860 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:54:50,860 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:54:50,860 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:54:50,860 - src.training - INFO - 모델 학습 완료
2025-06-24 12:54:50,860 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:54:50,860 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:50,860 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:50,860 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:50,860 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:50,881 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:54:50,881 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:54:51,320 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = catboost
2025-06-24 12:54:53,318 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:54:53,318 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:54:53,318 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:54:53,319 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:54:53,319 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:54:53,319 - src.training - INFO - 교차 검증 시작
2025-06-24 12:54:53,319 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:54:53,337 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:54:53,812 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:54:53,812 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:54:53,812 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:54:53,812 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:54:53,812 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:54:53,812 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:54:53,813 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:54:53,813 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:54:53,813 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:54:53,977 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:54:53,977 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:54:53,977 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:54:53,977 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:54:55,453 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:54:56,491 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:56,491 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:54:56,497 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:54:56,528 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:54:56,528 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:54:56,528 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:54:56,528 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:54:57,760 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:54:58,016 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:54:58,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:58,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:58,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:54:58,215 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:54:58,215 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:58,215 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:54:58,215 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:54:58,215 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:58,215 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:54:58,272 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:54:58,272 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:54:58,272 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:58,272 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:58,272 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:54:58,272 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:54:58,272 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:58,330 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:58,330 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:54:58,330 - src.training - INFO - 모델 학습 시작
2025-06-24 12:54:58,456 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:54:58,456 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:54:58,456 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:54:58,456 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:54:58,456 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:54:58,456 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:54:58,456 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:54:58,456 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:54:58,456 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:54:58,456 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:54:58,456 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:54:58,456 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:54:58,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:54:58,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:58,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:58,535 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:58,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:58,655 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:58,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:58,775 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:58,849 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:58,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:54:58,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:58,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:54:58,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:58,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:54:58,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:58,940 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:54:58,957 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:54:58,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:54:58,986 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:54:59,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:54:59,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:54:59,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:54:59,037 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:54:59,037 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:54:59,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:54:59,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:59,052 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:54:59,052 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:54:59,052 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:54:59,052 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:54:59,052 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:54:59,064 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   iterations: 132
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   learning_rate: 0.028145092716060652
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.347776308515933
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   random_strength: 1.6738085788752133
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   bagging_temperature: 0.36210622617823773
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   border_count: 128
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:54:59,068 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:54:59,069 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:59,069 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:54:59,069 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:54:59,069 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:55:00,336 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:55:00,336 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:55:00,336 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:55:00,336 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:55:00,336 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:55:00,337 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:55:00,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:00,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:00,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:00,355 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:00,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:00,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:00,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:00,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:00,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:00,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:00,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:00,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:55:00,468 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:55:00,468 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:55:00,468 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:55:00,468 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:55:00,468 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:00,468 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:00,468 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:55:00,468 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:55:00,472 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:55:00,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:55:00,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:55:00,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:55:01,277 - src.training - INFO -   precision: 0.0
2025-06-24 12:55:01,277 - src.training - INFO -   recall: 0.0
2025-06-24 12:55:01,277 - src.training - INFO -   f1: 0.0
2025-06-24 12:55:01,277 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:55:01,277 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:55:01,277 - src.training - INFO -   positive_samples: 270
2025-06-24 12:55:01,277 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:55:01,277 - src.training - INFO -   total_samples: 220940
2025-06-24 12:55:01,277 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:55:01,277 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:55:01,277 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:55:01,277 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:55:01,278 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:55:01,278 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:55:01,278 - src.training - INFO - 모델 학습 완료
2025-06-24 12:55:01,278 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:55:01,278 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:01,278 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:01,278 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:01,278 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:01,299 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:55:01,300 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:55:01,723 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = catboost
2025-06-24 12:55:03,514 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:55:03,514 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:55:03,514 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:55:03,514 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:55:03,514 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:55:03,514 - src.training - INFO - 교차 검증 시작
2025-06-24 12:55:03,514 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:55:03,531 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:55:03,976 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:55:03,976 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:55:03,976 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:55:03,976 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:55:03,976 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:55:03,976 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:55:03,976 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:55:03,976 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:55:03,976 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:55:04,169 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:55:04,169 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:55:04,169 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:55:04,169 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:55:05,473 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:55:06,504 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:06,504 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:55:06,510 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:55:06,541 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:55:06,541 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:55:06,541 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:55:06,541 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:07,790 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:08,039 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:55:08,039 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:08,198 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:08,199 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:08,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:08,239 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:08,239 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:08,239 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:55:08,239 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:08,239 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:08,296 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:55:08,296 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:55:08,296 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:08,296 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:08,296 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:55:08,296 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:55:08,296 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:08,353 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:08,354 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:08,354 - src.training - INFO - 모델 학습 시작
2025-06-24 12:55:08,479 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:55:08,479 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:55:08,479 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:55:08,479 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:55:08,479 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:55:08,479 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:55:08,479 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:55:08,479 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:55:08,479 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:08,479 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:55:08,479 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:55:08,479 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:55:08,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:55:08,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:08,480 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:08,558 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:08,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:08,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:08,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:08,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:08,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:08,897 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:55:08,897 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:08,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:55:08,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:08,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:08,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:08,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:08,987 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:09,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:09,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:09,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:09,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:09,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:09,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:09,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:09,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:55:09,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:09,082 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:09,082 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:09,082 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:55:09,082 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:55:09,082 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:55:09,096 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   iterations: 112
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   learning_rate: 0.03476649150592621
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.858051065806936
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   random_strength: 1.0677482709481354
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   bagging_temperature: 0.2797064039425238
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   border_count: 207
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:55:09,099 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:09,100 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:55:10,373 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:55:10,373 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:55:10,373 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:55:10,373 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:55:10,373 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:55:10,374 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:55:10,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:10,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:10,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:10,399 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:10,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:10,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:10,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:10,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:10,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:10,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:10,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:10,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:55:10,530 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:55:10,531 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:55:10,531 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:55:10,531 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:55:10,531 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:10,531 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:10,531 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:55:10,531 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:55:10,534 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:55:10,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:55:10,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:55:10,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:55:11,421 - src.training - INFO -   precision: 0.0
2025-06-24 12:55:11,421 - src.training - INFO -   recall: 0.0
2025-06-24 12:55:11,421 - src.training - INFO -   f1: 0.0
2025-06-24 12:55:11,421 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:55:11,421 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:55:11,421 - src.training - INFO -   positive_samples: 270
2025-06-24 12:55:11,421 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:55:11,421 - src.training - INFO -   total_samples: 220940
2025-06-24 12:55:11,421 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:55:11,421 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:55:11,421 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:55:11,421 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:55:11,421 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:55:11,422 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:55:11,422 - src.training - INFO - 모델 학습 완료
2025-06-24 12:55:11,422 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:55:11,422 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:11,422 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:11,422 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:11,422 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:11,441 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:55:11,441 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:55:11,883 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = catboost
2025-06-24 12:55:13,835 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:55:13,835 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:55:13,835 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:55:13,835 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:55:13,835 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:55:13,835 - src.training - INFO - 교차 검증 시작
2025-06-24 12:55:13,836 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:55:13,854 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:55:14,333 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:55:14,333 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:55:14,333 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:55:14,333 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:55:14,333 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:55:14,333 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:55:14,333 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:55:14,333 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:55:14,333 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:55:14,510 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:55:14,510 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:55:14,510 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:55:14,510 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:55:15,969 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:55:17,109 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:17,109 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:55:17,115 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:55:17,148 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:55:17,148 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:55:17,148 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:55:17,149 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:18,518 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:18,794 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:55:18,794 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:18,963 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:18,963 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:19,007 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:19,007 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:19,007 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:19,007 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:55:19,007 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:19,007 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,068 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:55:19,068 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:55:19,068 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,068 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,068 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:55:19,068 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:55:19,068 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,134 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:19,134 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:19,134 - src.training - INFO - 모델 학습 시작
2025-06-24 12:55:19,264 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:55:19,264 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:55:19,264 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:55:19,264 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:55:19,264 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:55:19,264 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:55:19,264 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:55:19,264 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:55:19,264 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:19,264 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:55:19,264 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:55:19,264 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:55:19,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:55:19,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:19,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:19,354 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:19,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:19,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:19,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:19,625 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:19,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:19,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:55:19,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:19,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:55:19,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:19,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:19,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:19,803 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:19,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:19,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:19,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:19,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:19,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:19,890 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:19,890 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:19,905 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:55:19,905 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,905 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:19,905 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:19,905 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:55:19,905 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:55:19,905 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:55:19,920 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   iterations: 317
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   learning_rate: 0.07896186801026692
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4808945119975185
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   random_strength: 8.536189862866832
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   bagging_temperature: 0.9539969835279999
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   border_count: 46
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:55:19,923 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:19,924 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:55:21,203 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:55:21,204 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:55:21,204 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:55:21,204 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:55:21,204 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:55:21,204 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:55:21,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:21,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:21,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:21,225 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:21,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:21,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:21,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:21,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:21,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:21,314 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:21,314 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:21,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:55:21,346 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:55:21,346 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:55:21,346 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:55:21,346 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:55:21,346 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:21,346 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:21,346 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:55:21,346 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:55:21,350 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:55:21,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:55:21,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:55:21,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:55:22,240 - src.training - INFO -   precision: 0.0
2025-06-24 12:55:22,240 - src.training - INFO -   recall: 0.0
2025-06-24 12:55:22,240 - src.training - INFO -   f1: 0.0
2025-06-24 12:55:22,240 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:55:22,240 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:55:22,240 - src.training - INFO -   positive_samples: 270
2025-06-24 12:55:22,240 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:55:22,240 - src.training - INFO -   total_samples: 220940
2025-06-24 12:55:22,240 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:55:22,240 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:55:22,240 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:55:22,240 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:55:22,240 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:55:22,240 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:55:22,240 - src.training - INFO - 모델 학습 완료
2025-06-24 12:55:22,240 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:55:22,240 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:22,240 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:22,240 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:22,240 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:22,260 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:55:22,260 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:55:22,710 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = catboost
2025-06-24 12:55:24,705 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:55:24,705 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:55:24,705 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:55:24,705 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:55:24,705 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:55:24,705 - src.training - INFO - 교차 검증 시작
2025-06-24 12:55:24,705 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:55:24,723 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:55:25,203 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:55:25,203 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:55:25,203 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:55:25,203 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:55:25,203 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:55:25,203 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:55:25,203 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:55:25,203 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:55:25,203 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:55:25,376 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:25,376 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:25,377 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:25,377 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:25,377 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:25,377 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:55:25,377 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:55:25,377 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:55:25,377 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:55:25,377 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:55:26,855 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:55:28,007 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:28,007 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:55:28,013 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:55:28,047 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:55:28,047 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:55:28,047 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:55:28,047 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:29,429 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:29,701 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:55:29,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:29,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:29,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:29,912 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:29,912 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:29,912 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:29,912 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:55:29,912 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:29,912 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:29,974 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:55:29,974 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:55:29,974 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:29,974 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:29,974 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:55:29,974 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:55:29,975 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:30,039 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:30,039 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:30,039 - src.training - INFO - 모델 학습 시작
2025-06-24 12:55:30,171 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:55:30,171 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:55:30,171 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:55:30,171 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:55:30,171 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:55:30,171 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:55:30,171 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:55:30,171 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:55:30,171 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:30,171 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:55:30,171 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:55:30,171 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:55:30,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:55:30,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:30,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:30,262 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:30,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:30,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:30,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:30,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:30,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:30,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:55:30,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:30,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:55:30,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:30,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:30,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:30,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:30,710 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:30,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:30,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:30,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:30,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:30,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:30,798 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:30,798 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:30,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:55:30,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:30,813 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:30,813 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:30,813 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:55:30,813 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:55:30,813 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:55:30,825 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   iterations: 414
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   learning_rate: 0.013940346079873234
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.833180632488465
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   random_strength: 0.978033701665941
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   bagging_temperature: 0.20983441136030095
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   border_count: 130
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:55:30,827 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:30,828 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:55:32,097 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:55:32,097 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:55:32,097 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:55:32,097 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:55:32,097 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:55:32,098 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:55:32,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:32,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:32,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:32,117 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:32,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:32,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:32,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:32,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:32,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:32,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:32,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:32,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:55:32,237 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:55:32,237 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:55:32,238 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:55:32,238 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:55:32,238 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:32,238 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:32,238 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:55:32,238 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:55:32,241 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:55:32,245 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:55:32,246 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:55:32,246 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:55:33,126 - src.training - INFO -   precision: 0.0
2025-06-24 12:55:33,126 - src.training - INFO -   recall: 0.0
2025-06-24 12:55:33,126 - src.training - INFO -   f1: 0.0
2025-06-24 12:55:33,126 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:55:33,126 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:55:33,126 - src.training - INFO -   positive_samples: 270
2025-06-24 12:55:33,126 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:55:33,126 - src.training - INFO -   total_samples: 220940
2025-06-24 12:55:33,126 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:55:33,126 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:55:33,126 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:55:33,126 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:55:33,126 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:55:33,126 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:55:33,126 - src.training - INFO - 모델 학습 완료
2025-06-24 12:55:33,126 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:55:33,126 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:33,126 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:33,126 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:33,126 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:33,145 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:55:33,145 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:55:33,601 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = catboost
2025-06-24 12:55:35,585 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:55:35,585 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:55:35,585 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:55:35,585 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:55:35,585 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:55:35,585 - src.training - INFO - 교차 검증 시작
2025-06-24 12:55:35,585 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:55:35,602 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:55:36,079 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:55:36,079 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:55:36,079 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:55:36,079 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:55:36,079 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:55:36,079 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:55:36,079 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:55:36,079 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:55:36,079 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:55:36,254 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:55:36,254 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:55:36,254 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:55:36,254 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:55:37,728 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:55:38,878 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:38,878 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:55:38,885 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:55:38,918 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:55:38,918 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:55:38,918 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:55:38,918 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:40,300 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:40,571 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:55:40,571 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:40,740 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:40,741 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:40,783 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:40,783 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:40,783 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:40,783 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:55:40,783 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:40,783 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:40,844 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:55:40,845 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:55:40,845 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:40,845 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:40,845 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:55:40,845 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:55:40,845 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:40,910 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:40,910 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:40,910 - src.training - INFO - 모델 학습 시작
2025-06-24 12:55:41,040 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:55:41,040 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:55:41,040 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:55:41,040 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:55:41,040 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:55:41,040 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:55:41,040 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:55:41,040 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:55:41,040 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:41,041 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:55:41,041 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:55:41,041 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:55:41,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:55:41,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:41,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:41,132 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:41,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:41,268 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:41,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:41,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:41,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:41,497 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:55:41,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:41,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:55:41,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:41,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:41,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:41,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:41,581 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:41,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:41,614 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:41,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:41,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:41,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:41,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:41,669 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:41,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:55:41,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:41,685 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:41,685 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:41,685 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:55:41,685 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:55:41,685 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:55:41,698 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   iterations: 65
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   learning_rate: 0.024112898115291985
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.597505784732165
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   random_strength: 1.2399967836846095
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   bagging_temperature: 0.5680612190600297
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   border_count: 101
2025-06-24 12:55:41,701 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:41,702 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:55:42,997 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:55:42,998 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:55:42,998 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:55:42,998 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:55:42,998 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:55:42,998 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:55:42,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:42,998 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:42,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:43,016 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:43,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:43,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:43,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:43,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:43,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:43,097 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:43,097 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:43,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:55:43,127 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:55:43,127 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:55:43,127 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:55:43,127 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:55:43,127 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:43,127 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:43,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:55:43,127 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:55:43,130 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:55:43,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:55:43,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:55:43,135 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:55:43,889 - src.training - INFO -   precision: 0.0
2025-06-24 12:55:43,889 - src.training - INFO -   recall: 0.0
2025-06-24 12:55:43,889 - src.training - INFO -   f1: 0.0
2025-06-24 12:55:43,889 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:55:43,889 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:55:43,889 - src.training - INFO -   positive_samples: 270
2025-06-24 12:55:43,889 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:55:43,889 - src.training - INFO -   total_samples: 220940
2025-06-24 12:55:43,889 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:55:43,889 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:55:43,889 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:55:43,889 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:55:43,890 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:55:43,890 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:55:43,890 - src.training - INFO - 모델 학습 완료
2025-06-24 12:55:43,890 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:55:43,890 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:43,890 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:43,890 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:43,890 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:43,911 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:55:43,911 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:55:44,343 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = catboost
2025-06-24 12:55:46,159 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:55:46,159 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:55:46,159 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:55:46,159 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:55:46,159 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:55:46,159 - src.training - INFO - 교차 검증 시작
2025-06-24 12:55:46,159 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:55:46,177 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:55:46,653 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:55:46,653 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:55:46,653 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:55:46,653 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:55:46,653 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:55:46,653 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:55:46,653 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:55:46,653 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:55:46,653 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:55:46,819 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:55:46,819 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:55:46,819 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:55:46,819 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:55:48,282 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:55:49,424 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:49,424 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:55:49,431 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:55:49,464 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:55:49,464 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:55:49,464 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:55:49,464 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:50,843 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:55:51,114 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:55:51,114 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:51,282 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:51,282 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:55:51,325 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:55:51,325 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:51,325 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:55:51,325 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:55:51,325 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:51,325 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:51,375 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:55:51,376 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:55:51,376 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:51,376 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:51,376 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:55:51,376 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:55:51,376 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:51,441 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:51,441 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:55:51,441 - src.training - INFO - 모델 학습 시작
2025-06-24 12:55:51,572 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:55:51,572 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:55:51,572 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:55:51,572 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:55:51,572 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:55:51,572 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:55:51,572 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:55:51,572 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:55:51,572 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:51,572 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:55:51,572 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:55:51,572 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:55:51,572 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:55:51,572 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:51,573 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:51,663 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:51,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:51,799 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:51,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:51,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:52,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:52,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:55:52,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:52,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:55:52,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:52,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:52,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:52,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:52,106 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:52,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:52,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:52,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:52,173 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:52,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:52,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:52,194 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:52,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:55:52,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:52,209 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:55:52,209 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:52,209 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:55:52,209 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:55:52,209 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:55:52,222 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO -   iterations: 133
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO -   learning_rate: 0.13962563737015762
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO -   l2_leaf_reg: 8.699593128513321
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:55:52,224 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   random_strength: 6.978281265126034
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   bagging_temperature: 0.6381099809299766
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   border_count: 232
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:55:52,225 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:55:53,511 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:55:53,511 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:55:53,511 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:55:53,511 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:55:53,511 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:55:53,511 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:55:53,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:55:53,511 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:53,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:55:53,530 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:55:53,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:55:53,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:55:53,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:55:53,595 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:55:53,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:55:53,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:55:53,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:53,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:55:53,646 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:55:53,647 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:55:53,647 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:55:53,647 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:55:53,647 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:53,647 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:55:53,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:55:53,647 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:55:53,650 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:55:53,655 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:55:53,655 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:55:53,655 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:55:54,494 - src.training - INFO -   precision: 0.0
2025-06-24 12:55:54,494 - src.training - INFO -   recall: 0.0
2025-06-24 12:55:54,494 - src.training - INFO -   f1: 0.0
2025-06-24 12:55:54,494 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:55:54,494 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:55:54,494 - src.training - INFO -   positive_samples: 270
2025-06-24 12:55:54,494 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:55:54,494 - src.training - INFO -   total_samples: 220940
2025-06-24 12:55:54,494 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:55:54,494 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:55:54,494 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:55:54,494 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:55:54,494 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:55:54,494 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:55:54,494 - src.training - INFO - 모델 학습 완료
2025-06-24 12:55:54,494 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:55:54,494 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:54,494 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:54,494 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:55:54,494 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:55:54,513 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:55:54,513 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:55:54,968 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = catboost
2025-06-24 12:55:56,930 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:55:56,930 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:55:56,930 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:55:56,930 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:55:56,930 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:55:56,930 - src.training - INFO - 교차 검증 시작
2025-06-24 12:55:56,930 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:55:56,947 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:55:57,433 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:55:57,433 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:55:57,433 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:55:57,433 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:55:57,433 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:55:57,433 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:55:57,433 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:55:57,433 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:55:57,433 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:55:57,600 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:55:57,600 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:55:57,600 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:55:57,600 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:55:59,061 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:56:00,202 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:00,202 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:56:00,208 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:56:00,241 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:56:00,241 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:56:00,241 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:56:00,241 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:01,607 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:01,878 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:56:01,878 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:02,046 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:02,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:02,090 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:02,090 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:02,090 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:02,090 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:56:02,090 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:02,090 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,152 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:56:02,152 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:56:02,152 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,152 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,152 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:56:02,152 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:56:02,152 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,217 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:02,217 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:02,217 - src.training - INFO - 모델 학습 시작
2025-06-24 12:56:02,349 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:56:02,349 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:56:02,349 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:56:02,349 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:56:02,349 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:56:02,349 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:56:02,349 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:56:02,349 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:56:02,349 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:02,349 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:56:02,349 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:56:02,349 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:56:02,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:56:02,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:02,349 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:02,438 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:02,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:02,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:02,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:02,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:02,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:02,803 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:56:02,803 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:02,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:56:02,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:02,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:02,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:02,884 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:02,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:02,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:02,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:02,950 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:02,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:02,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:02,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:02,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:56:02,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,986 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:02,986 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:02,986 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:56:02,986 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:56:02,986 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:56:02,998 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   iterations: 89
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.1150972021685583
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   random_strength: 4.544383960336017
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   bagging_temperature: 0.34421412859650635
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   border_count: 119
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:56:03,000 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:03,001 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:56:04,235 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:56:04,235 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:56:04,235 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:56:04,235 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:56:04,235 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:56:04,236 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:56:04,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:04,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:04,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:04,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:04,272 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:04,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:04,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:04,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:04,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:04,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:04,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:04,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:56:04,377 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:56:04,377 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:56:04,377 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:56:04,377 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:56:04,377 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:04,377 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:04,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:56:04,377 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:56:04,381 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:56:04,385 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:56:04,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:56:04,386 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:56:05,271 - src.training - INFO -   precision: 0.0
2025-06-24 12:56:05,271 - src.training - INFO -   recall: 0.0
2025-06-24 12:56:05,271 - src.training - INFO -   f1: 0.0
2025-06-24 12:56:05,271 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:56:05,271 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:56:05,271 - src.training - INFO -   positive_samples: 270
2025-06-24 12:56:05,272 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:56:05,272 - src.training - INFO -   total_samples: 220940
2025-06-24 12:56:05,272 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:56:05,272 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:56:05,272 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:56:05,272 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:56:05,272 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:56:05,272 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:56:05,272 - src.training - INFO - 모델 학습 완료
2025-06-24 12:56:05,272 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:56:05,272 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:05,272 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:05,272 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:05,272 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:05,292 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:56:05,292 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:56:05,749 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = catboost
2025-06-24 12:56:07,731 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:56:07,731 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:56:07,731 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:56:07,731 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:56:07,731 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:56:07,731 - src.training - INFO - 교차 검증 시작
2025-06-24 12:56:07,731 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:56:07,748 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:56:08,236 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:56:08,236 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:56:08,236 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:56:08,236 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:56:08,236 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:56:08,236 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:56:08,236 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:56:08,236 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:56:08,236 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:56:08,403 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:08,403 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:08,403 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:08,404 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:08,404 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:08,404 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:56:08,404 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:56:08,404 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:56:08,404 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:56:08,404 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:56:09,867 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:56:11,012 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:11,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:56:11,018 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:56:11,050 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:56:11,050 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:56:11,050 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:56:11,050 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:12,432 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:12,704 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:56:12,704 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:12,873 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:12,873 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:12,915 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:12,916 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:12,916 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:12,916 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:56:12,916 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:12,916 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:12,977 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:56:12,977 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:56:12,977 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:12,977 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:12,977 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:56:12,977 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:56:12,977 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:13,042 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:13,042 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:13,042 - src.training - INFO - 모델 학습 시작
2025-06-24 12:56:13,173 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:56:13,173 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:56:13,173 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:56:13,173 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:56:13,173 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:56:13,173 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:56:13,173 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:56:13,173 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:56:13,173 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:13,173 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:56:13,173 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:56:13,173 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:56:13,173 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:56:13,173 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:13,174 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:13,264 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:13,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:13,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:13,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:13,533 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:13,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:13,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:56:13,632 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:13,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:56:13,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:13,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:13,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:13,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:13,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:13,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:13,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:13,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:13,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:13,799 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:13,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:13,801 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:13,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:56:13,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:13,816 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:13,817 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:13,817 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:56:13,817 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:56:13,817 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:56:13,828 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   iterations: 210
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   learning_rate: 0.06333268775321842
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.383324997521996
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   random_strength: 9.413993046829944
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   bagging_temperature: 0.16709557931179375
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   border_count: 211
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:56:13,831 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:13,832 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:56:15,151 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:56:15,151 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:56:15,152 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:56:15,152 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:56:15,152 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:56:15,152 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:56:15,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:15,152 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:15,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:15,170 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:15,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:15,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:15,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:15,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:15,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:15,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:15,254 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:15,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:56:15,285 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:56:15,286 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:56:15,286 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:56:15,286 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:56:15,286 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:15,286 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:15,286 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:56:15,286 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:56:15,289 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:56:15,293 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:56:15,294 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:56:15,294 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:56:16,083 - src.training - INFO -   precision: 0.0
2025-06-24 12:56:16,083 - src.training - INFO -   recall: 0.0
2025-06-24 12:56:16,083 - src.training - INFO -   f1: 0.0
2025-06-24 12:56:16,083 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:56:16,083 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:56:16,083 - src.training - INFO -   positive_samples: 270
2025-06-24 12:56:16,083 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:56:16,083 - src.training - INFO -   total_samples: 220940
2025-06-24 12:56:16,083 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:56:16,083 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:56:16,083 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:56:16,083 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:56:16,083 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:56:16,083 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:56:16,083 - src.training - INFO - 모델 학습 완료
2025-06-24 12:56:16,083 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:56:16,083 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:16,083 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:16,083 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:16,083 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:16,103 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:56:16,103 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:56:16,536 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = catboost
2025-06-24 12:56:18,327 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:56:18,327 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:56:18,327 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:56:18,327 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:56:18,327 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:56:18,327 - src.training - INFO - 교차 검증 시작
2025-06-24 12:56:18,327 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:56:18,344 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:56:18,794 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:56:18,795 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:56:18,795 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:56:18,795 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:56:18,795 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:56:18,795 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:56:18,795 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:56:18,795 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:56:18,795 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:56:18,978 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:56:18,978 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:56:18,978 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:56:18,978 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:56:20,279 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:56:21,307 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:21,307 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:56:21,312 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:56:21,344 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:56:21,344 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:56:21,344 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:56:21,344 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:22,575 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:22,823 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:56:22,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:22,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:22,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:23,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:23,021 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:23,021 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:23,021 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:56:23,021 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:23,021 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,067 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:56:23,067 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:56:23,067 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,067 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,067 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:56:23,067 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:56:23,067 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,125 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:23,125 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:23,125 - src.training - INFO - 모델 학습 시작
2025-06-24 12:56:23,251 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:56:23,251 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:56:23,251 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:56:23,251 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:56:23,251 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:56:23,251 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:56:23,251 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:56:23,251 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:56:23,252 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:23,252 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:56:23,252 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:56:23,252 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:56:23,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:56:23,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:23,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:23,330 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:23,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:23,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:23,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:23,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:23,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:23,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:56:23,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:23,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:56:23,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:23,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:23,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:23,751 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:23,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:23,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:23,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:23,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:23,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:23,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:23,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:23,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:56:23,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,847 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:23,847 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:23,847 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:56:23,847 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:56:23,847 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:56:23,859 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   iterations: 89
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   learning_rate: 0.1628279061946544
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.789889238666401
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   random_strength: 0.12825232645752735
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   bagging_temperature: 0.15328776797049498
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   border_count: 67
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:56:23,862 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:23,863 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:56:25,128 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:56:25,128 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:56:25,128 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:56:25,128 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:56:25,128 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:56:25,129 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:56:25,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:25,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:25,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:25,147 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:25,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:25,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:25,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:25,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:25,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:25,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:25,231 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:25,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:56:25,260 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:56:25,260 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:56:25,260 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:56:25,260 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:56:25,260 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:25,260 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:25,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:56:25,260 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:56:25,263 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:56:25,267 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:56:25,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:56:25,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:56:26,061 - src.training - INFO -   precision: 0.0
2025-06-24 12:56:26,061 - src.training - INFO -   recall: 0.0
2025-06-24 12:56:26,061 - src.training - INFO -   f1: 0.0
2025-06-24 12:56:26,061 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:56:26,061 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:56:26,061 - src.training - INFO -   positive_samples: 270
2025-06-24 12:56:26,061 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:56:26,061 - src.training - INFO -   total_samples: 220940
2025-06-24 12:56:26,061 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:56:26,061 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:56:26,061 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:56:26,061 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:56:26,061 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:56:26,061 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:56:26,061 - src.training - INFO - 모델 학습 완료
2025-06-24 12:56:26,061 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:56:26,061 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:26,061 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:26,061 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:26,061 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:26,081 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:56:26,081 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:56:26,506 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = catboost
2025-06-24 12:56:28,309 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:56:28,309 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:56:28,309 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:56:28,309 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:56:28,309 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:56:28,309 - src.training - INFO - 교차 검증 시작
2025-06-24 12:56:28,309 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:56:28,326 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:56:28,766 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:56:28,766 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:56:28,766 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:56:28,766 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:56:28,766 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:56:28,766 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:56:28,766 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:56:28,766 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:56:28,766 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:56:28,949 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:56:28,949 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:56:28,949 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:56:28,949 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:56:30,256 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:56:31,308 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:31,308 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:56:31,313 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:56:31,345 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:56:31,345 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:56:31,345 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:56:31,345 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:32,569 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:32,815 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:56:32,815 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:32,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:32,975 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:33,015 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:33,015 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:33,015 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:33,015 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:56:33,015 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:33,015 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,061 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:56:33,061 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:56:33,061 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,061 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,061 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:56:33,061 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:56:33,061 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,119 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:33,119 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:33,119 - src.training - INFO - 모델 학습 시작
2025-06-24 12:56:33,245 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:56:33,245 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:56:33,245 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:56:33,245 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:56:33,246 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:56:33,246 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:56:33,246 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:56:33,246 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:56:33,246 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:33,246 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:56:33,246 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:56:33,246 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:56:33,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:56:33,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:33,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:33,324 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:33,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:33,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:33,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:33,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:33,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:33,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:56:33,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:33,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:56:33,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:33,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:33,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:33,738 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:33,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:33,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:33,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:33,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:33,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:33,818 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:33,818 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:33,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:56:33,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,832 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:33,832 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:33,832 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:56:33,832 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:56:33,832 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:56:33,843 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   iterations: 426
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   learning_rate: 0.19871806320931118
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.6783584509783942
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:56:33,845 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   random_strength: 0.23238296507029205
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   bagging_temperature: 0.7784014163965293
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   border_count: 220
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:33,846 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:56:35,180 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:56:35,180 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:56:35,180 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:56:35,180 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:56:35,180 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:56:35,180 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:56:35,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:35,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:35,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:35,199 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:35,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:35,230 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:35,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:35,261 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:35,279 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:35,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:35,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:35,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:56:35,312 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:56:35,313 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:56:35,313 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:56:35,313 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:56:35,313 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:35,313 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:35,313 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:56:35,313 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:56:35,316 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:56:35,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:56:35,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:56:35,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:56:36,114 - src.training - INFO -   precision: 0.0
2025-06-24 12:56:36,114 - src.training - INFO -   recall: 0.0
2025-06-24 12:56:36,114 - src.training - INFO -   f1: 0.0
2025-06-24 12:56:36,114 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:56:36,114 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:56:36,114 - src.training - INFO -   positive_samples: 270
2025-06-24 12:56:36,114 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:56:36,114 - src.training - INFO -   total_samples: 220940
2025-06-24 12:56:36,114 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:56:36,114 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:56:36,114 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:56:36,114 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:56:36,114 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:56:36,114 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:56:36,114 - src.training - INFO - 모델 학습 완료
2025-06-24 12:56:36,114 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:56:36,114 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:36,114 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:36,114 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:36,114 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:36,134 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:56:36,134 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:56:36,565 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = catboost
2025-06-24 12:56:38,357 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:56:38,357 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:56:38,357 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:56:38,357 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:56:38,357 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:56:38,357 - src.training - INFO - 교차 검증 시작
2025-06-24 12:56:38,357 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:56:38,375 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:56:38,816 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:56:38,816 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:56:38,816 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:56:38,816 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:56:38,816 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:56:38,816 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:56:38,816 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:56:38,816 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:56:38,816 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:56:38,991 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:56:38,991 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:56:38,991 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:56:38,991 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:56:40,312 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:56:41,337 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:41,337 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:56:41,343 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:56:41,375 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:56:41,375 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:56:41,375 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:56:41,375 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:42,609 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:42,860 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:56:42,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:43,019 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:43,019 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:43,060 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:43,060 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:43,060 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:43,060 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:56:43,060 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:43,060 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,117 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:56:43,117 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:56:43,117 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,117 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,117 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:56:43,117 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:56:43,117 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,175 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:43,175 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:43,175 - src.training - INFO - 모델 학습 시작
2025-06-24 12:56:43,303 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:56:43,303 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:56:43,303 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:56:43,303 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:56:43,303 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:56:43,303 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:56:43,303 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:56:43,303 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:56:43,303 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:43,303 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:56:43,303 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:56:43,303 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:56:43,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:56:43,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:43,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:43,383 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:43,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:43,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:43,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:43,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:43,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:43,713 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:56:43,713 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:43,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:56:43,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:43,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:43,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:43,803 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:43,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:43,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:43,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:43,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:43,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:43,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:43,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:43,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:56:43,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,899 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:43,899 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:43,899 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:56:43,899 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:56:43,899 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:56:43,912 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   iterations: 282
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   learning_rate: 0.10772987843192815
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.367304868010517
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   random_strength: 0.19913610411161292
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   bagging_temperature: 0.2537418138464965
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   border_count: 77
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:56:43,915 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:43,916 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:56:45,301 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:56:45,301 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:56:45,301 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:56:45,301 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:56:45,301 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:56:45,302 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:56:45,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:45,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:45,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:45,321 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:45,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:45,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:45,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:45,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:45,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:45,408 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:45,408 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:45,411 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:56:45,440 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:56:45,440 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:56:45,440 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:56:45,440 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:56:45,440 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:45,440 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:45,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:56:45,440 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:56:45,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:56:45,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:56:45,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:56:45,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:56:46,326 - src.training - INFO -   precision: 0.0
2025-06-24 12:56:46,326 - src.training - INFO -   recall: 0.0
2025-06-24 12:56:46,326 - src.training - INFO -   f1: 0.0
2025-06-24 12:56:46,326 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:56:46,326 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:56:46,326 - src.training - INFO -   positive_samples: 270
2025-06-24 12:56:46,326 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:56:46,326 - src.training - INFO -   total_samples: 220940
2025-06-24 12:56:46,326 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:56:46,326 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:56:46,326 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:56:46,326 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:56:46,326 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:56:46,326 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:56:46,326 - src.training - INFO - 모델 학습 완료
2025-06-24 12:56:46,326 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:56:46,326 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:46,326 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:46,326 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:46,326 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:46,346 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:56:46,346 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:56:46,810 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = catboost
2025-06-24 12:56:48,788 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:56:48,788 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:56:48,788 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:56:48,788 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:56:48,788 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:56:48,788 - src.training - INFO - 교차 검증 시작
2025-06-24 12:56:48,788 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:56:48,806 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:56:49,273 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:56:49,274 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:56:49,274 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:56:49,274 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:56:49,274 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:56:49,274 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:56:49,274 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:56:49,274 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:56:49,274 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:56:49,438 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:49,438 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:49,438 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:56:49,438 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:56:49,438 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:49,439 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:56:49,439 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:56:49,439 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:56:49,439 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:56:49,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:56:50,905 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:56:52,036 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:52,036 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:56:52,042 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:56:52,075 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:56:52,075 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:56:52,075 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:56:52,075 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:56:53,447 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:56:53,717 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:56:53,717 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:53,886 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:53,886 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:56:53,929 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:56:53,929 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:53,929 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:56:53,929 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:56:53,929 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:53,929 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:53,991 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:56:53,991 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:56:53,991 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:53,991 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:53,991 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:56:53,991 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:56:53,991 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:54,057 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:54,057 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:56:54,057 - src.training - INFO - 모델 학습 시작
2025-06-24 12:56:54,175 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:56:54,175 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:56:54,175 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:56:54,175 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:56:54,175 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:56:54,175 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:56:54,175 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:56:54,175 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:56:54,175 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:54,175 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:56:54,175 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:56:54,175 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:56:54,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:56:54,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:54,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:54,254 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:54,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:54,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:54,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:54,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:54,599 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:54,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:56:54,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:54,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:56:54,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:54,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:54,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:54,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:54,692 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:54,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:54,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:54,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:54,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:54,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:54,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:54,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:54,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:56:54,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:54,794 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:56:54,794 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:54,794 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:56:54,794 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:56:54,794 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:56:54,805 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   iterations: 461
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   learning_rate: 0.05086836204610761
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0499816668699289
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   random_strength: 0.48764506112270106
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   bagging_temperature: 0.7787472629625942
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   border_count: 216
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:56:54,808 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:56:54,809 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:56:56,114 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:56:56,115 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:56:56,115 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:56:56,115 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:56:56,115 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:56:56,115 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:56:56,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:56:56,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:56,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:56:56,135 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:56:56,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:56:56,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:56:56,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:56:56,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:56:56,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:56:56,220 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:56:56,220 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:56,223 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:56:56,251 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:56:56,252 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:56:56,252 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:56:56,252 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:56:56,252 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:56,252 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:56:56,252 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:56:56,252 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:56:56,255 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:56:56,259 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:56:56,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:56:56,260 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:56:57,135 - src.training - INFO -   precision: 0.0
2025-06-24 12:56:57,135 - src.training - INFO -   recall: 0.0
2025-06-24 12:56:57,135 - src.training - INFO -   f1: 0.0
2025-06-24 12:56:57,135 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:56:57,135 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:56:57,135 - src.training - INFO -   positive_samples: 270
2025-06-24 12:56:57,135 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:56:57,135 - src.training - INFO -   total_samples: 220940
2025-06-24 12:56:57,135 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:56:57,135 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:56:57,135 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:56:57,135 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:56:57,135 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:56:57,135 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:56:57,135 - src.training - INFO - 모델 학습 완료
2025-06-24 12:56:57,135 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:56:57,135 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:57,135 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:57,135 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:56:57,135 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:56:57,154 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:56:57,154 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:56:57,604 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = catboost
2025-06-24 12:56:59,589 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:56:59,589 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:56:59,589 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:56:59,589 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:56:59,589 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:56:59,589 - src.training - INFO - 교차 검증 시작
2025-06-24 12:56:59,589 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:56:59,607 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:57:00,082 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:57:00,082 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:57:00,082 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:57:00,082 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:57:00,082 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:57:00,082 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:57:00,082 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:57:00,082 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:57:00,082 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:57:00,248 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:57:00,248 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:57:00,248 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:57:00,248 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:57:01,714 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:57:02,852 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:02,852 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:57:02,858 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:57:02,896 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:57:02,896 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:57:02,896 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:57:02,896 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:04,264 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:04,532 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:57:04,532 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:04,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:04,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:04,744 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:04,744 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:04,744 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:04,744 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:57:04,744 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:04,744 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:04,806 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:57:04,806 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:57:04,806 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:04,806 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:04,807 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:57:04,807 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:57:04,807 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:04,874 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:04,874 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:04,874 - src.training - INFO - 모델 학습 시작
2025-06-24 12:57:04,993 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:57:04,993 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:57:04,993 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:57:04,993 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:57:04,993 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:57:04,994 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:57:04,994 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:57:04,994 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:57:04,994 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:04,994 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:57:04,994 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:57:04,994 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:57:04,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:57:04,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:04,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:05,075 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:05,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:05,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:05,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:05,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:05,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:05,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:57:05,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:05,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:57:05,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:05,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:05,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:05,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:05,513 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:05,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:05,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:05,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:05,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:05,599 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:05,602 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:05,602 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:05,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:57:05,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:05,617 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:05,617 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:05,617 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:57:05,617 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:57:05,617 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:57:05,628 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   iterations: 277
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   learning_rate: 0.18905136107159665
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.3074973006105306
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   random_strength: 0.26963641598622134
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   bagging_temperature: 0.9227377790352584
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   border_count: 207
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:05,631 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:57:05,632 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:05,632 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:57:06,856 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:57:06,856 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:57:06,856 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:57:06,856 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:57:06,856 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:57:06,857 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:57:06,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:06,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:06,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:06,876 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:06,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:06,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:06,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:06,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:06,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:06,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:06,965 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:06,968 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:57:06,996 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:57:06,996 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:57:06,996 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:57:06,996 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:57:06,996 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:06,996 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:06,996 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:57:06,996 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:57:07,000 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:57:07,004 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:57:07,005 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:57:07,005 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:57:07,880 - src.training - INFO -   precision: 0.0
2025-06-24 12:57:07,880 - src.training - INFO -   recall: 0.0
2025-06-24 12:57:07,880 - src.training - INFO -   f1: 0.0
2025-06-24 12:57:07,880 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:57:07,880 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:57:07,880 - src.training - INFO -   positive_samples: 270
2025-06-24 12:57:07,880 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:57:07,880 - src.training - INFO -   total_samples: 220940
2025-06-24 12:57:07,880 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:57:07,880 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:57:07,880 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:57:07,880 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:57:07,880 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:57:07,880 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:57:07,880 - src.training - INFO - 모델 학습 완료
2025-06-24 12:57:07,880 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:57:07,880 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:07,880 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:07,880 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:07,880 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:07,900 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:57:07,900 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:57:08,369 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = catboost
2025-06-24 12:57:10,350 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:57:10,350 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:57:10,350 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:57:10,350 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:57:10,350 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:57:10,350 - src.training - INFO - 교차 검증 시작
2025-06-24 12:57:10,350 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:57:10,365 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:57:10,832 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:57:10,832 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:57:10,832 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:57:10,832 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:57:10,832 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:57:10,833 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:57:10,833 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:57:10,833 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:57:10,833 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:57:10,998 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:57:10,998 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:57:10,998 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:57:10,998 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:57:12,473 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:57:13,616 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:13,617 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:57:13,623 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:57:13,656 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:57:13,656 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:57:13,656 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:57:13,656 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:15,011 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:15,278 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:57:15,278 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:15,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:15,447 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:15,490 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:15,490 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:15,490 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:15,490 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:57:15,490 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:15,490 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:15,540 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:57:15,540 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:57:15,540 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:15,540 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:15,540 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:57:15,540 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:57:15,540 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:15,607 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:15,607 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:15,607 - src.training - INFO - 모델 학습 시작
2025-06-24 12:57:15,739 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:57:15,739 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:57:15,739 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:57:15,739 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:57:15,739 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:57:15,739 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:57:15,739 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:57:15,739 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:57:15,740 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:15,740 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:57:15,740 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:57:15,740 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:57:15,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:57:15,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:15,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:15,831 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:15,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:15,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:16,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:16,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:16,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:16,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:57:16,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:57:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:16,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:16,269 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:16,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:16,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:16,318 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:16,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:16,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:16,356 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:16,356 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:16,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:57:16,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:16,372 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:16,372 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:16,372 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:57:16,372 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:57:16,372 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:57:16,383 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:57:16,385 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   iterations: 205
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   learning_rate: 0.05785790067725656
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.2648422594899174
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   random_strength: 0.1141212463834017
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   bagging_temperature: 0.41092646708201197
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   border_count: 156
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:16,386 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:57:17,638 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:57:17,638 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:57:17,638 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:57:17,638 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:57:17,638 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:57:17,639 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:57:17,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:17,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:17,640 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:17,658 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:17,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:17,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:17,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:17,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:17,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:17,745 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:17,748 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:57:17,776 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:57:17,776 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:57:17,776 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:57:17,776 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:57:17,776 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:17,776 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:17,777 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:57:17,777 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:57:17,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:57:17,784 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:57:17,785 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:57:17,785 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:57:18,620 - src.training - INFO -   precision: 0.0
2025-06-24 12:57:18,620 - src.training - INFO -   recall: 0.0
2025-06-24 12:57:18,620 - src.training - INFO -   f1: 0.0
2025-06-24 12:57:18,620 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:57:18,620 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:57:18,620 - src.training - INFO -   positive_samples: 270
2025-06-24 12:57:18,620 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:57:18,620 - src.training - INFO -   total_samples: 220940
2025-06-24 12:57:18,620 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:57:18,620 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:57:18,620 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:57:18,620 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:57:18,620 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:57:18,620 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:57:18,620 - src.training - INFO - 모델 학습 완료
2025-06-24 12:57:18,620 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:57:18,620 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:18,620 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:18,620 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:18,620 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:18,639 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:57:18,639 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:57:19,100 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = catboost
2025-06-24 12:57:21,087 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:57:21,087 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:57:21,087 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:57:21,087 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:57:21,087 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:57:21,087 - src.training - INFO - 교차 검증 시작
2025-06-24 12:57:21,087 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:57:21,104 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:57:21,571 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:57:21,571 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:57:21,571 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:57:21,571 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:57:21,571 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:57:21,572 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:57:21,572 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:57:21,572 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:57:21,572 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:57:21,737 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:21,738 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:21,738 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:21,738 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:21,738 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:21,738 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:57:21,738 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:57:21,738 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:57:21,738 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:57:21,738 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:57:23,176 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:57:24,198 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:24,199 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:57:24,204 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:57:24,236 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:57:24,236 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:57:24,236 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:57:24,237 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:25,450 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:25,705 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:57:25,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:25,867 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:25,867 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:25,908 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:25,908 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:25,908 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:25,908 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:57:25,908 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:25,908 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:25,954 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:57:25,954 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:57:25,954 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:25,954 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:25,954 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:57:25,954 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:57:25,954 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:26,013 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:26,013 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:26,013 - src.training - INFO - 모델 학습 시작
2025-06-24 12:57:26,155 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:57:26,155 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:57:26,155 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:57:26,155 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:57:26,155 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:57:26,155 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:57:26,155 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:57:26,155 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:57:26,155 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:26,155 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:57:26,155 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:57:26,155 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:57:26,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:57:26,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:26,156 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:26,248 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:26,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:26,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:26,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:26,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:26,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:26,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:57:26,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:26,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:57:26,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:26,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:26,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:26,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:26,692 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:26,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:26,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:26,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:26,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:26,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:26,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:26,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:57:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:26,794 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:26,794 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:26,794 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:57:26,794 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:57:26,794 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:57:26,805 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   iterations: 171
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   learning_rate: 0.15925684179046562
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.99058521107192
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   random_strength: 0.22526291081193694
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   bagging_temperature: 0.6885770166336725
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   border_count: 49
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:57:26,808 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:26,809 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:57:28,045 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:57:28,045 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:57:28,045 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:57:28,045 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:57:28,045 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:57:28,046 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:57:28,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:28,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:28,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:28,065 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:28,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:28,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:28,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:28,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:28,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:28,150 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:28,150 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:28,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:57:28,182 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:57:28,182 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:57:28,182 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:57:28,182 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:57:28,182 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:28,182 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:28,182 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:57:28,182 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:57:28,185 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:57:28,189 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:57:28,190 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:57:28,190 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:57:29,070 - src.training - INFO -   precision: 0.0
2025-06-24 12:57:29,070 - src.training - INFO -   recall: 0.0
2025-06-24 12:57:29,070 - src.training - INFO -   f1: 0.0
2025-06-24 12:57:29,070 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:57:29,070 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:57:29,070 - src.training - INFO -   positive_samples: 270
2025-06-24 12:57:29,071 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:57:29,071 - src.training - INFO -   total_samples: 220940
2025-06-24 12:57:29,071 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:57:29,071 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:57:29,071 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:57:29,071 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:57:29,071 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:57:29,071 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:57:29,071 - src.training - INFO - 모델 학습 완료
2025-06-24 12:57:29,071 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:57:29,071 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:29,071 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:29,071 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:29,071 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:29,090 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:57:29,090 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:57:29,553 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = catboost
2025-06-24 12:57:31,525 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:57:31,525 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:57:31,525 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:57:31,525 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:57:31,525 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:57:31,525 - src.training - INFO - 교차 검증 시작
2025-06-24 12:57:31,525 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:57:31,542 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:57:32,016 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:57:32,016 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:57:32,016 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:57:32,016 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:57:32,016 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:57:32,016 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:57:32,016 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:57:32,016 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:57:32,016 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:57:32,180 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:32,180 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:32,181 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:32,181 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:32,181 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:32,181 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:57:32,181 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:57:32,181 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:57:32,181 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:57:32,181 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:57:33,634 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:57:34,761 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:34,762 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:57:34,768 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:57:34,800 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:57:34,800 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:57:34,801 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:57:34,801 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:36,173 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:36,443 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:57:36,443 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:36,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:36,611 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:36,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:36,654 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:36,654 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:36,654 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:57:36,654 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:36,655 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:36,716 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:57:36,716 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:57:36,716 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:36,716 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:36,716 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:57:36,716 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:57:36,716 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:36,782 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:36,782 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:36,782 - src.training - INFO - 모델 학습 시작
2025-06-24 12:57:36,902 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:57:36,902 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:57:36,902 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:57:36,902 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:57:36,902 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:57:36,902 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:57:36,902 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:57:36,902 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:57:36,902 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:36,902 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:57:36,902 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:57:36,902 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:57:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:57:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:36,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:36,984 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:37,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:37,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:37,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:37,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:37,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:37,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:57:37,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:37,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:57:37,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:37,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:37,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:37,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:37,420 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:37,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:37,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:37,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:37,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:37,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:37,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:37,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:37,521 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:57:37,521 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:37,521 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:37,521 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:37,521 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:57:37,521 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:57:37,521 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:57:37,533 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   iterations: 268
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   learning_rate: 0.1699499696038888
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.1885061310912444
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   random_strength: 0.15983888773304006
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   bagging_temperature: 0.29686834717340166
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   border_count: 38
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:57:37,536 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:37,537 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:57:38,860 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:57:38,860 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:57:38,860 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:57:38,860 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:57:38,860 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:57:38,860 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:57:38,860 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:38,860 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:38,861 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:38,878 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:38,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:38,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:38,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:38,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:38,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:38,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:38,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:38,965 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:57:38,991 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:57:38,992 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:57:38,992 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:57:38,992 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:57:38,992 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:38,992 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:38,992 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:57:38,992 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:57:38,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:57:38,999 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:57:38,999 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:57:38,999 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:57:39,794 - src.training - INFO -   precision: 0.0
2025-06-24 12:57:39,794 - src.training - INFO -   recall: 0.0
2025-06-24 12:57:39,794 - src.training - INFO -   f1: 0.0
2025-06-24 12:57:39,794 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:57:39,794 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:57:39,794 - src.training - INFO -   positive_samples: 270
2025-06-24 12:57:39,794 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:57:39,794 - src.training - INFO -   total_samples: 220940
2025-06-24 12:57:39,794 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:57:39,794 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:57:39,794 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:57:39,794 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:57:39,795 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:57:39,795 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:57:39,795 - src.training - INFO - 모델 학습 완료
2025-06-24 12:57:39,795 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:57:39,795 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:39,795 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:39,795 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:39,795 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:39,814 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:57:39,815 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:57:40,248 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = catboost
2025-06-24 12:57:42,049 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:57:42,050 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:57:42,050 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:57:42,050 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:57:42,050 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:57:42,050 - src.training - INFO - 교차 검증 시작
2025-06-24 12:57:42,050 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:57:42,067 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:57:42,506 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:57:42,506 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:57:42,506 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:57:42,506 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:57:42,506 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:57:42,506 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:57:42,506 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:57:42,506 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:57:42,506 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:57:42,693 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:57:42,693 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:57:42,693 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:57:42,693 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:57:44,006 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:57:45,021 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:45,021 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:57:45,027 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:57:45,059 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:57:45,059 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:57:45,059 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:57:45,059 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:46,293 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:46,542 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:57:46,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:46,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:46,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:46,741 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:46,741 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:46,741 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:46,741 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:57:46,741 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:46,741 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:46,787 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:57:46,787 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:57:46,787 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:46,787 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:46,787 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:57:46,787 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:57:46,787 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:46,845 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:46,845 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:46,845 - src.training - INFO - 모델 학습 시작
2025-06-24 12:57:46,972 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:57:46,972 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:57:46,972 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:57:46,972 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:57:46,972 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:57:46,972 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:57:46,972 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:57:46,972 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:57:46,972 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:46,972 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:57:46,972 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:57:46,972 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:57:46,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:57:46,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:46,973 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:47,049 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:47,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:47,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:47,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:47,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:47,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:47,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:57:47,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:47,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:57:47,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:47,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:47,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:47,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:47,458 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:47,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:47,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:47,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:47,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:47,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:47,539 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:47,539 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:47,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:57:47,553 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:47,553 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:47,553 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:47,553 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:57:47,553 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:57:47,553 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:57:47,564 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   iterations: 463
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   learning_rate: 0.030062086581643672
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.506108264665391
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   random_strength: 0.19247580868927167
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   bagging_temperature: 0.520541280901869
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   border_count: 247
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:57:47,567 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:47,568 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:57:48,871 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:57:48,871 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:57:48,871 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:57:48,871 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:57:48,871 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:57:48,872 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:57:48,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:48,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:48,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:48,890 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:48,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:48,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:48,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:48,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:48,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:48,972 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:48,972 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:48,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:57:49,002 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:57:49,003 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:57:49,003 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:57:49,003 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:57:49,003 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:49,003 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:49,003 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:57:49,003 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:57:49,006 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:57:49,010 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:57:49,010 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:57:49,010 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:57:49,794 - src.training - INFO -   precision: 0.0
2025-06-24 12:57:49,794 - src.training - INFO -   recall: 0.0
2025-06-24 12:57:49,794 - src.training - INFO -   f1: 0.0
2025-06-24 12:57:49,794 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:57:49,794 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:57:49,794 - src.training - INFO -   positive_samples: 270
2025-06-24 12:57:49,794 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:57:49,794 - src.training - INFO -   total_samples: 220940
2025-06-24 12:57:49,794 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:57:49,794 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:57:49,794 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:57:49,794 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:57:49,794 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:57:49,794 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:57:49,794 - src.training - INFO - 모델 학습 완료
2025-06-24 12:57:49,794 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:57:49,794 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:49,794 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:49,795 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:49,795 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:49,814 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:57:49,814 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:57:50,254 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = catboost
2025-06-24 12:57:52,034 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:57:52,034 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:57:52,034 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:57:52,034 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:57:52,034 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:57:52,034 - src.training - INFO - 교차 검증 시작
2025-06-24 12:57:52,034 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:57:52,051 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:57:52,492 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:57:52,492 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:57:52,492 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:57:52,492 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:57:52,492 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:57:52,492 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:57:52,492 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:57:52,492 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:57:52,492 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:57:52,668 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:57:52,668 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:57:52,668 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:57:52,668 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:57:53,986 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:57:55,005 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:55,005 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:57:55,010 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:57:55,042 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:57:55,042 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:57:55,042 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:57:55,042 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:57:56,273 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:57:56,528 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:57:56,528 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:56,687 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:56,688 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:57:56,728 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:57:56,728 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:56,728 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:57:56,728 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:57:56,728 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:56,728 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:56,785 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:57:56,785 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:57:56,785 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:56,785 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:56,785 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:57:56,785 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:57:56,785 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:56,842 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:56,842 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:57:56,842 - src.training - INFO - 모델 학습 시작
2025-06-24 12:57:56,968 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:57:56,968 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:57:56,968 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:57:56,968 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:57:56,968 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:57:56,968 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:57:56,968 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:57:56,969 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:57:56,969 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:56,969 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:57:56,969 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:57:56,969 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:57:56,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:57:56,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:56,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:57,047 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:57,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:57,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:57,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:57,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:57,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:57,374 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:57:57,374 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:57,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:57:57,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:57,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:57,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:57,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:57,461 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:57,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:57,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:57,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:57,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:57,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:57,541 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:57,541 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:57,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:57:57,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:57,556 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:57:57,556 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:57,556 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:57:57,556 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:57:57,556 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:57:57,568 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   iterations: 460
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   learning_rate: 0.12633259569493857
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.3168013142612764
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   random_strength: 2.160051599305389
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   bagging_temperature: 0.5234183197222069
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   border_count: 227
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:57:57,571 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:57:57,572 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:57:58,851 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:57:58,852 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:57:58,852 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:57:58,852 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:57:58,852 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:57:58,852 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:57:58,852 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:57:58,852 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:58,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:57:58,870 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:57:58,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:57:58,900 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:57:58,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:57:58,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:57:58,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:57:58,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:57:58,950 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:58,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:57:58,982 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:57:58,982 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:57:58,982 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:57:58,982 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:57:58,982 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:58,982 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:57:58,982 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:57:58,982 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:57:58,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:57:58,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:57:58,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:57:58,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:57:59,795 - src.training - INFO -   precision: 0.0
2025-06-24 12:57:59,795 - src.training - INFO -   recall: 0.0
2025-06-24 12:57:59,795 - src.training - INFO -   f1: 0.0
2025-06-24 12:57:59,795 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:57:59,795 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:57:59,795 - src.training - INFO -   positive_samples: 270
2025-06-24 12:57:59,795 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:57:59,795 - src.training - INFO -   total_samples: 220940
2025-06-24 12:57:59,795 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:57:59,795 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:57:59,795 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:57:59,795 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:57:59,795 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:57:59,795 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:57:59,795 - src.training - INFO - 모델 학습 완료
2025-06-24 12:57:59,795 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:57:59,795 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:59,795 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:59,795 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:57:59,795 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:57:59,815 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:57:59,815 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:58:00,242 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = catboost
2025-06-24 12:58:02,052 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:58:02,052 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:58:02,052 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:58:02,052 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:58:02,052 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:58:02,052 - src.training - INFO - 교차 검증 시작
2025-06-24 12:58:02,052 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:58:02,069 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:58:02,507 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:58:02,507 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:58:02,507 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:58:02,507 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:58:02,507 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:58:02,507 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:58:02,507 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:58:02,507 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:58:02,507 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:58:02,699 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:02,700 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:02,700 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:02,700 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:02,700 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:02,700 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:58:02,700 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:58:02,700 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:58:02,700 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:58:02,700 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:58:04,015 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:58:05,038 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:05,038 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:58:05,044 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:58:05,075 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:58:05,075 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:58:05,075 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:58:05,075 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:06,305 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:06,558 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:58:06,558 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:06,718 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:06,719 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:06,759 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:06,759 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:06,759 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:06,759 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:58:06,759 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:06,759 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:06,816 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:58:06,816 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:58:06,816 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:06,816 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:06,816 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:58:06,816 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:58:06,816 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:06,874 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:06,874 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:06,874 - src.training - INFO - 모델 학습 시작
2025-06-24 12:58:07,000 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:58:07,000 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:58:07,000 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:58:07,001 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:58:07,001 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:58:07,001 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:58:07,001 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:58:07,001 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:58:07,001 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:07,001 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:58:07,001 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:58:07,001 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:58:07,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:58:07,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:07,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:07,077 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:07,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:07,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:07,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:07,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:07,394 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:07,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:58:07,409 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:07,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:58:07,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:07,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:07,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:07,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:07,496 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:07,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:07,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:07,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:07,559 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:07,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:07,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:07,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:07,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:58:07,594 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:07,594 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:07,594 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:07,594 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:58:07,594 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:58:07,594 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:58:07,606 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   iterations: 486
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   learning_rate: 0.1598378854364877
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0534529344508805
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   random_strength: 0.21570725767130203
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   bagging_temperature: 0.5115577393353339
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   border_count: 194
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:58:07,609 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:07,610 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:58:08,898 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:58:08,898 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:58:08,898 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:58:08,898 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:58:08,898 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:58:08,899 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:58:08,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:08,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:08,899 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:08,916 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:08,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:08,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:08,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:08,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:08,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:09,000 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:09,000 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:09,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:58:09,029 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:58:09,029 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:58:09,029 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:58:09,029 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:58:09,029 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:09,029 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:09,029 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:58:09,029 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:58:09,032 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:58:09,036 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:58:09,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:58:09,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:58:09,782 - src.training - INFO -   precision: 0.0
2025-06-24 12:58:09,782 - src.training - INFO -   recall: 0.0
2025-06-24 12:58:09,782 - src.training - INFO -   f1: 0.0
2025-06-24 12:58:09,782 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:58:09,782 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:58:09,782 - src.training - INFO -   positive_samples: 270
2025-06-24 12:58:09,782 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:58:09,782 - src.training - INFO -   total_samples: 220940
2025-06-24 12:58:09,782 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:58:09,782 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:58:09,782 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:58:09,782 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:58:09,783 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:58:09,783 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:58:09,783 - src.training - INFO - 모델 학습 완료
2025-06-24 12:58:09,783 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:58:09,783 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:09,783 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:09,783 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:09,783 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:09,803 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:58:09,803 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:58:10,247 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = catboost
2025-06-24 12:58:12,020 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:58:12,020 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:58:12,020 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:58:12,020 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:58:12,020 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:58:12,021 - src.training - INFO - 교차 검증 시작
2025-06-24 12:58:12,021 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:58:12,037 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:58:12,469 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:58:12,470 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:58:12,470 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:58:12,470 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:58:12,470 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:58:12,470 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:58:12,470 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:58:12,470 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:58:12,470 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:58:12,654 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:58:12,654 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:58:12,654 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:58:12,654 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:58:13,967 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:58:14,987 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:14,987 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:58:14,993 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:58:15,025 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:58:15,025 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:58:15,025 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:58:15,025 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:16,240 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:16,496 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:58:16,496 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:16,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:16,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:16,696 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:16,696 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:16,696 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:16,696 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:58:16,697 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:16,697 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:16,753 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:58:16,753 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:58:16,753 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:16,753 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:16,753 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:58:16,753 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:58:16,753 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:16,811 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:16,811 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:16,811 - src.training - INFO - 모델 학습 시작
2025-06-24 12:58:16,938 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:58:16,938 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:58:16,938 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:58:16,938 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:58:16,938 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:58:16,939 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:58:16,939 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:58:16,939 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:58:16,939 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:16,939 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:58:16,939 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:58:16,939 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:58:16,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:58:16,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:16,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:17,017 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:17,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:17,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:17,194 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:17,255 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:17,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:17,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:58:17,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:17,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:58:17,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:17,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:17,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:17,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:17,432 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:17,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:17,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:17,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:17,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:17,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:17,512 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:17,512 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:17,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:58:17,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:17,526 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:17,526 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:17,526 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:58:17,526 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:58:17,526 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:58:17,537 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:58:17,539 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   iterations: 205
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   learning_rate: 0.037081787533808405
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.6462716069257075
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   random_strength: 1.6730536022335614
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   bagging_temperature: 0.3576879589888832
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   border_count: 54
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:17,540 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:58:18,893 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:58:18,893 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:58:18,893 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:58:18,893 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:58:18,894 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:58:18,894 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:58:18,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:18,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:18,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:18,912 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:18,928 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:18,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:18,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:18,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:18,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:18,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:18,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:18,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:58:19,025 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:58:19,026 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:58:19,026 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:58:19,026 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:58:19,026 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:19,026 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:19,026 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:58:19,026 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:58:19,029 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:58:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:58:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:58:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:58:19,791 - src.training - INFO -   precision: 0.0
2025-06-24 12:58:19,791 - src.training - INFO -   recall: 0.0
2025-06-24 12:58:19,791 - src.training - INFO -   f1: 0.0
2025-06-24 12:58:19,791 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:58:19,791 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:58:19,791 - src.training - INFO -   positive_samples: 270
2025-06-24 12:58:19,791 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:58:19,791 - src.training - INFO -   total_samples: 220940
2025-06-24 12:58:19,791 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:58:19,791 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:58:19,791 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:58:19,791 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:58:19,791 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:58:19,791 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:58:19,791 - src.training - INFO - 모델 학습 완료
2025-06-24 12:58:19,791 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:58:19,791 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:19,791 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:19,791 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:19,791 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:19,812 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:58:19,812 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:58:20,251 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = catboost
2025-06-24 12:58:22,102 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:58:22,102 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:58:22,102 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:58:22,102 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:58:22,102 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:58:22,103 - src.training - INFO - 교차 검증 시작
2025-06-24 12:58:22,103 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:58:22,119 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:58:22,568 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:58:22,568 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:58:22,568 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:58:22,568 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:58:22,568 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:58:22,568 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:58:22,568 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:58:22,568 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:58:22,568 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:58:22,745 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:58:22,745 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:58:22,745 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:58:22,745 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:58:24,050 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:58:25,078 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:25,078 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:58:25,084 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:58:25,117 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:58:25,117 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:58:25,117 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:58:25,117 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:26,329 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:26,583 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:58:26,583 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:26,741 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:26,741 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:26,781 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:26,782 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:26,782 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:26,782 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:58:26,782 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:26,782 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:26,838 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:58:26,838 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:58:26,839 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:26,839 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:26,839 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:58:26,839 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:58:26,839 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:26,897 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:26,897 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:26,897 - src.training - INFO - 모델 학습 시작
2025-06-24 12:58:27,022 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:58:27,022 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:58:27,022 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:58:27,022 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:58:27,022 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:58:27,023 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:58:27,023 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:58:27,023 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:58:27,023 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:27,023 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:58:27,023 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:58:27,023 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:58:27,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:58:27,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:27,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:27,100 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:27,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:27,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:27,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:27,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:27,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:27,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:58:27,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:27,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:58:27,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:27,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:27,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:27,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:27,519 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:27,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:27,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:27,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:27,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:27,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:27,599 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:27,599 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:27,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:58:27,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:27,613 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:27,613 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:27,614 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:58:27,614 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:58:27,614 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:58:27,625 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   iterations: 61
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   learning_rate: 0.06303458502238798
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.037589081316434
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   random_strength: 0.6050055751525697
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   bagging_temperature: 0.10989027031939402
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   border_count: 128
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:58:27,628 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:58:27,629 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:27,629 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:58:27,629 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:27,629 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:58:28,894 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:58:28,894 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:58:28,894 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:58:28,894 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:58:28,894 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:58:28,895 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:58:28,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:28,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:28,896 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:28,913 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:28,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:28,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:28,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:28,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:28,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:28,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:28,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:29,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:58:29,027 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:58:29,027 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:58:29,027 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:58:29,027 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:58:29,027 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:29,027 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:29,027 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:58:29,027 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:58:29,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:58:29,034 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:58:29,035 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:58:29,035 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:58:29,797 - src.training - INFO -   precision: 0.0
2025-06-24 12:58:29,798 - src.training - INFO -   recall: 0.0
2025-06-24 12:58:29,798 - src.training - INFO -   f1: 0.0
2025-06-24 12:58:29,798 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:58:29,798 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:58:29,798 - src.training - INFO -   positive_samples: 270
2025-06-24 12:58:29,798 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:58:29,798 - src.training - INFO -   total_samples: 220940
2025-06-24 12:58:29,798 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:58:29,798 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:58:29,798 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:58:29,798 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:58:29,798 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:58:29,798 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:58:29,798 - src.training - INFO - 모델 학습 완료
2025-06-24 12:58:29,798 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:58:29,798 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:29,798 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:29,798 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:29,798 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:29,817 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:58:29,817 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:58:30,262 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = catboost
2025-06-24 12:58:32,078 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:58:32,078 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:58:32,078 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:58:32,078 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:58:32,078 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:58:32,078 - src.training - INFO - 교차 검증 시작
2025-06-24 12:58:32,078 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:58:32,094 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:58:32,533 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:58:32,533 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:58:32,533 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:58:32,533 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:58:32,533 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:58:32,533 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:58:32,533 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:58:32,533 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:58:32,533 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:58:32,709 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:58:32,709 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:58:32,709 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:58:32,709 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:58:34,020 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:58:35,034 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:35,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:58:35,040 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:58:35,070 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:58:35,071 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:58:35,071 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:58:35,071 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:36,292 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:36,546 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:58:36,547 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:36,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:36,706 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:36,746 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:36,747 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:36,747 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:36,747 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:58:36,747 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:36,747 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:36,803 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:58:36,803 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:58:36,803 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:36,803 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:36,803 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:58:36,803 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:58:36,803 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:36,861 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:36,861 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:36,861 - src.training - INFO - 모델 학습 시작
2025-06-24 12:58:36,986 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:58:36,986 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:58:36,986 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:58:36,986 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:58:36,986 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:58:36,986 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:58:36,986 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:58:36,986 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:58:36,986 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:36,986 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:58:36,986 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:58:36,986 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:58:36,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:58:36,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:36,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:37,062 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:37,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:37,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:37,240 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:37,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:37,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:37,387 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:58:37,387 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:37,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:58:37,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:37,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:37,456 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:37,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:37,474 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:37,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:37,504 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:37,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:37,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:37,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:37,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:37,554 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:37,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:58:37,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:37,568 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:37,568 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:37,568 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:58:37,568 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:58:37,568 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:58:37,579 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   iterations: 250
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   learning_rate: 0.10038094193042334
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.405212748239358
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   random_strength: 0.30775165971331825
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   bagging_temperature: 0.10420246626894783
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   border_count: 113
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:37,582 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:58:38,824 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:58:38,824 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:58:38,824 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:58:38,824 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:58:38,824 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:58:38,824 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:58:38,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:38,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:38,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:38,843 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:38,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:38,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:38,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:38,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:38,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:38,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:38,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:38,935 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:58:38,960 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:58:38,961 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:58:38,961 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:58:38,961 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:58:38,961 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:38,961 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:38,961 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:58:38,961 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:58:38,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:58:38,968 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:58:38,968 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:58:38,968 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:58:39,727 - src.training - INFO -   precision: 0.0
2025-06-24 12:58:39,727 - src.training - INFO -   recall: 0.0
2025-06-24 12:58:39,727 - src.training - INFO -   f1: 0.0
2025-06-24 12:58:39,727 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:58:39,727 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:58:39,727 - src.training - INFO -   positive_samples: 270
2025-06-24 12:58:39,727 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:58:39,727 - src.training - INFO -   total_samples: 220940
2025-06-24 12:58:39,727 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:58:39,727 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:58:39,727 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:58:39,727 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:58:39,727 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:58:39,728 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:58:39,728 - src.training - INFO - 모델 학습 완료
2025-06-24 12:58:39,728 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:58:39,728 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:39,728 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:39,728 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:39,728 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:39,747 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:58:39,747 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:58:40,185 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = catboost
2025-06-24 12:58:41,978 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:58:41,978 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:58:41,978 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:58:41,978 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:58:41,978 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:58:41,978 - src.training - INFO - 교차 검증 시작
2025-06-24 12:58:41,978 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:58:41,995 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:58:42,436 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:58:42,436 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:58:42,436 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:58:42,436 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:58:42,436 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:58:42,436 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:58:42,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:58:42,436 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:58:42,436 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:58:42,618 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:58:42,618 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:58:42,618 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:58:42,618 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:58:43,932 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:58:44,949 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:44,949 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:58:44,954 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:58:44,986 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:58:44,986 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:58:44,986 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:58:44,986 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:46,219 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:46,470 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:58:46,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:46,629 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:46,629 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:46,670 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:46,670 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:46,670 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:46,670 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:58:46,670 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:46,670 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:46,727 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:58:46,727 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:58:46,727 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:46,727 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:46,727 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:58:46,727 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:58:46,727 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:46,785 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:46,785 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:46,786 - src.training - INFO - 모델 학습 시작
2025-06-24 12:58:46,911 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:58:46,911 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:58:46,911 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:58:46,911 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:58:46,911 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:58:46,911 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:58:46,911 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:58:46,911 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:58:46,911 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:46,911 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:58:46,911 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:58:46,911 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:58:46,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:58:46,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:46,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:46,987 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:47,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:47,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:47,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:47,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:47,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:47,319 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:58:47,319 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:47,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:58:47,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:47,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:47,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:47,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:47,408 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:47,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:47,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:47,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:47,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:47,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:47,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:47,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:47,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:58:47,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:47,503 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:47,503 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:47,503 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:58:47,503 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:58:47,503 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:58:47,515 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   iterations: 166
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   learning_rate: 0.025019499092876218
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.3350912125051635
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   random_strength: 1.408961730654469
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   bagging_temperature: 0.5988176039538597
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   border_count: 143
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:58:47,518 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:47,519 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:58:48,786 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:58:48,786 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:58:48,786 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:58:48,786 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:58:48,786 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:58:48,787 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:58:48,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:48,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:48,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:48,805 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:48,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:48,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:48,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:48,869 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:48,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:48,889 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:48,889 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:48,894 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:58:48,921 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:58:48,921 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:58:48,921 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:58:48,921 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:58:48,921 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:48,921 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:48,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:58:48,921 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:58:48,924 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:58:48,928 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:58:48,929 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:58:48,929 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:58:49,716 - src.training - INFO -   precision: 0.0
2025-06-24 12:58:49,717 - src.training - INFO -   recall: 0.0
2025-06-24 12:58:49,717 - src.training - INFO -   f1: 0.0
2025-06-24 12:58:49,717 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:58:49,717 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:58:49,717 - src.training - INFO -   positive_samples: 270
2025-06-24 12:58:49,717 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:58:49,717 - src.training - INFO -   total_samples: 220940
2025-06-24 12:58:49,717 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:58:49,717 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:58:49,717 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:58:49,717 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:58:49,717 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:58:49,717 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:58:49,717 - src.training - INFO - 모델 학습 완료
2025-06-24 12:58:49,717 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:58:49,717 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:49,717 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:49,717 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:49,717 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:49,737 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:58:49,737 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:58:50,182 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = catboost
2025-06-24 12:58:51,965 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:58:51,965 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:58:51,965 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:58:51,965 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:58:51,965 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:58:51,965 - src.training - INFO - 교차 검증 시작
2025-06-24 12:58:51,965 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:58:51,982 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:58:52,420 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:58:52,420 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:58:52,420 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:58:52,420 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:58:52,420 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:58:52,420 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:58:52,420 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:58:52,420 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:58:52,420 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:58:52,604 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:58:52,604 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:58:52,604 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:58:52,604 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:58:53,924 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:58:55,057 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:55,057 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:58:55,063 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:58:55,097 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:58:55,097 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:58:55,097 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:58:55,097 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:58:56,449 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:58:56,722 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:58:56,722 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:56,889 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:56,889 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:58:56,931 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:58:56,931 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:56,931 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:58:56,931 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:58:56,931 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:56,931 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:56,992 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:58:56,992 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:58:56,992 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:56,992 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:56,992 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:58:56,992 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:58:56,992 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:57,058 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:57,058 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:58:57,058 - src.training - INFO - 모델 학습 시작
2025-06-24 12:58:57,188 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:58:57,188 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:58:57,188 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:58:57,188 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:58:57,188 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:58:57,188 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:58:57,188 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:58:57,188 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:58:57,188 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:57,188 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:58:57,188 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:58:57,188 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:58:57,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:58:57,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:57,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:57,280 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:57,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:57,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:57,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:57,547 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:57,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:57,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:58:57,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:57,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:58:57,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:57,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:57,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:57,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:57,727 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:57,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:57,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:57,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:57,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:57,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:57,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:57,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:57,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:58:57,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:57,830 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:58:57,830 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:58:57,830 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:58:57,830 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:58:57,830 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:58:57,841 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   iterations: 281
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   learning_rate: 0.07144418280381627
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.442924162025971
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   random_strength: 0.12604856668298306
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   bagging_temperature: 0.6838871326612888
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   border_count: 252
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:58:57,844 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:58:57,845 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:57,845 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:58:57,845 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:58:57,845 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:58:59,129 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:58:59,129 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:58:59,129 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:58:59,130 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:58:59,130 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:58:59,130 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:58:59,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:58:59,130 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:59,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:58:59,150 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:58:59,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:58:59,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:58:59,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:58:59,215 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:58:59,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:58:59,236 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:58:59,236 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:58:59,239 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:58:59,268 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:58:59,268 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:58:59,268 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:58:59,268 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:58:59,268 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:59,268 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:58:59,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:58:59,268 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:58:59,271 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:58:59,276 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:58:59,276 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:58:59,276 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:59:00,134 - src.training - INFO -   precision: 0.0
2025-06-24 12:59:00,134 - src.training - INFO -   recall: 0.0
2025-06-24 12:59:00,134 - src.training - INFO -   f1: 0.0
2025-06-24 12:59:00,134 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:59:00,134 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:59:00,134 - src.training - INFO -   positive_samples: 270
2025-06-24 12:59:00,134 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:59:00,134 - src.training - INFO -   total_samples: 220940
2025-06-24 12:59:00,134 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:59:00,134 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:59:00,134 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:59:00,134 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:59:00,134 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:59:00,134 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:59:00,134 - src.training - INFO - 모델 학습 완료
2025-06-24 12:59:00,134 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:59:00,134 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:00,134 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:00,134 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:00,134 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:00,153 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:59:00,153 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:59:00,617 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = catboost
2025-06-24 12:59:02,581 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:59:02,581 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:59:02,581 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:59:02,581 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:59:02,581 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:59:02,581 - src.training - INFO - 교차 검증 시작
2025-06-24 12:59:02,581 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:59:02,598 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:59:03,069 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:59:03,070 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:59:03,070 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:59:03,070 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:59:03,070 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:59:03,070 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:59:03,070 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:59:03,070 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:59:03,070 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:59:03,238 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:03,239 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:03,239 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:03,239 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:03,239 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:03,239 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:59:03,239 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:59:03,239 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:59:03,239 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:59:03,239 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:59:04,664 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:59:05,776 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:05,776 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:59:05,783 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:59:05,816 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:59:05,816 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:59:05,816 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:59:05,816 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:07,158 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:07,430 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:59:07,430 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:07,597 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:07,598 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:07,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:07,640 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:07,640 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:07,640 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:59:07,640 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:07,640 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:07,701 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:59:07,701 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:59:07,701 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:07,701 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:07,701 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:59:07,701 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:59:07,701 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:07,767 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:07,767 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:07,767 - src.training - INFO - 모델 학습 시작
2025-06-24 12:59:07,898 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:59:07,898 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:59:07,898 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:59:07,898 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:59:07,898 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:59:07,898 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:59:07,898 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:59:07,898 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:59:07,898 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:07,898 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:59:07,898 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:59:07,898 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:59:07,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:59:07,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:07,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:07,991 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:08,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:08,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:08,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:08,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:08,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:08,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:59:08,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:08,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:59:08,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:08,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:08,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:08,429 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:08,447 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:08,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:08,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:08,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:08,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:08,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:08,534 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:08,534 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:08,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:59:08,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:08,549 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:08,549 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:08,549 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:59:08,549 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:59:08,549 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:59:08,560 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:59:08,562 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:59:08,562 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:59:08,562 - src.models.catboost_model - INFO -   iterations: 138
2025-06-24 12:59:08,562 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 12:59:08,562 - src.models.catboost_model - INFO -   learning_rate: 0.059038531271690696
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.485298572961071
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   random_strength: 0.12804260474222293
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   bagging_temperature: 0.3939236881471524
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   border_count: 89
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:08,563 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:59:09,845 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:59:09,845 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:59:09,845 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:59:09,845 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:59:09,845 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:59:09,846 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:59:09,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:09,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:09,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:09,863 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:09,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:09,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:09,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:09,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:09,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:09,947 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:09,947 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:09,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:59:09,976 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:59:09,976 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:59:09,976 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:59:09,976 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:59:09,976 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:09,976 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:09,976 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:59:09,976 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:59:09,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:59:09,983 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:59:09,984 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:59:09,984 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:59:10,760 - src.training - INFO -   precision: 0.0
2025-06-24 12:59:10,760 - src.training - INFO -   recall: 0.0
2025-06-24 12:59:10,760 - src.training - INFO -   f1: 0.0
2025-06-24 12:59:10,760 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:59:10,760 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:59:10,760 - src.training - INFO -   positive_samples: 270
2025-06-24 12:59:10,760 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:59:10,760 - src.training - INFO -   total_samples: 220940
2025-06-24 12:59:10,760 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:59:10,760 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:59:10,760 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:59:10,760 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:59:10,760 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:59:10,760 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:59:10,760 - src.training - INFO - 모델 학습 완료
2025-06-24 12:59:10,760 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:59:10,760 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:10,761 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:10,761 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:10,761 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:10,780 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:59:10,780 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:59:11,212 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = catboost
2025-06-24 12:59:13,000 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:59:13,000 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:59:13,000 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:59:13,000 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:59:13,000 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:59:13,000 - src.training - INFO - 교차 검증 시작
2025-06-24 12:59:13,000 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:59:13,017 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:59:13,453 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:59:13,453 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:59:13,453 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:59:13,453 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:59:13,453 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:59:13,453 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:59:13,453 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:59:13,453 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:59:13,453 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:59:13,638 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:13,639 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:13,639 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:13,639 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:13,639 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:13,639 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:59:13,639 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:59:13,639 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:59:13,639 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:59:13,639 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:59:14,933 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:59:15,951 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:15,951 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:59:15,957 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:59:15,988 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:59:15,988 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:59:15,989 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:59:15,989 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:17,215 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:17,464 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:59:17,464 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:17,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:17,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:17,663 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:17,663 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:17,663 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:17,663 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:59:17,663 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:17,663 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:17,719 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:59:17,719 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:59:17,719 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:17,719 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:17,719 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:59:17,719 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:59:17,719 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:17,777 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:17,777 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:17,777 - src.training - INFO - 모델 학습 시작
2025-06-24 12:59:17,904 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:59:17,904 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:59:17,904 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:59:17,904 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:59:17,904 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:59:17,904 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:59:17,904 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:59:17,904 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:59:17,904 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:17,904 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:59:17,904 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:59:17,904 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:59:17,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:59:17,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:17,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:17,982 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:18,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:18,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:18,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:18,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:18,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:18,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:59:18,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:18,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:59:18,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:18,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:18,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:18,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:18,399 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:18,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:18,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:18,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:18,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:18,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:18,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:18,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:18,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:59:18,496 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:18,496 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:18,496 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:18,496 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:59:18,496 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:59:18,496 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:59:18,508 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   iterations: 377
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   learning_rate: 0.16766915174256597
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.2273073522135607
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   random_strength: 1.1005171624941914
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   bagging_temperature: 0.984222056450188
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   border_count: 243
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:59:18,511 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:18,512 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:59:19,792 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:59:19,792 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:59:19,792 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:59:19,792 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:59:19,792 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:59:19,794 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:59:19,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:19,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:19,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:19,811 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:19,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:19,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:19,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:19,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:19,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:19,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:19,896 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:19,900 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:59:19,926 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:59:19,927 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:59:19,927 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:59:19,927 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:59:19,927 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:19,927 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:19,927 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:59:19,927 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:59:19,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:59:19,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:59:19,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:59:19,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:59:20,699 - src.training - INFO -   precision: 0.0
2025-06-24 12:59:20,699 - src.training - INFO -   recall: 0.0
2025-06-24 12:59:20,699 - src.training - INFO -   f1: 0.0
2025-06-24 12:59:20,699 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:59:20,699 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:59:20,699 - src.training - INFO -   positive_samples: 270
2025-06-24 12:59:20,699 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:59:20,699 - src.training - INFO -   total_samples: 220940
2025-06-24 12:59:20,699 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:59:20,699 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:59:20,699 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:59:20,699 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:59:20,699 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:59:20,699 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:59:20,699 - src.training - INFO - 모델 학습 완료
2025-06-24 12:59:20,699 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:59:20,699 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:20,699 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:20,699 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:20,699 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:20,719 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:59:20,719 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:59:21,145 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = catboost
2025-06-24 12:59:22,934 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:59:22,934 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:59:22,934 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:59:22,934 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:59:22,934 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:59:22,934 - src.training - INFO - 교차 검증 시작
2025-06-24 12:59:22,934 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:59:22,950 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:59:23,392 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:59:23,392 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:59:23,392 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:59:23,392 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:59:23,392 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:59:23,392 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:59:23,392 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:59:23,392 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:59:23,392 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:59:23,564 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:59:23,564 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:59:23,564 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:59:23,564 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:59:24,863 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:59:25,880 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:25,880 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:59:25,886 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:59:25,917 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:59:25,917 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:59:25,917 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:59:25,917 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:27,116 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:27,374 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:59:27,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:27,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:27,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:27,571 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:27,571 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:27,571 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:27,571 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:59:27,571 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:27,571 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:27,628 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:59:27,628 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:59:27,628 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:27,628 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:27,628 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:59:27,628 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:59:27,628 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:27,685 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:27,685 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:27,685 - src.training - INFO - 모델 학습 시작
2025-06-24 12:59:27,811 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:59:27,811 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:59:27,811 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:59:27,811 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:59:27,811 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:59:27,811 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:59:27,811 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:59:27,811 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:59:27,811 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:27,811 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:59:27,811 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:59:27,811 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:59:27,811 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:59:27,811 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:27,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:27,887 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:27,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:28,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:28,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:28,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:28,199 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:28,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:59:28,216 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:28,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:59:28,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:28,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:28,285 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:28,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:28,303 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:28,318 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:28,333 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:28,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:28,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:28,380 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:28,383 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:28,383 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:28,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:59:28,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:28,397 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:28,397 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:28,397 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:59:28,397 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:59:28,397 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:59:28,408 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   iterations: 479
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   learning_rate: 0.06309826798048644
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.2684401219344976
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   random_strength: 0.30637816203791557
2025-06-24 12:59:28,411 - src.models.catboost_model - INFO -   bagging_temperature: 0.9985904160036447
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   border_count: 254
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:28,412 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:59:29,761 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:59:29,761 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:59:29,761 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:59:29,761 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:59:29,761 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:59:29,762 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:59:29,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:29,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:29,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:29,780 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:29,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:29,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:29,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:29,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:29,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:29,859 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:29,859 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:29,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:59:29,889 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:59:29,889 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:59:29,889 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:59:29,889 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:59:29,889 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:29,889 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:29,889 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:59:29,889 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:59:29,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:59:29,896 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:59:29,897 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:59:29,897 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:59:30,701 - src.training - INFO -   precision: 0.0
2025-06-24 12:59:30,701 - src.training - INFO -   recall: 0.0
2025-06-24 12:59:30,701 - src.training - INFO -   f1: 0.0
2025-06-24 12:59:30,701 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:59:30,701 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:59:30,701 - src.training - INFO -   positive_samples: 270
2025-06-24 12:59:30,701 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:59:30,701 - src.training - INFO -   total_samples: 220940
2025-06-24 12:59:30,701 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:59:30,701 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:59:30,701 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:59:30,701 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:59:30,702 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:59:30,702 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:59:30,702 - src.training - INFO - 모델 학습 완료
2025-06-24 12:59:30,702 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:59:30,702 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:30,702 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:30,702 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:30,702 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:30,722 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:59:30,722 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:59:31,150 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = catboost
2025-06-24 12:59:32,934 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:59:32,934 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:59:32,934 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:59:32,934 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:59:32,934 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:59:32,934 - src.training - INFO - 교차 검증 시작
2025-06-24 12:59:32,934 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:59:32,951 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:59:33,391 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:59:33,391 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:59:33,391 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:59:33,391 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:59:33,391 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:59:33,391 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:59:33,391 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:59:33,391 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:59:33,391 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:59:33,571 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:59:33,571 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:59:33,571 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:59:33,571 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:59:34,877 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:59:35,899 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:35,899 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:59:35,905 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:59:35,936 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:59:35,936 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:59:35,936 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:59:35,936 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:37,153 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:37,403 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:59:37,403 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:37,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:37,559 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:37,599 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:37,599 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:37,599 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:37,599 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:59:37,599 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:37,599 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:37,656 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:59:37,656 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:59:37,656 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:37,656 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:37,656 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:59:37,656 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:59:37,656 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:37,714 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:37,714 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:37,714 - src.training - INFO - 모델 학습 시작
2025-06-24 12:59:37,839 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:59:37,839 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:59:37,839 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:59:37,839 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:59:37,839 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:59:37,839 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:59:37,839 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:59:37,839 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:59:37,840 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:37,840 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:59:37,840 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:59:37,840 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:59:37,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:59:37,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:37,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:37,919 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:37,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:38,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:38,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:38,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:38,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:38,252 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:59:38,252 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:38,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:59:38,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:38,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:38,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:38,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:38,339 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:38,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:38,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:38,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:38,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:38,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:38,419 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:38,419 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:38,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:59:38,433 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:38,433 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:38,433 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:38,433 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:59:38,433 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:59:38,433 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:59:38,444 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   iterations: 139
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   learning_rate: 0.28238153099759167
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.802249600354113
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:59:38,447 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   random_strength: 0.9240538757372133
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   bagging_temperature: 0.3202754805485963
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   border_count: 95
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:38,448 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:59:39,734 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:59:39,734 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:59:39,734 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:59:39,734 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:59:39,734 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:59:39,735 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:59:39,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:39,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:39,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:39,754 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:39,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:39,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:39,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:39,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:39,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:39,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:39,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:39,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:59:39,874 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:59:39,874 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:59:39,875 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:59:39,875 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:59:39,875 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:39,875 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:39,875 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:59:39,875 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:59:39,878 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:59:39,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:59:39,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:59:39,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:59:40,772 - src.training - INFO -   precision: 0.0
2025-06-24 12:59:40,773 - src.training - INFO -   recall: 0.0
2025-06-24 12:59:40,773 - src.training - INFO -   f1: 0.0
2025-06-24 12:59:40,773 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:59:40,773 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:59:40,773 - src.training - INFO -   positive_samples: 270
2025-06-24 12:59:40,773 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:59:40,773 - src.training - INFO -   total_samples: 220940
2025-06-24 12:59:40,773 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:59:40,773 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:59:40,773 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:59:40,773 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:59:40,773 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:59:40,773 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:59:40,773 - src.training - INFO - 모델 학습 완료
2025-06-24 12:59:40,773 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:59:40,773 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:40,773 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:40,773 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:40,773 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:40,793 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:59:40,793 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:59:41,255 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = catboost
2025-06-24 12:59:43,206 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:59:43,206 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:59:43,206 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:59:43,206 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:59:43,206 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:59:43,206 - src.training - INFO - 교차 검증 시작
2025-06-24 12:59:43,207 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:59:43,224 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:59:43,695 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:59:43,695 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:59:43,695 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:59:43,695 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:59:43,695 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:59:43,695 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:59:43,695 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:59:43,695 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:59:43,695 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:59:43,859 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:59:43,859 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:59:43,859 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:59:43,859 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:59:45,300 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:59:46,426 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:46,426 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:59:46,432 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:59:46,471 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:59:46,471 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:59:46,471 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:59:46,471 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:47,826 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:48,095 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:59:48,095 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:48,265 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:48,265 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:48,307 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:48,307 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:48,307 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:48,308 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:59:48,308 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:48,308 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:48,369 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:59:48,369 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:59:48,369 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:48,369 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:48,369 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:59:48,369 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:59:48,369 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:48,435 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:48,435 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:48,436 - src.training - INFO - 모델 학습 시작
2025-06-24 12:59:48,565 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:59:48,565 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:59:48,565 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:59:48,565 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:59:48,565 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:59:48,565 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:59:48,565 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:59:48,565 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:59:48,565 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:48,565 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:59:48,565 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:59:48,565 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:59:48,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:59:48,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:48,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:48,657 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:48,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:48,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:48,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:48,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:49,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:49,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:59:49,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:49,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:59:49,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:49,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:49,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:49,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:49,101 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:49,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:49,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:49,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:49,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:49,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:49,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:49,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:49,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:59:49,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:49,206 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:49,206 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:49,206 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:59:49,207 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:59:49,207 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:59:49,218 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:59:49,221 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   iterations: 75
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   learning_rate: 0.04633153238850579
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.695685367284841
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   random_strength: 4.585090504278902
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   bagging_temperature: 0.22192995251064201
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   border_count: 83
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:49,222 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 12:59:50,488 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 12:59:50,488 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 12:59:50,488 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 12:59:50,488 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 12:59:50,488 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:59:50,490 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 12:59:50,490 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:50,490 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:50,491 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:50,508 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:50,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:50,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:50,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:50,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:50,588 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:50,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:50,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:50,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:59:50,623 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 12:59:50,623 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:59:50,623 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:59:50,623 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:59:50,623 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:50,623 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:50,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:59:50,623 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 12:59:50,626 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:59:50,630 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:59:50,631 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 12:59:50,631 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:59:51,395 - src.training - INFO -   precision: 0.0
2025-06-24 12:59:51,395 - src.training - INFO -   recall: 0.0
2025-06-24 12:59:51,395 - src.training - INFO -   f1: 0.0
2025-06-24 12:59:51,395 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 12:59:51,395 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 12:59:51,395 - src.training - INFO -   positive_samples: 270
2025-06-24 12:59:51,395 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:59:51,395 - src.training - INFO -   total_samples: 220940
2025-06-24 12:59:51,395 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:59:51,395 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:59:51,395 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:59:51,395 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:59:51,396 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:59:51,396 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 12:59:51,396 - src.training - INFO - 모델 학습 완료
2025-06-24 12:59:51,396 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:59:51,396 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:51,396 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:51,396 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:51,396 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:51,416 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:59:51,416 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:59:51,860 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = catboost
2025-06-24 12:59:53,653 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:59:53,653 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:59:53,653 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:59:53,653 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:59:53,653 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:59:53,653 - src.training - INFO - 교차 검증 시작
2025-06-24 12:59:53,653 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:59:53,669 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:59:54,111 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:59:54,111 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:59:54,111 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:59:54,111 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:59:54,111 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:59:54,111 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:59:54,111 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:59:54,111 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:59:54,111 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:59:54,282 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:59:54,282 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:59:54,282 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:59:54,282 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:59:55,587 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:59:56,601 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:56,601 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:59:56,607 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:59:56,637 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:59:56,638 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:59:56,638 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:59:56,638 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:59:57,854 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:59:58,108 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:59:58,108 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:58,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:58,268 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:59:58,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:59:58,309 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:58,309 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:59:58,309 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:59:58,309 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:58,309 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:59:58,366 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:59:58,366 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:59:58,366 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:58,366 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:58,366 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:59:58,366 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:59:58,366 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:58,424 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:58,424 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:59:58,424 - src.training - INFO - 모델 학습 시작
2025-06-24 12:59:58,550 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:59:58,550 - src.training - INFO - 모델 타입: catboost
2025-06-24 12:59:58,550 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 12:59:58,550 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 12:59:58,550 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:59:58,550 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:59:58,551 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:59:58,551 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 12:59:58,551 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:58,551 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:59:58,551 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 12:59:58,551 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 12:59:58,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:59:58,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:58,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:58,629 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:58,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:58,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:58,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:58,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:58,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:58,960 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:59:58,961 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:59,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:59:59,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:59,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:59:59,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:59,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:59:59,051 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:59:59,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:59:59,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:59:59,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:59:59,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:59:59,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:59:59,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:59:59,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:59:59,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:59:59,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:59,146 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 12:59:59,146 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:59:59,146 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 12:59:59,147 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 12:59:59,147 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 12:59:59,157 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   iterations: 72
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   learning_rate: 0.03241255223125937
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.544474549919716
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   random_strength: 2.961124361750655
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   bagging_temperature: 0.4123371368846687
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   border_count: 206
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 12:59:59,161 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 12:59:59,162 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:00:00,484 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:00:00,484 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:00:00,484 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:00:00,484 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:00:00,484 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:00:00,486 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:00:00,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:00,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:00,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:00,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:00,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:00,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:00,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:00,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:00,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:00,586 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:00,586 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:00,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:00:00,617 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:00:00,617 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:00:00,617 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:00:00,617 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:00:00,617 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:00,617 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:00,617 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:00:00,617 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:00:00,620 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:00:00,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:00:00,625 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:00:00,625 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:00:01,401 - src.training - INFO -   precision: 0.0
2025-06-24 13:00:01,401 - src.training - INFO -   recall: 0.0
2025-06-24 13:00:01,401 - src.training - INFO -   f1: 0.0
2025-06-24 13:00:01,401 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:00:01,401 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:00:01,401 - src.training - INFO -   positive_samples: 270
2025-06-24 13:00:01,402 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:00:01,402 - src.training - INFO -   total_samples: 220940
2025-06-24 13:00:01,402 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:00:01,402 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:00:01,402 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:00:01,402 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:00:01,402 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:00:01,402 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:00:01,402 - src.training - INFO - 모델 학습 완료
2025-06-24 13:00:01,402 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:00:01,402 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:01,402 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:01,402 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:01,402 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:01,422 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:00:01,422 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:00:01,860 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = catboost
2025-06-24 13:00:03,648 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:00:03,648 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:00:03,648 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:00:03,649 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:00:03,649 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:00:03,649 - src.training - INFO - 교차 검증 시작
2025-06-24 13:00:03,649 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:00:03,665 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:00:04,107 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:00:04,107 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:00:04,107 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:00:04,107 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:00:04,107 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:00:04,107 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:00:04,107 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:00:04,107 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:00:04,107 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:00:04,288 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:00:04,288 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:00:04,288 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:00:04,288 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:00:05,575 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:00:06,588 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:06,588 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:00:06,594 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:00:06,625 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:00:06,625 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:00:06,625 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:00:06,625 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:07,838 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:08,093 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:00:08,093 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:08,250 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:08,251 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:08,291 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:08,291 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:08,291 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:08,291 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:00:08,291 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:08,291 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:08,337 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:00:08,337 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:00:08,337 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:08,337 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:08,337 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:00:08,337 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:00:08,337 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:08,396 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:08,396 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:08,396 - src.training - INFO - 모델 학습 시작
2025-06-24 13:00:08,523 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:00:08,523 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:00:08,523 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:00:08,523 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:00:08,523 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:00:08,523 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:00:08,523 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:00:08,523 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:00:08,523 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:08,523 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:00:08,523 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:00:08,523 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:00:08,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:00:08,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:08,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:08,601 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:08,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:08,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:08,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:08,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:08,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:08,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:00:08,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:09,008 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:00:09,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:09,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:09,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:09,009 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:09,026 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:09,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:09,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:09,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:09,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:09,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:09,106 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:09,106 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:09,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:00:09,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:09,123 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:09,123 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:09,123 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:00:09,123 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:00:09,123 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:00:09,135 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   iterations: 54
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   learning_rate: 0.0358730506906457
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.9355806172519054
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   random_strength: 0.49338821352888
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   bagging_temperature: 0.1823652309358857
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   border_count: 159
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:00:09,139 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:09,140 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:00:10,392 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:00:10,392 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:00:10,392 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:00:10,392 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:00:10,392 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:00:10,393 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:00:10,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:10,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:10,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:10,411 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:10,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:10,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:10,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:10,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:10,495 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:10,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:10,498 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:10,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:00:10,530 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:00:10,530 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:00:10,530 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:00:10,530 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:00:10,530 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:10,530 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:10,530 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:00:10,530 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:00:10,533 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:00:10,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:00:10,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:00:10,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:00:11,402 - src.training - INFO -   precision: 0.0
2025-06-24 13:00:11,403 - src.training - INFO -   recall: 0.0
2025-06-24 13:00:11,403 - src.training - INFO -   f1: 0.0
2025-06-24 13:00:11,403 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:00:11,403 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:00:11,403 - src.training - INFO -   positive_samples: 270
2025-06-24 13:00:11,403 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:00:11,403 - src.training - INFO -   total_samples: 220940
2025-06-24 13:00:11,403 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:00:11,403 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:00:11,403 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:00:11,403 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:00:11,403 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:00:11,403 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:00:11,403 - src.training - INFO - 모델 학습 완료
2025-06-24 13:00:11,403 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:00:11,403 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:11,403 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:11,403 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:11,403 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:11,424 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:00:11,424 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:00:11,880 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = catboost
2025-06-24 13:00:13,685 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:00:13,685 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:00:13,685 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:00:13,685 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:00:13,685 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:00:13,686 - src.training - INFO - 교차 검증 시작
2025-06-24 13:00:13,686 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:00:13,702 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:00:14,143 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:00:14,143 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:00:14,143 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:00:14,143 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:00:14,143 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:00:14,143 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:00:14,143 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:00:14,143 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:00:14,143 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:00:14,320 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:00:14,320 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:00:14,320 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:00:14,320 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:00:15,616 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:00:16,616 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:16,616 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:00:16,621 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:00:16,653 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:00:16,653 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:00:16,653 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:00:16,653 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:17,853 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:18,102 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:00:18,102 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:18,260 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:18,260 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:18,301 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:18,301 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:18,301 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:18,301 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:00:18,301 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:18,301 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:18,347 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:00:18,347 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:00:18,347 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:18,347 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:18,347 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:00:18,347 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:00:18,347 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:18,405 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:18,405 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:18,405 - src.training - INFO - 모델 학습 시작
2025-06-24 13:00:18,531 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:00:18,532 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:00:18,532 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:00:18,532 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:00:18,532 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:00:18,532 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:00:18,532 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:00:18,532 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:00:18,532 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:18,532 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:00:18,532 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:00:18,532 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:00:18,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:00:18,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:18,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:18,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:18,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:18,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:18,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:18,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:18,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:18,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:00:18,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:18,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:00:18,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:18,990 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:18,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:18,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:19,008 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:19,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:19,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:19,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:19,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:19,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:19,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:19,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:19,104 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:00:19,104 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:19,104 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:19,104 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:19,104 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:00:19,104 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:00:19,104 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:00:19,115 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   iterations: 54
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   learning_rate: 0.022556040332954542
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.273391521673652
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   random_strength: 0.5510196588504804
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   bagging_temperature: 0.42801803071804917
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   border_count: 254
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:19,119 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:00:20,455 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:00:20,455 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:00:20,455 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:00:20,455 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:00:20,455 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:00:20,457 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:00:20,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:20,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:20,458 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:20,475 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:20,490 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:20,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:20,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:20,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:20,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:20,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:20,555 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:20,560 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:00:20,586 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:00:20,587 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:00:20,587 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:00:20,587 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:00:20,587 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:20,587 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:20,587 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:00:20,587 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:00:20,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:00:20,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:00:20,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:00:20,594 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:00:21,359 - src.training - INFO -   precision: 0.0
2025-06-24 13:00:21,359 - src.training - INFO -   recall: 0.0
2025-06-24 13:00:21,359 - src.training - INFO -   f1: 0.0
2025-06-24 13:00:21,359 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:00:21,359 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:00:21,359 - src.training - INFO -   positive_samples: 270
2025-06-24 13:00:21,359 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:00:21,359 - src.training - INFO -   total_samples: 220940
2025-06-24 13:00:21,359 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:00:21,359 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:00:21,359 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:00:21,359 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:00:21,359 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:00:21,359 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:00:21,359 - src.training - INFO - 모델 학습 완료
2025-06-24 13:00:21,359 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:00:21,359 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:21,359 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:21,359 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:21,359 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:21,379 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:00:21,380 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:00:21,816 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = catboost
2025-06-24 13:00:23,648 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:00:23,648 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:00:23,648 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:00:23,648 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:00:23,648 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:00:23,648 - src.training - INFO - 교차 검증 시작
2025-06-24 13:00:23,648 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:00:23,665 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:00:24,109 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:00:24,109 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:00:24,109 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:00:24,109 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:00:24,109 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:00:24,109 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:00:24,109 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:00:24,109 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:00:24,109 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:00:24,285 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:00:24,285 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:00:24,285 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:00:24,285 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:00:25,556 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:00:26,556 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:26,556 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:00:26,562 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:00:26,593 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:00:26,593 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:00:26,593 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:00:26,593 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:27,801 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:28,056 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:00:28,056 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:28,212 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:28,212 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:28,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:28,253 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:28,253 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:28,253 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:00:28,253 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:28,253 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:28,309 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:00:28,309 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:00:28,309 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:28,309 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:28,309 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:00:28,309 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:00:28,309 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:28,367 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:28,367 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:28,367 - src.training - INFO - 모델 학습 시작
2025-06-24 13:00:28,492 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:00:28,492 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:00:28,492 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:00:28,492 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:00:28,492 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:00:28,492 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:00:28,492 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:00:28,492 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:00:28,492 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:28,492 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:00:28,492 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:00:28,492 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:00:28,492 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:00:28,492 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:28,493 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:28,570 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:28,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:28,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:28,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:28,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:28,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:28,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:00:28,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:28,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:00:28,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:28,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:28,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:28,974 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:28,991 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:29,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:29,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:29,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:29,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:29,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:29,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:29,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:29,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:00:29,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:29,085 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:29,085 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:29,085 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:00:29,085 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:00:29,085 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:00:29,096 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO -   iterations: 213
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO -   learning_rate: 0.010599051245978075
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.251202744701338
2025-06-24 13:00:29,098 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   random_strength: 0.4972644569320494
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   bagging_temperature: 0.3060284315730011
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   border_count: 129
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:29,099 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:00:30,339 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:00:30,339 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:00:30,339 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:00:30,339 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:00:30,339 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:00:30,340 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:00:30,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:30,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:30,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:30,359 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:30,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:30,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:30,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:30,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:30,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:30,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:30,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:30,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:00:30,481 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:00:30,481 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:00:30,481 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:00:30,481 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:00:30,481 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:30,481 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:30,481 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:00:30,481 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:00:30,484 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:00:30,489 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:00:30,489 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:00:30,489 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:00:31,350 - src.training - INFO -   precision: 0.0
2025-06-24 13:00:31,350 - src.training - INFO -   recall: 0.0
2025-06-24 13:00:31,350 - src.training - INFO -   f1: 0.0
2025-06-24 13:00:31,350 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:00:31,350 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:00:31,350 - src.training - INFO -   positive_samples: 270
2025-06-24 13:00:31,350 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:00:31,351 - src.training - INFO -   total_samples: 220940
2025-06-24 13:00:31,351 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:00:31,351 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:00:31,351 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:00:31,351 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:00:31,351 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:00:31,351 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:00:31,351 - src.training - INFO - 모델 학습 완료
2025-06-24 13:00:31,351 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:00:31,351 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:31,351 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:31,351 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:31,351 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:31,370 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:00:31,370 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:00:31,830 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = catboost
2025-06-24 13:00:33,793 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:00:33,793 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:00:33,793 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:00:33,793 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:00:33,793 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:00:33,793 - src.training - INFO - 교차 검증 시작
2025-06-24 13:00:33,793 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:00:33,811 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:00:34,286 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:00:34,286 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:00:34,286 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:00:34,286 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:00:34,286 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:00:34,286 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:00:34,286 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:00:34,286 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:00:34,286 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:00:34,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:34,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:34,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:34,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:34,452 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:34,452 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:00:34,452 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:00:34,452 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:00:34,452 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:00:34,453 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:00:35,887 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:00:37,011 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:37,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:00:37,018 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:00:37,052 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:00:37,052 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:00:37,052 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:00:37,052 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:38,402 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:38,671 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:00:38,671 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:38,839 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:38,839 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:38,881 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:38,881 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:38,881 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:38,881 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:00:38,881 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:38,881 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:38,943 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:00:38,943 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:00:38,943 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:38,943 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:38,943 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:00:38,943 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:00:38,943 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:39,008 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:39,008 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:39,008 - src.training - INFO - 모델 학습 시작
2025-06-24 13:00:39,138 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:00:39,138 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:00:39,138 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:00:39,138 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:00:39,138 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:00:39,138 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:00:39,138 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:00:39,138 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:00:39,138 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:39,138 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:00:39,138 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:00:39,138 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:00:39,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:00:39,138 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:39,139 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:39,230 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:39,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:39,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:39,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:39,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:39,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:39,594 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:00:39,594 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:39,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:00:39,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:39,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:39,658 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:39,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:39,677 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:39,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:39,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:39,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:39,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:39,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:39,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:39,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:39,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:00:39,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:39,782 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:39,782 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:39,782 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:00:39,782 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:00:39,782 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:00:39,794 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   iterations: 144
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   learning_rate: 0.0526102035167056
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.569331806306898
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   random_strength: 2.547738534659897
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   bagging_temperature: 0.3731784274367346
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   border_count: 112
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:00:39,798 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:39,799 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:00:41,037 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:00:41,037 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:00:41,037 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:00:41,037 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:00:41,037 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:00:41,039 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:00:41,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:41,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:41,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:41,058 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:41,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:41,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:41,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:41,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:41,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:41,145 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:41,145 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:41,148 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:00:41,178 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:00:41,178 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:00:41,178 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:00:41,178 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:00:41,178 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:41,178 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:41,178 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:00:41,178 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:00:41,181 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:00:41,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:00:41,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:00:41,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:00:42,066 - src.training - INFO -   precision: 0.0
2025-06-24 13:00:42,066 - src.training - INFO -   recall: 0.0
2025-06-24 13:00:42,066 - src.training - INFO -   f1: 0.0
2025-06-24 13:00:42,066 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:00:42,066 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:00:42,066 - src.training - INFO -   positive_samples: 270
2025-06-24 13:00:42,066 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:00:42,066 - src.training - INFO -   total_samples: 220940
2025-06-24 13:00:42,066 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:00:42,066 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:00:42,066 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:00:42,066 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:00:42,066 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:00:42,066 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:00:42,066 - src.training - INFO - 모델 학습 완료
2025-06-24 13:00:42,066 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:00:42,066 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:42,066 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:42,066 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:42,066 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:42,085 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:00:42,085 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:00:42,543 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = catboost
2025-06-24 13:00:44,506 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:00:44,506 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:00:44,506 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:00:44,506 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:00:44,506 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:00:44,506 - src.training - INFO - 교차 검증 시작
2025-06-24 13:00:44,506 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:00:44,523 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:00:44,998 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:00:44,998 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:00:44,998 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:00:44,998 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:00:44,998 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:00:44,998 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:00:44,998 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:00:44,998 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:00:44,998 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:00:45,164 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:00:45,164 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:00:45,164 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:00:45,164 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:00:46,605 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:00:47,723 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:47,724 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:00:47,730 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:00:47,764 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:00:47,764 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:00:47,764 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:00:47,764 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:49,097 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:49,367 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:00:49,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:49,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:49,535 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:00:49,577 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:00:49,577 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:49,577 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:00:49,577 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:00:49,577 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:49,577 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:49,627 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:00:49,627 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:00:49,627 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:49,627 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:49,627 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:00:49,627 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:00:49,627 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:49,694 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:49,694 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:00:49,694 - src.training - INFO - 모델 학습 시작
2025-06-24 13:00:49,825 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:00:49,825 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:00:49,825 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:00:49,825 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:00:49,825 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:00:49,825 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:00:49,825 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:00:49,825 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:00:49,825 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:49,825 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:00:49,825 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:00:49,825 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:00:49,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:00:49,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:49,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:49,916 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:49,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:50,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:50,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:50,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:50,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:50,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:00:50,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:50,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:00:50,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:50,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:50,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:50,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:50,363 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:50,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:50,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:50,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:50,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:50,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:50,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:50,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:50,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:00:50,468 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:50,469 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:00:50,469 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:50,469 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:00:50,469 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:00:50,469 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:00:50,480 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:00:50,482 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   iterations: 235
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   learning_rate: 0.06010732392877588
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.4150993602204744
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   random_strength: 0.10472149525956034
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   bagging_temperature: 0.15101389787588015
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   border_count: 41
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:00:50,483 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:00:51,752 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:00:51,752 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:00:51,752 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:00:51,752 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:00:51,752 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:00:51,754 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:00:51,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:00:51,754 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:51,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:00:51,773 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:00:51,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:00:51,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:00:51,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:00:51,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:00:51,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:00:51,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:00:51,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:51,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:00:51,894 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:00:51,895 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:00:51,895 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:00:51,895 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:00:51,895 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:51,895 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:00:51,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:00:51,895 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:00:51,898 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:00:51,902 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:00:51,902 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:00:51,903 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:00:52,798 - src.training - INFO -   precision: 0.0
2025-06-24 13:00:52,798 - src.training - INFO -   recall: 0.0
2025-06-24 13:00:52,798 - src.training - INFO -   f1: 0.0
2025-06-24 13:00:52,798 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:00:52,798 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:00:52,798 - src.training - INFO -   positive_samples: 270
2025-06-24 13:00:52,798 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:00:52,798 - src.training - INFO -   total_samples: 220940
2025-06-24 13:00:52,798 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:00:52,798 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:00:52,798 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:00:52,798 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:00:52,798 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:00:52,798 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:00:52,798 - src.training - INFO - 모델 학습 완료
2025-06-24 13:00:52,798 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:00:52,798 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:52,798 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:52,798 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:00:52,798 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:00:52,818 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:00:52,818 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:00:53,286 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = catboost
2025-06-24 13:00:55,246 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:00:55,246 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:00:55,246 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:00:55,246 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:00:55,246 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:00:55,246 - src.training - INFO - 교차 검증 시작
2025-06-24 13:00:55,246 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:00:55,263 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:00:55,739 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:00:55,739 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:00:55,739 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:00:55,739 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:00:55,739 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:00:55,739 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:00:55,739 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:00:55,739 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:00:55,739 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:00:55,906 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:00:55,906 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:00:55,906 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:00:55,906 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:00:57,352 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:00:58,474 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:00:58,475 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:00:58,481 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:00:58,514 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:00:58,514 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:00:58,514 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:00:58,514 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:00:59,853 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:00,125 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:01:00,125 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:00,293 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:00,293 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:00,335 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:00,335 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:00,335 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:00,335 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:01:00,335 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:00,336 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:00,397 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:01:00,397 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:01:00,397 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:00,397 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:00,397 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:01:00,397 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:01:00,397 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:00,464 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:00,464 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:00,464 - src.training - INFO - 모델 학습 시작
2025-06-24 13:01:00,595 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:01:00,595 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:01:00,595 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:01:00,595 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:01:00,595 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:01:00,595 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:01:00,595 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:01:00,595 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:01:00,595 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:00,595 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:01:00,595 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:01:00,595 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:01:00,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:01:00,595 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:00,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:00,687 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:00,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:00,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:00,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:00,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:01,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:01,050 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:01:01,050 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:01,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:01:01,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:01,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:01,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:01,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:01,133 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:01,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:01,167 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:01,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:01,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:01,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:01,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:01,222 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:01,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:01:01,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:01,237 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:01,237 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:01,237 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:01:01,237 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:01:01,237 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:01:01,251 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   iterations: 299
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   learning_rate: 0.03224587060453413
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.6747314398783884
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   random_strength: 0.6779344330060494
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   bagging_temperature: 0.4712746465257969
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   border_count: 219
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:01:01,254 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:01,255 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:01:02,498 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:01:02,498 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:01:02,498 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:01:02,498 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:01:02,498 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:01:02,499 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:01:02,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:02,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:02,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:02,519 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:02,534 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:02,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:02,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:02,583 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:02,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:02,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:02,604 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:02,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:01:02,636 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:01:02,636 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:01:02,636 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:01:02,636 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:01:02,636 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:02,636 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:02,637 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:01:02,637 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:01:02,640 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:01:02,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:01:02,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:01:02,645 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:01:03,543 - src.training - INFO -   precision: 0.0
2025-06-24 13:01:03,543 - src.training - INFO -   recall: 0.0
2025-06-24 13:01:03,543 - src.training - INFO -   f1: 0.0
2025-06-24 13:01:03,543 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:01:03,543 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:01:03,543 - src.training - INFO -   positive_samples: 270
2025-06-24 13:01:03,543 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:01:03,543 - src.training - INFO -   total_samples: 220940
2025-06-24 13:01:03,543 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:01:03,543 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:01:03,543 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:01:03,543 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:01:03,543 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:01:03,544 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:01:03,544 - src.training - INFO - 모델 학습 완료
2025-06-24 13:01:03,544 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:01:03,544 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:03,544 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:03,544 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:03,544 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:03,564 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:01:03,564 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:01:04,034 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = catboost
2025-06-24 13:01:06,000 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:01:06,000 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:01:06,000 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:01:06,000 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:01:06,000 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:01:06,000 - src.training - INFO - 교차 검증 시작
2025-06-24 13:01:06,000 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:01:06,017 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:01:06,491 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:01:06,491 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:01:06,491 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:01:06,491 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:01:06,491 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:01:06,491 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:01:06,491 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:01:06,491 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:01:06,491 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:01:06,659 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:01:06,659 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:01:06,659 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:01:06,659 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:01:08,133 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:01:09,266 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:09,266 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:01:09,272 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:01:09,305 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:01:09,305 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:01:09,305 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:01:09,305 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:10,652 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:10,920 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:01:10,921 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:11,089 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:11,089 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:11,133 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:11,133 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:11,133 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:11,133 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:01:11,133 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:11,133 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:11,194 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:01:11,194 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:01:11,194 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:11,194 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:11,194 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:01:11,194 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:01:11,194 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:11,259 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:11,259 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:11,259 - src.training - INFO - 모델 학습 시작
2025-06-24 13:01:11,388 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:01:11,388 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:01:11,388 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:01:11,388 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:01:11,388 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:01:11,388 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:01:11,388 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:01:11,388 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:01:11,388 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:11,388 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:01:11,389 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:01:11,389 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:01:11,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:01:11,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:11,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:11,481 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:11,547 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:11,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:11,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:11,751 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:11,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:11,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:01:11,847 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:11,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:01:11,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:11,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:11,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:11,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:11,931 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:11,947 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:11,964 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:11,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:11,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:12,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:12,019 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:12,019 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:12,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:01:12,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:12,036 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:12,036 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:12,036 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:01:12,036 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:01:12,036 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:01:12,049 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:01:12,052 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:01:12,052 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:01:12,052 - src.models.catboost_model - INFO -   iterations: 449
2025-06-24 13:01:12,052 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:01:12,052 - src.models.catboost_model - INFO -   learning_rate: 0.11969313662362757
2025-06-24 13:01:12,052 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.9667537816832084
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   random_strength: 0.12679932475157185
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   bagging_temperature: 0.9835731255440304
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   border_count: 231
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:12,053 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:01:13,315 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:01:13,316 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:01:13,316 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:01:13,316 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:01:13,316 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:01:13,318 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:01:13,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:13,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:13,318 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:13,338 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:13,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:13,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:13,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:13,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:13,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:13,429 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:13,429 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:13,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:01:13,461 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:01:13,462 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:01:13,462 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:01:13,462 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:01:13,462 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:13,462 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:13,462 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:01:13,462 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:01:13,465 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:01:13,469 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:01:13,470 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:01:13,470 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:01:14,324 - src.training - INFO -   precision: 0.0
2025-06-24 13:01:14,324 - src.training - INFO -   recall: 0.0
2025-06-24 13:01:14,324 - src.training - INFO -   f1: 0.0
2025-06-24 13:01:14,324 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:01:14,324 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:01:14,324 - src.training - INFO -   positive_samples: 270
2025-06-24 13:01:14,324 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:01:14,324 - src.training - INFO -   total_samples: 220940
2025-06-24 13:01:14,324 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:01:14,324 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:01:14,324 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:01:14,324 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:01:14,324 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:01:14,324 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:01:14,324 - src.training - INFO - 모델 학습 완료
2025-06-24 13:01:14,324 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:01:14,324 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:14,324 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:14,324 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:14,324 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:14,343 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:01:14,343 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:01:14,804 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = catboost
2025-06-24 13:01:16,761 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:01:16,761 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:01:16,761 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:01:16,761 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:01:16,761 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:01:16,761 - src.training - INFO - 교차 검증 시작
2025-06-24 13:01:16,761 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:01:16,778 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:01:17,252 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:01:17,252 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:01:17,252 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:01:17,252 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:01:17,252 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:01:17,252 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:01:17,252 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:01:17,252 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:01:17,252 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:01:17,419 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:01:17,419 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:01:17,419 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:01:17,419 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:01:18,893 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:01:20,022 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:20,023 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:01:20,029 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:01:20,062 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:01:20,062 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:01:20,062 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:01:20,062 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:21,416 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:21,694 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:01:21,694 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:21,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:21,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:21,902 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:21,902 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:21,902 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:21,902 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:01:21,902 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:21,902 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:21,963 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:01:21,963 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:01:21,963 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:21,963 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:21,963 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:01:21,963 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:01:21,963 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:22,031 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:22,031 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:22,031 - src.training - INFO - 모델 학습 시작
2025-06-24 13:01:22,162 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:01:22,162 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:01:22,162 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:01:22,162 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:01:22,162 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:01:22,163 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:01:22,163 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:01:22,163 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:01:22,163 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:22,163 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:01:22,163 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:01:22,163 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:01:22,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:01:22,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:22,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:22,254 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:22,320 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:22,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:22,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:22,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:22,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:22,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:01:22,618 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:22,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:01:22,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:22,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:22,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:22,685 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:22,703 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:22,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:22,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:22,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:22,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:22,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:22,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:22,791 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:22,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:01:22,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:22,808 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:22,808 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:22,808 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:01:22,808 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:01:22,808 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:01:22,819 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:01:22,822 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   iterations: 182
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   learning_rate: 0.03725657102269728
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.883561499093869
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   random_strength: 0.9250674808726193
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   bagging_temperature: 0.21506848374413762
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   border_count: 233
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:22,823 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:01:24,076 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:01:24,077 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:01:24,077 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:01:24,077 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:01:24,077 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:01:24,079 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:01:24,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:24,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:24,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:24,098 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:24,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:24,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:24,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:24,166 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:24,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:24,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:24,188 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:24,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:01:24,220 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:01:24,220 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:01:24,220 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:01:24,220 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:01:24,220 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:24,220 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:24,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:01:24,220 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:01:24,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:01:24,227 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:01:24,228 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:01:24,228 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:01:25,114 - src.training - INFO -   precision: 0.0
2025-06-24 13:01:25,115 - src.training - INFO -   recall: 0.0
2025-06-24 13:01:25,115 - src.training - INFO -   f1: 0.0
2025-06-24 13:01:25,115 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:01:25,115 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:01:25,115 - src.training - INFO -   positive_samples: 270
2025-06-24 13:01:25,115 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:01:25,115 - src.training - INFO -   total_samples: 220940
2025-06-24 13:01:25,115 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:01:25,115 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:01:25,115 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:01:25,115 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:01:25,115 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:01:25,115 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:01:25,115 - src.training - INFO - 모델 학습 완료
2025-06-24 13:01:25,115 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:01:25,115 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:25,115 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:25,115 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:25,115 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:25,134 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:01:25,134 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:01:25,588 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = catboost
2025-06-24 13:01:27,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:01:27,541 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:01:27,541 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:01:27,541 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:01:27,541 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:01:27,541 - src.training - INFO - 교차 검증 시작
2025-06-24 13:01:27,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:01:27,558 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:01:28,032 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:01:28,033 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:01:28,033 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:01:28,033 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:01:28,033 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:01:28,033 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:01:28,033 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:01:28,033 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:01:28,033 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:01:28,201 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:01:28,201 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:01:28,201 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:01:28,201 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:01:29,646 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:01:30,775 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:30,775 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:01:30,779 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:01:30,813 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:01:30,813 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:01:30,813 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:01:30,813 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:32,141 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:32,416 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:01:32,416 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:32,585 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:32,585 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:32,628 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:32,629 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:32,629 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:32,629 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:01:32,629 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:32,629 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:32,691 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:01:32,691 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:01:32,691 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:32,691 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:32,691 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:01:32,691 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:01:32,691 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:32,757 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:32,757 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:32,757 - src.training - INFO - 모델 학습 시작
2025-06-24 13:01:32,888 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:01:32,888 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:01:32,888 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:01:32,888 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:01:32,888 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:01:32,888 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:01:32,888 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:01:32,889 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:01:32,889 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:32,889 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:01:32,889 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:01:32,889 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:01:32,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:01:32,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:32,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:32,981 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:33,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:33,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:33,183 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:33,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:33,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:33,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:01:33,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:33,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:01:33,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:33,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:33,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:33,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:33,436 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:33,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:33,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:33,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:33,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:33,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:33,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:33,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:33,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:01:33,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:33,539 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:33,539 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:33,539 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:01:33,539 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:01:33,540 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:01:33,552 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   iterations: 77
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   learning_rate: 0.01698381347320523
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.053986269054397
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   random_strength: 1.34919946485374
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   bagging_temperature: 0.11071785865277461
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   border_count: 213
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:01:33,556 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:33,557 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:01:33,557 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:33,557 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:01:34,803 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:01:34,803 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:01:34,803 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:01:34,803 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:01:34,803 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:01:34,803 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:01:34,803 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:34,803 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:34,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:34,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:34,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:34,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:34,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:34,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:34,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:34,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:34,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:34,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:01:34,944 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:01:34,945 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:01:34,945 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:01:34,945 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:01:34,945 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:34,945 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:34,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:01:34,945 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:01:34,948 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:01:34,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:01:34,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:01:34,953 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:01:35,837 - src.training - INFO -   precision: 0.0
2025-06-24 13:01:35,837 - src.training - INFO -   recall: 0.0
2025-06-24 13:01:35,837 - src.training - INFO -   f1: 0.0
2025-06-24 13:01:35,837 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:01:35,837 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:01:35,837 - src.training - INFO -   positive_samples: 270
2025-06-24 13:01:35,837 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:01:35,837 - src.training - INFO -   total_samples: 220940
2025-06-24 13:01:35,837 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:01:35,837 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:01:35,837 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:01:35,837 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:01:35,837 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:01:35,837 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:01:35,837 - src.training - INFO - 모델 학습 완료
2025-06-24 13:01:35,837 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:01:35,837 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:35,837 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:35,837 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:35,837 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:35,856 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:01:35,856 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:01:36,314 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = catboost
2025-06-24 13:01:38,274 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:01:38,274 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:01:38,274 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:01:38,274 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:01:38,274 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:01:38,274 - src.training - INFO - 교차 검증 시작
2025-06-24 13:01:38,274 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:01:38,292 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:01:38,768 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:01:38,768 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:01:38,768 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:01:38,768 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:01:38,768 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:01:38,768 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:01:38,768 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:01:38,768 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:01:38,768 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:01:38,939 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:01:38,939 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:01:38,939 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:01:38,939 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:01:40,382 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:01:41,506 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:41,506 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:01:41,512 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:01:41,545 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:01:41,546 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:01:41,546 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:01:41,546 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:42,866 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:43,142 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:01:43,142 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:43,308 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:43,308 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:43,351 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:43,351 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:43,351 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:43,351 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:01:43,351 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:43,351 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:43,411 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:01:43,411 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:01:43,411 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:43,412 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:43,412 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:01:43,412 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:01:43,412 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:43,478 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:43,478 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:43,478 - src.training - INFO - 모델 학습 시작
2025-06-24 13:01:43,609 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:01:43,609 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:01:43,609 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:01:43,609 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:01:43,609 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:01:43,609 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:01:43,609 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:01:43,609 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:01:43,609 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:43,609 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:01:43,609 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:01:43,609 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:01:43,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:01:43,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:43,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:43,701 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:43,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:43,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:43,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:43,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:44,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:44,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:01:44,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:44,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:01:44,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:44,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:44,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:44,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:44,162 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:44,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:44,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:44,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:44,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:44,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:44,250 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:44,250 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:44,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:01:44,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:44,264 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:44,264 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:44,264 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:01:44,264 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:01:44,264 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:01:44,279 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:01:44,282 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:01:44,282 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:01:44,282 - src.models.catboost_model - INFO -   iterations: 379
2025-06-24 13:01:44,282 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:01:44,282 - src.models.catboost_model - INFO -   learning_rate: 0.08359229316749771
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.028202964770759
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   random_strength: 9.249388502105532
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   bagging_temperature: 0.8757999144885271
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   border_count: 67
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:44,283 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:01:45,513 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:01:45,513 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:01:45,513 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:01:45,513 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:01:45,513 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:01:45,514 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:01:45,514 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:45,514 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:45,514 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:45,533 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:45,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:45,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:45,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:45,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:45,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:45,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:45,620 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:45,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:01:45,651 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:01:45,651 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:01:45,651 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:01:45,651 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:01:45,651 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:45,651 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:45,651 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:01:45,651 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:01:45,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:01:45,659 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:01:45,659 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:01:45,659 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:01:46,542 - src.training - INFO -   precision: 0.0
2025-06-24 13:01:46,542 - src.training - INFO -   recall: 0.0
2025-06-24 13:01:46,542 - src.training - INFO -   f1: 0.0
2025-06-24 13:01:46,542 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:01:46,542 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:01:46,542 - src.training - INFO -   positive_samples: 270
2025-06-24 13:01:46,542 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:01:46,542 - src.training - INFO -   total_samples: 220940
2025-06-24 13:01:46,542 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:01:46,542 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:01:46,542 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:01:46,542 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:01:46,542 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:01:46,542 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:01:46,542 - src.training - INFO - 모델 학습 완료
2025-06-24 13:01:46,542 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:01:46,542 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:46,542 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:46,542 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:46,542 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:46,564 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:01:46,564 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:01:47,032 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = catboost
2025-06-24 13:01:48,980 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:01:48,980 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:01:48,980 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:01:48,980 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:01:48,980 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:01:48,980 - src.training - INFO - 교차 검증 시작
2025-06-24 13:01:48,980 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:01:48,997 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:01:49,474 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:01:49,474 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:01:49,474 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:01:49,474 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:01:49,474 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:01:49,474 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:01:49,474 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:01:49,474 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:01:49,474 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:01:49,644 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:49,644 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:49,644 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:01:49,644 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:01:49,644 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:49,645 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:01:49,645 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:01:49,645 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:01:49,645 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:01:49,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:01:51,117 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:01:52,253 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:52,253 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:01:52,259 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:01:52,293 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:01:52,293 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:01:52,293 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:01:52,293 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:01:53,635 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:01:53,906 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:01:53,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:54,075 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:54,075 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:01:54,118 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:01:54,118 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:54,118 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:01:54,118 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:01:54,118 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:54,118 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:54,180 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:01:54,180 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:01:54,180 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:54,180 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:54,181 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:01:54,181 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:01:54,181 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:54,249 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:54,249 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:01:54,249 - src.training - INFO - 모델 학습 시작
2025-06-24 13:01:54,381 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:01:54,381 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:01:54,381 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:01:54,381 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:01:54,381 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:01:54,381 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:01:54,381 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:01:54,381 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:01:54,381 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:54,381 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:01:54,381 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:01:54,381 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:01:54,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:01:54,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:54,381 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:54,474 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:54,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:54,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:54,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:54,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:54,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:54,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:01:54,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:54,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:01:54,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:54,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:54,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:54,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:54,937 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:54,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:54,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:54,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:55,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:55,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:55,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:55,025 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:55,039 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:01:55,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:55,040 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:01:55,040 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:55,040 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:01:55,040 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:01:55,040 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:01:55,054 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   iterations: 154
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   learning_rate: 0.07200672623499324
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4334726758444796
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   random_strength: 3.242815980726605
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   bagging_temperature: 0.7784758262865392
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   border_count: 117
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:01:55,058 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:01:56,334 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:01:56,334 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:01:56,334 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:01:56,334 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:01:56,334 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:01:56,335 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:01:56,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:01:56,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:56,335 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:01:56,355 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:01:56,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:01:56,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:01:56,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:01:56,428 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:01:56,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:01:56,457 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:01:56,457 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:56,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:01:56,489 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:01:56,489 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:01:56,489 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:01:56,489 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:01:56,489 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:56,489 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:01:56,489 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:01:56,489 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:01:56,493 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:01:56,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:01:56,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:01:56,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:01:57,338 - src.training - INFO -   precision: 0.0
2025-06-24 13:01:57,338 - src.training - INFO -   recall: 0.0
2025-06-24 13:01:57,338 - src.training - INFO -   f1: 0.0
2025-06-24 13:01:57,338 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:01:57,338 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:01:57,338 - src.training - INFO -   positive_samples: 270
2025-06-24 13:01:57,338 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:01:57,338 - src.training - INFO -   total_samples: 220940
2025-06-24 13:01:57,338 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:01:57,338 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:01:57,338 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:01:57,338 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:01:57,338 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:01:57,338 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:01:57,338 - src.training - INFO - 모델 학습 완료
2025-06-24 13:01:57,338 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:01:57,338 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:57,338 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:57,338 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:01:57,338 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:01:57,359 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:01:57,359 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:01:57,828 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = catboost
2025-06-24 13:01:59,682 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:01:59,682 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:01:59,682 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:01:59,682 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:01:59,682 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:01:59,682 - src.training - INFO - 교차 검증 시작
2025-06-24 13:01:59,682 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:01:59,698 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:02:00,137 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:02:00,137 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:02:00,137 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:02:00,137 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:02:00,137 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:02:00,137 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:02:00,137 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:02:00,137 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:02:00,137 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:02:00,324 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:02:00,324 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:02:00,324 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:02:00,324 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:02:01,634 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:02:02,646 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:02,646 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:02:02,653 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:02:02,684 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:02:02,684 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:02:02,684 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:02:02,684 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:03,890 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:04,139 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:02:04,139 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:04,299 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:04,299 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:04,340 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:04,340 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:04,340 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:04,340 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:02:04,340 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:04,340 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:04,396 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:02:04,397 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:02:04,397 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:04,397 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:04,397 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:02:04,397 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:02:04,397 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:04,456 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:04,456 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:04,456 - src.training - INFO - 모델 학습 시작
2025-06-24 13:02:04,584 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:02:04,585 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:02:04,585 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:02:04,585 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:02:04,585 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:02:04,585 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:02:04,585 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:02:04,585 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:02:04,585 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:04,585 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:02:04,585 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:02:04,585 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:02:04,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:02:04,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:04,585 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:04,663 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:04,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:04,784 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:04,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:04,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:04,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:05,000 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:02:05,000 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:05,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:02:05,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:05,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:05,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:05,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:05,096 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:05,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:05,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:05,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:05,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:05,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:05,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:05,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:05,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:02:05,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:05,191 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:05,191 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:05,191 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:02:05,191 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:02:05,191 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:02:05,205 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:02:05,208 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:02:05,208 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:02:05,208 - src.models.catboost_model - INFO -   iterations: 324
2025-06-24 13:02:05,208 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:02:05,208 - src.models.catboost_model - INFO -   learning_rate: 0.0496952077062092
2025-06-24 13:02:05,208 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.082200292533818
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   random_strength: 7.282839742313878
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   bagging_temperature: 0.9783463792128092
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   border_count: 53
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:05,209 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:02:06,516 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:02:06,516 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:02:06,516 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:02:06,516 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:02:06,516 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:02:06,516 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:02:06,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:06,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:06,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:06,535 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:06,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:06,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:06,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:06,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:06,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:06,624 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:06,624 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:06,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:02:06,654 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:02:06,655 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:02:06,655 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:02:06,655 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:02:06,655 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:06,655 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:06,655 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:02:06,655 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:02:06,658 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:02:06,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:02:06,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:02:06,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:02:07,557 - src.training - INFO -   precision: 0.0
2025-06-24 13:02:07,557 - src.training - INFO -   recall: 0.0
2025-06-24 13:02:07,557 - src.training - INFO -   f1: 0.0
2025-06-24 13:02:07,557 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:02:07,557 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:02:07,557 - src.training - INFO -   positive_samples: 270
2025-06-24 13:02:07,557 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:02:07,557 - src.training - INFO -   total_samples: 220940
2025-06-24 13:02:07,557 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:02:07,557 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:02:07,557 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:02:07,557 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:02:07,557 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:02:07,557 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:02:07,557 - src.training - INFO - 모델 학습 완료
2025-06-24 13:02:07,557 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:02:07,557 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:07,557 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:07,557 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:07,557 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:07,579 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:02:07,579 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:02:08,045 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = catboost
2025-06-24 13:02:10,021 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:02:10,021 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:02:10,021 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:02:10,021 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:02:10,021 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:02:10,021 - src.training - INFO - 교차 검증 시작
2025-06-24 13:02:10,021 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:02:10,038 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:02:10,511 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:02:10,511 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:02:10,511 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:02:10,511 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:02:10,511 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:02:10,511 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:02:10,512 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:02:10,512 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:02:10,512 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:02:10,683 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:02:10,683 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:02:10,683 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:02:10,683 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:02:12,110 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:02:13,226 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:13,226 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:02:13,232 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:02:13,264 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:02:13,265 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:02:13,265 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:02:13,265 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:14,599 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:14,870 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:02:14,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:15,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:15,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:15,081 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:15,081 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:15,081 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:15,081 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:02:15,081 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:15,081 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,143 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:02:15,143 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:02:15,143 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,143 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,143 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:02:15,143 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:02:15,143 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,209 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:15,209 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:15,210 - src.training - INFO - 모델 학습 시작
2025-06-24 13:02:15,341 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:02:15,341 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:02:15,341 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:02:15,341 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:02:15,341 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:02:15,341 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:02:15,341 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:02:15,341 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:02:15,341 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:15,341 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:02:15,341 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:02:15,341 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:02:15,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:02:15,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:15,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:15,434 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:15,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:15,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:15,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:15,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:15,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:15,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:02:15,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:15,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:02:15,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:15,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:15,871 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:15,889 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:15,906 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:15,922 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:15,939 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:15,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:15,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:15,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:15,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:15,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:02:15,991 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,991 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:15,991 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:15,991 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:02:15,991 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:02:15,991 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:02:16,005 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   iterations: 132
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   learning_rate: 0.05625664347287668
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.411037559482746
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   random_strength: 2.4791176234316716
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   bagging_temperature: 0.32572738384298205
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   border_count: 224
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:02:16,009 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:16,010 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:02:17,305 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:02:17,305 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:02:17,305 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:02:17,305 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:02:17,305 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:02:17,305 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:02:17,305 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:17,305 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:17,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:17,324 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:17,359 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:17,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:17,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:17,411 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:17,413 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:17,414 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:17,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:02:17,444 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:02:17,445 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:02:17,445 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:02:17,445 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:02:17,445 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:17,445 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:17,445 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:02:17,445 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:02:17,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:02:17,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:02:17,453 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:02:17,453 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:02:18,347 - src.training - INFO -   precision: 0.0
2025-06-24 13:02:18,347 - src.training - INFO -   recall: 0.0
2025-06-24 13:02:18,347 - src.training - INFO -   f1: 0.0
2025-06-24 13:02:18,347 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:02:18,347 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:02:18,347 - src.training - INFO -   positive_samples: 270
2025-06-24 13:02:18,347 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:02:18,347 - src.training - INFO -   total_samples: 220940
2025-06-24 13:02:18,347 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:02:18,347 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:02:18,347 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:02:18,347 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:02:18,347 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:02:18,347 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:02:18,347 - src.training - INFO - 모델 학습 완료
2025-06-24 13:02:18,347 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:02:18,347 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:18,347 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:18,347 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:18,347 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:18,369 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:02:18,369 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:02:18,829 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = catboost
2025-06-24 13:02:20,781 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:02:20,781 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:02:20,781 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:02:20,781 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:02:20,781 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:02:20,781 - src.training - INFO - 교차 검증 시작
2025-06-24 13:02:20,781 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:02:20,798 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:02:21,276 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:02:21,276 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:02:21,276 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:02:21,276 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:02:21,276 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:02:21,276 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:02:21,276 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:02:21,276 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:02:21,276 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:02:21,443 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:02:21,443 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:02:21,443 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:02:21,443 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:02:22,899 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:02:24,017 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:24,017 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:02:24,023 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:02:24,056 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:02:24,056 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:02:24,056 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:02:24,056 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:25,388 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:25,658 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:02:25,658 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:25,828 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:25,828 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:25,871 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:25,871 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:25,871 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:25,871 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:02:25,871 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:25,871 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:25,933 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:02:25,933 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:02:25,933 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:25,933 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:25,933 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:02:25,933 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:02:25,933 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:26,000 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:26,000 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:26,000 - src.training - INFO - 모델 학습 시작
2025-06-24 13:02:26,130 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:02:26,130 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:02:26,130 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:02:26,130 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:02:26,130 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:02:26,130 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:02:26,130 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:02:26,131 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:02:26,131 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:26,131 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:02:26,131 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:02:26,131 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:02:26,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:02:26,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:26,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:26,221 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:26,289 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:26,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:26,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:26,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:26,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:26,589 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:02:26,589 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:26,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:02:26,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:26,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:26,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:26,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:26,678 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:26,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:26,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:26,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:26,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:26,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:26,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:26,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:26,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:02:26,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:26,780 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:26,780 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:26,780 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:02:26,781 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:02:26,781 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:02:26,793 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   iterations: 290
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   learning_rate: 0.02909415047936122
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.0760287183244346
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   random_strength: 1.6269728228387765
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   bagging_temperature: 0.2894368612467271
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   border_count: 121
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:02:26,797 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:26,798 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:02:28,099 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:02:28,099 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:02:28,099 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:02:28,099 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:02:28,099 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:02:28,100 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:02:28,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:28,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:28,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:28,119 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:28,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:28,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:28,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:28,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:28,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:28,209 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:28,209 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:28,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:02:28,240 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:02:28,240 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:02:28,240 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:02:28,240 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:02:28,240 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:28,240 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:28,240 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:02:28,240 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:02:28,243 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:02:28,247 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:02:28,248 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:02:28,248 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:02:29,144 - src.training - INFO -   precision: 0.0
2025-06-24 13:02:29,144 - src.training - INFO -   recall: 0.0
2025-06-24 13:02:29,144 - src.training - INFO -   f1: 0.0
2025-06-24 13:02:29,144 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:02:29,144 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:02:29,144 - src.training - INFO -   positive_samples: 270
2025-06-24 13:02:29,144 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:02:29,144 - src.training - INFO -   total_samples: 220940
2025-06-24 13:02:29,144 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:02:29,144 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:02:29,144 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:02:29,144 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:02:29,145 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:02:29,145 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:02:29,145 - src.training - INFO - 모델 학습 완료
2025-06-24 13:02:29,145 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:02:29,145 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:29,145 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:29,145 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:29,145 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:29,164 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:02:29,164 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:02:29,632 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = catboost
2025-06-24 13:02:31,510 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:02:31,510 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:02:31,510 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:02:31,510 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:02:31,511 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:02:31,511 - src.training - INFO - 교차 검증 시작
2025-06-24 13:02:31,511 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:02:31,527 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:02:31,969 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:02:31,969 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:02:31,969 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:02:31,969 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:02:31,969 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:02:31,969 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:02:31,969 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:02:31,969 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:02:31,969 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:02:32,154 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:32,154 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:32,155 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:32,155 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:32,155 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:32,155 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:02:32,155 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:02:32,155 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:02:32,155 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:02:32,155 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:02:33,460 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:02:34,482 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:34,482 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:02:34,487 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:02:34,519 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:02:34,519 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:02:34,519 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:02:34,519 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:35,724 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:35,973 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:02:35,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:36,130 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:36,130 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:36,170 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:36,170 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:36,170 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:36,170 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:02:36,170 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:36,170 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:36,226 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:02:36,227 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:02:36,227 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:36,227 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:36,227 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:02:36,227 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:02:36,227 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:36,287 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:36,287 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:36,287 - src.training - INFO - 모델 학습 시작
2025-06-24 13:02:36,416 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:02:36,416 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:02:36,416 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:02:36,416 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:02:36,416 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:02:36,416 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:02:36,416 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:02:36,416 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:02:36,416 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:36,416 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:02:36,416 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:02:36,416 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:02:36,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:02:36,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:36,417 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:36,494 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:36,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:36,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:36,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:36,734 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:36,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:36,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:02:36,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:02:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:36,902 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:36,919 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:36,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:36,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:36,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:36,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:36,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:36,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:36,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:37,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:02:37,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:37,011 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:37,011 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:37,011 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:02:37,011 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:02:37,011 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:02:37,025 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   iterations: 373
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   learning_rate: 0.2089597518741113
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.2867536883651802
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   random_strength: 0.263185246620795
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   bagging_temperature: 0.815912616853349
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   border_count: 253
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:02:37,028 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:37,029 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:02:38,311 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:02:38,311 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:02:38,311 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:02:38,311 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:02:38,311 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:02:38,312 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:02:38,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:38,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:38,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:38,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:38,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:38,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:38,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:38,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:38,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:38,421 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:38,421 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:38,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:02:38,452 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:02:38,452 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:02:38,452 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:02:38,452 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:02:38,452 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:38,452 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:38,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:02:38,452 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:02:38,456 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:02:38,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:02:38,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:02:38,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:02:39,345 - src.training - INFO -   precision: 0.0
2025-06-24 13:02:39,345 - src.training - INFO -   recall: 0.0
2025-06-24 13:02:39,345 - src.training - INFO -   f1: 0.0
2025-06-24 13:02:39,345 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:02:39,345 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:02:39,345 - src.training - INFO -   positive_samples: 270
2025-06-24 13:02:39,345 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:02:39,345 - src.training - INFO -   total_samples: 220940
2025-06-24 13:02:39,345 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:02:39,345 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:02:39,345 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:02:39,345 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:02:39,345 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:02:39,345 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:02:39,345 - src.training - INFO - 모델 학습 완료
2025-06-24 13:02:39,345 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:02:39,345 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:39,345 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:39,345 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:39,345 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:39,367 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:02:39,367 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:02:39,829 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = catboost
2025-06-24 13:02:41,789 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:02:41,790 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:02:41,790 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:02:41,790 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:02:41,790 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:02:41,790 - src.training - INFO - 교차 검증 시작
2025-06-24 13:02:41,790 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:02:41,807 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:02:42,264 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:02:42,264 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:02:42,264 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:02:42,264 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:02:42,265 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:02:42,265 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:02:42,265 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:02:42,265 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:02:42,265 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:02:42,450 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:02:42,450 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:02:42,450 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:02:42,450 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:02:43,768 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:02:44,785 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:44,785 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:02:44,791 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:02:44,822 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:02:44,822 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:02:44,822 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:02:44,822 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:46,031 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:46,287 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:02:46,287 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:46,446 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:46,446 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:46,487 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:46,487 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:46,487 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:46,487 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:02:46,487 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:46,487 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:46,543 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:02:46,543 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:02:46,543 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:46,543 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:46,543 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:02:46,543 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:02:46,543 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:46,603 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:46,603 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:46,603 - src.training - INFO - 모델 학습 시작
2025-06-24 13:02:46,729 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:02:46,729 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:02:46,729 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:02:46,729 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:02:46,729 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:02:46,729 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:02:46,729 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:02:46,729 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:02:46,729 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:46,729 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:02:46,729 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:02:46,729 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:02:46,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:02:46,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:46,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:46,806 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:46,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:46,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:46,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:47,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:47,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:47,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:02:47,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:47,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:02:47,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:47,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:47,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:47,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:47,227 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:47,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:47,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:47,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:47,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:47,303 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:47,306 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:47,306 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:47,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:02:47,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:47,320 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:47,320 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:47,320 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:02:47,320 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:02:47,320 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:02:47,333 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   iterations: 303
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   learning_rate: 0.15089833434789748
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.479947075830844
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   random_strength: 7.749922408477804
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   bagging_temperature: 0.9360882100554004
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   border_count: 92
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:02:47,337 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:47,338 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:02:48,607 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:02:48,607 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:02:48,607 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:02:48,607 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:02:48,607 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:02:48,608 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:02:48,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:48,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:48,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:48,626 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:48,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:48,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:48,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:48,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:48,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:48,706 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:48,706 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:48,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:02:48,736 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:02:48,736 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:02:48,736 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:02:48,736 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:02:48,736 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:48,736 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:48,736 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:02:48,736 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:02:48,740 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:02:48,744 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:02:48,744 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:02:48,744 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:02:49,493 - src.training - INFO -   precision: 0.0
2025-06-24 13:02:49,493 - src.training - INFO -   recall: 0.0
2025-06-24 13:02:49,493 - src.training - INFO -   f1: 0.0
2025-06-24 13:02:49,493 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:02:49,493 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:02:49,493 - src.training - INFO -   positive_samples: 270
2025-06-24 13:02:49,493 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:02:49,493 - src.training - INFO -   total_samples: 220940
2025-06-24 13:02:49,493 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:02:49,493 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:02:49,493 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:02:49,493 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:02:49,493 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:02:49,493 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:02:49,493 - src.training - INFO - 모델 학습 완료
2025-06-24 13:02:49,493 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:02:49,493 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:49,493 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:49,493 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:49,493 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:49,515 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:02:49,515 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:02:49,949 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = catboost
2025-06-24 13:02:51,792 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:02:51,792 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:02:51,792 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:02:51,792 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:02:51,792 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:02:51,792 - src.training - INFO - 교차 검증 시작
2025-06-24 13:02:51,792 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:02:51,809 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:02:52,254 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:02:52,254 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:02:52,254 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:02:52,254 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:02:52,254 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:02:52,254 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:02:52,254 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:02:52,254 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:02:52,254 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:02:52,439 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:02:52,439 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:02:52,439 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:02:52,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:02:53,737 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:02:54,751 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:54,751 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:02:54,757 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:02:54,788 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:02:54,788 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:02:54,788 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:02:54,788 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:02:55,984 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:02:56,232 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:02:56,232 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:56,392 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:56,392 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:02:56,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:02:56,433 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:56,433 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:02:56,433 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:02:56,433 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:56,433 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:56,489 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:02:56,489 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:02:56,489 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:56,489 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:56,489 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:02:56,489 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:02:56,489 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:56,549 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:56,549 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:02:56,549 - src.training - INFO - 모델 학습 시작
2025-06-24 13:02:56,675 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:02:56,676 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:02:56,676 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:02:56,676 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:02:56,676 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:02:56,676 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:02:56,676 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:02:56,676 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:02:56,676 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:56,676 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:02:56,676 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:02:56,676 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:02:56,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:02:56,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:56,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:56,754 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:56,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:56,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:56,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:56,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:57,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:57,084 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:02:57,084 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:57,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:02:57,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:57,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:57,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:57,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:57,179 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:57,194 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:57,209 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:57,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:57,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:57,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:57,259 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:57,259 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:57,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:02:57,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:57,274 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:02:57,274 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:57,274 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:02:57,274 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:02:57,274 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:02:57,287 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   iterations: 166
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   learning_rate: 0.02451431264367709
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.62463032543343
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:02:57,290 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   random_strength: 0.12095334395298236
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   bagging_temperature: 0.7575553905789882
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   border_count: 42
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:02:57,291 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:02:58,591 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:02:58,591 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:02:58,591 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:02:58,591 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:02:58,591 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:02:58,592 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:02:58,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:02:58,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:58,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:02:58,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:02:58,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:02:58,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:02:58,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:02:58,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:02:58,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:02:58,697 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:02:58,697 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:58,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:02:58,729 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:02:58,729 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:02:58,729 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:02:58,729 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:02:58,729 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:58,729 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:02:58,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:02:58,729 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:02:58,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:02:58,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:02:58,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:02:58,738 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:02:59,581 - src.training - INFO -   precision: 0.0
2025-06-24 13:02:59,581 - src.training - INFO -   recall: 0.0
2025-06-24 13:02:59,581 - src.training - INFO -   f1: 0.0
2025-06-24 13:02:59,581 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:02:59,581 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:02:59,581 - src.training - INFO -   positive_samples: 270
2025-06-24 13:02:59,582 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:02:59,582 - src.training - INFO -   total_samples: 220940
2025-06-24 13:02:59,582 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:02:59,582 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:02:59,582 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:02:59,582 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:02:59,582 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:02:59,582 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:02:59,582 - src.training - INFO - 모델 학습 완료
2025-06-24 13:02:59,582 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:02:59,582 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:59,582 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:59,582 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:02:59,582 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:02:59,601 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:02:59,602 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:03:00,063 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = catboost
2025-06-24 13:03:02,016 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:03:02,016 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:03:02,016 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:03:02,016 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:03:02,016 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:03:02,016 - src.training - INFO - 교차 검증 시작
2025-06-24 13:03:02,016 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:03:02,033 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:03:02,520 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:03:02,520 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:03:02,520 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:03:02,520 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:03:02,520 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:03:02,520 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:03:02,520 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:03:02,520 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:03:02,520 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:03:02,693 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:02,694 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:02,694 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:02,694 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:02,694 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:02,694 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:03:02,694 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:03:02,694 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:03:02,694 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:03:02,694 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:03:04,154 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:03:05,272 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:05,272 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:03:05,278 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:03:05,311 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:03:05,311 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:03:05,311 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:03:05,311 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:06,649 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:06,926 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:03:06,926 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:07,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:07,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:07,136 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:07,137 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:07,137 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:07,137 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:03:07,137 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:07,137 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:07,198 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:03:07,198 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:03:07,198 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:07,198 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:07,198 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:03:07,198 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:03:07,198 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:07,265 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:07,265 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:07,265 - src.training - INFO - 모델 학습 시작
2025-06-24 13:03:07,396 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:03:07,396 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:03:07,396 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:03:07,396 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:03:07,396 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:03:07,396 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:03:07,396 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:03:07,396 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:03:07,396 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:07,396 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:03:07,396 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:03:07,396 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:03:07,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:03:07,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:07,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:07,488 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:07,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:07,624 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:07,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:07,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:07,837 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:07,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:03:07,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:07,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:03:07,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:07,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:07,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:07,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:07,936 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:07,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:07,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:07,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:08,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:08,018 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:08,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:08,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:08,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:03:08,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:08,036 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:08,036 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:08,036 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:03:08,036 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:03:08,036 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:03:08,049 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   iterations: 140
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   learning_rate: 0.012280043694898152
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.7906802864591724
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   random_strength: 3.4668050658965415
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   bagging_temperature: 0.8011295490550813
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   border_count: 163
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:03:08,052 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:08,053 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:03:09,294 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:03:09,294 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:03:09,294 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:03:09,294 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:03:09,294 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:03:09,295 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:03:09,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:09,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:09,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:09,314 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:09,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:09,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:09,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:09,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:09,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:09,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:09,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:09,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:03:09,434 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:03:09,434 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:03:09,434 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:03:09,434 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:03:09,434 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:09,434 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:09,434 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:03:09,434 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:03:09,438 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:03:09,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:03:09,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:03:09,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:03:10,328 - src.training - INFO -   precision: 0.0
2025-06-24 13:03:10,328 - src.training - INFO -   recall: 0.0
2025-06-24 13:03:10,328 - src.training - INFO -   f1: 0.0
2025-06-24 13:03:10,328 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:03:10,328 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:03:10,328 - src.training - INFO -   positive_samples: 270
2025-06-24 13:03:10,328 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:03:10,328 - src.training - INFO -   total_samples: 220940
2025-06-24 13:03:10,328 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:03:10,328 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:03:10,328 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:03:10,328 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:03:10,328 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:03:10,328 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:03:10,328 - src.training - INFO - 모델 학습 완료
2025-06-24 13:03:10,328 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:03:10,328 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:10,328 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:10,328 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:10,328 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:10,349 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:03:10,349 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:03:10,811 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = catboost
2025-06-24 13:03:12,778 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:03:12,778 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:03:12,778 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:03:12,778 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:03:12,778 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:03:12,778 - src.training - INFO - 교차 검증 시작
2025-06-24 13:03:12,779 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:03:12,796 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:03:13,273 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:03:13,273 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:03:13,273 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:03:13,273 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:03:13,273 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:03:13,273 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:03:13,273 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:03:13,273 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:03:13,273 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:03:13,444 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:13,445 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:13,445 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:13,445 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:13,445 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:13,445 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:03:13,445 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:03:13,445 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:03:13,445 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:03:13,445 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:03:14,884 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:03:16,001 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:16,002 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:03:16,006 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:03:16,038 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:03:16,038 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:03:16,038 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:03:16,038 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:17,342 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:17,615 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:03:17,615 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:17,783 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:17,783 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:17,825 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:17,826 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:17,826 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:17,826 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:03:17,826 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:17,826 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:17,887 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:03:17,887 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:03:17,887 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:17,887 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:17,887 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:03:17,887 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:03:17,887 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:17,956 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:17,956 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:17,956 - src.training - INFO - 모델 학습 시작
2025-06-24 13:03:18,088 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:03:18,088 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:03:18,088 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:03:18,088 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:03:18,088 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:03:18,088 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:03:18,088 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:03:18,088 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:03:18,088 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:18,088 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:03:18,088 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:03:18,088 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:03:18,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:03:18,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:18,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:18,180 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:18,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:18,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:18,381 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:18,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:18,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:18,545 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:03:18,545 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:18,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:03:18,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:18,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:18,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:18,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:18,636 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:18,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:18,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:18,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:18,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:18,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:18,724 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:18,724 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:18,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:03:18,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:18,740 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:18,740 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:18,740 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:03:18,740 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:03:18,740 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:03:18,753 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   iterations: 256
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   learning_rate: 0.14862022100234434
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.6283350936297405
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:03:18,756 - src.models.catboost_model - INFO -   random_strength: 6.460064003861595
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   bagging_temperature: 0.9963790650113442
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   border_count: 51
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:18,757 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:03:20,022 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:03:20,023 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:03:20,023 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:03:20,023 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:03:20,023 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:03:20,023 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:03:20,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:20,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:20,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:20,043 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:20,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:20,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:20,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:20,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:20,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:20,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:20,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:20,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:03:20,162 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:03:20,162 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:03:20,162 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:03:20,162 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:03:20,163 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:20,163 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:20,163 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:03:20,163 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:03:20,166 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:03:20,170 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:03:20,170 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:03:20,170 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:03:21,052 - src.training - INFO -   precision: 0.0
2025-06-24 13:03:21,052 - src.training - INFO -   recall: 0.0
2025-06-24 13:03:21,052 - src.training - INFO -   f1: 0.0
2025-06-24 13:03:21,052 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:03:21,052 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:03:21,052 - src.training - INFO -   positive_samples: 270
2025-06-24 13:03:21,052 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:03:21,052 - src.training - INFO -   total_samples: 220940
2025-06-24 13:03:21,052 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:03:21,052 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:03:21,052 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:03:21,052 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:03:21,052 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:03:21,052 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:03:21,052 - src.training - INFO - 모델 학습 완료
2025-06-24 13:03:21,052 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:03:21,052 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:21,052 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:21,052 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:21,052 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:21,073 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:03:21,073 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:03:21,542 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = catboost
2025-06-24 13:03:23,491 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:03:23,492 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:03:23,492 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:03:23,492 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:03:23,492 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:03:23,492 - src.training - INFO - 교차 검증 시작
2025-06-24 13:03:23,492 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:03:23,509 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:03:23,983 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:03:23,983 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:03:23,983 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:03:23,983 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:03:23,983 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:03:23,983 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:03:23,983 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:03:23,983 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:03:23,983 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:03:24,155 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:03:24,155 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:03:24,155 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:03:24,155 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:03:25,601 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:03:26,723 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:26,723 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:03:26,729 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:03:26,761 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:03:26,761 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:03:26,761 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:03:26,761 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:28,088 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:28,362 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:03:28,362 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:28,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:28,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:28,574 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:28,575 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:28,575 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:28,575 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:03:28,575 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:28,575 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:28,637 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:03:28,637 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:03:28,637 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:28,637 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:28,637 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:03:28,637 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:03:28,637 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:28,704 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:28,704 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:28,704 - src.training - INFO - 모델 학습 시작
2025-06-24 13:03:28,835 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:03:28,836 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:03:28,836 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:03:28,836 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:03:28,836 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:03:28,836 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:03:28,836 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:03:28,836 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:03:28,836 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:28,836 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:03:28,836 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:03:28,836 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:03:28,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:03:28,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:28,836 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:28,927 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:28,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:29,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:29,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:29,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:29,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:29,294 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:03:29,294 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:29,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:03:29,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:29,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:29,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:29,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:29,382 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:29,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:29,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:29,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:29,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:29,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:29,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:29,470 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:29,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:03:29,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:29,485 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:29,485 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:29,485 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:03:29,485 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:03:29,485 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:03:29,498 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   iterations: 452
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   learning_rate: 0.013490719104337788
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.427878320589112
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   random_strength: 1.2720012329968786
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   bagging_temperature: 0.31593537824267487
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   border_count: 117
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:03:29,502 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:03:29,503 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:03:29,503 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:03:29,503 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:29,503 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:03:29,503 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:29,503 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:03:30,772 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:03:30,772 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:03:30,772 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:03:30,772 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:03:30,772 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:03:30,773 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:03:30,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:30,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:30,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:30,791 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:30,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:30,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:30,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:30,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:30,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:30,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:30,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:30,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:03:30,906 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:03:30,906 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:03:30,906 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:03:30,906 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:03:30,906 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:30,906 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:30,906 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:03:30,906 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:03:30,909 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:03:30,913 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:03:30,914 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:03:30,914 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:03:31,701 - src.training - INFO -   precision: 0.0
2025-06-24 13:03:31,701 - src.training - INFO -   recall: 0.0
2025-06-24 13:03:31,701 - src.training - INFO -   f1: 0.0
2025-06-24 13:03:31,701 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:03:31,701 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:03:31,701 - src.training - INFO -   positive_samples: 270
2025-06-24 13:03:31,701 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:03:31,701 - src.training - INFO -   total_samples: 220940
2025-06-24 13:03:31,701 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:03:31,701 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:03:31,701 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:03:31,701 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:03:31,701 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:03:31,702 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:03:31,702 - src.training - INFO - 모델 학습 완료
2025-06-24 13:03:31,702 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:03:31,702 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:31,702 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:31,702 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:31,702 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:31,721 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:03:31,722 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:03:32,158 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = catboost
2025-06-24 13:03:33,972 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:03:33,972 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:03:33,972 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:03:33,972 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:03:33,972 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:03:33,972 - src.training - INFO - 교차 검증 시작
2025-06-24 13:03:33,972 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:03:33,990 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:03:34,436 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:03:34,436 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:03:34,436 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:03:34,436 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:03:34,436 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:03:34,436 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:03:34,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:03:34,436 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:03:34,436 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:03:34,623 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:03:34,623 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:03:34,623 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:03:34,623 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:03:35,896 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:03:36,889 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:36,889 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:03:36,895 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:03:36,926 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:03:36,927 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:03:36,927 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:03:36,927 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:38,124 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:38,378 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:03:38,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:38,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:38,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:38,583 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:38,583 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:38,583 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:38,583 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:03:38,583 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:38,583 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:38,640 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:03:38,640 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:03:38,640 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:38,640 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:38,640 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:03:38,640 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:03:38,640 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:38,697 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:38,697 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:38,697 - src.training - INFO - 모델 학습 시작
2025-06-24 13:03:38,822 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:03:38,823 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:03:38,823 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:03:38,823 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:03:38,823 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:03:38,823 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:03:38,823 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:03:38,823 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:03:38,823 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:38,823 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:03:38,823 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:03:38,823 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:03:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:03:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:38,900 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:38,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:39,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:39,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:39,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:39,215 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:39,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:03:39,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:39,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:03:39,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:39,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:39,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:39,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:39,328 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:39,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:39,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:39,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:39,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:39,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:39,408 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:39,408 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:39,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:03:39,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:39,422 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:39,422 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:39,422 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:03:39,422 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:03:39,422 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:03:39,439 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:03:39,442 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:03:39,442 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   iterations: 456
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   learning_rate: 0.013827737934980855
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.226525692945671
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   random_strength: 0.21412724665344204
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   bagging_temperature: 0.23794940979391208
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   border_count: 86
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:03:39,443 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:39,444 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:03:40,731 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:03:40,731 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:03:40,731 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:03:40,731 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:03:40,731 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:03:40,732 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:03:40,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:40,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:40,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:40,750 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:40,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:40,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:40,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:40,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:40,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:40,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:40,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:40,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:03:40,864 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:03:40,865 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:03:40,865 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:03:40,865 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:03:40,865 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:40,865 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:40,865 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:03:40,865 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:03:40,868 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:03:40,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:03:40,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:03:40,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:03:41,637 - src.training - INFO -   precision: 0.0
2025-06-24 13:03:41,638 - src.training - INFO -   recall: 0.0
2025-06-24 13:03:41,638 - src.training - INFO -   f1: 0.0
2025-06-24 13:03:41,638 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:03:41,638 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:03:41,638 - src.training - INFO -   positive_samples: 270
2025-06-24 13:03:41,638 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:03:41,638 - src.training - INFO -   total_samples: 220940
2025-06-24 13:03:41,638 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:03:41,638 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:03:41,638 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:03:41,638 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:03:41,638 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:03:41,638 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:03:41,638 - src.training - INFO - 모델 학습 완료
2025-06-24 13:03:41,638 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:03:41,638 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:41,638 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:41,638 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:41,638 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:41,659 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:03:41,659 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:03:42,103 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = catboost
2025-06-24 13:03:43,879 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:03:43,880 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:03:43,880 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:03:43,880 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:03:43,880 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:03:43,880 - src.training - INFO - 교차 검증 시작
2025-06-24 13:03:43,880 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:03:43,897 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:03:44,348 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:03:44,348 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:03:44,348 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:03:44,348 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:03:44,348 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:03:44,348 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:03:44,348 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:03:44,348 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:03:44,348 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:03:44,535 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:03:44,535 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:03:44,535 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:03:44,535 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:03:45,842 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:03:46,844 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:46,844 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:03:46,849 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:03:46,880 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:03:46,880 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:03:46,880 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:03:46,880 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:48,079 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:48,333 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:03:48,333 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:48,493 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:48,493 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:48,534 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:48,534 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:48,534 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:48,534 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:03:48,534 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:48,534 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:48,590 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:03:48,590 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:03:48,590 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:48,590 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:48,590 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:03:48,590 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:03:48,590 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:48,648 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:48,648 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:48,648 - src.training - INFO - 모델 학습 시작
2025-06-24 13:03:48,775 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:03:48,775 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:03:48,775 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:03:48,775 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:03:48,775 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:03:48,775 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:03:48,775 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:03:48,775 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:03:48,775 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:48,775 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:03:48,775 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:03:48,775 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:03:48,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:03:48,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:48,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:48,853 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:48,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:48,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:49,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:49,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:49,168 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:49,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:03:49,185 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:49,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:03:49,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:49,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:49,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:49,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:49,280 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:49,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:49,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:49,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:49,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:49,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:49,360 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:49,360 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:49,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:03:49,375 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:49,375 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:49,375 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:49,375 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:03:49,375 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:03:49,375 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:03:49,389 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   iterations: 474
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   learning_rate: 0.10760337278788225
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0963973640255693
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   random_strength: 0.14616994415206933
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   bagging_temperature: 0.7605895416467543
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   border_count: 173
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:03:49,392 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:49,393 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:03:50,690 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:03:50,690 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:03:50,690 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:03:50,690 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:03:50,690 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:03:50,691 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:03:50,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:50,691 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:50,692 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:50,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:50,740 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:50,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:50,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:50,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:50,793 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:50,793 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:50,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:03:50,824 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:03:50,824 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:03:50,824 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:03:50,824 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:03:50,824 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:50,824 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:50,824 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:03:50,824 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:03:50,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:03:50,831 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:03:50,832 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:03:50,832 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:03:51,588 - src.training - INFO -   precision: 0.0
2025-06-24 13:03:51,588 - src.training - INFO -   recall: 0.0
2025-06-24 13:03:51,588 - src.training - INFO -   f1: 0.0
2025-06-24 13:03:51,588 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:03:51,588 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:03:51,588 - src.training - INFO -   positive_samples: 270
2025-06-24 13:03:51,588 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:03:51,588 - src.training - INFO -   total_samples: 220940
2025-06-24 13:03:51,588 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:03:51,588 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:03:51,588 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:03:51,588 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:03:51,588 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:03:51,588 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:03:51,588 - src.training - INFO - 모델 학습 완료
2025-06-24 13:03:51,589 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:03:51,589 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:51,589 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:51,589 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:51,589 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:51,611 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:03:51,611 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:03:52,051 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = catboost
2025-06-24 13:03:53,849 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:03:53,849 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:03:53,849 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:03:53,849 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:03:53,849 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:03:53,849 - src.training - INFO - 교차 검증 시작
2025-06-24 13:03:53,849 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:03:53,866 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:03:54,309 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:03:54,309 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:03:54,309 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:03:54,309 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:03:54,309 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:03:54,309 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:03:54,309 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:03:54,309 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:03:54,309 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:03:54,495 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:03:54,495 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:03:54,495 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:03:54,495 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:03:55,790 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:03:56,800 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:56,800 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:03:56,806 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:03:56,837 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:03:56,837 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:03:56,837 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:03:56,838 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:03:58,040 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:03:58,299 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:03:58,299 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:58,457 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:58,457 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:03:58,497 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:03:58,497 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:58,497 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:03:58,497 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:03:58,497 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:58,497 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:03:58,553 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:03:58,553 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:03:58,553 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:58,553 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:58,553 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:03:58,553 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:03:58,553 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:58,612 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:58,612 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:03:58,612 - src.training - INFO - 모델 학습 시작
2025-06-24 13:03:58,737 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:03:58,737 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:03:58,737 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:03:58,737 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:03:58,737 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:03:58,737 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:03:58,737 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:03:58,737 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:03:58,737 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:58,737 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:03:58,737 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:03:58,737 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:03:58,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:03:58,738 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:58,738 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:58,816 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:58,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:58,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:58,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:59,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:59,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:59,148 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:03:59,148 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:59,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:03:59,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:59,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:03:59,225 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:59,226 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:03:59,243 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:03:59,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:03:59,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:03:59,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:03:59,304 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:03:59,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:03:59,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:03:59,325 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:03:59,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:03:59,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:59,340 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:03:59,340 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:03:59,340 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:03:59,340 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:03:59,340 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:03:59,353 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   iterations: 345
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   learning_rate: 0.06965245713252999
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.8788378690393142
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   random_strength: 1.4531957015661667
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   bagging_temperature: 0.5105048640078802
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   border_count: 41
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:03:59,357 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:59,358 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:03:59,358 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:03:59,358 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:04:00,644 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:04:00,644 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:04:00,644 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:04:00,644 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:04:00,644 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:04:00,645 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:04:00,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:00,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:00,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:00,663 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:00,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:00,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:00,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:00,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:00,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:00,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:00,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:00,747 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:04:00,774 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:04:00,775 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:04:00,775 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:04:00,775 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:04:00,775 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:00,775 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:00,775 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:04:00,775 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:04:00,778 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:04:00,782 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:04:00,783 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:04:00,783 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:04:01,630 - src.training - INFO -   precision: 0.0
2025-06-24 13:04:01,630 - src.training - INFO -   recall: 0.0
2025-06-24 13:04:01,630 - src.training - INFO -   f1: 0.0
2025-06-24 13:04:01,630 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:04:01,630 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:04:01,630 - src.training - INFO -   positive_samples: 270
2025-06-24 13:04:01,630 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:04:01,630 - src.training - INFO -   total_samples: 220940
2025-06-24 13:04:01,630 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:04:01,630 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:04:01,630 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:04:01,630 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:04:01,630 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:04:01,630 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:04:01,630 - src.training - INFO - 모델 학습 완료
2025-06-24 13:04:01,630 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:04:01,630 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:01,630 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:01,631 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:01,631 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:01,652 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:04:01,652 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:04:02,107 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = catboost
2025-06-24 13:04:04,063 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:04:04,063 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:04:04,063 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:04:04,063 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:04:04,063 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:04:04,063 - src.training - INFO - 교차 검증 시작
2025-06-24 13:04:04,063 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:04:04,080 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:04:04,557 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:04:04,557 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:04:04,557 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:04:04,557 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:04:04,557 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:04:04,557 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:04:04,557 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:04:04,557 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:04:04,557 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:04:04,729 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:04:04,729 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:04:04,729 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:04:04,729 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:04:06,165 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:04:07,272 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:07,272 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:04:07,278 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:04:07,311 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:04:07,311 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:04:07,311 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:04:07,311 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:08,637 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:08,912 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:04:08,912 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:09,080 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:09,080 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:09,122 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:09,122 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:09,122 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:09,122 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:04:09,122 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:09,122 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:09,183 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:04:09,183 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:04:09,183 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:09,183 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:09,183 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:04:09,183 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:04:09,183 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:09,249 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:09,249 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:09,249 - src.training - INFO - 모델 학습 시작
2025-06-24 13:04:09,379 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:04:09,379 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:04:09,379 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:04:09,379 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:04:09,379 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:04:09,379 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:04:09,379 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:04:09,379 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:04:09,379 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:09,379 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:04:09,379 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:04:09,379 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:04:09,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:04:09,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:09,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:09,470 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:09,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:09,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:09,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:09,738 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:09,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:09,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:04:09,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:09,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:04:09,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:09,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:09,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:09,904 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:09,922 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:09,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:09,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:09,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:09,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:10,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:10,011 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:10,011 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:10,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:04:10,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:10,026 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:10,026 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:10,026 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:04:10,026 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:04:10,026 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:04:10,038 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   iterations: 404
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   learning_rate: 0.011748232399150542
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.315075233153787
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   random_strength: 1.1594208066320488
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   bagging_temperature: 0.25510106002659466
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   border_count: 198
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:04:10,042 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:04:10,043 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:10,043 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:04:10,043 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:10,043 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:04:11,311 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:04:11,311 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:04:11,311 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:04:11,311 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:04:11,311 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:04:11,311 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:04:11,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:11,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:11,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:11,329 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:11,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:11,362 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:11,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:11,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:11,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:11,414 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:11,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:11,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:04:11,444 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:04:11,445 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:04:11,445 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:04:11,445 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:04:11,445 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:11,445 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:11,445 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:04:11,445 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:04:11,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:04:11,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:04:11,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:04:11,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:04:12,323 - src.training - INFO -   precision: 0.0
2025-06-24 13:04:12,323 - src.training - INFO -   recall: 0.0
2025-06-24 13:04:12,323 - src.training - INFO -   f1: 0.0
2025-06-24 13:04:12,323 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:04:12,323 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:04:12,323 - src.training - INFO -   positive_samples: 270
2025-06-24 13:04:12,323 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:04:12,323 - src.training - INFO -   total_samples: 220940
2025-06-24 13:04:12,323 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:04:12,323 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:04:12,323 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:04:12,323 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:04:12,323 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:04:12,323 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:04:12,323 - src.training - INFO - 모델 학습 완료
2025-06-24 13:04:12,323 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:04:12,323 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:12,323 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:12,323 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:12,323 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:12,345 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:04:12,345 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:04:12,804 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = catboost
2025-06-24 13:04:14,771 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:04:14,771 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:04:14,771 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:04:14,771 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:04:14,771 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:04:14,771 - src.training - INFO - 교차 검증 시작
2025-06-24 13:04:14,771 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:04:14,788 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:04:15,266 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:04:15,266 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:04:15,266 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:04:15,266 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:04:15,266 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:04:15,266 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:04:15,266 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:04:15,266 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:04:15,266 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:04:15,437 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:04:15,437 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:04:15,437 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:04:15,437 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:04:16,869 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:04:17,985 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:17,985 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:04:17,991 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:04:18,023 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:04:18,023 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:04:18,023 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:04:18,023 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:19,334 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:19,611 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:04:19,612 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:19,780 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:19,780 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:19,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:19,824 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:19,824 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:19,824 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:04:19,824 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:19,824 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:19,885 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:04:19,885 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:04:19,885 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:19,885 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:19,885 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:04:19,885 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:04:19,886 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:19,951 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:19,951 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:19,951 - src.training - INFO - 모델 학습 시작
2025-06-24 13:04:20,082 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:04:20,082 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:04:20,082 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:04:20,082 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:04:20,082 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:04:20,082 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:04:20,082 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:04:20,082 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:04:20,082 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:20,082 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:04:20,082 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:04:20,082 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:04:20,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:04:20,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:20,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:20,175 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:20,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:20,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:20,378 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:20,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:20,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:20,542 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:04:20,542 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:20,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:04:20,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:20,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:20,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:20,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:20,631 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:20,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:20,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:20,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:20,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:20,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:20,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:20,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:20,734 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:04:20,734 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:20,734 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:20,734 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:20,734 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:04:20,734 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:04:20,734 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:04:20,747 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   iterations: 212
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   learning_rate: 0.18517053981016193
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.1764205612618195
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:04:20,750 - src.models.catboost_model - INFO -   random_strength: 0.11144149833823645
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   bagging_temperature: 0.32593034756125594
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   border_count: 148
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:20,751 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:04:22,026 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:04:22,026 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:04:22,026 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:04:22,026 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:04:22,026 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:04:22,027 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:04:22,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:22,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:22,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:22,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:22,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:22,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:22,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:22,111 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:22,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:22,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:22,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:22,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:04:22,164 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:04:22,164 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:04:22,164 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:04:22,164 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:04:22,164 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:22,164 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:22,164 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:04:22,164 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:04:22,167 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:04:22,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:04:22,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:04:22,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:04:23,014 - src.training - INFO -   precision: 0.0
2025-06-24 13:04:23,014 - src.training - INFO -   recall: 0.0
2025-06-24 13:04:23,014 - src.training - INFO -   f1: 0.0
2025-06-24 13:04:23,014 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:04:23,015 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:04:23,015 - src.training - INFO -   positive_samples: 270
2025-06-24 13:04:23,015 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:04:23,015 - src.training - INFO -   total_samples: 220940
2025-06-24 13:04:23,015 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:04:23,015 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:04:23,015 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:04:23,015 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:04:23,015 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:04:23,015 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:04:23,015 - src.training - INFO - 모델 학습 완료
2025-06-24 13:04:23,015 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:04:23,015 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:23,015 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:23,015 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:23,015 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:23,034 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:04:23,034 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:04:23,497 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = catboost
2025-06-24 13:04:25,460 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:04:25,461 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:04:25,461 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:04:25,461 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:04:25,461 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:04:25,461 - src.training - INFO - 교차 검증 시작
2025-06-24 13:04:25,461 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:04:25,478 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:04:25,956 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:04:25,956 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:04:25,956 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:04:25,956 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:04:25,956 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:04:25,956 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:04:25,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:04:25,956 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:04:25,956 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:04:26,125 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:04:26,125 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:04:26,125 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:04:26,125 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:04:27,440 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:04:28,441 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:28,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:04:28,448 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:04:28,480 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:04:28,480 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:04:28,480 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:04:28,480 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:29,675 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:29,942 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:04:29,942 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:30,109 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:30,109 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:30,151 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:30,151 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:30,151 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:30,151 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:04:30,151 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:30,151 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:30,212 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:04:30,212 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:04:30,212 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:30,212 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:30,212 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:04:30,212 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:04:30,212 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:30,278 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:30,278 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:30,278 - src.training - INFO - 모델 학습 시작
2025-06-24 13:04:30,409 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:04:30,409 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:04:30,409 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:04:30,409 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:04:30,409 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:04:30,409 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:04:30,409 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:04:30,409 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:04:30,409 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:30,409 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:04:30,409 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:04:30,410 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:04:30,410 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:04:30,410 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:30,410 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:30,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:30,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:30,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:30,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:30,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:30,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:30,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:04:30,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:30,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:04:30,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:30,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:30,945 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:30,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:30,964 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:30,980 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:30,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:31,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:31,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:31,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:31,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:31,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:31,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:04:31,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:31,067 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:31,067 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:31,067 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:04:31,067 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:04:31,067 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:04:31,081 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   iterations: 156
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   learning_rate: 0.18392244999425317
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.6202704559637
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   random_strength: 0.16638433092377947
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   bagging_temperature: 0.15463713590464168
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   border_count: 92
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:31,085 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:04:31,086 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:31,086 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:04:32,433 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:04:32,433 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:04:32,433 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:04:32,434 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:04:32,434 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:04:32,434 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:04:32,434 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:32,434 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:32,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:32,452 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:32,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:32,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:32,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:32,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:32,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:32,533 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:32,533 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:32,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:04:32,564 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:04:32,565 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:04:32,565 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:04:32,565 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:04:32,565 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:32,565 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:32,565 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:04:32,565 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:04:32,568 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:04:32,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:04:32,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:04:32,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:04:33,326 - src.training - INFO -   precision: 0.0
2025-06-24 13:04:33,326 - src.training - INFO -   recall: 0.0
2025-06-24 13:04:33,326 - src.training - INFO -   f1: 0.0
2025-06-24 13:04:33,326 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:04:33,326 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:04:33,326 - src.training - INFO -   positive_samples: 270
2025-06-24 13:04:33,326 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:04:33,326 - src.training - INFO -   total_samples: 220940
2025-06-24 13:04:33,327 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:04:33,327 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:04:33,327 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:04:33,327 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:04:33,327 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:04:33,327 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:04:33,327 - src.training - INFO - 모델 학습 완료
2025-06-24 13:04:33,327 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:04:33,327 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:33,327 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:33,327 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:33,327 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:33,348 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:04:33,348 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:04:33,784 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = catboost
2025-06-24 13:04:35,566 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:04:35,566 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:04:35,566 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:04:35,566 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:04:35,566 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:04:35,566 - src.training - INFO - 교차 검증 시작
2025-06-24 13:04:35,566 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:04:35,583 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:04:36,031 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:04:36,031 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:04:36,031 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:04:36,031 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:04:36,031 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:04:36,031 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:04:36,031 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:04:36,031 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:04:36,031 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:04:36,218 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:04:36,218 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:04:36,218 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:04:36,218 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:04:37,511 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:04:38,521 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:38,521 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:04:38,527 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:04:38,559 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:04:38,559 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:04:38,559 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:04:38,559 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:39,804 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:40,083 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:04:40,083 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:40,250 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:40,250 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:40,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:40,292 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:40,292 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:40,292 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:04:40,292 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:40,292 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:40,353 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:04:40,353 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:04:40,353 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:40,353 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:40,353 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:04:40,353 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:04:40,353 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:40,420 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:40,420 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:40,420 - src.training - INFO - 모델 학습 시작
2025-06-24 13:04:40,551 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:04:40,551 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:04:40,551 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:04:40,551 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:04:40,551 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:04:40,551 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:04:40,551 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:04:40,551 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:04:40,551 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:40,551 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:04:40,551 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:04:40,551 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:04:40,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:04:40,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:40,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:40,642 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:40,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:40,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:40,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:40,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:40,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:41,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:04:41,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:41,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:04:41,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:41,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:41,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:41,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:41,102 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:41,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:41,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:41,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:41,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:41,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:41,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:41,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:41,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:04:41,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:41,205 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:41,205 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:41,205 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:04:41,205 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:04:41,205 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:04:41,220 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   iterations: 445
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   learning_rate: 0.07145636506350263
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   l2_leaf_reg: 9.960556107124365
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   random_strength: 2.7494068278577055
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   bagging_temperature: 0.38288451726673883
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   border_count: 118
2025-06-24 13:04:41,223 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:41,224 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:04:42,480 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:04:42,480 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:04:42,480 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:04:42,480 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:04:42,480 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:04:42,481 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:04:42,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:42,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:42,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:42,499 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:42,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:42,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:42,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:42,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:42,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:42,583 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:42,583 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:42,587 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:04:42,615 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:04:42,615 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:04:42,615 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:04:42,615 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:04:42,615 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:42,615 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:42,615 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:04:42,615 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:04:42,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:04:42,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:04:42,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:04:42,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:04:43,380 - src.training - INFO -   precision: 0.0
2025-06-24 13:04:43,380 - src.training - INFO -   recall: 0.0
2025-06-24 13:04:43,380 - src.training - INFO -   f1: 0.0
2025-06-24 13:04:43,380 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:04:43,380 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:04:43,380 - src.training - INFO -   positive_samples: 270
2025-06-24 13:04:43,380 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:04:43,380 - src.training - INFO -   total_samples: 220940
2025-06-24 13:04:43,381 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:04:43,381 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:04:43,381 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:04:43,381 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:04:43,381 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:04:43,381 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:04:43,381 - src.training - INFO - 모델 학습 완료
2025-06-24 13:04:43,381 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:04:43,381 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:43,381 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:43,381 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:43,381 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:43,403 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:04:43,403 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:04:43,837 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = catboost
2025-06-24 13:04:45,618 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:04:45,618 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:04:45,618 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:04:45,618 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:04:45,618 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:04:45,618 - src.training - INFO - 교차 검증 시작
2025-06-24 13:04:45,618 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:04:45,635 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:04:46,077 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:04:46,077 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:04:46,077 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:04:46,077 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:04:46,077 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:04:46,077 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:04:46,077 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:04:46,077 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:04:46,077 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:04:46,260 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:04:46,260 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:04:46,260 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:04:46,260 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:04:47,546 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:04:48,557 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:48,557 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:04:48,563 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:04:48,595 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:04:48,595 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:04:48,595 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:04:48,595 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:49,804 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:50,064 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:04:50,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:50,225 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:50,225 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:04:50,266 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:04:50,266 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:50,266 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:04:50,266 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:04:50,266 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:50,266 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:50,323 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:04:50,323 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:04:50,323 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:50,323 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:50,323 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:04:50,323 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:04:50,323 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:50,381 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:50,381 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:04:50,381 - src.training - INFO - 모델 학습 시작
2025-06-24 13:04:50,507 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:04:50,508 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:04:50,508 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:04:50,508 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:04:50,508 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:04:50,508 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:04:50,508 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:04:50,508 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:04:50,508 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:50,508 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:04:50,508 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:04:50,508 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:04:50,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:04:50,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:50,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:50,588 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:50,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:50,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:50,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:50,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:50,906 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:50,922 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:04:50,922 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:50,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:04:51,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:51,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:51,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:51,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:51,017 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:51,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:51,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:51,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:51,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:51,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:51,100 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:51,100 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:51,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:04:51,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:51,114 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:04:51,114 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:51,114 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:04:51,114 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:04:51,114 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:04:51,127 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   iterations: 395
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   learning_rate: 0.010630568080367742
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   l2_leaf_reg: 8.473070071397649
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   random_strength: 0.7139456208058347
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   bagging_temperature: 0.16336017893200738
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   border_count: 175
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:04:51,131 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:04:51,132 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:04:52,407 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:04:52,407 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:04:52,407 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:04:52,407 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:04:52,407 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:04:52,408 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:04:52,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:04:52,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:52,408 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:04:52,425 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:04:52,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:04:52,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:04:52,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:04:52,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:04:52,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:04:52,508 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:04:52,509 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:52,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:04:52,538 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:04:52,539 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:04:52,539 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:04:52,539 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:04:52,539 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:52,539 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:04:52,539 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:04:52,539 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:04:52,541 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:04:52,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:04:52,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:04:52,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:04:53,337 - src.training - INFO -   precision: 0.0
2025-06-24 13:04:53,337 - src.training - INFO -   recall: 0.0
2025-06-24 13:04:53,337 - src.training - INFO -   f1: 0.0
2025-06-24 13:04:53,337 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:04:53,337 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:04:53,337 - src.training - INFO -   positive_samples: 270
2025-06-24 13:04:53,337 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:04:53,337 - src.training - INFO -   total_samples: 220940
2025-06-24 13:04:53,337 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:04:53,337 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:04:53,337 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:04:53,337 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:04:53,337 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:04:53,338 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:04:53,338 - src.training - INFO - 모델 학습 완료
2025-06-24 13:04:53,338 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:04:53,338 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:53,338 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:53,338 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:04:53,338 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:04:53,359 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:04:53,359 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:04:53,803 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = catboost
2025-06-24 13:04:55,583 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:04:55,583 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:04:55,583 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:04:55,583 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:04:55,583 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:04:55,583 - src.training - INFO - 교차 검증 시작
2025-06-24 13:04:55,583 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:04:55,600 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:04:56,046 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:04:56,046 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:04:56,046 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:04:56,046 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:04:56,046 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:04:56,046 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:04:56,046 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:04:56,046 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:04:56,046 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:04:56,228 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:56,228 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:56,228 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:04:56,228 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:04:56,228 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:56,228 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:04:56,229 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:04:56,229 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:04:56,229 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:04:56,229 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:04:57,511 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:04:58,513 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:58,513 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:04:58,519 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:04:58,550 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:04:58,550 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:04:58,550 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:04:58,550 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:04:59,735 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:04:59,995 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:04:59,995 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:00,155 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:00,155 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:00,196 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:00,196 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:00,196 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:00,196 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:05:00,196 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:00,196 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:00,253 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:05:00,253 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:05:00,253 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:00,253 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:00,253 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:05:00,253 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:05:00,253 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:00,311 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:00,311 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:00,311 - src.training - INFO - 모델 학습 시작
2025-06-24 13:05:00,437 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:05:00,437 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:05:00,437 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:05:00,437 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:05:00,437 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:05:00,437 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:05:00,437 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:05:00,437 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:05:00,437 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:00,437 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:05:00,437 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:05:00,437 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:05:00,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:05:00,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:00,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:00,516 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:00,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:00,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:00,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:00,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:00,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:00,848 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:05:00,848 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:00,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:05:00,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:00,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:00,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:00,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:00,943 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:00,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:00,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:00,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:01,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:01,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:01,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:01,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:01,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:05:01,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:01,040 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:01,040 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:01,040 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:05:01,040 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:05:01,040 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:05:01,053 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   iterations: 174
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   learning_rate: 0.07447187704347227
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.9318442844227661
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   random_strength: 0.1026576181249016
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   bagging_temperature: 0.33459926271882834
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   border_count: 101
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:01,057 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:05:02,382 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:05:02,382 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:05:02,382 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:05:02,382 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:05:02,382 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:05:02,382 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:05:02,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:02,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:02,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:02,402 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:02,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:02,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:02,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:02,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:02,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:02,488 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:02,488 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:02,490 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:05:02,520 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:05:02,520 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:05:02,520 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:05:02,520 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:05:02,520 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:02,520 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:02,520 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:05:02,520 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:05:02,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:05:02,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:05:02,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:05:02,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:05:03,364 - src.training - INFO -   precision: 0.0
2025-06-24 13:05:03,364 - src.training - INFO -   recall: 0.0
2025-06-24 13:05:03,364 - src.training - INFO -   f1: 0.0
2025-06-24 13:05:03,364 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:05:03,364 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:05:03,365 - src.training - INFO -   positive_samples: 270
2025-06-24 13:05:03,365 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:05:03,365 - src.training - INFO -   total_samples: 220940
2025-06-24 13:05:03,365 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:05:03,365 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:05:03,365 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:05:03,365 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:05:03,365 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:05:03,365 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:05:03,365 - src.training - INFO - 모델 학습 완료
2025-06-24 13:05:03,365 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:05:03,365 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:03,365 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:03,365 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:03,365 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:03,386 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:05:03,387 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:05:03,845 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = catboost
2025-06-24 13:05:05,807 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:05:05,807 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:05:05,807 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:05:05,807 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:05:05,807 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:05:05,807 - src.training - INFO - 교차 검증 시작
2025-06-24 13:05:05,807 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:05:05,824 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:05:06,305 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:05:06,305 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:05:06,305 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:05:06,305 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:05:06,305 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:05:06,305 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:05:06,305 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:05:06,305 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:05:06,305 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:05:06,475 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:05:06,475 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:05:06,475 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:05:06,475 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:05:07,886 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:05:08,988 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:08,988 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:05:08,994 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:05:09,027 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:05:09,027 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:05:09,027 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:05:09,027 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:10,326 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:10,603 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:05:10,603 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:10,772 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:10,772 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:10,814 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:10,814 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:10,814 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:10,814 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:05:10,814 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:10,814 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:10,875 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:05:10,875 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:05:10,875 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:10,875 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:10,875 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:05:10,875 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:05:10,875 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:10,941 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:10,941 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:10,942 - src.training - INFO - 모델 학습 시작
2025-06-24 13:05:11,071 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:05:11,072 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:05:11,072 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:05:11,072 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:05:11,072 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:05:11,072 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:05:11,072 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:05:11,072 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:05:11,072 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:11,072 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:05:11,072 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:05:11,072 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:05:11,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:05:11,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:11,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:11,162 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:11,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:11,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:11,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:11,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:11,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:11,534 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:05:11,534 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:11,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:05:11,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:11,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:11,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:11,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:11,623 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:11,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:11,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:11,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:11,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:11,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:11,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:11,710 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:11,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:05:11,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:11,725 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:11,725 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:11,725 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:05:11,725 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:05:11,725 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:05:11,739 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   iterations: 91
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   learning_rate: 0.02324777231990505
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.739730609769745
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   random_strength: 0.3753553189772704
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   bagging_temperature: 0.6303518331473116
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   border_count: 109
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:11,743 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:05:12,979 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:05:12,979 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:05:12,979 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:05:12,980 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:05:12,980 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:05:12,980 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:05:12,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:12,980 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:12,981 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:12,999 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:13,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:13,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:13,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:13,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:13,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:13,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:13,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:13,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:05:13,109 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:05:13,109 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:05:13,110 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:05:13,110 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:05:13,110 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:13,110 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:13,110 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:05:13,110 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:05:13,112 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:05:13,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:05:13,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:05:13,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:05:13,908 - src.training - INFO -   precision: 0.0
2025-06-24 13:05:13,908 - src.training - INFO -   recall: 0.0
2025-06-24 13:05:13,908 - src.training - INFO -   f1: 0.0
2025-06-24 13:05:13,908 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:05:13,908 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:05:13,908 - src.training - INFO -   positive_samples: 270
2025-06-24 13:05:13,908 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:05:13,908 - src.training - INFO -   total_samples: 220940
2025-06-24 13:05:13,908 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:05:13,908 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:05:13,908 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:05:13,908 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:05:13,908 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:05:13,908 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:05:13,908 - src.training - INFO - 모델 학습 완료
2025-06-24 13:05:13,908 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:05:13,908 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:13,908 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:13,908 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:13,908 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:13,931 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:05:13,931 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:05:14,356 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = catboost
2025-06-24 13:05:16,142 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:05:16,142 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:05:16,142 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:05:16,142 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:05:16,142 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:05:16,142 - src.training - INFO - 교차 검증 시작
2025-06-24 13:05:16,142 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:05:16,159 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:05:16,603 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:05:16,603 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:05:16,603 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:05:16,603 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:05:16,603 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:05:16,603 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:05:16,603 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:05:16,603 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:05:16,603 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:05:16,786 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:16,787 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:16,787 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:16,787 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:16,787 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:16,787 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:05:16,787 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:05:16,787 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:05:16,787 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:05:16,787 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:05:18,074 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:05:19,070 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:19,070 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:05:19,075 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:05:19,106 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:05:19,106 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:05:19,106 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:05:19,106 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:20,306 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:20,562 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:05:20,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:20,722 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:20,722 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:20,763 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:20,763 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:20,763 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:20,763 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:05:20,763 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:20,763 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:20,819 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:05:20,820 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:05:20,820 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:20,820 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:20,820 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:05:20,820 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:05:20,820 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:20,878 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:20,878 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:20,878 - src.training - INFO - 모델 학습 시작
2025-06-24 13:05:21,005 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:05:21,005 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:05:21,005 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:05:21,005 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:05:21,005 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:05:21,005 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:05:21,005 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:05:21,005 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:05:21,005 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:21,005 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:05:21,005 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:05:21,006 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:05:21,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:05:21,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:21,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:21,084 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:21,144 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:21,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:21,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:21,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:21,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:21,416 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:05:21,416 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:21,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:05:21,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:21,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:21,494 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:21,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:21,512 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:21,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:21,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:21,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:21,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:21,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:21,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:21,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:05:21,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:21,605 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:21,605 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:21,606 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:05:21,606 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:05:21,606 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:05:21,619 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   iterations: 75
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   learning_rate: 0.031012653974484706
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.515094184613051
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   random_strength: 1.5514002944037852
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   bagging_temperature: 0.4617101595280576
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   border_count: 65
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:05:21,623 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:21,624 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:05:22,927 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:05:22,927 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:05:22,927 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:05:22,927 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:05:22,927 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:05:22,928 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:05:22,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:22,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:22,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:22,946 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:22,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:22,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:22,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:23,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:23,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:23,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:23,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:23,029 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:05:23,056 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:05:23,057 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:05:23,057 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:05:23,057 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:05:23,057 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:23,057 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:23,057 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:05:23,057 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:05:23,060 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:05:23,064 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:05:23,064 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:05:23,064 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:05:23,813 - src.training - INFO -   precision: 0.0
2025-06-24 13:05:23,813 - src.training - INFO -   recall: 0.0
2025-06-24 13:05:23,813 - src.training - INFO -   f1: 0.0
2025-06-24 13:05:23,813 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:05:23,813 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:05:23,813 - src.training - INFO -   positive_samples: 270
2025-06-24 13:05:23,813 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:05:23,813 - src.training - INFO -   total_samples: 220940
2025-06-24 13:05:23,813 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:05:23,813 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:05:23,813 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:05:23,813 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:05:23,814 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:05:23,814 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:05:23,814 - src.training - INFO - 모델 학습 완료
2025-06-24 13:05:23,814 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:05:23,814 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:23,814 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:23,814 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:23,814 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:23,835 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:05:23,835 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:05:24,280 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = catboost
2025-06-24 13:05:26,086 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:05:26,086 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:05:26,086 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:05:26,086 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:05:26,086 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:05:26,086 - src.training - INFO - 교차 검증 시작
2025-06-24 13:05:26,086 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:05:26,103 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:05:26,582 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:05:26,582 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:05:26,582 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:05:26,582 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:05:26,582 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:05:26,582 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:05:26,582 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:05:26,582 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:05:26,582 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:05:26,752 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:05:26,752 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:05:26,752 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:05:26,752 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:05:28,185 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:05:29,292 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:29,292 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:05:29,298 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:05:29,336 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:05:29,336 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:05:29,336 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:05:29,336 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:30,636 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:30,918 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:05:30,918 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:31,085 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:31,086 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:31,128 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:31,128 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:31,128 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:31,128 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:05:31,128 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:31,128 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:31,189 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:05:31,189 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:05:31,189 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:31,189 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:31,189 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:05:31,189 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:05:31,189 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:31,255 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:31,255 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:31,255 - src.training - INFO - 모델 학습 시작
2025-06-24 13:05:31,388 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:05:31,388 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:05:31,388 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:05:31,388 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:05:31,388 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:05:31,388 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:05:31,388 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:05:31,388 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:05:31,388 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:31,388 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:05:31,388 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:05:31,388 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:05:31,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:05:31,388 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:31,389 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:31,478 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:31,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:31,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:31,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:31,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:31,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:31,851 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:05:31,851 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:31,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:05:31,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:31,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:31,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:31,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:31,940 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:31,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:31,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:31,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:32,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:32,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:32,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:32,028 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:32,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:05:32,042 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:32,042 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:32,043 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:32,043 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:05:32,043 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:05:32,043 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:05:32,057 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:05:32,060 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:05:32,060 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:05:32,060 - src.models.catboost_model - INFO -   iterations: 195
2025-06-24 13:05:32,060 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   learning_rate: 0.03417515805328453
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.350738282095378
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   random_strength: 1.091441019534737
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   bagging_temperature: 0.8610277689821821
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   border_count: 133
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:32,061 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:05:33,351 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:05:33,351 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:05:33,351 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:05:33,351 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:05:33,351 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:05:33,351 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:05:33,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:33,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:33,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:33,369 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:33,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:33,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:33,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:33,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:33,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:33,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:33,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:33,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:05:33,482 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:05:33,482 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:05:33,482 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:05:33,482 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:05:33,482 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:33,482 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:33,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:05:33,483 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:05:33,485 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:05:33,490 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:05:33,490 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:05:33,490 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:05:34,277 - src.training - INFO -   precision: 0.0
2025-06-24 13:05:34,277 - src.training - INFO -   recall: 0.0
2025-06-24 13:05:34,277 - src.training - INFO -   f1: 0.0
2025-06-24 13:05:34,277 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:05:34,277 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:05:34,277 - src.training - INFO -   positive_samples: 270
2025-06-24 13:05:34,277 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:05:34,277 - src.training - INFO -   total_samples: 220940
2025-06-24 13:05:34,277 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:05:34,277 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:05:34,277 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:05:34,277 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:05:34,277 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:05:34,278 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:05:34,278 - src.training - INFO - 모델 학습 완료
2025-06-24 13:05:34,278 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:05:34,278 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:34,278 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:34,278 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:34,278 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:34,300 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:05:34,300 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:05:34,739 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = catboost
2025-06-24 13:05:36,549 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:05:36,549 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:05:36,549 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:05:36,549 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:05:36,549 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:05:36,549 - src.training - INFO - 교차 검증 시작
2025-06-24 13:05:36,549 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:05:36,566 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:05:37,019 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:05:37,019 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:05:37,019 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:05:37,019 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:05:37,019 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:05:37,019 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:05:37,019 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:05:37,019 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:05:37,019 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:05:37,206 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:05:37,206 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:05:37,206 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:05:37,206 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:05:38,485 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:05:39,486 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:39,486 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:05:39,492 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:05:39,524 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:05:39,524 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:05:39,524 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:05:39,524 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:40,729 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:40,989 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:05:40,989 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:41,149 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:41,149 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:41,189 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:41,189 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:41,189 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:41,189 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:05:41,189 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:41,189 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:41,246 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:05:41,246 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:05:41,246 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:41,246 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:41,246 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:05:41,246 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:05:41,246 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:41,305 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:41,305 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:41,305 - src.training - INFO - 모델 학습 시작
2025-06-24 13:05:41,432 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:05:41,432 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:05:41,432 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:05:41,432 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:05:41,432 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:05:41,432 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:05:41,432 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:05:41,432 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:05:41,432 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:41,432 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:05:41,432 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:05:41,432 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:05:41,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:05:41,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:41,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:41,509 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:41,569 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:41,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:41,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:41,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:41,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:41,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:05:41,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:41,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:05:41,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:41,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:41,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:41,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:41,940 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:41,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:41,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:41,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:42,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:42,018 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:42,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:42,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:42,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:05:42,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:42,035 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:42,035 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:42,035 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:05:42,035 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:05:42,035 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:05:42,049 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   iterations: 99
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   learning_rate: 0.02300281136150855
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.2773614858784685
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:05:42,052 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   random_strength: 2.87968884347481
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   bagging_temperature: 0.43897815251772065
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   border_count: 139
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:42,053 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:05:43,340 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:05:43,340 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:05:43,340 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:05:43,340 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:05:43,340 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:05:43,340 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:05:43,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:43,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:43,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:43,358 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:43,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:43,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:43,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:43,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:43,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:43,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:43,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:43,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:05:43,473 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:05:43,473 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:05:43,473 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:05:43,473 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:05:43,473 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:43,473 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:43,473 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:05:43,473 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:05:43,476 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:05:43,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:05:43,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:05:43,480 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:05:44,241 - src.training - INFO -   precision: 0.0
2025-06-24 13:05:44,241 - src.training - INFO -   recall: 0.0
2025-06-24 13:05:44,241 - src.training - INFO -   f1: 0.0
2025-06-24 13:05:44,241 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:05:44,241 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:05:44,241 - src.training - INFO -   positive_samples: 270
2025-06-24 13:05:44,241 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:05:44,241 - src.training - INFO -   total_samples: 220940
2025-06-24 13:05:44,241 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:05:44,241 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:05:44,241 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:05:44,241 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:05:44,241 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:05:44,241 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:05:44,241 - src.training - INFO - 모델 학습 완료
2025-06-24 13:05:44,241 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:05:44,241 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:44,241 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:44,241 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:44,241 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:44,263 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:05:44,263 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:05:44,703 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = catboost
2025-06-24 13:05:46,495 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:05:46,495 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:05:46,496 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:05:46,496 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:05:46,496 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:05:46,496 - src.training - INFO - 교차 검증 시작
2025-06-24 13:05:46,496 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:05:46,512 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:05:46,959 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:05:46,959 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:05:46,959 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:05:46,959 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:05:46,959 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:05:46,959 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:05:46,959 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:05:46,959 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:05:46,959 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:05:47,152 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:05:47,152 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:05:47,152 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:05:47,152 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:05:48,425 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:05:49,419 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:49,419 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:05:49,425 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:05:49,455 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:05:49,455 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:05:49,455 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:05:49,455 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:50,646 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:50,899 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:05:50,899 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:51,059 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:51,059 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:05:51,099 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:05:51,099 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:51,100 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:05:51,100 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:05:51,100 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:51,100 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,159 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:05:51,159 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:05:51,159 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,159 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,159 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:05:51,159 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:05:51,159 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,220 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:51,220 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:05:51,220 - src.training - INFO - 모델 학습 시작
2025-06-24 13:05:51,347 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:05:51,347 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:05:51,347 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:05:51,347 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:05:51,347 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:05:51,347 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:05:51,347 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:05:51,347 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:05:51,347 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:51,347 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:05:51,347 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:05:51,347 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:05:51,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:05:51,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:51,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:51,424 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:51,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:51,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:51,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:51,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:51,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:51,762 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:05:51,762 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:51,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:05:51,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:51,840 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:51,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:51,858 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:51,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:51,888 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:51,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:51,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:51,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:51,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:51,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:51,951 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:05:51,952 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,952 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:05:51,952 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:51,952 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:05:51,952 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:05:51,952 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:05:51,965 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   iterations: 74
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   learning_rate: 0.01824128925816181
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.3969413871772542
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   random_strength: 2.9542913275880824
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   bagging_temperature: 0.4104056673947457
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   border_count: 108
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:05:51,969 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:05:51,970 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:05:53,231 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:05:53,231 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:05:53,231 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:05:53,231 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:05:53,231 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:05:53,231 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:05:53,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:05:53,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:53,232 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:05:53,250 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:05:53,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:05:53,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:05:53,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:05:53,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:05:53,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:05:53,337 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:05:53,338 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:53,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:05:53,369 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:05:53,369 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:05:53,369 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:05:53,369 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:05:53,369 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:53,369 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:05:53,369 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:05:53,369 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:05:53,372 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:05:53,376 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:05:53,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:05:53,377 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:05:54,215 - src.training - INFO -   precision: 0.0
2025-06-24 13:05:54,215 - src.training - INFO -   recall: 0.0
2025-06-24 13:05:54,215 - src.training - INFO -   f1: 0.0
2025-06-24 13:05:54,215 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:05:54,215 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:05:54,215 - src.training - INFO -   positive_samples: 270
2025-06-24 13:05:54,215 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:05:54,215 - src.training - INFO -   total_samples: 220940
2025-06-24 13:05:54,215 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:05:54,215 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:05:54,215 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:05:54,215 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:05:54,215 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:05:54,215 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:05:54,215 - src.training - INFO - 모델 학습 완료
2025-06-24 13:05:54,215 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:05:54,215 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:54,215 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:54,215 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:05:54,215 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:05:54,237 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:05:54,237 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:05:54,698 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = catboost
2025-06-24 13:05:56,665 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:05:56,665 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:05:56,665 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:05:56,665 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:05:56,665 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:05:56,665 - src.training - INFO - 교차 검증 시작
2025-06-24 13:05:56,665 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:05:56,682 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:05:57,162 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:05:57,162 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:05:57,162 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:05:57,162 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:05:57,162 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:05:57,162 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:05:57,162 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:05:57,162 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:05:57,162 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:05:57,335 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:57,335 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:57,336 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:05:57,336 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:05:57,336 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:05:57,336 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:05:57,336 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:05:57,336 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:05:57,336 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:05:57,336 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:05:58,748 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:05:59,856 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:05:59,856 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:05:59,862 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:05:59,894 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:05:59,894 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:05:59,894 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:05:59,894 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:01,219 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:01,483 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:06:01,483 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:01,644 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:01,644 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:01,685 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:01,685 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:01,685 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:01,685 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:06:01,685 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:01,685 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:01,742 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:06:01,742 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:06:01,742 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:01,742 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:01,742 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:06:01,742 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:06:01,742 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:01,801 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:01,801 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:01,801 - src.training - INFO - 모델 학습 시작
2025-06-24 13:06:01,927 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:06:01,927 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:06:01,927 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:06:01,927 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:06:01,927 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:06:01,927 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:06:01,927 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:06:01,927 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:06:01,927 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:01,927 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:06:01,927 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:06:01,927 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:06:01,927 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:06:01,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:01,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:02,007 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:02,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:02,128 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:02,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:02,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:02,324 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:02,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:06:02,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:02,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:06:02,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:02,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:02,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:02,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:02,440 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:02,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:02,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:02,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:02,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:02,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:02,520 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:02,521 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:02,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:06:02,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:02,534 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:02,534 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:02,534 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:06:02,534 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:06:02,534 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:06:02,548 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   iterations: 223
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   learning_rate: 0.018740640454546424
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0722491369601155
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   random_strength: 5.093675044723515
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   bagging_temperature: 0.9493044672248446
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   border_count: 79
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:02,552 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:06:03,811 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:06:03,811 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:06:03,811 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:06:03,812 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:06:03,812 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:06:03,812 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:06:03,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:03,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:03,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:03,831 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:03,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:03,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:03,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:03,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:03,915 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:03,918 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:03,918 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:03,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:06:03,949 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:06:03,949 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:06:03,949 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:06:03,949 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:06:03,949 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:03,949 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:03,949 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:06:03,949 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:06:03,952 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:06:03,957 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:06:03,957 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:06:03,957 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:06:04,796 - src.training - INFO -   precision: 0.0
2025-06-24 13:06:04,796 - src.training - INFO -   recall: 0.0
2025-06-24 13:06:04,796 - src.training - INFO -   f1: 0.0
2025-06-24 13:06:04,796 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:06:04,796 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:06:04,796 - src.training - INFO -   positive_samples: 270
2025-06-24 13:06:04,796 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:06:04,796 - src.training - INFO -   total_samples: 220940
2025-06-24 13:06:04,796 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:06:04,796 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:06:04,796 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:06:04,796 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:06:04,796 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:06:04,796 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:06:04,796 - src.training - INFO - 모델 학습 완료
2025-06-24 13:06:04,796 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:06:04,796 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:04,796 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:04,796 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:04,796 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:04,819 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:06:04,819 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:06:05,282 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = catboost
2025-06-24 13:06:07,240 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:06:07,240 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:06:07,240 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:06:07,240 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:06:07,240 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:06:07,240 - src.training - INFO - 교차 검증 시작
2025-06-24 13:06:07,240 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:06:07,258 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:06:07,738 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:06:07,738 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:06:07,738 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:06:07,738 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:06:07,738 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:06:07,738 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:06:07,738 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:06:07,738 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:06:07,738 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:06:07,913 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:06:07,913 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:06:07,913 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:06:07,913 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:06:09,332 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:06:10,432 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:10,432 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:06:10,439 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:06:10,472 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:06:10,472 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:06:10,472 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:06:10,472 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:11,784 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:12,060 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:06:12,060 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:12,229 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:12,229 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:12,272 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:12,272 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:12,272 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:12,272 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:06:12,272 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:12,272 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:12,334 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:06:12,334 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:06:12,334 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:12,334 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:12,334 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:06:12,334 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:06:12,334 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:12,399 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:12,399 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:12,399 - src.training - INFO - 모델 학습 시작
2025-06-24 13:06:12,531 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:06:12,531 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:06:12,531 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:06:12,531 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:06:12,531 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:06:12,531 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:06:12,531 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:06:12,531 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:06:12,531 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:12,531 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:06:12,531 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:06:12,531 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:06:12,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:06:12,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:12,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:12,625 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:12,692 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:12,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:12,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:12,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:12,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:12,992 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:06:12,992 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:13,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:06:13,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:13,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:13,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:13,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:13,084 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:13,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:13,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:13,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:13,150 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:13,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:13,171 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:13,171 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:13,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:06:13,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:13,186 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:13,186 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:13,186 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:06:13,186 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:06:13,186 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:06:13,200 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   iterations: 435
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   depth: 7
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   learning_rate: 0.020314979182728413
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.8700602527623507
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   random_strength: 0.8602154063777578
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   bagging_temperature: 0.16473400173752847
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   border_count: 128
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:06:13,204 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:06:13,205 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:13,205 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:06:13,205 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:13,205 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:06:14,517 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:06:14,517 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:06:14,517 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:06:14,517 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:06:14,517 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:06:14,518 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:06:14,518 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:14,518 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:14,518 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:14,537 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:14,553 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:14,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:14,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:14,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:14,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:14,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:14,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:14,626 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:06:14,655 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:06:14,655 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:06:14,656 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:06:14,656 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:06:14,656 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:14,656 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:14,656 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:06:14,656 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:06:14,659 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:06:14,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:06:14,664 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:06:14,664 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:06:15,550 - src.training - INFO -   precision: 0.0
2025-06-24 13:06:15,550 - src.training - INFO -   recall: 0.0
2025-06-24 13:06:15,550 - src.training - INFO -   f1: 0.0
2025-06-24 13:06:15,550 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:06:15,550 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:06:15,550 - src.training - INFO -   positive_samples: 270
2025-06-24 13:06:15,550 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:06:15,550 - src.training - INFO -   total_samples: 220940
2025-06-24 13:06:15,550 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:06:15,550 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:06:15,550 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:06:15,550 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:06:15,550 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:06:15,550 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:06:15,550 - src.training - INFO - 모델 학습 완료
2025-06-24 13:06:15,550 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:06:15,550 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:15,550 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:15,550 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:15,550 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:15,571 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:06:15,572 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:06:16,036 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = catboost
2025-06-24 13:06:17,991 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:06:17,991 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:06:17,991 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:06:17,991 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:06:17,991 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:06:17,991 - src.training - INFO - 교차 검증 시작
2025-06-24 13:06:17,991 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:06:18,008 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:06:18,487 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:06:18,487 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:06:18,487 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:06:18,487 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:06:18,487 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:06:18,487 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:06:18,487 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:06:18,487 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:06:18,487 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:06:18,654 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:18,654 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:18,654 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:18,654 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:18,654 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:18,655 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:06:18,655 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:06:18,655 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:06:18,655 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:06:18,655 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:06:20,060 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:06:21,154 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:21,154 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:06:21,160 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:06:21,193 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:06:21,193 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:06:21,193 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:06:21,193 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:22,518 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:22,792 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:06:22,793 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:22,961 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:22,961 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:23,004 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:23,005 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:23,005 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:23,005 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:06:23,005 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:23,005 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,067 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:06:23,067 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:06:23,067 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,067 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,067 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:06:23,067 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:06:23,067 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,132 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:23,132 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:23,132 - src.training - INFO - 모델 학습 시작
2025-06-24 13:06:23,276 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:06:23,276 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:06:23,276 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:06:23,276 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:06:23,276 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:06:23,276 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:06:23,276 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:06:23,276 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:06:23,276 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:23,276 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:06:23,276 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:06:23,276 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:06:23,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:06:23,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:23,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:23,356 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:23,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:23,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:23,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:23,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:23,662 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:23,678 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:06:23,678 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:23,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:06:23,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:23,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:23,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:23,775 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:23,789 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:23,804 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:23,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:23,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:23,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:23,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:23,854 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:23,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:06:23,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,869 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:23,869 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:23,869 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:06:23,869 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:06:23,869 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:06:23,881 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   iterations: 279
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   learning_rate: 0.010308677126777199
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.9141234275134027
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   random_strength: 0.19916688768339885
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   bagging_temperature: 0.7785989189756864
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   border_count: 180
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:06:23,885 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:23,886 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:06:25,164 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:06:25,164 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:06:25,164 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:06:25,164 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:06:25,164 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:06:25,165 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:06:25,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:25,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:25,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:25,184 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:25,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:25,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:25,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:25,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:25,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:25,270 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:25,270 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:25,273 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:06:25,303 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:06:25,303 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:06:25,303 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:06:25,303 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:06:25,303 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:25,303 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:25,303 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:06:25,303 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:06:25,306 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:06:25,310 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:06:25,311 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:06:25,311 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:06:26,195 - src.training - INFO -   precision: 0.0
2025-06-24 13:06:26,195 - src.training - INFO -   recall: 0.0
2025-06-24 13:06:26,195 - src.training - INFO -   f1: 0.0
2025-06-24 13:06:26,195 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:06:26,195 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:06:26,195 - src.training - INFO -   positive_samples: 270
2025-06-24 13:06:26,195 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:06:26,195 - src.training - INFO -   total_samples: 220940
2025-06-24 13:06:26,195 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:06:26,195 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:06:26,195 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:06:26,195 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:06:26,196 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:06:26,196 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:06:26,196 - src.training - INFO - 모델 학습 완료
2025-06-24 13:06:26,196 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:06:26,196 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:26,196 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:26,196 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:26,196 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:26,218 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:06:26,218 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:06:26,678 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = catboost
2025-06-24 13:06:28,642 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:06:28,642 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:06:28,642 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:06:28,642 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:06:28,642 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:06:28,642 - src.training - INFO - 교차 검증 시작
2025-06-24 13:06:28,642 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:06:28,659 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:06:29,137 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:06:29,137 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:06:29,137 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:06:29,137 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:06:29,137 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:06:29,137 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:06:29,137 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:06:29,137 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:06:29,137 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:06:29,303 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:06:29,303 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:06:29,303 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:06:29,303 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:06:30,724 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:06:31,820 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:31,820 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:06:31,826 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:06:31,859 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:06:31,860 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:06:31,860 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:06:31,860 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:33,163 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:33,438 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:06:33,438 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:33,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:33,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:33,648 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:33,648 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:33,648 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:33,648 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:06:33,648 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:33,648 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:33,709 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:06:33,709 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:06:33,709 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:33,709 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:33,709 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:06:33,709 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:06:33,709 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:33,776 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:33,776 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:33,776 - src.training - INFO - 모델 학습 시작
2025-06-24 13:06:33,907 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:06:33,907 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:06:33,907 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:06:33,907 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:06:33,907 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:06:33,907 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:06:33,907 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:06:33,907 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:06:33,907 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:33,907 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:06:33,907 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:06:33,907 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:06:33,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:06:33,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:33,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:33,999 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:34,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:34,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:34,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:34,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:34,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:34,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:06:34,365 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:34,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:06:34,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:34,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:34,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:34,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:34,454 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:34,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:34,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:34,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:34,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:34,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:34,542 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:34,542 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:34,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:06:34,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:34,557 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:34,557 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:34,557 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:06:34,557 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:06:34,557 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:06:34,569 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   iterations: 152
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   learning_rate: 0.022048276389330282
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.875589739406083
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   random_strength: 1.4970066991799396
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   bagging_temperature: 0.8757775932695453
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   border_count: 69
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:06:34,573 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:34,574 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:06:35,837 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:06:35,837 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:06:35,837 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:06:35,837 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:06:35,837 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:06:35,838 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:06:35,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:35,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:35,839 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:35,857 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:35,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:35,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:35,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:35,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:35,944 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:35,947 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:35,947 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:35,949 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:06:35,978 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:06:35,978 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:06:35,978 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:06:35,978 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:06:35,978 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:35,978 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:35,978 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:06:35,978 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:06:35,981 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:06:35,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:06:35,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:06:35,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:06:36,869 - src.training - INFO -   precision: 0.0
2025-06-24 13:06:36,869 - src.training - INFO -   recall: 0.0
2025-06-24 13:06:36,869 - src.training - INFO -   f1: 0.0
2025-06-24 13:06:36,869 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:06:36,869 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:06:36,869 - src.training - INFO -   positive_samples: 270
2025-06-24 13:06:36,869 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:06:36,869 - src.training - INFO -   total_samples: 220940
2025-06-24 13:06:36,869 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:06:36,869 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:06:36,869 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:06:36,869 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:06:36,869 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:06:36,869 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:06:36,869 - src.training - INFO - 모델 학습 완료
2025-06-24 13:06:36,869 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:06:36,869 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:36,869 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:36,869 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:36,869 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:36,890 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:06:36,891 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:06:37,349 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = catboost
2025-06-24 13:06:39,309 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:06:39,309 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:06:39,309 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:06:39,309 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:06:39,309 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:06:39,309 - src.training - INFO - 교차 검증 시작
2025-06-24 13:06:39,309 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:06:39,326 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:06:39,803 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:06:39,803 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:06:39,803 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:06:39,803 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:06:39,803 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:06:39,803 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:06:39,803 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:06:39,803 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:06:39,803 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:06:39,972 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:06:39,972 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:06:39,972 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:06:39,972 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:06:41,392 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:06:42,500 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:42,500 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:06:42,506 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:06:42,538 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:06:42,539 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:06:42,539 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:06:42,539 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:43,852 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:44,131 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:06:44,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:44,300 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:44,300 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:44,343 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:44,343 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:44,344 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:44,344 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:06:44,344 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:44,344 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:44,405 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:06:44,406 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:06:44,406 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:44,406 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:44,406 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:06:44,406 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:06:44,406 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:44,473 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:44,473 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:44,473 - src.training - INFO - 모델 학습 시작
2025-06-24 13:06:44,604 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:06:44,604 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:06:44,604 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:06:44,604 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:06:44,604 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:06:44,604 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:06:44,604 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:06:44,604 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:06:44,604 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:44,604 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:06:44,604 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:06:44,604 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:06:44,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:06:44,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:44,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:44,695 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:44,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:44,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:44,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:44,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:45,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:45,064 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:06:45,064 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:45,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:06:45,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:45,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:45,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:45,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:45,153 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:45,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:45,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:45,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:45,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:45,238 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:45,241 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:45,241 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:45,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:06:45,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:45,255 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:45,255 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:45,256 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:06:45,256 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:06:45,256 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:06:45,270 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   iterations: 55
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   learning_rate: 0.014830613116352804
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.1449164482161045
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   random_strength: 0.8907441545188355
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   bagging_temperature: 0.6572585408647755
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   border_count: 66
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:06:45,273 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:45,274 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:06:46,554 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:06:46,554 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:06:46,554 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:06:46,554 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:06:46,554 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:06:46,555 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:06:46,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:46,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:46,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:46,574 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:46,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:46,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:46,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:46,639 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:46,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:46,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:46,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:46,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:06:46,690 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:06:46,691 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:06:46,691 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:06:46,691 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:06:46,691 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:46,691 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:46,691 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:06:46,691 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:06:46,694 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:06:46,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:06:46,699 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:06:46,699 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:06:47,536 - src.training - INFO -   precision: 0.0
2025-06-24 13:06:47,536 - src.training - INFO -   recall: 0.0
2025-06-24 13:06:47,536 - src.training - INFO -   f1: 0.0
2025-06-24 13:06:47,536 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:06:47,536 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:06:47,536 - src.training - INFO -   positive_samples: 270
2025-06-24 13:06:47,536 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:06:47,536 - src.training - INFO -   total_samples: 220940
2025-06-24 13:06:47,536 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:06:47,536 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:06:47,536 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:06:47,536 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:06:47,536 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:06:47,536 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:06:47,536 - src.training - INFO - 모델 학습 완료
2025-06-24 13:06:47,536 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:06:47,536 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:47,536 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:47,536 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:47,536 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:47,558 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:06:47,558 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:06:48,020 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = catboost
2025-06-24 13:06:49,810 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:06:49,811 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:06:49,811 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:06:49,811 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:06:49,811 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:06:49,811 - src.training - INFO - 교차 검증 시작
2025-06-24 13:06:49,811 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:06:49,827 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:06:50,268 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:06:50,268 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:06:50,268 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:06:50,268 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:06:50,268 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:06:50,268 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:06:50,268 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:06:50,268 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:06:50,268 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:06:50,452 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:06:50,452 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:06:50,452 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:06:50,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:06:51,727 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:06:52,712 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:52,712 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:06:52,718 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:06:52,749 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:06:52,749 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:06:52,749 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:06:52,749 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:06:53,931 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:06:54,185 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:06:54,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:54,345 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:54,345 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:06:54,386 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:06:54,386 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:54,386 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:06:54,386 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:06:54,386 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:54,386 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:54,443 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:06:54,443 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:06:54,443 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:54,443 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:54,443 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:06:54,443 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:06:54,443 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:54,504 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:54,504 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:06:54,504 - src.training - INFO - 모델 학습 시작
2025-06-24 13:06:54,633 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:06:54,633 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:06:54,633 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:06:54,633 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:06:54,633 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:06:54,633 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:06:54,633 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:06:54,633 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:06:54,633 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:54,633 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:06:54,633 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:06:54,633 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:06:54,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:06:54,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:54,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:54,713 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:54,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:54,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:54,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:54,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:55,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:55,045 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:06:55,045 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:06:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:55,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:55,141 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:55,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:55,171 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:55,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:55,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:55,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:55,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:55,221 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:55,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:06:55,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:55,235 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:06:55,235 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:55,235 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:06:55,235 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:06:55,235 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:06:55,249 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   iterations: 99
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   learning_rate: 0.07181559121459598
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.754851755353521
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:06:55,252 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   random_strength: 4.385871701425791
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   bagging_temperature: 0.4920893478382507
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   border_count: 153
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:06:55,253 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:06:56,511 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:06:56,512 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:06:56,512 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:06:56,512 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:06:56,512 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:06:56,512 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:06:56,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:06:56,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:56,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:06:56,530 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:06:56,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:06:56,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:06:56,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:06:56,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:06:56,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:06:56,614 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:06:56,614 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:56,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:06:56,643 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:06:56,644 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:06:56,644 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:06:56,644 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:06:56,644 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:56,644 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:06:56,644 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:06:56,644 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:06:56,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:06:56,651 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:06:56,651 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:06:56,651 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:06:57,399 - src.training - INFO -   precision: 0.0
2025-06-24 13:06:57,399 - src.training - INFO -   recall: 0.0
2025-06-24 13:06:57,399 - src.training - INFO -   f1: 0.0
2025-06-24 13:06:57,399 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:06:57,399 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:06:57,399 - src.training - INFO -   positive_samples: 270
2025-06-24 13:06:57,399 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:06:57,399 - src.training - INFO -   total_samples: 220940
2025-06-24 13:06:57,399 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:06:57,399 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:06:57,399 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:06:57,399 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:06:57,399 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:06:57,399 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:06:57,399 - src.training - INFO - 모델 학습 완료
2025-06-24 13:06:57,399 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:06:57,399 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:57,399 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:57,399 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:06:57,399 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:06:57,422 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:06:57,422 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:06:57,853 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = catboost
2025-06-24 13:06:59,627 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:06:59,627 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:06:59,627 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:06:59,627 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:06:59,627 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:06:59,627 - src.training - INFO - 교차 검증 시작
2025-06-24 13:06:59,627 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:06:59,643 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:07:00,091 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:07:00,091 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:07:00,091 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:07:00,091 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:07:00,091 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:07:00,091 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:07:00,091 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:07:00,091 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:07:00,091 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:07:00,275 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:07:00,275 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:07:00,275 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:07:00,275 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:07:01,562 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:07:02,549 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:02,549 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:07:02,553 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:07:02,585 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:07:02,585 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:07:02,585 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:07:02,585 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:03,766 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:04,022 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:07:04,022 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:04,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:04,182 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:04,222 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:04,223 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:04,223 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:04,223 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:07:04,223 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:04,223 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:04,279 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:07:04,279 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:07:04,279 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:04,279 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:04,279 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:07:04,279 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:07:04,279 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:04,339 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:04,339 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:04,339 - src.training - INFO - 모델 학습 시작
2025-06-24 13:07:04,466 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:07:04,466 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:07:04,466 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:07:04,466 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:07:04,466 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:07:04,466 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:07:04,466 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:07:04,466 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:07:04,466 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:04,466 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:07:04,466 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:07:04,466 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:07:04,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:07:04,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:04,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:04,545 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:04,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:04,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:04,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:04,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:04,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:04,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:07:04,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:04,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:07:04,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:04,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:04,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:04,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:04,979 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:04,993 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:05,009 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:05,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:05,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:05,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:05,059 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:05,059 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:05,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:07:05,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:05,073 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:05,073 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:05,073 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:07:05,073 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:07:05,073 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:07:05,086 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   iterations: 69
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   learning_rate: 0.2499294590495994
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.903985782813161
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   random_strength: 5.949961234966432
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   bagging_temperature: 0.8451022862848669
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   border_count: 199
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:07:05,090 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:05,091 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:07:06,401 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:07:06,401 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:07:06,401 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:07:06,401 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:07:06,401 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:07:06,402 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:07:06,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:06,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:06,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:06,421 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:06,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:06,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:06,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:06,488 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:06,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:06,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:06,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:06,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:07:06,541 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:07:06,542 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:07:06,542 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:07:06,542 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:07:06,542 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:06,542 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:06,542 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:07:06,542 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:07:06,545 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:07:06,549 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:07:06,550 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:07:06,550 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:07:07,342 - src.training - INFO -   precision: 0.0
2025-06-24 13:07:07,342 - src.training - INFO -   recall: 0.0
2025-06-24 13:07:07,342 - src.training - INFO -   f1: 0.0
2025-06-24 13:07:07,342 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:07:07,342 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:07:07,343 - src.training - INFO -   positive_samples: 270
2025-06-24 13:07:07,343 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:07:07,343 - src.training - INFO -   total_samples: 220940
2025-06-24 13:07:07,343 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:07:07,343 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:07:07,343 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:07:07,343 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:07:07,344 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:07:07,344 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:07:07,344 - src.training - INFO - 모델 학습 완료
2025-06-24 13:07:07,344 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:07:07,344 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:07,344 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:07,344 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:07,344 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:07,369 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:07:07,369 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:07:07,798 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = catboost
2025-06-24 13:07:09,576 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:07:09,576 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:07:09,576 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:07:09,576 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:07:09,576 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:07:09,576 - src.training - INFO - 교차 검증 시작
2025-06-24 13:07:09,576 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:07:09,592 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:07:10,034 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:07:10,035 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:07:10,035 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:07:10,035 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:07:10,035 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:07:10,035 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:07:10,035 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:07:10,035 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:07:10,035 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:07:10,218 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:07:10,218 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:07:10,218 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:07:10,218 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:07:11,487 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:07:12,467 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:12,467 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:07:12,472 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:07:12,503 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:07:12,503 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:07:12,503 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:07:12,503 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:13,682 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:13,934 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:07:13,934 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:14,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:14,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:14,135 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:14,135 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:14,135 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:14,135 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:07:14,135 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:14,135 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,192 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:07:14,192 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:07:14,192 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,192 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,192 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:07:14,192 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:07:14,192 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,250 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:14,250 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:14,250 - src.training - INFO - 모델 학습 시작
2025-06-24 13:07:14,376 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:07:14,376 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:07:14,376 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:07:14,376 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:07:14,376 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:07:14,376 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:07:14,376 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:07:14,376 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:07:14,376 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:14,376 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:07:14,376 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:07:14,376 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:07:14,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:07:14,376 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:14,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:14,455 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:14,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:14,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:14,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:14,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:14,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:14,786 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:07:14,787 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:14,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:07:14,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:14,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:14,866 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:14,883 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:14,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:14,912 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:14,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:14,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:14,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:14,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:14,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:14,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:07:14,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,977 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:14,977 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:14,977 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:07:14,977 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:07:14,977 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:07:14,991 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:07:14,994 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   iterations: 296
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   learning_rate: 0.11672906185354659
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   l2_leaf_reg: 9.370085488815526
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   random_strength: 7.270115296721383
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   bagging_temperature: 0.8885199256198286
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   border_count: 228
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:14,995 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:07:16,273 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:07:16,273 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:07:16,273 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:07:16,273 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:07:16,273 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:07:16,274 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:07:16,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:16,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:16,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:16,292 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:16,309 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:16,326 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:16,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:16,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:16,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:16,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:16,382 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:16,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:07:16,412 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:07:16,412 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:07:16,412 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:07:16,412 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:07:16,412 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:16,412 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:16,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:07:16,412 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:07:16,415 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:07:16,419 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:07:16,419 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:07:16,419 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:07:17,164 - src.training - INFO -   precision: 0.0
2025-06-24 13:07:17,164 - src.training - INFO -   recall: 0.0
2025-06-24 13:07:17,164 - src.training - INFO -   f1: 0.0
2025-06-24 13:07:17,164 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:07:17,164 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:07:17,164 - src.training - INFO -   positive_samples: 270
2025-06-24 13:07:17,164 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:07:17,164 - src.training - INFO -   total_samples: 220940
2025-06-24 13:07:17,164 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:07:17,164 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:07:17,164 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:07:17,164 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:07:17,164 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:07:17,165 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:07:17,165 - src.training - INFO - 모델 학습 완료
2025-06-24 13:07:17,165 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:07:17,165 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:17,165 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:17,165 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:17,165 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:17,186 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:07:17,186 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:07:17,620 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = catboost
2025-06-24 13:07:19,447 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:07:19,447 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:07:19,447 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:07:19,447 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:07:19,447 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:07:19,447 - src.training - INFO - 교차 검증 시작
2025-06-24 13:07:19,447 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:07:19,464 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:07:19,910 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:07:19,910 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:07:19,910 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:07:19,910 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:07:19,910 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:07:19,910 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:07:19,910 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:07:19,910 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:07:19,910 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:07:20,096 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:07:20,096 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:07:20,096 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:07:20,096 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:07:21,356 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:07:22,343 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:22,343 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:07:22,349 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:07:22,381 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:07:22,381 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:07:22,381 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:07:22,382 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:23,688 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:23,967 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:07:23,967 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:24,136 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:24,136 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:24,179 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:24,179 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:24,179 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:24,180 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:07:24,180 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:24,180 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:24,241 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:07:24,241 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:07:24,241 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:24,241 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:24,241 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:07:24,241 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:07:24,241 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:24,307 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:24,307 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:24,307 - src.training - INFO - 모델 학습 시작
2025-06-24 13:07:24,437 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:07:24,438 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:07:24,438 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:07:24,438 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:07:24,438 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:07:24,438 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:07:24,438 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:07:24,438 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:07:24,438 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:24,438 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:07:24,438 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:07:24,438 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:07:24,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:07:24,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:24,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:24,530 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:24,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:24,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:24,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:24,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:24,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:24,891 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:07:24,891 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:24,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:07:24,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:24,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:24,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:24,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:24,981 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:24,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:25,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:25,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:25,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:25,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:25,067 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:25,067 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:25,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:07:25,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:25,081 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:25,081 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:25,082 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:07:25,082 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:07:25,082 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:07:25,096 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   iterations: 352
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   learning_rate: 0.0767723897012814
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.61964248902273
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   random_strength: 1.3966784884002232
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   bagging_temperature: 0.1389642194602775
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   border_count: 169
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:07:25,099 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:25,100 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:07:26,378 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:07:26,378 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:07:26,378 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:07:26,379 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:07:26,379 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:07:26,379 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:07:26,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:26,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:26,380 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:26,399 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:26,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:26,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:26,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:26,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:26,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:26,489 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:26,489 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:26,492 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:07:26,519 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:07:26,519 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:07:26,519 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:07:26,519 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:07:26,519 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:26,519 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:26,519 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:07:26,519 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:07:26,522 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:07:26,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:07:26,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:07:26,527 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:07:27,405 - src.training - INFO -   precision: 0.0
2025-06-24 13:07:27,405 - src.training - INFO -   recall: 0.0
2025-06-24 13:07:27,405 - src.training - INFO -   f1: 0.0
2025-06-24 13:07:27,405 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:07:27,405 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:07:27,405 - src.training - INFO -   positive_samples: 270
2025-06-24 13:07:27,405 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:07:27,405 - src.training - INFO -   total_samples: 220940
2025-06-24 13:07:27,405 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:07:27,405 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:07:27,405 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:07:27,405 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:07:27,405 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:07:27,405 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:07:27,405 - src.training - INFO - 모델 학습 완료
2025-06-24 13:07:27,405 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:07:27,405 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:27,405 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:27,405 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:27,405 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:27,427 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:07:27,428 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:07:27,889 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = catboost
2025-06-24 13:07:29,857 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:07:29,857 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:07:29,857 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:07:29,857 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:07:29,857 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:07:29,857 - src.training - INFO - 교차 검증 시작
2025-06-24 13:07:29,857 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:07:29,874 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:07:30,350 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:07:30,350 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:07:30,350 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:07:30,350 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:07:30,350 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:07:30,350 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:07:30,350 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:07:30,350 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:07:30,350 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:07:30,522 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:07:30,522 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:07:30,522 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:07:30,522 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:07:31,922 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:07:33,016 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:33,016 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:07:33,022 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:07:33,054 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:07:33,054 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:07:33,054 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:07:33,054 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:34,372 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:34,650 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:07:34,650 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:34,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:34,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:34,863 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:34,863 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:34,863 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:34,863 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:07:34,863 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:34,863 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:34,925 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:07:34,925 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:07:34,925 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:34,925 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:34,925 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:07:34,925 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:07:34,925 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:34,994 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:34,994 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:34,994 - src.training - INFO - 모델 학습 시작
2025-06-24 13:07:35,126 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:07:35,126 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:07:35,126 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:07:35,126 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:07:35,126 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:07:35,126 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:07:35,126 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:07:35,126 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:07:35,126 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:35,126 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:07:35,126 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:07:35,126 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:07:35,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:07:35,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:35,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:35,220 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:35,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:35,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:35,428 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:35,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:35,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:35,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:07:35,592 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:35,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:07:35,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:35,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:35,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:35,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:35,685 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:35,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:35,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:35,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:35,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:35,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:35,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:35,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:35,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:07:35,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:35,785 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:35,785 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:35,785 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:07:35,785 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:07:35,785 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:07:35,800 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   iterations: 106
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   learning_rate: 0.13786797707373574
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   l2_leaf_reg: 9.324475237903888
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   random_strength: 0.9967470425281176
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   bagging_temperature: 0.642780367497514
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   border_count: 235
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:07:35,803 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:35,804 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:07:37,082 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:07:37,082 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:07:37,082 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:07:37,082 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:07:37,082 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:07:37,083 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:07:37,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:37,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:37,083 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:37,100 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:37,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:37,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:37,147 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:37,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:37,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:37,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:37,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:37,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:07:37,212 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:07:37,212 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:07:37,213 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:07:37,213 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:07:37,213 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:37,213 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:37,213 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:07:37,213 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:07:37,215 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:07:37,219 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:07:37,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:07:37,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:07:38,000 - src.training - INFO -   precision: 0.0
2025-06-24 13:07:38,000 - src.training - INFO -   recall: 0.0
2025-06-24 13:07:38,000 - src.training - INFO -   f1: 0.0
2025-06-24 13:07:38,000 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:07:38,000 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:07:38,000 - src.training - INFO -   positive_samples: 270
2025-06-24 13:07:38,000 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:07:38,000 - src.training - INFO -   total_samples: 220940
2025-06-24 13:07:38,000 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:07:38,000 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:07:38,000 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:07:38,000 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:07:38,000 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:07:38,000 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:07:38,000 - src.training - INFO - 모델 학습 완료
2025-06-24 13:07:38,000 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:07:38,000 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:38,000 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:38,000 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:38,000 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:38,022 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:07:38,022 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:07:38,461 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = catboost
2025-06-24 13:07:40,264 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:07:40,264 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:07:40,264 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:07:40,264 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:07:40,264 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:07:40,264 - src.training - INFO - 교차 검증 시작
2025-06-24 13:07:40,264 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:07:40,280 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:07:40,726 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:07:40,726 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:07:40,726 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:07:40,726 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:07:40,726 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:07:40,726 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:07:40,726 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:07:40,726 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:07:40,726 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:07:40,911 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:07:40,911 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:07:40,911 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:07:40,911 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:07:42,181 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:07:43,172 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:43,172 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:07:43,178 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:07:43,209 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:07:43,209 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:07:43,209 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:07:43,209 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:44,392 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:44,652 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:07:44,652 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:44,812 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:44,812 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:44,853 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:44,853 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:44,853 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:44,853 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:07:44,853 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:44,853 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:44,910 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:07:44,910 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:07:44,910 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:44,910 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:44,910 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:07:44,910 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:07:44,910 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:44,969 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:44,969 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:44,969 - src.training - INFO - 모델 학습 시작
2025-06-24 13:07:45,101 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:07:45,101 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:07:45,101 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:07:45,101 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:07:45,101 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:07:45,101 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:07:45,102 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:07:45,102 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:07:45,102 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:45,102 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:07:45,102 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:07:45,102 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:07:45,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:07:45,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:45,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:45,180 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:45,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:45,300 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:45,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:45,423 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:45,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:45,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:07:45,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:45,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:07:45,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:45,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:45,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:45,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:45,620 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:45,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:45,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:45,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:45,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:45,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:45,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:45,700 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:45,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:07:45,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:45,715 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:45,715 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:45,715 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:07:45,715 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:07:45,715 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:07:45,729 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO -   iterations: 121
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO -   learning_rate: 0.025567921101007324
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO -   l2_leaf_reg: 8.131481134500646
2025-06-24 13:07:45,732 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   random_strength: 0.5619037223604958
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   bagging_temperature: 0.4053700092293643
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   border_count: 151
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:45,733 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:07:47,000 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:07:47,000 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:07:47,000 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:07:47,000 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:07:47,000 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:07:47,000 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:07:47,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:47,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:47,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:47,018 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:47,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:47,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:47,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:47,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:47,098 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:47,101 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:47,101 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:47,104 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:07:47,131 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:07:47,131 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:07:47,131 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:07:47,131 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:07:47,131 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:47,131 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:47,131 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:07:47,131 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:07:47,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:07:47,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:07:47,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:07:47,138 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:07:47,883 - src.training - INFO -   precision: 0.0
2025-06-24 13:07:47,883 - src.training - INFO -   recall: 0.0
2025-06-24 13:07:47,883 - src.training - INFO -   f1: 0.0
2025-06-24 13:07:47,883 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:07:47,883 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:07:47,883 - src.training - INFO -   positive_samples: 270
2025-06-24 13:07:47,883 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:07:47,883 - src.training - INFO -   total_samples: 220940
2025-06-24 13:07:47,883 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:07:47,883 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:07:47,883 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:07:47,883 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:07:47,884 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:07:47,884 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:07:47,884 - src.training - INFO - 모델 학습 완료
2025-06-24 13:07:47,884 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:07:47,884 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:47,884 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:47,884 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:47,884 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:47,906 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:07:47,906 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:07:48,338 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = catboost
2025-06-24 13:07:50,146 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:07:50,146 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:07:50,146 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:07:50,146 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:07:50,146 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:07:50,146 - src.training - INFO - 교차 검증 시작
2025-06-24 13:07:50,146 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:07:50,163 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:07:50,616 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:07:50,616 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:07:50,616 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:07:50,617 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:07:50,617 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:07:50,617 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:07:50,617 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:07:50,617 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:07:50,617 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:07:50,807 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:07:50,807 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:07:50,807 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:07:50,807 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:07:52,097 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:07:53,100 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:53,100 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:07:53,106 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:07:53,137 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:07:53,137 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:07:53,137 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:07:53,137 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:07:54,351 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:07:54,619 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:07:54,619 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:54,785 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:54,785 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:07:54,828 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:07:54,828 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:54,828 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:07:54,828 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:07:54,828 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:54,828 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:54,889 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:07:54,889 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:07:54,889 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:54,889 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:54,889 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:07:54,889 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:07:54,889 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:54,951 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:54,951 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:07:54,951 - src.training - INFO - 모델 학습 시작
2025-06-24 13:07:55,083 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:07:55,084 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:07:55,084 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:07:55,084 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:07:55,084 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:07:55,084 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:07:55,084 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:07:55,084 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:07:55,084 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:55,084 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:07:55,084 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:07:55,084 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:07:55,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:07:55,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:55,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:55,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:55,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:55,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:55,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:55,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:55,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:55,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:07:55,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:55,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:07:55,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:55,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:55,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:55,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:55,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:55,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:55,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:55,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:55,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:55,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:55,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:55,695 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:55,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:07:55,709 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:55,709 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:07:55,709 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:55,709 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:07:55,709 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:07:55,709 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:07:55,724 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   iterations: 187
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   learning_rate: 0.15712541542435687
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.380771515208671
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   random_strength: 7.891375444896646
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   bagging_temperature: 0.45235553746225854
2025-06-24 13:07:55,727 - src.models.catboost_model - INFO -   border_count: 220
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:07:55,728 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:07:57,150 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:07:57,150 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:07:57,150 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:07:57,150 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:07:57,150 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:07:57,151 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:07:57,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:07:57,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:57,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:07:57,169 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:07:57,184 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:07:57,200 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:07:57,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:07:57,232 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:07:57,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:07:57,253 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:07:57,253 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:57,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:07:57,283 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:07:57,283 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:07:57,283 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:07:57,283 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:07:57,283 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:57,283 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:07:57,283 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:07:57,283 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:07:57,286 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:07:57,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:07:57,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:07:57,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:07:58,122 - src.training - INFO -   precision: 0.0
2025-06-24 13:07:58,122 - src.training - INFO -   recall: 0.0
2025-06-24 13:07:58,122 - src.training - INFO -   f1: 0.0
2025-06-24 13:07:58,122 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:07:58,122 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:07:58,122 - src.training - INFO -   positive_samples: 270
2025-06-24 13:07:58,122 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:07:58,122 - src.training - INFO -   total_samples: 220940
2025-06-24 13:07:58,122 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:07:58,122 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:07:58,123 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:07:58,123 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:07:58,123 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:07:58,123 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:07:58,123 - src.training - INFO - 모델 학습 완료
2025-06-24 13:07:58,123 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:07:58,123 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:58,123 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:58,123 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:07:58,123 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:07:58,144 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:07:58,144 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:07:58,591 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = catboost
2025-06-24 13:08:00,400 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:08:00,400 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:08:00,400 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:08:00,400 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:08:00,400 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:08:00,400 - src.training - INFO - 교차 검증 시작
2025-06-24 13:08:00,400 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:08:00,417 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:08:00,878 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:08:00,878 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:08:00,878 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:08:00,878 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:08:00,878 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:08:00,878 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:08:00,878 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:08:00,878 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:08:00,878 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:08:01,070 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:08:01,070 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:08:01,070 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:08:01,070 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:08:02,369 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:08:03,398 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:03,398 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:08:03,404 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:08:03,435 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:08:03,435 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:08:03,435 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:08:03,435 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:04,643 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:04,913 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:08:04,913 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:05,080 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:05,080 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:05,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:05,122 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:05,122 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:05,122 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:08:05,122 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:05,122 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:05,181 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:08:05,181 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:08:05,181 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:05,181 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:05,181 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:08:05,181 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:08:05,181 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:05,243 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:05,243 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:05,243 - src.training - INFO - 모델 학습 시작
2025-06-24 13:08:05,378 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:08:05,378 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:08:05,378 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:08:05,378 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:08:05,378 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:08:05,378 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:08:05,378 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:08:05,378 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:08:05,378 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:05,378 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:08:05,378 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:08:05,378 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:08:05,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:08:05,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:05,379 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:05,463 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:05,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:05,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:05,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:05,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:05,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:05,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:08:05,802 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:05,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:08:05,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:05,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:05,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:05,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:05,903 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:05,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:05,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:05,951 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:05,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:05,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:05,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:05,988 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:06,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:08:06,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:06,002 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:06,002 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:06,002 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:08:06,002 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:08:06,002 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:08:06,017 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   iterations: 430
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   learning_rate: 0.08290363265124806
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0390245777056188
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   random_strength: 0.18268934697131672
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   bagging_temperature: 0.6872651544755416
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   border_count: 237
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:06,021 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:08:07,346 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:08:07,346 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:08:07,346 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:08:07,346 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:08:07,346 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:08:07,347 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:08:07,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:07,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:07,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:07,366 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:07,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:07,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:07,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:07,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:07,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:07,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:07,452 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:07,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:08:07,484 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:08:07,484 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:08:07,484 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:08:07,484 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:08:07,484 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:07,484 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:07,484 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:08:07,484 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:08:07,487 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:08:07,492 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:08:07,492 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:08:07,492 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:08:08,383 - src.training - INFO -   precision: 0.0
2025-06-24 13:08:08,383 - src.training - INFO -   recall: 0.0
2025-06-24 13:08:08,383 - src.training - INFO -   f1: 0.0
2025-06-24 13:08:08,383 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:08:08,383 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:08:08,383 - src.training - INFO -   positive_samples: 270
2025-06-24 13:08:08,383 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:08:08,383 - src.training - INFO -   total_samples: 220940
2025-06-24 13:08:08,383 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:08:08,383 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:08:08,383 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:08:08,383 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:08:08,383 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:08:08,383 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:08:08,383 - src.training - INFO - 모델 학습 완료
2025-06-24 13:08:08,384 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:08:08,384 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:08,384 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:08,384 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:08,384 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:08,406 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:08:08,406 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:08:08,860 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = catboost
2025-06-24 13:08:10,830 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:08:10,830 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:08:10,830 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:08:10,830 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:08:10,830 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:08:10,830 - src.training - INFO - 교차 검증 시작
2025-06-24 13:08:10,830 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:08:10,847 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:08:11,326 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:08:11,326 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:08:11,326 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:08:11,326 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:08:11,326 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:08:11,326 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:08:11,326 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:08:11,326 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:08:11,326 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:08:11,500 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:08:11,500 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:08:11,500 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:08:11,500 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:08:12,888 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:08:13,976 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:13,976 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:08:13,982 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:08:14,015 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:08:14,015 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:08:14,015 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:08:14,015 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:15,323 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:15,600 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:08:15,600 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:15,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:15,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:15,813 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:15,813 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:15,813 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:15,813 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:08:15,813 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:15,813 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:15,876 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:08:15,876 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:08:15,876 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:15,876 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:15,876 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:08:15,876 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:08:15,876 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:15,942 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:15,942 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:15,942 - src.training - INFO - 모델 학습 시작
2025-06-24 13:08:16,075 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:08:16,075 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:08:16,075 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:08:16,075 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:08:16,075 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:08:16,075 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:08:16,075 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:08:16,075 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:08:16,075 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:16,075 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:08:16,075 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:08:16,075 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:08:16,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:08:16,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:16,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:16,166 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:16,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:16,303 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:16,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:16,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:16,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:16,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:08:16,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:16,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:08:16,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:16,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:16,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:16,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:16,633 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:16,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:16,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:16,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:16,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:16,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:16,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:16,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:16,738 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:08:16,738 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:16,738 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:16,738 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:16,738 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:08:16,738 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:08:16,738 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:08:16,751 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   iterations: 145
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   learning_rate: 0.02807411666609635
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.754568788701898
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   random_strength: 0.9245326351704691
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   bagging_temperature: 0.44155111378061973
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   border_count: 99
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:16,755 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:08:18,035 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:08:18,035 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:08:18,035 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:08:18,035 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:08:18,035 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:08:18,036 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:08:18,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:18,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:18,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:18,055 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:18,088 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:18,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:18,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:18,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:18,143 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:18,143 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:18,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:08:18,175 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:08:18,175 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:08:18,175 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:08:18,175 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:08:18,175 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:18,175 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:18,175 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:08:18,175 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:08:18,178 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:08:18,183 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:08:18,183 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:08:18,183 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:08:19,029 - src.training - INFO -   precision: 0.0
2025-06-24 13:08:19,029 - src.training - INFO -   recall: 0.0
2025-06-24 13:08:19,029 - src.training - INFO -   f1: 0.0
2025-06-24 13:08:19,029 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:08:19,029 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:08:19,029 - src.training - INFO -   positive_samples: 270
2025-06-24 13:08:19,029 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:08:19,029 - src.training - INFO -   total_samples: 220940
2025-06-24 13:08:19,029 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:08:19,029 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:08:19,029 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:08:19,029 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:08:19,030 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:08:19,030 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:08:19,030 - src.training - INFO - 모델 학습 완료
2025-06-24 13:08:19,030 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:08:19,030 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:19,030 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:19,030 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:19,030 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:19,051 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:08:19,051 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:08:19,497 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = catboost
2025-06-24 13:08:21,413 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:08:21,413 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:08:21,413 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:08:21,413 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:08:21,413 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:08:21,413 - src.training - INFO - 교차 검증 시작
2025-06-24 13:08:21,413 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:08:21,430 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:08:21,902 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:08:21,902 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:08:21,902 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:08:21,902 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:08:21,902 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:08:21,902 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:08:21,902 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:08:21,902 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:08:21,902 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:08:22,099 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:08:22,099 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:08:22,099 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:08:22,099 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:08:23,434 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:08:24,466 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:24,466 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:08:24,472 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:08:24,504 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:08:24,504 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:08:24,504 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:08:24,504 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:25,742 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:26,030 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:08:26,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:26,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:26,220 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:26,267 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:26,267 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:26,267 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:26,267 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:08:26,268 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:26,268 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:26,330 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:08:26,330 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:08:26,330 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:26,330 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:26,330 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:08:26,330 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:08:26,330 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:26,395 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:26,395 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:26,395 - src.training - INFO - 모델 학습 시작
2025-06-24 13:08:26,537 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:08:26,537 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:08:26,537 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:08:26,537 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:08:26,537 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:08:26,537 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:08:26,537 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:08:26,537 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:08:26,538 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:26,538 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:08:26,538 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:08:26,538 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:08:26,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:08:26,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:26,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:26,624 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:26,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:26,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:26,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:26,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:26,960 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:26,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:08:26,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:27,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:08:27,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:27,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:27,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:27,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:27,089 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:27,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:27,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:27,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:27,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:27,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:27,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:27,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:27,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:08:27,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:27,192 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:27,192 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:27,192 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:08:27,192 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:08:27,192 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:08:27,208 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   iterations: 225
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   learning_rate: 0.0897833366212171
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.9325405248802365
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   random_strength: 2.522872544273569
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   bagging_temperature: 0.6153158272031442
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   border_count: 216
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:08:27,212 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:27,213 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:08:28,911 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:08:28,911 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:08:28,911 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:08:28,911 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:08:28,911 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:08:28,912 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:08:28,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:28,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:28,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:28,934 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:28,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:28,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:28,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:29,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:29,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:29,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:29,027 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:29,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:08:29,058 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:08:29,058 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:08:29,058 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:08:29,058 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:08:29,058 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:29,058 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:29,058 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:08:29,058 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:08:29,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:08:29,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:08:29,067 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:08:29,067 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:08:29,900 - src.training - INFO -   precision: 0.0
2025-06-24 13:08:29,900 - src.training - INFO -   recall: 0.0
2025-06-24 13:08:29,900 - src.training - INFO -   f1: 0.0
2025-06-24 13:08:29,900 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:08:29,900 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:08:29,900 - src.training - INFO -   positive_samples: 270
2025-06-24 13:08:29,901 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:08:29,901 - src.training - INFO -   total_samples: 220940
2025-06-24 13:08:29,901 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:08:29,901 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:08:29,901 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:08:29,901 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:08:29,901 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:08:29,901 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:08:29,901 - src.training - INFO - 모델 학습 완료
2025-06-24 13:08:29,901 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:08:29,901 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:29,901 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:29,901 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:29,901 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:29,924 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:08:29,924 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:08:30,379 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = catboost
2025-06-24 13:08:32,249 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:08:32,249 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:08:32,249 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:08:32,249 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:08:32,249 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:08:32,249 - src.training - INFO - 교차 검증 시작
2025-06-24 13:08:32,249 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:08:32,266 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:08:32,737 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:08:32,738 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:08:32,738 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:08:32,738 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:08:32,738 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:08:32,738 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:08:32,738 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:08:32,738 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:08:32,738 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:08:32,934 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:08:32,934 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:08:32,934 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:08:32,934 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:08:34,220 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:08:35,253 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:35,253 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:08:35,259 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:08:35,292 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:08:35,292 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:08:35,292 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:08:35,292 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:36,639 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:36,932 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:08:36,932 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:37,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:37,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:37,158 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:37,158 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:37,158 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:37,158 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:08:37,158 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:37,158 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:37,220 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:08:37,220 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:08:37,220 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:37,220 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:37,220 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:08:37,220 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:08:37,220 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:37,284 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:37,284 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:37,284 - src.training - INFO - 모델 학습 시작
2025-06-24 13:08:37,424 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:08:37,424 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:08:37,424 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:08:37,424 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:08:37,424 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:08:37,424 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:08:37,424 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:08:37,425 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:08:37,425 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:37,425 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:08:37,425 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:08:37,425 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:08:37,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:08:37,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:37,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:37,510 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:37,573 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:37,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:37,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:37,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:37,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:37,883 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:08:37,883 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:38,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:08:38,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:38,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:38,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:38,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:38,027 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:38,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:38,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:38,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:38,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:38,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:38,151 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:38,152 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:38,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:08:38,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:38,175 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:38,175 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:38,176 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:08:38,176 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:08:38,176 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:08:38,193 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:08:38,198 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   iterations: 70
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   learning_rate: 0.018641530666780034
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.407719464132172
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   random_strength: 0.7828340179879668
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   bagging_temperature: 0.6398372260824768
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   border_count: 180
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:08:38,199 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:08:38,200 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:08:38,201 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:38,201 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:08:38,201 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:38,201 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:08:39,849 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:08:39,849 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:08:39,849 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:08:39,849 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:08:39,849 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:08:39,849 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:08:39,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:39,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:39,850 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:39,874 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:39,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:39,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:39,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:39,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:39,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:39,966 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:39,966 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:39,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:08:39,999 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:08:40,000 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:08:40,000 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:08:40,000 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:08:40,000 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:40,000 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:40,000 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:08:40,000 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:08:40,003 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:08:40,008 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:08:40,008 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:08:40,008 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:08:40,836 - src.training - INFO -   precision: 0.0
2025-06-24 13:08:40,836 - src.training - INFO -   recall: 0.0
2025-06-24 13:08:40,836 - src.training - INFO -   f1: 0.0
2025-06-24 13:08:40,836 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:08:40,836 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:08:40,836 - src.training - INFO -   positive_samples: 270
2025-06-24 13:08:40,836 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:08:40,837 - src.training - INFO -   total_samples: 220940
2025-06-24 13:08:40,837 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:08:40,837 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:08:40,837 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:08:40,837 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:08:40,837 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:08:40,837 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:08:40,837 - src.training - INFO - 모델 학습 완료
2025-06-24 13:08:40,837 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:08:40,837 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:40,837 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:40,837 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:40,837 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:40,860 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:08:40,860 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:08:41,326 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = catboost
2025-06-24 13:08:43,303 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:08:43,303 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:08:43,303 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:08:43,303 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:08:43,303 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:08:43,303 - src.training - INFO - 교차 검증 시작
2025-06-24 13:08:43,303 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:08:43,322 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:08:43,821 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:08:43,821 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:08:43,821 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:08:43,821 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:08:43,821 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:08:43,821 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:08:43,821 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:08:43,821 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:08:43,821 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:08:44,032 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:08:44,032 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:08:44,032 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:08:44,032 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:08:45,351 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:08:46,411 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:46,411 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:08:46,415 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:08:46,449 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:08:46,449 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:08:46,449 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:08:46,449 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:47,694 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:47,972 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:08:47,972 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:48,144 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:48,144 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:48,188 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:48,188 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:48,188 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:48,188 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:08:48,188 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:48,188 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:48,251 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:08:48,251 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:08:48,251 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:48,251 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:48,251 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:08:48,251 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:08:48,251 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:48,317 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:48,317 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:48,317 - src.training - INFO - 모델 학습 시작
2025-06-24 13:08:48,454 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:08:48,454 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:08:48,454 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:08:48,454 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:08:48,454 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:08:48,454 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:08:48,454 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:08:48,454 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:08:48,455 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:48,455 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:08:48,455 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:08:48,455 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:08:48,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:08:48,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:48,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:48,548 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:48,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:48,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:48,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:48,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:48,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:48,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:08:48,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:49,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:08:49,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:49,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:49,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:49,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:49,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:49,042 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:49,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:49,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:49,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:49,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:49,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:49,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:49,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:08:49,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:49,131 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:49,131 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:49,131 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:08:49,131 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:08:49,131 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:08:49,147 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   iterations: 133
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   learning_rate: 0.010674677038524712
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.870941806044729
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   random_strength: 3.374519585880339
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   bagging_temperature: 0.489533439987364
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   border_count: 155
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:08:49,151 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:49,152 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:08:50,800 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:08:50,800 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:08:50,800 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:08:50,800 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:08:50,801 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:08:50,801 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:08:50,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:50,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:50,802 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:50,821 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:50,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:50,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:50,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:50,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:50,906 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:50,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:50,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:50,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:08:50,941 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:08:50,942 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:08:50,942 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:08:50,942 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:08:50,942 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:50,942 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:50,942 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:08:50,942 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:08:50,945 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:08:50,949 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:08:50,949 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:08:50,949 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:08:51,800 - src.training - INFO -   precision: 0.0
2025-06-24 13:08:51,800 - src.training - INFO -   recall: 0.0
2025-06-24 13:08:51,800 - src.training - INFO -   f1: 0.0
2025-06-24 13:08:51,800 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:08:51,800 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:08:51,800 - src.training - INFO -   positive_samples: 270
2025-06-24 13:08:51,800 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:08:51,800 - src.training - INFO -   total_samples: 220940
2025-06-24 13:08:51,800 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:08:51,800 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:08:51,800 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:08:51,800 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:08:51,801 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:08:51,801 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:08:51,801 - src.training - INFO - 모델 학습 완료
2025-06-24 13:08:51,801 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:08:51,801 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:51,801 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:51,801 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:51,801 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:51,823 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:08:51,823 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:08:52,242 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = catboost
2025-06-24 13:08:54,154 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:08:54,154 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:08:54,154 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:08:54,154 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:08:54,154 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:08:54,154 - src.training - INFO - 교차 검증 시작
2025-06-24 13:08:54,154 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:08:54,172 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:08:54,667 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:08:54,667 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:08:54,667 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:08:54,667 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:08:54,667 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:08:54,667 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:08:54,667 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:08:54,667 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:08:54,667 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:08:54,847 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:08:54,847 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:08:54,847 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:08:54,847 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:08:56,161 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:08:57,194 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:57,194 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:08:57,201 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:08:57,238 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:08:57,238 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:08:57,238 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:08:57,238 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:08:58,435 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:08:58,717 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:08:58,717 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:58,884 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:58,884 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:08:58,926 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:08:58,926 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:58,926 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:08:58,926 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:08:58,926 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:58,926 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:08:58,988 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:08:58,988 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:08:58,988 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:58,988 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:58,988 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:08:58,988 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:08:58,988 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:59,051 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:59,052 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:08:59,052 - src.training - INFO - 모델 학습 시작
2025-06-24 13:08:59,188 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:08:59,188 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:08:59,188 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:08:59,188 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:08:59,188 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:08:59,188 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:08:59,188 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:08:59,188 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:08:59,188 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:59,188 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:08:59,188 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:08:59,188 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:08:59,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:08:59,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:59,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:59,273 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:59,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:59,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:59,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:59,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:59,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:59,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:08:59,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:08:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:59,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:08:59,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:59,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:08:59,726 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:08:59,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:08:59,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:08:59,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:08:59,791 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:08:59,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:08:59,812 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:08:59,812 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:08:59,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:08:59,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:59,827 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:08:59,828 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:08:59,828 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:08:59,828 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:08:59,828 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:08:59,842 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   iterations: 141
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   learning_rate: 0.013157010442178
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.9663990857980205
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   random_strength: 3.746541038159191
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   bagging_temperature: 0.35039610179268255
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   border_count: 87
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:08:59,846 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:08:59,847 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:09:01,333 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:09:01,333 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:09:01,333 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:09:01,333 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:09:01,333 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:09:01,333 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:09:01,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:01,333 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:01,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:01,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:01,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:01,386 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:01,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:01,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:01,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:01,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:01,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:01,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:09:01,474 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:09:01,474 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:09:01,474 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:09:01,474 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:09:01,474 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:01,474 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:01,474 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:09:01,474 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:09:01,478 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:09:01,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:09:01,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:09:01,482 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:09:02,311 - src.training - INFO -   precision: 0.0
2025-06-24 13:09:02,311 - src.training - INFO -   recall: 0.0
2025-06-24 13:09:02,311 - src.training - INFO -   f1: 0.0
2025-06-24 13:09:02,311 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:09:02,311 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:09:02,311 - src.training - INFO -   positive_samples: 270
2025-06-24 13:09:02,311 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:09:02,311 - src.training - INFO -   total_samples: 220940
2025-06-24 13:09:02,311 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:09:02,311 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:09:02,311 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:09:02,311 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:09:02,311 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:09:02,311 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:09:02,311 - src.training - INFO - 모델 학습 완료
2025-06-24 13:09:02,311 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:09:02,311 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:02,311 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:02,311 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:02,311 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:02,333 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:09:02,333 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:09:02,754 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = catboost
2025-06-24 13:09:04,759 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:09:04,759 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:09:04,759 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:09:04,759 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:09:04,759 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:09:04,759 - src.training - INFO - 교차 검증 시작
2025-06-24 13:09:04,759 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:09:04,777 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:09:05,275 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:09:05,275 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:09:05,275 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:09:05,275 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:09:05,275 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:09:05,275 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:09:05,275 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:09:05,275 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:09:05,275 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:09:05,482 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:09:05,482 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:09:05,482 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:09:05,482 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:09:06,746 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:09:07,785 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:07,785 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:09:07,791 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:09:07,824 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:09:07,824 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:09:07,824 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:09:07,824 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:09,045 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:09,316 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:09:09,316 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:09,481 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:09,481 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:09,523 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:09,523 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:09,523 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:09,523 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:09:09,523 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:09,523 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:09,583 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:09:09,584 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:09:09,584 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:09,584 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:09,584 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:09:09,584 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:09:09,584 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:09,650 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:09,651 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:09,651 - src.training - INFO - 모델 학습 시작
2025-06-24 13:09:09,780 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:09:09,780 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:09:09,780 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:09:09,780 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:09:09,780 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:09:09,780 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:09:09,780 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:09:09,780 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:09:09,780 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:09,780 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:09:09,780 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:09:09,780 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:09:09,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:09:09,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:09,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:09,874 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:09,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:10,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:10,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:10,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:10,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:10,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:09:10,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:10,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:09:10,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:10,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:10,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:10,323 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:10,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:10,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:10,376 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:10,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:10,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:10,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:10,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:10,432 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:10,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:09:10,447 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:10,447 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:10,447 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:10,447 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:09:10,447 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:09:10,447 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:09:10,461 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   iterations: 81
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   learning_rate: 0.06116705436009082
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   l2_leaf_reg: 6.410315040797983
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   random_strength: 4.196723056026567
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   bagging_temperature: 0.7391005242504494
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   border_count: 248
2025-06-24 13:09:10,464 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:10,465 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:09:11,821 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:09:11,821 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:09:11,821 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:09:11,821 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:09:11,821 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:09:11,821 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:09:11,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:11,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:11,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:11,841 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:11,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:11,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:11,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:11,910 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:11,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:11,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:11,931 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:11,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:09:11,963 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:09:11,963 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:09:11,964 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:09:11,964 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:09:11,964 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:11,964 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:11,964 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:09:11,964 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:09:11,967 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:09:11,971 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:09:11,972 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:09:11,972 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:09:12,791 - src.training - INFO -   precision: 0.0
2025-06-24 13:09:12,791 - src.training - INFO -   recall: 0.0
2025-06-24 13:09:12,791 - src.training - INFO -   f1: 0.0
2025-06-24 13:09:12,791 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:09:12,791 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:09:12,791 - src.training - INFO -   positive_samples: 270
2025-06-24 13:09:12,791 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:09:12,791 - src.training - INFO -   total_samples: 220940
2025-06-24 13:09:12,791 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:09:12,791 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:09:12,791 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:09:12,791 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:09:12,791 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:09:12,791 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:09:12,791 - src.training - INFO - 모델 학습 완료
2025-06-24 13:09:12,791 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:09:12,791 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:12,791 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:12,791 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:12,791 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:12,812 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:09:12,812 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:09:13,234 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = catboost
2025-06-24 13:09:15,194 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:09:15,194 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:09:15,194 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:09:15,194 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:09:15,194 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:09:15,194 - src.training - INFO - 교차 검증 시작
2025-06-24 13:09:15,194 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:09:15,212 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:09:15,689 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:09:15,689 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:09:15,689 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:09:15,689 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:09:15,689 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:09:15,689 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:09:15,689 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:09:15,689 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:09:15,689 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:09:15,860 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:09:15,860 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:09:15,860 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:09:15,860 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:09:17,175 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:09:18,199 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:18,199 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:09:18,203 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:09:18,235 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:09:18,235 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:09:18,235 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:09:18,235 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:19,465 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:19,731 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:09:19,731 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:19,893 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:19,893 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:19,934 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:19,935 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:19,935 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:19,935 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:09:19,935 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:19,935 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:19,995 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:09:19,995 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:09:19,995 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:19,995 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:19,995 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:09:19,995 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:09:19,995 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:20,063 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:20,063 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:20,063 - src.training - INFO - 모델 학습 시작
2025-06-24 13:09:20,193 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:09:20,193 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:09:20,193 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:09:20,193 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:09:20,193 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:09:20,193 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:09:20,193 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:09:20,193 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:09:20,193 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:20,193 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:09:20,193 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:09:20,193 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:09:20,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:09:20,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:20,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:20,285 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:20,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:20,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:20,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:20,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:20,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:20,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:09:20,650 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:20,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:09:20,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:20,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:20,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:20,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:20,742 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:20,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:20,775 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:20,792 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:20,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:20,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:20,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:20,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:09:20,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:20,844 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:20,844 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:20,845 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:09:20,845 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:09:20,845 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:09:20,858 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   iterations: 76
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   depth: 9
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   learning_rate: 0.17575487606581916
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   l2_leaf_reg: 7.859630553526206
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   random_strength: 7.42150379097519
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   bagging_temperature: 0.5693219622482893
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   border_count: 254
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:09:20,862 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:20,863 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:09:22,189 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:09:22,189 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:09:22,189 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:09:22,189 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:09:22,189 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:09:22,189 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:09:22,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:22,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:22,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:22,209 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:22,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:22,241 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:22,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:22,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:22,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:22,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:22,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:22,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:09:22,325 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:09:22,325 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:09:22,325 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:09:22,325 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:09:22,325 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:22,325 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:22,325 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:09:22,325 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:09:22,328 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:09:22,333 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:09:22,333 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:09:22,333 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:09:23,150 - src.training - INFO -   precision: 0.0
2025-06-24 13:09:23,150 - src.training - INFO -   recall: 0.0
2025-06-24 13:09:23,150 - src.training - INFO -   f1: 0.0
2025-06-24 13:09:23,150 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:09:23,150 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:09:23,150 - src.training - INFO -   positive_samples: 270
2025-06-24 13:09:23,150 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:09:23,150 - src.training - INFO -   total_samples: 220940
2025-06-24 13:09:23,150 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:09:23,150 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:09:23,150 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:09:23,150 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:09:23,150 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:09:23,150 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:09:23,150 - src.training - INFO - 모델 학습 완료
2025-06-24 13:09:23,150 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:09:23,150 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:23,150 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:23,150 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:23,150 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:23,171 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:09:23,172 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:09:23,613 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = catboost
2025-06-24 13:09:25,584 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:09:25,584 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:09:25,584 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:09:25,584 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:09:25,584 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:09:25,584 - src.training - INFO - 교차 검증 시작
2025-06-24 13:09:25,584 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:09:25,602 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:09:26,083 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:09:26,083 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:09:26,083 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:09:26,083 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:09:26,083 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:09:26,083 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:09:26,083 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:09:26,083 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:09:26,083 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:09:26,263 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:09:26,263 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:09:26,263 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:09:26,263 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:09:27,584 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:09:28,635 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:28,635 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:09:28,641 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:09:28,673 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:09:28,673 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:09:28,673 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:09:28,673 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:29,906 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:30,178 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:09:30,178 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:30,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:30,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:30,383 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:30,383 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:30,383 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:30,383 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:09:30,383 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:30,383 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:30,446 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:09:30,446 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:09:30,446 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:30,446 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:30,446 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:09:30,446 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:09:30,446 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:30,513 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:30,513 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:30,513 - src.training - INFO - 모델 학습 시작
2025-06-24 13:09:30,646 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:09:30,646 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:09:30,646 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:09:30,646 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:09:30,646 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:09:30,646 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:09:30,646 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:09:30,646 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:09:30,646 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:30,646 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:09:30,646 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:09:30,646 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:09:30,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:09:30,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:30,647 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:30,742 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:30,809 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:30,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:30,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:31,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:31,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:31,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:09:31,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:31,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:09:31,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:31,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:31,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:31,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:31,207 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:31,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:31,240 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:31,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:31,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:31,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:31,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:31,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:31,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:09:31,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:31,312 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:31,312 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:31,313 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:09:31,313 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:09:31,313 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:09:31,325 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   iterations: 113
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   learning_rate: 0.02135045593507221
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4213150911871786
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   random_strength: 7.246244636064738
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   bagging_temperature: 0.2325246925915888
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   border_count: 198
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:09:31,329 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:31,330 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:09:32,636 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:09:32,637 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:09:32,637 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:09:32,637 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:09:32,637 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:09:32,637 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:09:32,637 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:32,637 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:32,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:32,657 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:32,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:32,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:32,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:32,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:32,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:32,746 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:32,746 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:32,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:09:32,778 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:09:32,778 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:09:32,778 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:09:32,778 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:09:32,778 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:32,778 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:32,778 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:09:32,778 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:09:32,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:09:32,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:09:32,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:09:32,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:09:33,609 - src.training - INFO -   precision: 0.0
2025-06-24 13:09:33,609 - src.training - INFO -   recall: 0.0
2025-06-24 13:09:33,610 - src.training - INFO -   f1: 0.0
2025-06-24 13:09:33,610 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:09:33,610 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:09:33,610 - src.training - INFO -   positive_samples: 270
2025-06-24 13:09:33,610 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:09:33,610 - src.training - INFO -   total_samples: 220940
2025-06-24 13:09:33,610 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:09:33,610 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:09:33,610 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:09:33,610 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:09:33,610 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:09:33,610 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:09:33,610 - src.training - INFO - 모델 학습 완료
2025-06-24 13:09:33,610 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:09:33,610 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:33,610 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:33,610 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:33,610 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:33,631 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:09:33,631 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:09:34,049 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = catboost
2025-06-24 13:09:36,017 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:09:36,017 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:09:36,017 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:09:36,017 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:09:36,018 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:09:36,018 - src.training - INFO - 교차 검증 시작
2025-06-24 13:09:36,018 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:09:36,035 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:09:36,517 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:09:36,517 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:09:36,517 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:09:36,517 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:09:36,517 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:09:36,517 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:09:36,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:09:36,517 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:09:36,517 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:09:36,691 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:36,691 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:36,691 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:36,691 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:36,691 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:36,692 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:09:36,692 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:09:36,692 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:09:36,692 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:09:36,692 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:09:38,018 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:09:39,060 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:39,060 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:09:39,066 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:09:39,098 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:09:39,098 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:09:39,098 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:09:39,098 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:40,341 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:40,607 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:09:40,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:40,776 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:40,776 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:40,818 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:40,819 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:40,819 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:40,819 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:09:40,819 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:40,819 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:40,879 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:09:40,880 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:09:40,880 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:40,880 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:40,880 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:09:40,880 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:09:40,880 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:40,948 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:40,948 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:40,948 - src.training - INFO - 모델 학습 시작
2025-06-24 13:09:41,078 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:09:41,079 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:09:41,079 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:09:41,079 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:09:41,079 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:09:41,079 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:09:41,079 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:09:41,079 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:09:41,079 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:41,079 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:09:41,079 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:09:41,079 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:09:41,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:09:41,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:41,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:41,173 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:41,240 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:41,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:41,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:41,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:41,524 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:41,541 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:09:41,541 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:41,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:09:41,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:41,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:41,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:41,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:41,633 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:41,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:41,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:41,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:41,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:41,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:41,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:41,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:41,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:09:41,737 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:41,737 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:41,737 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:41,737 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:09:41,737 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:09:41,737 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:09:41,751 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   iterations: 73
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   learning_rate: 0.028209566053773536
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   l2_leaf_reg: 4.476518439587032
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   random_strength: 1.3332710176934421
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   bagging_temperature: 0.3093855402100751
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   border_count: 159
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:09:41,754 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:41,755 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:09:43,070 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:09:43,070 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:09:43,070 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:09:43,070 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:09:43,070 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:09:43,070 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:09:43,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:43,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:43,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:43,090 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:43,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:43,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:43,138 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:43,155 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:43,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:43,176 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:43,176 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:43,179 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:09:43,209 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:09:43,209 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:09:43,209 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:09:43,209 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:09:43,209 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:43,209 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:43,209 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:09:43,209 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:09:43,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:09:43,216 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:09:43,217 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:09:43,217 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:09:44,082 - src.training - INFO -   precision: 0.0
2025-06-24 13:09:44,082 - src.training - INFO -   recall: 0.0
2025-06-24 13:09:44,082 - src.training - INFO -   f1: 0.0
2025-06-24 13:09:44,082 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:09:44,082 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:09:44,082 - src.training - INFO -   positive_samples: 270
2025-06-24 13:09:44,082 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:09:44,082 - src.training - INFO -   total_samples: 220940
2025-06-24 13:09:44,082 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:09:44,082 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:09:44,082 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:09:44,082 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:09:44,083 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:09:44,083 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:09:44,083 - src.training - INFO - 모델 학습 완료
2025-06-24 13:09:44,083 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:09:44,083 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:44,083 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:44,083 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:44,083 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:44,103 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:09:44,104 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:09:44,525 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = catboost
2025-06-24 13:09:46,506 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:09:46,506 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:09:46,506 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:09:46,506 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:09:46,506 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:09:46,506 - src.training - INFO - 교차 검증 시작
2025-06-24 13:09:46,506 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:09:46,523 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:09:47,007 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:09:47,007 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:09:47,007 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:09:47,007 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:09:47,007 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:09:47,007 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:09:47,007 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:09:47,007 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:09:47,007 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:09:47,183 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:47,183 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:47,183 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:47,183 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:47,183 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:47,183 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:09:47,184 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:09:47,184 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:09:47,184 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:09:47,184 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:09:48,509 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:09:49,555 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:49,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:09:49,558 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:09:49,590 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:09:49,590 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:09:49,590 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:09:49,590 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:50,810 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:51,078 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:09:51,079 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:51,242 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:51,242 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:09:51,284 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:09:51,284 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:51,284 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:09:51,284 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:09:51,284 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:51,284 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:51,345 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:09:51,345 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:09:51,345 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:51,345 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:51,345 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:09:51,345 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:09:51,345 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:51,411 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:51,411 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:09:51,411 - src.training - INFO - 모델 학습 시작
2025-06-24 13:09:51,542 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:09:51,542 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:09:51,542 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:09:51,542 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:09:51,542 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:09:51,542 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:09:51,542 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:09:51,542 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:09:51,542 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:51,542 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:09:51,542 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:09:51,542 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:09:51,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:09:51,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:51,543 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:51,636 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:51,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:51,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:51,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:51,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:51,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:52,004 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:09:52,004 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:52,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:09:52,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:52,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:52,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:52,078 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:52,096 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:52,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:52,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:52,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:52,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:52,182 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:52,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:52,184 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:52,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:09:52,198 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:52,198 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:09:52,198 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:52,199 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:09:52,199 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:09:52,199 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:09:52,212 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:09:52,215 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   iterations: 64
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   depth: 3
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   learning_rate: 0.010257783671818201
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.4695012109074193
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   random_strength: 4.645909554876803
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   bagging_temperature: 0.3421721365693115
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   border_count: 117
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:09:52,216 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:09:53,548 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:09:53,548 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:09:53,548 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:09:53,548 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:09:53,548 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:09:53,549 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:09:53,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:09:53,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:53,549 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:09:53,569 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:09:53,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:09:53,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:09:53,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:09:53,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:09:53,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:09:53,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:09:53,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:53,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:09:53,695 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:09:53,695 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:09:53,695 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:09:53,695 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:09:53,695 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:53,695 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:09:53,695 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:09:53,695 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:09:53,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:09:53,702 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:09:53,703 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:09:53,703 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:09:54,521 - src.training - INFO -   precision: 0.0
2025-06-24 13:09:54,521 - src.training - INFO -   recall: 0.0
2025-06-24 13:09:54,521 - src.training - INFO -   f1: 0.0
2025-06-24 13:09:54,521 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:09:54,521 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:09:54,521 - src.training - INFO -   positive_samples: 270
2025-06-24 13:09:54,521 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:09:54,521 - src.training - INFO -   total_samples: 220940
2025-06-24 13:09:54,521 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:09:54,521 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:09:54,521 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:09:54,521 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:09:54,522 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:09:54,522 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:09:54,522 - src.training - INFO - 모델 학습 완료
2025-06-24 13:09:54,522 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:09:54,522 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:54,522 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:54,522 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:09:54,522 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:09:54,542 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:09:54,542 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:09:54,980 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = catboost
2025-06-24 13:09:56,962 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:09:56,962 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:09:56,962 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:09:56,962 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:09:56,962 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:09:56,962 - src.training - INFO - 교차 검증 시작
2025-06-24 13:09:56,962 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:09:56,979 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:09:57,434 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:09:57,435 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:09:57,435 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:09:57,435 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:09:57,435 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:09:57,435 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:09:57,435 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:09:57,435 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:09:57,435 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:09:57,624 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:09:57,624 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:09:57,624 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:09:57,624 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:09:58,846 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:09:59,836 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:09:59,836 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:09:59,842 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:09:59,873 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:09:59,873 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:09:59,873 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:09:59,873 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:01,038 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:01,301 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:10:01,301 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:01,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:01,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:01,501 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:01,502 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:01,502 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:01,502 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:10:01,502 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:01,502 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:01,561 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:10:01,561 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:10:01,561 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:01,561 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:01,561 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:10:01,561 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:10:01,561 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:01,623 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:01,623 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:01,623 - src.training - INFO - 모델 학습 시작
2025-06-24 13:10:01,752 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:10:01,752 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:10:01,752 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:10:01,752 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:10:01,752 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:10:01,753 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:10:01,753 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:10:01,753 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:10:01,753 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:01,753 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:10:01,753 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:10:01,753 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:10:01,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:10:01,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:01,753 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:01,834 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:01,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:01,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:02,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:02,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:02,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:02,168 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:10:02,168 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:02,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:10:02,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:02,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:02,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:02,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:02,267 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:02,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:02,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:02,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:02,330 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:02,349 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:02,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:02,352 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:02,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:10:02,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:02,366 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:02,366 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:02,366 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:10:02,366 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:10:02,366 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:10:02,380 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   iterations: 443
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   learning_rate: 0.11635352194347451
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.296676074564244
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   random_strength: 0.3621575299240084
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   bagging_temperature: 0.7883047374296045
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   border_count: 250
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:10:02,383 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:02,384 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:10:03,675 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:10:03,675 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:10:03,675 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:10:03,675 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:10:03,675 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:10:03,675 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:10:03,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:03,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:03,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:03,694 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:03,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:03,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:03,748 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:03,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:03,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:03,788 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:03,788 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:03,791 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:10:03,818 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:10:03,818 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:10:03,818 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:10:03,818 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:10:03,818 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:03,819 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:03,819 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:10:03,819 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:10:03,822 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:10:03,826 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:10:03,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:10:03,827 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:10:04,653 - src.training - INFO -   precision: 0.0
2025-06-24 13:10:04,653 - src.training - INFO -   recall: 0.0
2025-06-24 13:10:04,653 - src.training - INFO -   f1: 0.0
2025-06-24 13:10:04,653 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:10:04,653 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:10:04,653 - src.training - INFO -   positive_samples: 270
2025-06-24 13:10:04,653 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:10:04,653 - src.training - INFO -   total_samples: 220940
2025-06-24 13:10:04,653 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:10:04,653 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:10:04,653 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:10:04,653 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:10:04,653 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:10:04,653 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:10:04,653 - src.training - INFO - 모델 학습 완료
2025-06-24 13:10:04,653 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:10:04,653 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:04,653 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:04,653 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:04,653 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:04,675 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:10:04,675 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:10:05,118 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = catboost
2025-06-24 13:10:07,126 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:10:07,126 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:10:07,126 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:10:07,126 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:10:07,126 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:10:07,126 - src.training - INFO - 교차 검증 시작
2025-06-24 13:10:07,126 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:10:07,143 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:10:07,628 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:10:07,628 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:10:07,628 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:10:07,628 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:10:07,628 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:10:07,628 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:10:07,628 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:10:07,628 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:10:07,628 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:10:07,801 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:10:07,801 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:10:07,801 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:10:07,801 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:10:09,139 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:10:10,187 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:10,187 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:10:10,193 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:10:10,225 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:10:10,225 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:10:10,225 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:10:10,225 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:11,467 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:11,735 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:10:11,735 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:11,901 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:11,901 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:11,944 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:11,944 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:11,944 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:11,944 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:10:11,944 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:11,944 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,005 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:10:12,005 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:10:12,005 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,005 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,005 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:10:12,005 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:10:12,005 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,072 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:12,072 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:12,072 - src.training - INFO - 모델 학습 시작
2025-06-24 13:10:12,203 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:10:12,203 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:10:12,203 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:10:12,203 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:10:12,203 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:10:12,203 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:10:12,203 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:10:12,203 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:10:12,203 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:12,203 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:10:12,203 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:10:12,203 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:10:12,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:10:12,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:12,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:12,294 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:12,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:12,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:12,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:12,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:12,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:12,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:10:12,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:12,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:10:12,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:12,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:12,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:12,755 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:12,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:12,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:12,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:12,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:12,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:12,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:12,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:12,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:10:12,858 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,858 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:12,858 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:12,859 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:10:12,859 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:10:12,859 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:10:12,872 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   iterations: 73
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   learning_rate: 0.01519677377716648
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.66143470058664
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   random_strength: 8.064488433079093
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   bagging_temperature: 0.3414852469274745
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   border_count: 163
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:10:12,876 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:12,877 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:10:12,877 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:12,877 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:10:14,249 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:10:14,249 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:10:14,249 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:10:14,249 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:10:14,249 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:10:14,249 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:10:14,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:14,249 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:14,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:14,269 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:14,285 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:14,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:14,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:14,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:14,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:14,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:14,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:14,357 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:10:14,386 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:10:14,387 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:10:14,387 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:10:14,387 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:10:14,387 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:14,387 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:14,387 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:10:14,387 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:10:14,390 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:10:14,394 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:10:14,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:10:14,395 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:10:15,218 - src.training - INFO -   precision: 0.0
2025-06-24 13:10:15,218 - src.training - INFO -   recall: 0.0
2025-06-24 13:10:15,218 - src.training - INFO -   f1: 0.0
2025-06-24 13:10:15,218 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:10:15,218 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:10:15,218 - src.training - INFO -   positive_samples: 270
2025-06-24 13:10:15,218 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:10:15,218 - src.training - INFO -   total_samples: 220940
2025-06-24 13:10:15,218 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:10:15,218 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:10:15,218 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:10:15,218 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:10:15,218 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:10:15,218 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:10:15,218 - src.training - INFO - 모델 학습 완료
2025-06-24 13:10:15,218 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:10:15,218 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:15,218 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:15,218 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:15,218 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:15,239 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:10:15,239 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:10:15,678 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = catboost
2025-06-24 13:10:17,657 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:10:17,658 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:10:17,658 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:10:17,658 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:10:17,658 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:10:17,658 - src.training - INFO - 교차 검증 시작
2025-06-24 13:10:17,658 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:10:17,675 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:10:18,153 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:10:18,153 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:10:18,153 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:10:18,153 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:10:18,153 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:10:18,153 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:10:18,153 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:10:18,153 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:10:18,153 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:10:18,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:18,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:18,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:18,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:18,329 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:18,329 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:10:18,329 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:10:18,329 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:10:18,329 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:10:18,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:10:19,672 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:10:20,717 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:20,717 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:10:20,723 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:10:20,755 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:10:20,756 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:10:20,756 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:10:20,756 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:21,979 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:22,244 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:10:22,244 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:22,406 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:22,406 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:22,448 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:22,448 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:22,448 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:22,448 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:10:22,448 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:22,449 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:22,509 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:10:22,509 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:10:22,509 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:22,509 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:22,509 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:10:22,509 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:10:22,509 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:22,577 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:22,577 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:22,577 - src.training - INFO - 모델 학습 시작
2025-06-24 13:10:22,707 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:10:22,707 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:10:22,708 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:10:22,708 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:10:22,708 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:10:22,708 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:10:22,708 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:10:22,708 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:10:22,708 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:22,708 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:10:22,708 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:10:22,708 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:10:22,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:10:22,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:22,708 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:22,797 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:22,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:22,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:23,000 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:23,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:23,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:23,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:10:23,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:23,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:10:23,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:23,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:23,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:23,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:23,255 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:23,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:23,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:23,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:23,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:23,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:23,344 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:23,344 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:23,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:10:23,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:23,358 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:23,358 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:23,358 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:10:23,358 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:10:23,358 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:10:23,372 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   iterations: 112
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   learning_rate: 0.08347693285071893
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.8428285993066549
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   random_strength: 0.821984014976741
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   bagging_temperature: 0.33707244274429676
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   border_count: 186
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:10:23,376 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:10:23,377 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:10:23,377 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:23,377 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:10:23,377 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:23,377 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:10:24,630 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:10:24,630 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:10:24,630 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:10:24,630 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:10:24,630 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:10:24,630 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:10:24,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:24,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:24,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:24,649 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:24,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:24,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:24,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:24,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:24,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:24,736 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:24,736 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:24,739 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:10:24,768 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:10:24,768 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:10:24,768 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:10:24,768 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:10:24,768 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:24,768 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:24,768 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:10:24,768 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:10:24,772 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:10:24,776 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:10:24,776 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:10:24,776 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:10:25,599 - src.training - INFO -   precision: 0.0
2025-06-24 13:10:25,599 - src.training - INFO -   recall: 0.0
2025-06-24 13:10:25,599 - src.training - INFO -   f1: 0.0
2025-06-24 13:10:25,599 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:10:25,599 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:10:25,599 - src.training - INFO -   positive_samples: 270
2025-06-24 13:10:25,599 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:10:25,599 - src.training - INFO -   total_samples: 220940
2025-06-24 13:10:25,599 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:10:25,599 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:10:25,599 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:10:25,599 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:10:25,599 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:10:25,599 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:10:25,599 - src.training - INFO - 모델 학습 완료
2025-06-24 13:10:25,600 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:10:25,600 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:25,600 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:25,600 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:25,600 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:25,620 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:10:25,620 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:10:26,063 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = catboost
2025-06-24 13:10:28,033 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:10:28,033 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:10:28,033 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:10:28,033 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:10:28,033 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:10:28,033 - src.training - INFO - 교차 검증 시작
2025-06-24 13:10:28,033 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:10:28,050 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:10:28,533 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:10:28,533 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:10:28,533 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:10:28,533 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:10:28,534 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:10:28,534 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:10:28,534 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:10:28,534 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:10:28,534 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:10:28,708 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:28,708 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:28,708 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:28,708 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:28,708 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:28,709 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:10:28,709 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:10:28,709 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:10:28,709 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:10:28,709 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:10:30,041 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:10:31,089 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:31,090 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:10:31,096 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:10:31,127 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:10:31,127 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:10:31,127 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:10:31,127 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:32,366 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:32,644 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:10:32,644 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:32,807 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:32,807 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:32,849 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:32,849 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:32,849 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:32,849 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:10:32,849 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:32,849 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:32,910 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:10:32,910 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:10:32,910 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:32,910 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:32,910 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:10:32,910 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:10:32,910 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:32,976 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:32,976 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:32,976 - src.training - INFO - 모델 학습 시작
2025-06-24 13:10:33,110 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:10:33,110 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:10:33,110 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:10:33,110 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:10:33,110 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:10:33,110 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:10:33,110 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:10:33,110 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:10:33,110 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:33,110 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:10:33,110 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:10:33,110 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:10:33,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:10:33,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:33,110 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:33,202 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:33,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:33,340 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:33,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:33,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:33,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:33,571 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:10:33,572 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:33,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:10:33,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:33,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:33,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:33,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:33,663 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:33,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:33,697 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:33,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:33,731 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:33,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:33,752 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:33,752 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:33,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:10:33,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:33,767 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:33,767 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:33,767 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:10:33,767 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:10:33,767 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:10:33,781 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   iterations: 266
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   learning_rate: 0.054832499767336826
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0378025629129926
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   random_strength: 8.009784561759998
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   bagging_temperature: 0.2708945091650011
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   border_count: 166
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:10:33,785 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:10:33,786 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:33,786 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:10:33,786 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:33,786 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:10:35,075 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:10:35,075 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:10:35,075 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:10:35,075 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:10:35,075 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:10:35,076 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:10:35,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:35,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:35,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:35,094 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:35,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:35,125 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:35,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:35,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:35,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:35,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:35,179 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:35,183 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:10:35,209 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:10:35,209 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:10:35,209 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:10:35,209 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:10:35,209 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:35,209 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:35,209 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:10:35,209 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:10:35,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:10:35,216 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:10:35,217 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:10:35,217 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:10:35,999 - src.training - INFO -   precision: 0.0
2025-06-24 13:10:35,999 - src.training - INFO -   recall: 0.0
2025-06-24 13:10:35,999 - src.training - INFO -   f1: 0.0
2025-06-24 13:10:35,999 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:10:35,999 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:10:35,999 - src.training - INFO -   positive_samples: 270
2025-06-24 13:10:35,999 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:10:36,000 - src.training - INFO -   total_samples: 220940
2025-06-24 13:10:36,000 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:10:36,000 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:10:36,000 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:10:36,000 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:10:36,000 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:10:36,000 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:10:36,000 - src.training - INFO - 모델 학습 완료
2025-06-24 13:10:36,000 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:10:36,000 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:36,000 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:36,000 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:36,000 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:36,022 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:10:36,022 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:10:36,434 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = catboost
2025-06-24 13:10:38,259 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:10:38,259 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:10:38,259 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:10:38,259 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:10:38,259 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:10:38,259 - src.training - INFO - 교차 검증 시작
2025-06-24 13:10:38,259 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:10:38,277 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:10:38,735 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:10:38,735 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:10:38,735 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:10:38,735 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:10:38,735 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:10:38,735 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:10:38,735 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:10:38,735 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:10:38,735 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:10:38,928 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:10:38,928 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:10:38,928 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:10:38,928 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:10:40,173 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:10:41,126 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:41,126 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:10:41,134 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:10:41,165 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:10:41,165 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:10:41,165 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:10:41,165 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:42,344 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:42,601 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:10:42,601 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:42,762 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:42,762 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:42,803 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:42,803 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:42,803 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:42,803 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:10:42,803 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:42,803 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:42,862 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:10:42,862 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:10:42,862 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:42,862 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:42,862 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:10:42,862 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:10:42,862 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:42,925 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:42,925 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:42,925 - src.training - INFO - 모델 학습 시작
2025-06-24 13:10:43,057 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:10:43,057 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:10:43,057 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:10:43,057 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:10:43,057 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:10:43,057 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:10:43,057 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:10:43,057 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:10:43,057 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:43,057 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:10:43,057 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:10:43,057 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:10:43,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:10:43,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:43,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:43,139 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:43,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:43,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:43,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:43,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:43,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:43,483 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:10:43,483 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:43,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:10:43,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:43,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:43,565 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:43,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:43,583 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:43,599 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:43,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:43,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:43,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:43,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:43,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:43,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:43,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:10:43,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:43,682 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:43,682 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:43,682 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:10:43,682 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:10:43,682 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:10:43,696 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   iterations: 220
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   depth: 5
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   learning_rate: 0.22138872561355
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0265300401418815
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   random_strength: 8.174643184363584
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   bagging_temperature: 0.16803028909699283
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   border_count: 190
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:43,700 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:10:43,701 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:43,701 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:10:44,958 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:10:44,958 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:10:44,958 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:10:44,958 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:10:44,958 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:10:44,959 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:10:44,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:44,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:44,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:44,978 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:44,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:45,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:45,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:45,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:45,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:45,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:45,068 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:45,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:10:45,100 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:10:45,101 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:10:45,101 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:10:45,101 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:10:45,101 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:45,101 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:45,101 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:10:45,101 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:10:45,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:10:45,108 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:10:45,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:10:45,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:10:45,936 - src.training - INFO -   precision: 0.0
2025-06-24 13:10:45,936 - src.training - INFO -   recall: 0.0
2025-06-24 13:10:45,936 - src.training - INFO -   f1: 0.0
2025-06-24 13:10:45,936 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:10:45,936 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:10:45,936 - src.training - INFO -   positive_samples: 270
2025-06-24 13:10:45,936 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:10:45,936 - src.training - INFO -   total_samples: 220940
2025-06-24 13:10:45,936 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:10:45,936 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:10:45,936 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:10:45,936 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:10:45,936 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:10:45,936 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:10:45,936 - src.training - INFO - 모델 학습 완료
2025-06-24 13:10:45,936 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:10:45,936 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:45,936 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:45,936 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:45,936 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:45,958 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:10:45,958 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:10:46,384 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = catboost
2025-06-24 13:10:48,341 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:10:48,341 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:10:48,341 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:10:48,341 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:10:48,341 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:10:48,341 - src.training - INFO - 교차 검증 시작
2025-06-24 13:10:48,341 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:10:48,358 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:10:48,833 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:10:48,833 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:10:48,833 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:10:48,833 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:10:48,833 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:10:48,833 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:10:48,833 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:10:48,833 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:10:48,833 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:10:49,006 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:10:49,006 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:10:49,006 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:10:49,006 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:10:50,348 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:10:51,395 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:51,395 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:10:51,404 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:10:51,435 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:10:51,435 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:10:51,435 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:10:51,435 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:52,687 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:10:52,967 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:10:52,967 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:53,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:53,129 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:10:53,171 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:10:53,171 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:53,171 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:10:53,171 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:10:53,171 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:53,171 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:53,232 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:10:53,232 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:10:53,232 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:53,232 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:53,232 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:10:53,232 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:10:53,232 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:53,299 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:53,299 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:10:53,299 - src.training - INFO - 모델 학습 시작
2025-06-24 13:10:53,430 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:10:53,430 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:10:53,430 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:10:53,430 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:10:53,430 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:10:53,430 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:10:53,430 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:10:53,431 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:10:53,431 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:53,431 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:10:53,431 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:10:53,431 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:10:53,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:10:53,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:53,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:53,523 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:53,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:53,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:53,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:53,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:53,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:53,891 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:10:53,891 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:53,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:10:53,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:53,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:53,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:53,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:53,981 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:53,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:54,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:54,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:54,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:54,067 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:54,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:54,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:54,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:10:54,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:54,084 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:10:54,084 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:54,085 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:10:54,085 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:10:54,085 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:10:54,099 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   iterations: 115
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   depth: 8
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   learning_rate: 0.040724615232906186
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.1012265211019487
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:10:54,102 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   random_strength: 5.30230296923763
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   bagging_temperature: 0.17717813422840684
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   border_count: 237
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:10:54,103 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:10:55,370 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:10:55,370 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:10:55,370 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:10:55,370 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:10:55,370 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:10:55,371 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:10:55,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:10:55,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:55,372 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:10:55,392 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:10:55,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:10:55,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:10:55,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:10:55,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:10:55,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:10:55,478 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:10:55,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:55,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:10:55,508 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:10:55,509 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:10:55,509 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:10:55,509 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:10:55,509 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:55,509 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:10:55,509 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:10:55,509 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:10:55,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:10:55,516 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:10:55,516 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:10:55,516 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:10:56,251 - src.training - INFO -   precision: 0.0
2025-06-24 13:10:56,251 - src.training - INFO -   recall: 0.0
2025-06-24 13:10:56,251 - src.training - INFO -   f1: 0.0
2025-06-24 13:10:56,251 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:10:56,251 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:10:56,251 - src.training - INFO -   positive_samples: 270
2025-06-24 13:10:56,251 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:10:56,251 - src.training - INFO -   total_samples: 220940
2025-06-24 13:10:56,251 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:10:56,251 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:10:56,251 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:10:56,251 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:10:56,251 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:10:56,251 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:10:56,251 - src.training - INFO - 모델 학습 완료
2025-06-24 13:10:56,251 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:10:56,251 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:56,251 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:56,251 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:10:56,251 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:10:56,272 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:10:56,273 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:10:56,690 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = catboost
2025-06-24 13:10:58,482 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:10:58,482 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:10:58,482 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:10:58,482 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:10:58,482 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:10:58,482 - src.training - INFO - 교차 검증 시작
2025-06-24 13:10:58,482 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:10:58,497 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:10:58,950 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:10:58,950 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:10:58,950 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:10:58,950 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:10:58,950 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:10:58,950 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:10:58,950 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:10:58,950 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:10:58,951 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:10:59,145 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:10:59,145 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:10:59,145 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:10:59,145 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:11:00,372 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:11:01,319 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:01,319 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:11:01,327 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:11:01,357 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:11:01,357 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:11:01,357 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:11:01,357 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:02,514 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:02,779 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:11:02,779 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:02,934 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:02,934 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:02,974 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:02,975 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:02,975 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:02,975 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:11:02,975 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:02,975 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,034 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:11:03,034 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:11:03,034 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,034 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,034 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:11:03,034 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:11:03,034 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,095 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:03,095 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:03,095 - src.training - INFO - 모델 학습 시작
2025-06-24 13:11:03,227 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:11:03,227 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:11:03,227 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:11:03,227 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:11:03,227 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:11:03,227 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:11:03,227 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:11:03,227 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:11:03,227 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:03,227 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:11:03,227 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:11:03,227 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:11:03,227 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:11:03,227 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:03,227 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:03,307 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:03,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:03,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:03,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:03,559 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:03,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:03,651 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:11:03,651 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:03,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:11:03,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:03,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:03,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:03,748 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:03,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:03,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:03,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:03,809 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:03,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:03,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:03,830 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:03,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:11:03,844 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,844 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:03,844 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:03,844 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:11:03,844 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:11:03,844 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:11:03,858 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   iterations: 260
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   depth: 10
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   learning_rate: 0.12735063500773222
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   l2_leaf_reg: 5.8620203374364985
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   random_strength: 0.16977132395641356
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   bagging_temperature: 0.36151398035279686
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   border_count: 51
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:11:03,862 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:03,863 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:11:05,185 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:11:05,185 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:11:05,185 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:11:05,185 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:11:05,185 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:11:05,186 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:11:05,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:05,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:05,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:05,205 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:05,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:05,239 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:05,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:05,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:05,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:05,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:05,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:05,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:11:05,325 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:11:05,326 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:11:05,326 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:11:05,326 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:11:05,326 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:05,326 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:05,326 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:11:05,326 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:11:05,329 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:11:05,333 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:11:05,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:11:05,334 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:11:06,153 - src.training - INFO -   precision: 0.0
2025-06-24 13:11:06,153 - src.training - INFO -   recall: 0.0
2025-06-24 13:11:06,153 - src.training - INFO -   f1: 0.0
2025-06-24 13:11:06,153 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:11:06,153 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:11:06,153 - src.training - INFO -   positive_samples: 270
2025-06-24 13:11:06,153 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:11:06,153 - src.training - INFO -   total_samples: 220940
2025-06-24 13:11:06,153 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:11:06,153 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:11:06,153 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:11:06,153 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:11:06,153 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:11:06,153 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:11:06,153 - src.training - INFO - 모델 학습 완료
2025-06-24 13:11:06,153 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:11:06,153 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:06,153 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:06,153 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:06,153 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:06,175 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:11:06,175 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:11:06,612 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = catboost
2025-06-24 13:11:08,600 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:11:08,601 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:11:08,601 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:11:08,601 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:11:08,601 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:11:08,601 - src.training - INFO - 교차 검증 시작
2025-06-24 13:11:08,601 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:11:08,618 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:11:09,092 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:11:09,092 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:11:09,092 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:11:09,092 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:11:09,092 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:11:09,092 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:11:09,092 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:11:09,092 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:11:09,092 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:11:09,264 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:11:09,264 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:11:09,264 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:11:09,264 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:11:10,607 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:11:11,664 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:11,664 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:11:11,673 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:11:11,704 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:11:11,704 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:11:11,704 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:11:11,704 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:12,964 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:13,234 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:11:13,234 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:13,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:13,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:13,438 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:13,438 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:13,438 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:13,438 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:11:13,438 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:13,438 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:13,500 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:11:13,500 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:11:13,500 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:13,500 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:13,500 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:11:13,500 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:11:13,500 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:13,567 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:13,567 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:13,567 - src.training - INFO - 모델 학습 시작
2025-06-24 13:11:13,699 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:11:13,699 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:11:13,699 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:11:13,699 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:11:13,699 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:11:13,699 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:11:13,699 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:11:13,699 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:11:13,699 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:13,699 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:11:13,699 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:11:13,699 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:11:13,699 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:11:13,699 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:13,700 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:13,791 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:13,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:13,929 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:13,994 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:14,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:14,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:14,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:11:14,159 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:14,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:11:14,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:14,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:14,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:14,231 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:14,249 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:14,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:14,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:14,299 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:14,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:14,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:14,337 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:14,337 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:14,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:11:14,352 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:14,352 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:14,352 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:14,352 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:11:14,352 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:11:14,352 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:11:14,366 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   iterations: 302
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   depth: 4
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   learning_rate: 0.08862302002574038
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   l2_leaf_reg: 2.788288462283964
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   random_strength: 7.873995134724547
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   bagging_temperature: 0.7665945933124059
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   border_count: 38
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:14,370 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:11:14,371 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:14,371 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:11:15,619 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:11:15,619 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:11:15,619 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:11:15,619 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:11:15,619 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:11:15,620 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:11:15,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:15,620 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:15,621 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:15,639 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:15,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:15,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:15,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:15,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:15,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:15,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:15,729 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:15,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:11:15,760 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:11:15,760 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:11:15,760 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:11:15,760 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:11:15,760 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:15,760 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:15,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:11:15,760 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:11:15,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:11:15,768 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:11:15,768 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:11:15,768 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:11:16,589 - src.training - INFO -   precision: 0.0
2025-06-24 13:11:16,589 - src.training - INFO -   recall: 0.0
2025-06-24 13:11:16,589 - src.training - INFO -   f1: 0.0
2025-06-24 13:11:16,589 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:11:16,589 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:11:16,589 - src.training - INFO -   positive_samples: 270
2025-06-24 13:11:16,589 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:11:16,589 - src.training - INFO -   total_samples: 220940
2025-06-24 13:11:16,589 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:11:16,589 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:11:16,589 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:11:16,589 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:11:16,590 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:11:16,590 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:11:16,590 - src.training - INFO - 모델 학습 완료
2025-06-24 13:11:16,590 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:11:16,590 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:16,590 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:16,590 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:16,590 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:16,611 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:11:16,611 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:11:17,042 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = catboost
2025-06-24 13:11:19,010 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:11:19,010 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:11:19,010 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:11:19,010 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:11:19,010 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:11:19,010 - src.training - INFO - 교차 검증 시작
2025-06-24 13:11:19,010 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:11:19,027 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:11:19,503 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:11:19,503 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:11:19,503 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:11:19,503 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:11:19,503 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:11:19,503 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:11:19,503 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:11:19,503 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:11:19,503 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:11:19,676 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:11:19,676 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:11:19,676 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:11:19,676 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:11:21,014 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:11:22,065 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:22,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:11:22,071 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:11:22,103 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:11:22,103 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:11:22,103 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:11:22,103 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:23,363 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:23,640 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:11:23,640 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:23,804 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:23,804 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:23,846 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:23,846 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:23,846 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:23,846 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:11:23,846 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:23,846 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:23,907 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:11:23,907 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:11:23,907 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:23,907 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:23,907 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:11:23,907 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:11:23,907 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:23,975 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:23,975 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:23,975 - src.training - INFO - 모델 학습 시작
2025-06-24 13:11:24,107 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:11:24,107 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:11:24,107 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:11:24,107 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:11:24,107 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:11:24,107 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:11:24,107 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:11:24,107 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:11:24,107 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:24,107 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:11:24,107 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:11:24,107 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:11:24,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:11:24,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:24,107 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:24,197 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:24,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:24,334 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:24,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:24,468 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:24,548 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:24,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:11:24,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:24,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:11:24,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:24,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:24,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:24,635 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:24,654 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:24,670 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:24,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:24,703 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:24,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:24,739 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:24,742 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:24,742 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:24,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:11:24,757 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:24,757 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:24,757 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:24,757 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:11:24,757 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:11:24,757 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:11:24,772 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   iterations: 234
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   learning_rate: 0.026734435640532808
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   l2_leaf_reg: 3.650791872130647
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   random_strength: 1.7871515595329295
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   bagging_temperature: 0.3747108907729261
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   border_count: 159
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:11:24,775 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:24,776 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:11:26,015 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:11:26,015 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:11:26,015 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:11:26,015 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:11:26,015 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:11:26,015 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:11:26,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:26,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:26,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:26,035 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:26,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:26,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:26,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:26,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:26,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:26,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:26,122 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:26,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:11:26,153 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:11:26,153 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:11:26,153 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:11:26,153 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:11:26,153 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:26,153 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:26,153 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:11:26,153 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:11:26,156 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:11:26,161 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:11:26,161 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:11:26,161 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:11:26,981 - src.training - INFO -   precision: 0.0
2025-06-24 13:11:26,981 - src.training - INFO -   recall: 0.0
2025-06-24 13:11:26,981 - src.training - INFO -   f1: 0.0
2025-06-24 13:11:26,981 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:11:26,982 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:11:26,982 - src.training - INFO -   positive_samples: 270
2025-06-24 13:11:26,982 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:11:26,982 - src.training - INFO -   total_samples: 220940
2025-06-24 13:11:26,982 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:11:26,982 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:11:26,982 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:11:26,982 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:11:26,982 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:11:26,982 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:11:26,982 - src.training - INFO - 모델 학습 완료
2025-06-24 13:11:26,982 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:11:26,982 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:26,982 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:26,982 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:26,982 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:27,003 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:11:27,003 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:11:27,440 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = catboost
2025-06-24 13:11:29,435 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:11:29,435 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:11:29,435 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:11:29,435 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:11:29,435 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:11:29,435 - src.training - INFO - 교차 검증 시작
2025-06-24 13:11:29,435 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:11:29,453 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:11:29,928 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:11:29,928 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:11:29,928 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:11:29,928 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:11:29,928 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:11:29,928 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:11:29,928 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:11:29,928 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:11:29,928 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:11:30,102 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:11:30,102 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:11:30,102 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:11:30,102 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:11:31,451 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:11:32,504 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:32,504 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:11:32,513 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:11:32,545 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:11:32,545 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:11:32,545 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:11:32,545 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:33,812 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:34,085 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:11:34,085 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:34,248 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:34,248 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:34,289 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:34,290 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:34,290 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:34,290 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:11:34,290 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:34,290 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:34,350 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:11:34,351 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:11:34,351 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:34,351 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:34,351 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:11:34,351 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:11:34,351 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:34,418 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:34,418 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:34,418 - src.training - INFO - 모델 학습 시작
2025-06-24 13:11:34,550 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:11:34,550 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:11:34,550 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:11:34,550 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:11:34,550 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:11:34,550 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:11:34,550 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:11:34,550 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:11:34,550 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:34,550 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:11:34,550 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:11:34,550 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:11:34,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:11:34,550 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:34,551 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:34,641 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:34,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:34,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:34,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:34,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:35,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:35,020 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:11:35,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:35,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:11:35,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:35,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:35,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:35,091 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:35,110 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:35,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:35,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:35,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:35,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:35,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:35,198 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:35,198 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:35,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:11:35,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:35,212 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:35,212 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:35,213 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:11:35,213 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:11:35,213 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:11:35,227 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   iterations: 177
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   learning_rate: 0.08694111026806872
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.8580985100865528
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   random_strength: 9.58765042065965
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   bagging_temperature: 0.2980745440336861
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   border_count: 247
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:11:35,231 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:35,232 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:11:36,533 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:11:36,533 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:11:36,533 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:11:36,533 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:11:36,533 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:11:36,533 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:11:36,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:36,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:36,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:36,551 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:36,566 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:36,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:36,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:36,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:36,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:36,633 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:36,633 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:36,636 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:11:36,662 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:11:36,663 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:11:36,663 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:11:36,663 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:11:36,663 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:36,663 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:36,663 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:11:36,663 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:11:36,666 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:11:36,670 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:11:36,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:11:36,671 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:11:37,421 - src.training - INFO -   precision: 0.0
2025-06-24 13:11:37,421 - src.training - INFO -   recall: 0.0
2025-06-24 13:11:37,421 - src.training - INFO -   f1: 0.0
2025-06-24 13:11:37,421 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:11:37,421 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:11:37,421 - src.training - INFO -   positive_samples: 270
2025-06-24 13:11:37,421 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:11:37,421 - src.training - INFO -   total_samples: 220940
2025-06-24 13:11:37,421 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:11:37,421 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:11:37,421 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:11:37,421 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:11:37,421 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:11:37,421 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:11:37,421 - src.training - INFO - 모델 학습 완료
2025-06-24 13:11:37,421 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:11:37,421 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:37,421 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:37,421 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:37,421 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:37,442 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:11:37,443 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:11:37,865 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = catboost
2025-06-24 13:11:39,666 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:11:39,667 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:11:39,667 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:11:39,667 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:11:39,667 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:11:39,667 - src.training - INFO - 교차 검증 시작
2025-06-24 13:11:39,667 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 13:11:39,684 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 13:11:40,135 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 13:11:40,135 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 13:11:40,135 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 13:11:40,135 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 13:11:40,135 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 13:11:40,135 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 13:11:40,135 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:11:40,135 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:11:40,135 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:11:40,329 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:11:40,329 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:11:40,329 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:11:40,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:11:41,554 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:11:42,514 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:42,514 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:11:42,522 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:11:42,552 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:11:42,552 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:11:42,552 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:11:42,552 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:43,714 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 13:11:43,973 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 13:11:43,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:44,130 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:44,130 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:44,170 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:44,170 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:44,170 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:44,170 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:11:44,170 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:44,170 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:44,229 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 13:11:44,229 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 13:11:44,229 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:44,229 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:44,229 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 13:11:44,229 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 13:11:44,229 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:44,291 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:44,291 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 13:11:44,291 - src.training - INFO - 모델 학습 시작
2025-06-24 13:11:44,422 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 13:11:44,423 - src.training - INFO - 모델 타입: catboost
2025-06-24 13:11:44,423 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:11:44,423 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:11:44,423 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:11:44,423 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:11:44,423 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:11:44,423 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:11:44,423 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:44,423 - src.models.catboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 13:11:44,423 - src.models.catboost_model - INFO - 검증 데이터 형태: X_val=(220940, 6), y_val=(220940, 1)
2025-06-24 13:11:44,423 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:11:44,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 13:11:44,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:44,423 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:44,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:44,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:44,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:44,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:44,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:44,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:44,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 13:11:44,845 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:44,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 13:11:44,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:44,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:44,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:44,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:44,943 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:44,958 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:44,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:44,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:45,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:45,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:45,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:45,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:45,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 13:11:45,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:45,040 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(883775, 6), y=(883775, 1)
2025-06-24 13:11:45,040 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:45,040 - src.models.catboost_model - INFO - 범주형 피처 인덱스: []
2025-06-24 13:11:45,040 - src.models.catboost_model - INFO - 범주형 피처 개수: 0
2025-06-24 13:11:45,040 - src.models.catboost_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 13:11:45,054 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(883775, 6), y=883775
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO - 검증 데이터 정리 후: X_val=(220940, 6), y_val=220940
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   iterations: 216
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   depth: 6
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   learning_rate: 0.050008846225400576
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   l2_leaf_reg: 1.0953719874713879
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   loss_function: Logloss
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   eval_metric: Logloss
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   cat_features: []
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   cat_l2: 10.0
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   cat_smooth: 10.0
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   max_cat_threshold: 32
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   one_hot_max_size: 10
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   random_strength: 7.746933668912277
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   bagging_temperature: 0.162615249921506
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   border_count: 215
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   feature_border_type: GreedyLogSum
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   verbose: False
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   auto_class_weights: Balanced
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   scale_pos_weight: 1.0
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   use_focal_loss: False
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   boosting_type: Plain
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   bootstrap_type: Bernoulli
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   subsample: 0.8
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   rsm: 0.8
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   leaf_estimation_method: Newton
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   random_seed: 42
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   bootstrap_seed: 42
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   min_data_in_leaf: 1
2025-06-24 13:11:45,058 - src.models.catboost_model - INFO -   max_leaves: 31
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   grow_policy: SymmetricTree
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   min_fold_size: 1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   leaf_estimation_iterations: 1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   fold_permutation_block: 1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   leaf_estimation_backtracking: AnyImprovement
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   best_model_min_trees: 1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   model_shrink_rate: 0
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   model_shrink_mode: Constant
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   langevin: False
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   diffusion_temperature: 10000
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   posterior_sampling: False
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   boost_from_average: True
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   allow_const_label: False
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   score_function: Cosine
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   monotone_constraints: 
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   penalties_coefficient: 1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   first_feature_use_penalties: 0
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   model_size_reg: 0.5
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   per_float_feature_quantization: 
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   eval_fraction: 0
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   fixed_binary_splits: None
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   ignored_features: None
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   train_dir: None
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   name: experiment
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   prediction_type: Probability
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   fold_len_multiplier: 2
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   has_time: False
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   allow_writing_files: False
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   save_snapshot: False
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   snapshot_file: None
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   snapshot_interval: 600
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   gradient_iterations: 1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   sampling_unit: Object
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   mvs_reg: 0.1
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO -   thread_count: 28
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO - CatBoost 모델 생성 중... (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO - 분류 모델 (CatBoostClassifier) 사용
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 13:11:45,059 - src.models.catboost_model - INFO - Early Stopping과 함께 학습
2025-06-24 13:11:46,382 - src.models.catboost_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 13:11:46,382 - src.models.catboost_model - INFO -   - Best Iteration: 66
2025-06-24 13:11:46,382 - src.models.catboost_model - INFO -   - Best Score: {'learn': {'Logloss': 0.008045449974871045}, 'validation': {'Logloss': 0.008917890819420004}}
2025-06-24 13:11:46,382 - src.models.catboost_model - INFO -   - 트리 개수: 67
2025-06-24 13:11:46,382 - src.models.catboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 13:11:46,383 - src.models.catboost_model - INFO - CatBoost 모델 예측 시작
2025-06-24 13:11:46,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 13:11:46,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:46,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:46,401 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:46,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:46,431 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:46,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:46,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:46,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:46,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 13:11:46,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:46,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 13:11:46,511 - src.models.catboost_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 13:11:46,512 - src.models.catboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 13:11:46,512 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 13:11:46,512 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 13:11:46,512 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:46,512 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 13:11:46,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 13:11:46,512 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 13:11:46,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 13:11:46,519 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 13:11:46,520 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.]
2025-06-24 13:11:46,520 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 13:11:47,256 - src.training - INFO -   precision: 0.0
2025-06-24 13:11:47,256 - src.training - INFO -   recall: 0.0
2025-06-24 13:11:47,256 - src.training - INFO -   f1: 0.0
2025-06-24 13:11:47,256 - src.training - INFO -   accuracy: 0.9987779487643704
2025-06-24 13:11:47,256 - src.training - INFO -   balanced_accuracy: 0.5
2025-06-24 13:11:47,256 - src.training - INFO -   positive_samples: 270
2025-06-24 13:11:47,256 - src.training - INFO -   negative_samples: 220670
2025-06-24 13:11:47,256 - src.training - INFO -   total_samples: 220940
2025-06-24 13:11:47,256 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 13:11:47,256 - src.training - INFO -   roc_auc: 0.0
2025-06-24 13:11:47,256 - src.training - INFO -   pr_auc: 0.0
2025-06-24 13:11:47,257 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 13:11:47,257 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 13:11:47,257 - src.models.catboost_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 13:11:47,257 - src.training - INFO - 모델 학습 완료
2025-06-24 13:11:47,257 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.9987779487643704, 'balanced_accuracy': 0.5, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 13:11:47,257 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:47,257 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:47,257 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:47,257 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 13:11:47,278 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 13:11:47,278 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 13:11:47,692 - src.hyperparameter_tuning - WARNING - 유효하지 않은 best_score: -inf
2025-06-24 13:11:47,695 - src.hyperparameter_tuning - INFO - 최적화 완료!
2025-06-24 13:11:47,695 - src.hyperparameter_tuning - INFO -   - 최고 성능: 0.0000
2025-06-24 13:11:47,695 - src.hyperparameter_tuning - INFO -   - 최적 파라미터: {'iterations': 218, 'depth': 10, 'learning_rate': 0.1205712628744377, 'l2_leaf_reg': 3.968793330444372, 'border_count': 66, 'bagging_temperature': 0.2403950683025824, 'random_strength': 0.13066739238053282}
2025-06-24 13:11:49,510 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 13:11:49,510 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 13:11:49,510 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 13:11:49,510 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 13:11:49,511 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 13:11:49,511 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 13:11:49,511 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 13:11:49,511 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 13:11:49,736 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 13:11:49,736 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 13:11:49,736 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 13:11:49,736 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 13:11:51,290 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 13:11:52,485 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 13:11:52,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 13:11:53,694 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 13:11:53,694 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 13:11:53,903 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 13:11:53,904 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 13:11:53,904 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 13:11:53,904 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 13:11:53,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 13:11:54,106 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 13:11:54,106 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 13:11:54,166 - src.models.model_factory - INFO - 모델 타입 'catboost'으로 모델을 생성합니다.
2025-06-24 13:11:54,166 - src.models.base_model - INFO - CATBOOST 모델 초기화 완료
2025-06-24 13:11:54,167 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 13:11:54,167 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 13:11:54,167 - src.models.catboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 13:11:54,167 - src.models.catboost_model - INFO - CatBoost 모델 학습 시작
2025-06-24 13:11:54,167 - src.models.catboost_model - INFO - 입력 데이터 형태: X=(1333765, 6), y=(1333765, 1)
2025-06-24 13:11:54,167 - src.models.catboost_model - INFO - Early Stopping 비활성화
2025-06-24 13:11:54,167 - src.models.catboost_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 13:11:54,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (1333765, 6)
2025-06-24 13:11:54,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:54,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 13:11:54,278 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 13:11:54,367 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 13:11:54,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 13:11:54,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 13:11:54,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 13:11:54,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 13:11:54,771 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (1333765, 6)
2025-06-24 13:11:54,771 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 13:11:54,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (1333765, 6)
2025-06-24 13:11:54,796 - src.models.catboost_model - INFO - 전처리 후 데이터 형태: X=(1333765, 6), y=(1333765, 0)
2025-06-24 13:11:54,796 - src.models.catboost_model - INFO - 사용 가능한 타겟 컬럼: []
2025-06-24 13:11:54,796 - src.models.catboost_model - ERROR - y 데이터프레임에 컬럼이 없습니다! 타겟 컬럼 매칭을 확인하세요.
2025-06-24 13:11:54,797 - src.models.base_model - INFO - 모델이 models/best_tuned_model.joblib에 저장되었습니다.
2025-06-24 13:11:54,798 - src.hyperparameter_tuning - INFO - 최고 모델 저장 완료: models/best_tuned_model.joblib
2025-06-24 13:11:55,510 - src.hyperparameter_tuning - INFO - Study 저장 완료: models/optuna_study.pkl
2025-06-24 13:11:55,788 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2025-06-24 13:11:55,937 - __main__ - INFO - === 하이퍼파라미터 튜닝 완료 ===
2025-06-24 13:11:55,937 - __main__ - INFO - 최고 성능: 0.0000
2025-06-24 13:11:55,937 - __main__ - INFO - 최적 파라미터:
2025-06-24 13:11:55,937 - __main__ - INFO -   iterations: 218
2025-06-24 13:11:55,937 - __main__ - INFO -   depth: 10
2025-06-24 13:11:55,937 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 13:11:55,937 - __main__ - INFO -   l2_leaf_reg: 3.968793330444372
2025-06-24 13:11:55,937 - __main__ - INFO -   border_count: 66
2025-06-24 13:11:55,937 - __main__ - INFO -   bagging_temperature: 0.2403950683025824
2025-06-24 13:11:55,937 - __main__ - INFO -   random_strength: 0.13066739238053282

==================================================
튜닝 결과 요약
==================================================
모델 타입: catboost
실험 타입: hyperparameter_tuning
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/3a32a0ce14174b7b8eb7e7f54c2d7ded
최고 성능: 0.0
최적 파라미터: {'iterations': 218, 'depth': 10, 'learning_rate': 0.1205712628744377, 'l2_leaf_reg': 3.968793330444372, 'border_count': 66, 'bagging_temperature': 0.2403950683025824, 'random_strength': 0.13066739238053282}
튜닝 시간: N/A
==================================================
2025-06-24 13:11:55,937 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_131155.txt에 저장되었습니다.
2025-06-24 13:11:55,937 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 13:11:55,938 - __main__ - INFO - MLflow Run ID: 3a32a0ce14174b7b8eb7e7f54c2d7ded
2025-06-24 13:11:55,938 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/3a32a0ce14174b7b8eb7e7f54c2d7ded
