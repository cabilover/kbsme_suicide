2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO - 전달받은 데이터 사용: (1333765, 33)
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO - 모델 타입: xgboost
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed/processed_data_with_features.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 5, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'pr_auc', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'metrics': {'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy', 'pr_auc'], 'regression_metrics': ['mae', 'rmse', 'r2'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2', 'pr_auc']}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'xgboost', 'xgboost': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'scale_pos_weight': 1.0, 'early_stopping_rounds': 10, 'verbose': 0, 'n_jobs': 28, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'resampling': {'enabled': False, 'method': 'smote', 'random_state': 42, 'smote_k_neighbors': 5, 'borderline_smote_k_neighbors': 5, 'adasyn_k_neighbors': 5, 'under_sampling_strategy': 'random', 'hybrid_strategy': 'smote_tomek', 'time_series_adapted': {'enabled': False, 'time_weight': 0.3, 'pattern_preservation': True}}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 100, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 11:01:31,326 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 11:01:31,350 - __main__ - INFO - MLflow Run 시작: 8c40817daf4b491796e27834103c5a4f
2025-06-24 11:01:31,353 - __main__ - INFO - 튜닝 파라미터 로깅 완료: 6개 파라미터
2025-06-24 11:01:31,353 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 최적화 시작
2025-06-24 11:01:31,358 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = xgboost
2025-06-24 11:01:33,404 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:01:33,404 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:01:33,404 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:01:33,404 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:01:33,404 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:01:33,404 - src.training - INFO - 교차 검증 시작
2025-06-24 11:01:33,404 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:01:33,421 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:01:33,885 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:01:33,885 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:01:33,885 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:01:33,885 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:01:33,885 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:01:33,885 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:01:33,885 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:01:33,885 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:01:33,885 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:01:34,054 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:01:34,054 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:01:34,054 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:01:34,054 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:01:35,470 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:01:36,565 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:01:36,565 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:01:36,570 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:01:36,601 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:01:36,601 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:01:36,601 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:01:36,601 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:01:37,917 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:01:38,180 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:01:38,181 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:01:38,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:01:38,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:01:38,382 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:01:38,382 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:01:38,383 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:01:38,383 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:01:38,383 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:01:38,383 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:01:38,444 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:01:38,444 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:01:38,444 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:38,444 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:38,444 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:01:38,444 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:01:38,444 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:38,509 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:01:38,509 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:01:38,509 - src.training - INFO - 모델 학습 시작
2025-06-24 11:01:38,628 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:01:38,628 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:01:38,628 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:01:38,628 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:01:38,628 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:01:38,628 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:01:38,628 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:01:38,628 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:01:38,628 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:01:38,628 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:38,628 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:01:38,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:01:38,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:01:38,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:01:38,716 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:01:38,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:01:38,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:01:38,911 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:01:38,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:01:39,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:01:39,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:01:39,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:01:39,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:01:39,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:39,136 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:39,136 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:01:39,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:01:39,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:01:39,136 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:01:39,154 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:01:39,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:01:39,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:01:39,201 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:01:39,218 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:01:39,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:01:39,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:01:39,239 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:01:39,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:01:39,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:39,254 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:01:39,254 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:01:39,254 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   n_estimators: 406
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   subsample: 0.8394633936788146
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:01:39,270 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:01:39,271 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:02:02,649 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:02:02,649 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:02:02,649 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:02:02,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:02:02,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:02,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:02,668 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:02,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:02,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:02,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:02,734 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:02,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:02,756 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:02:02,756 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:02,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:02:02,855 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:02:02,855 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:02:02,855 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:02:02,855 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:02:02,855 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:02:02,855 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:02:02,855 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:02:02,855 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:02:02,859 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:02:02,863 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:02:02,864 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:02:02,864 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:02:04,242 - src.training - INFO -   precision: 0.0028015564202334632
2025-06-24 11:02:04,242 - src.training - INFO -   recall: 0.06666666666666667
2025-06-24 11:02:04,242 - src.training - INFO -   f1: 0.005377147124719941
2025-06-24 11:02:04,242 - src.training - INFO -   accuracy: 0.9698605956368245
2025-06-24 11:02:04,242 - src.training - INFO -   balanced_accuracy: 0.5188161810244558
2025-06-24 11:02:04,242 - src.training - INFO -   positive_samples: 270
2025-06-24 11:02:04,242 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:02:04,242 - src.training - INFO -   total_samples: 220940
2025-06-24 11:02:04,242 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:02:04,242 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:02:04,242 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:02:04,242 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:02:04,242 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:02:04,244 - src.training - INFO - 모델 학습 완료
2025-06-24 11:02:04,244 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028015564202334632, 'recall': 0.06666666666666667, 'f1': 0.005377147124719941, 'accuracy': 0.9698605956368245, 'balanced_accuracy': 0.5188161810244558, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:02:04,244 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:04,244 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:04,244 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:04,244 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:04,279 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:02:04,279 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:02:04,701 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = xgboost
2025-06-24 11:02:06,663 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:02:06,663 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:02:06,663 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:02:06,663 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:02:06,663 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:02:06,663 - src.training - INFO - 교차 검증 시작
2025-06-24 11:02:06,663 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:02:06,682 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:02:07,153 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:02:07,153 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:02:07,153 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:02:07,153 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:02:07,153 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:02:07,153 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:02:07,153 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:02:07,153 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:02:07,153 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:02:07,322 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:02:07,322 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:02:07,322 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:02:07,322 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:02:08,815 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:02:09,965 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:02:09,965 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:02:09,971 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:02:10,004 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:02:10,004 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:02:10,004 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:02:10,004 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:02:11,403 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:02:11,671 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:02:11,671 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:02:11,840 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:02:11,840 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:02:11,883 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:02:11,883 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:02:11,883 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:02:11,883 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:02:11,883 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:11,883 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:02:11,945 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:02:11,946 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:02:11,946 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:11,946 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:11,946 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:02:11,946 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:02:11,946 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:12,011 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:02:12,011 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:02:12,011 - src.training - INFO - 모델 학습 시작
2025-06-24 11:02:12,131 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:02:12,131 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:02:12,131 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:02:12,131 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:02:12,131 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:02:12,131 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:02:12,131 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:02:12,131 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:02:12,131 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:02:12,131 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:12,131 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:02:12,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:02:12,131 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:12,132 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:12,208 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:12,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:12,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:12,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:12,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:12,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:12,561 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:02:12,561 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:12,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:02:12,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:12,624 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:12,624 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:02:12,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:02:12,624 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:12,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:12,642 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:12,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:12,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:12,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:12,706 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:12,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:12,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:02:12,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:12,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:02:12,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:12,740 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:02:12,740 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:12,740 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:02:12,756 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   n_estimators: 723
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   learning_rate: 0.2708160864249968
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   subsample: 0.9329770563201687
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6849356442713105
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   reg_alpha: 4.4734294104626844e-07
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   reg_lambda: 5.472429642032198e-06
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:02:12,757 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:02:16,865 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:02:16,865 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:02:16,868 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:02:16,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:02:16,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:16,869 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:16,887 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:16,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:16,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:16,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:16,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:16,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:16,975 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:02:16,975 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:16,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:02:16,986 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:02:16,986 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:02:16,986 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:02:16,986 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:02:16,986 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:02:16,986 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:02:16,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:02:16,986 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:02:16,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:02:16,994 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:02:16,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:02:16,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:02:18,380 - src.training - INFO -   precision: 0.002744624456956447
2025-06-24 11:02:18,380 - src.training - INFO -   recall: 0.6481481481481481
2025-06-24 11:02:18,380 - src.training - INFO -   f1: 0.0054661023566709875
2025-06-24 11:02:18,380 - src.training - INFO -   accuracy: 0.7117724269032316
2025-06-24 11:02:18,380 - src.training - INFO -   balanced_accuracy: 0.6799992111565956
2025-06-24 11:02:18,380 - src.training - INFO -   positive_samples: 270
2025-06-24 11:02:18,380 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:02:18,380 - src.training - INFO -   total_samples: 220940
2025-06-24 11:02:18,380 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:02:18,380 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:02:18,380 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:02:18,380 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:02:18,380 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:02:18,380 - src.training - INFO - 모델 학습 완료
2025-06-24 11:02:18,380 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002744624456956447, 'recall': 0.6481481481481481, 'f1': 0.0054661023566709875, 'accuracy': 0.7117724269032316, 'balanced_accuracy': 0.6799992111565956, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:02:18,380 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:18,380 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:18,380 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:18,380 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:18,415 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:02:18,415 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:02:18,871 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = xgboost
2025-06-24 11:02:20,797 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:02:20,797 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:02:20,797 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:02:20,797 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:02:20,797 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:02:20,797 - src.training - INFO - 교차 검증 시작
2025-06-24 11:02:20,797 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:02:20,815 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:02:21,286 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:02:21,286 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:02:21,286 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:02:21,286 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:02:21,286 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:02:21,286 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:02:21,286 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:02:21,286 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:02:21,286 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:02:21,457 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:02:21,457 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:02:21,457 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:02:21,457 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:02:22,954 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:02:24,114 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:02:24,114 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:02:24,120 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:02:24,153 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:02:24,153 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:02:24,153 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:02:24,153 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:02:25,546 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:02:25,817 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:02:25,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:02:25,985 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:02:25,985 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:02:26,028 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:02:26,028 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:02:26,028 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:02:26,028 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:02:26,028 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:26,028 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,090 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:02:26,090 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:02:26,090 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,090 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,090 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:02:26,090 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:02:26,090 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,155 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:02:26,155 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:02:26,155 - src.training - INFO - 모델 학습 시작
2025-06-24 11:02:26,274 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:02:26,274 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:02:26,274 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:02:26,274 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:02:26,274 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:02:26,274 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:02:26,274 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:02:26,274 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:02:26,274 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:02:26,274 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,274 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:02:26,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:02:26,274 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:26,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:26,355 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:26,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:26,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:26,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:26,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:26,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:26,707 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:02:26,707 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:26,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:02:26,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,765 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,765 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:02:26,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:02:26,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:26,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:26,783 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:26,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:26,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:26,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:26,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:26,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:26,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:02:26,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:26,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:02:26,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,881 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:02:26,881 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:26,881 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   n_estimators: 460
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   learning_rate: 0.08012737503998542
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   subsample: 0.6557975442608167
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7168578594140873
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:02:26,898 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:02:26,899 - src.models.xgboost_model - INFO -   reg_alpha: 0.00012724181576752517
2025-06-24 11:02:26,899 - src.models.xgboost_model - INFO -   reg_lambda: 0.1165691561324743
2025-06-24 11:02:26,899 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:02:26,899 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:02:26,899 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:02:54,473 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:02:54,473 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:02:54,475 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:02:54,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:02:54,475 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:54,476 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:02:54,494 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:02:54,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:02:54,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:02:54,540 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:02:54,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:02:54,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:02:54,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:02:54,578 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:54,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:02:54,646 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:02:54,646 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:02:54,647 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:02:54,647 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:02:54,647 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:02:54,647 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:02:54,647 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:02:54,647 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:02:54,650 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:02:54,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:02:54,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:02:54,654 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:02:55,888 - src.training - INFO -   precision: 0.003115513660329126
2025-06-24 11:02:55,889 - src.training - INFO -   recall: 0.28888888888888886
2025-06-24 11:02:55,889 - src.training - INFO -   f1: 0.006164545957480439
2025-06-24 11:02:55,889 - src.training - INFO -   accuracy: 0.8861681904589481
2025-06-24 11:02:55,889 - src.training - INFO -   balanced_accuracy: 0.5878939391650679
2025-06-24 11:02:55,889 - src.training - INFO -   positive_samples: 270
2025-06-24 11:02:55,889 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:02:55,889 - src.training - INFO -   total_samples: 220940
2025-06-24 11:02:55,889 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:02:55,889 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:02:55,889 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:02:55,889 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:02:55,889 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:02:55,891 - src.training - INFO - 모델 학습 완료
2025-06-24 11:02:55,891 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003115513660329126, 'recall': 0.28888888888888886, 'f1': 0.006164545957480439, 'accuracy': 0.8861681904589481, 'balanced_accuracy': 0.5878939391650679, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:02:55,891 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:55,891 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:55,891 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:02:55,891 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:02:55,926 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:02:55,926 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:02:56,357 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = xgboost
2025-06-24 11:02:58,108 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:02:58,108 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:02:58,108 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:02:58,108 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:02:58,108 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:02:58,108 - src.training - INFO - 교차 검증 시작
2025-06-24 11:02:58,108 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:02:58,126 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:02:58,560 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:02:58,560 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:02:58,560 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:02:58,560 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:02:58,560 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:02:58,560 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:02:58,560 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:02:58,560 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:02:58,560 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:02:58,739 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:02:58,739 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:02:58,739 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:02:58,739 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:02:58,740 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:02:58,740 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:02:58,740 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:02:58,740 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:02:58,740 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:02:58,740 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:03:00,081 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:03:01,122 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:03:01,122 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:03:01,128 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:03:01,161 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:03:01,161 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:03:01,161 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:03:01,161 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:03:02,401 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:03:02,641 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:03:02,641 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:03:02,800 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:03:02,801 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:03:02,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:03:02,841 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:03:02,841 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:03:02,841 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:03:02,841 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:02,841 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:03:02,886 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:03:02,887 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:03:02,887 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:02,887 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:02,887 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:03:02,887 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:03:02,887 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:02,944 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:03:02,944 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:03:02,944 - src.training - INFO - 모델 학습 시작
2025-06-24 11:03:03,060 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:03:03,060 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:03:03,060 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:03:03,061 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:03:03,061 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:03:03,061 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:03:03,061 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:03:03,061 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:03:03,061 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:03:03,061 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:03,061 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:03:03,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:03:03,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:03,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:03:03,138 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:03:03,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:03:03,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:03:03,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:03:03,358 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:03:03,427 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:03:03,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:03:03,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:03,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:03:03,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:03,523 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:03,523 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:03:03,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:03:03,523 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:03,524 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:03:03,540 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:03:03,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:03:03,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:03:03,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:03:03,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:03:03,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:03:03,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:03:03,615 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:03,630 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:03:03,631 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:03,631 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:03:03,631 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:03,631 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:03:03,648 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   n_estimators: 539
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   learning_rate: 0.011711509955524094
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   subsample: 0.8430179407605753
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6682096494749166
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   reg_alpha: 3.4671276804481113
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   reg_lambda: 4.905556676028774
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:03:03,649 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:03:49,723 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:03:49,723 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:03:49,723 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:03:49,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:03:49,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:49,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:03:49,743 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:03:49,758 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:03:49,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:03:49,786 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:03:49,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:03:49,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:03:49,822 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:03:49,822 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:49,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:03:49,987 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:03:49,987 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:03:49,987 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:03:49,987 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:03:49,987 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:03:49,987 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:03:49,987 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:03:49,987 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:03:49,991 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:03:49,994 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:03:49,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:03:49,995 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:03:51,219 - src.training - INFO -   precision: 0.003162585653361445
2025-06-24 11:03:51,219 - src.training - INFO -   recall: 0.24444444444444444
2025-06-24 11:03:51,219 - src.training - INFO -   f1: 0.006244382421117366
2025-06-24 11:03:51,219 - src.training - INFO -   accuracy: 0.9049198877523309
2025-06-24 11:03:51,219 - src.training - INFO -   balanced_accuracy: 0.5750862272976742
2025-06-24 11:03:51,219 - src.training - INFO -   positive_samples: 270
2025-06-24 11:03:51,220 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:03:51,220 - src.training - INFO -   total_samples: 220940
2025-06-24 11:03:51,220 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:03:51,220 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:03:51,220 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:03:51,220 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:03:51,220 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:03:51,222 - src.training - INFO - 모델 학습 완료
2025-06-24 11:03:51,222 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003162585653361445, 'recall': 0.24444444444444444, 'f1': 0.006244382421117366, 'accuracy': 0.9049198877523309, 'balanced_accuracy': 0.5750862272976742, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:03:51,223 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:51,223 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:51,223 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:51,223 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:51,257 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:03:51,257 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:03:51,688 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = xgboost
2025-06-24 11:03:53,488 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:03:53,488 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:03:53,488 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:03:53,488 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:03:53,488 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:03:53,488 - src.training - INFO - 교차 검증 시작
2025-06-24 11:03:53,488 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:03:53,504 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:03:53,974 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:03:53,974 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:03:53,974 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:03:53,974 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:03:53,974 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:03:53,974 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:03:53,974 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:03:53,974 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:03:53,974 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:03:54,150 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:03:54,150 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:03:54,150 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:03:54,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:03:55,637 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:03:56,780 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:03:56,780 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:03:56,786 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:03:56,819 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:03:56,819 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:03:56,819 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:03:56,819 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:03:58,193 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:03:58,462 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:03:58,462 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:03:58,630 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:03:58,630 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:03:58,673 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:03:58,673 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:03:58,673 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:03:58,673 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:03:58,673 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:58,673 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:03:58,722 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:03:58,723 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:03:58,723 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:58,723 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:58,723 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:03:58,723 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:03:58,723 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:58,790 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:03:58,790 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:03:58,790 - src.training - INFO - 모델 학습 시작
2025-06-24 11:03:58,922 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:03:58,922 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:03:58,922 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:03:58,922 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:03:58,922 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:03:58,922 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:03:58,922 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:03:58,922 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:03:58,922 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:03:58,922 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:58,922 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:03:58,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:03:58,922 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:58,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:03:59,011 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:03:59,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:03:59,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:03:59,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:03:59,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:03:59,349 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:03:59,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:03:59,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:59,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:03:59,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:59,428 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:59,428 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:03:59,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:03:59,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:59,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:03:59,446 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:03:59,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:03:59,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:03:59,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:03:59,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:03:59,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:03:59,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:03:59,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:03:59,545 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:03:59,545 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:59,545 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:03:59,545 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:03:59,545 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:03:59,561 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   n_estimators: 339
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   learning_rate: 0.1024932221692416
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   subsample: 0.7760609974958406
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6488152939379115
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   reg_alpha: 2.039373116525212e-08
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   reg_lambda: 1.527156759251193
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:03:59,562 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:04:08,005 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:04:08,006 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:04:08,006 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:04:08,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:04:08,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:08,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:04:08,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:04:08,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:04:08,054 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:04:08,068 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:04:08,084 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:04:08,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:04:08,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:04:08,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:08,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:04:08,126 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:04:08,126 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:04:08,126 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:04:08,126 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:04:08,126 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:04:08,126 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:04:08,126 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:04:08,126 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:04:08,130 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:04:08,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:04:08,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:04:08,134 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:04:09,376 - src.training - INFO -   precision: 0.0027155804344928696
2025-06-24 11:04:09,376 - src.training - INFO -   recall: 0.6037037037037037
2025-06-24 11:04:09,376 - src.training - INFO -   f1: 0.0054068398182240355
2025-06-24 11:04:09,376 - src.training - INFO -   accuracy: 0.7285778944509822
2025-06-24 11:04:09,376 - src.training - INFO -   balanced_accuracy: 0.666217193765116
2025-06-24 11:04:09,376 - src.training - INFO -   positive_samples: 270
2025-06-24 11:04:09,376 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:04:09,376 - src.training - INFO -   total_samples: 220940
2025-06-24 11:04:09,376 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:04:09,376 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:04:09,376 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:04:09,376 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:04:09,376 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:04:09,377 - src.training - INFO - 모델 학습 완료
2025-06-24 11:04:09,377 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027155804344928696, 'recall': 0.6037037037037037, 'f1': 0.0054068398182240355, 'accuracy': 0.7285778944509822, 'balanced_accuracy': 0.666217193765116, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:04:09,377 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:09,377 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:09,377 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:09,377 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:09,412 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:04:09,412 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:04:09,837 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = xgboost
2025-06-24 11:04:11,608 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:04:11,608 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:04:11,608 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:04:11,608 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:04:11,608 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:04:11,608 - src.training - INFO - 교차 검증 시작
2025-06-24 11:04:11,608 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:04:11,625 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:04:12,064 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:04:12,064 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:04:12,064 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:04:12,064 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:04:12,064 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:04:12,064 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:04:12,064 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:04:12,064 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:04:12,064 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:04:12,240 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:04:12,240 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:04:12,240 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:04:12,240 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:04:13,579 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:04:14,624 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:04:14,624 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:04:14,630 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:04:14,665 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:04:14,665 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:04:14,665 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:04:14,665 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:04:15,908 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:04:16,159 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:04:16,159 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:04:16,320 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:04:16,320 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:04:16,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:04:16,363 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:04:16,363 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:04:16,363 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:04:16,363 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:16,363 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:04:16,420 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:04:16,420 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:04:16,420 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:16,420 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:16,420 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:04:16,420 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:04:16,420 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:16,480 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:04:16,480 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:04:16,480 - src.training - INFO - 모델 학습 시작
2025-06-24 11:04:16,600 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:04:16,601 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:04:16,601 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:04:16,601 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:04:16,601 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:04:16,601 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:04:16,601 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:04:16,601 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:04:16,601 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:04:16,601 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:16,601 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:04:16,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:04:16,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:16,601 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:04:16,668 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:04:16,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:04:16,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:04:16,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:04:16,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:04:16,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:04:16,969 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:04:16,969 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:17,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:04:17,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:17,046 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:17,046 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:04:17,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:04:17,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:17,046 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:04:17,063 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:04:17,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:04:17,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:04:17,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:04:17,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:04:17,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:04:17,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:04:17,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:17,150 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:04:17,150 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:17,151 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:04:17,151 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:04:17,151 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   n_estimators: 680
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   learning_rate: 0.05864129169696527
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   subsample: 0.8186841117373118
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6739417822102108
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   reg_alpha: 0.09466630153726856
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   reg_lambda: 2.854239907497756
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:04:17,167 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:04:59,383 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:04:59,383 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:04:59,383 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:04:59,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:04:59,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:59,384 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:04:59,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:04:59,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:04:59,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:04:59,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:04:59,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:04:59,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:04:59,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:04:59,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:04:59,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:04:59,606 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:04:59,606 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:04:59,606 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:04:59,606 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:04:59,606 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:04:59,606 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:04:59,607 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:04:59,607 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:04:59,610 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:04:59,614 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:04:59,615 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:04:59,615 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:05:00,840 - src.training - INFO -   precision: 0.0034925160370634354
2025-06-24 11:05:00,840 - src.training - INFO -   recall: 0.1814814814814815
2025-06-24 11:05:00,840 - src.training - INFO -   f1: 0.006853146853146854
2025-06-24 11:05:00,840 - src.training - INFO -   accuracy: 0.935720105005884
2025-06-24 11:05:00,840 - src.training - INFO -   balanced_accuracy: 0.559062216247153
2025-06-24 11:05:00,840 - src.training - INFO -   positive_samples: 270
2025-06-24 11:05:00,840 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:05:00,840 - src.training - INFO -   total_samples: 220940
2025-06-24 11:05:00,840 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:05:00,840 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:05:00,840 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:05:00,840 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:05:00,841 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:05:00,842 - src.training - INFO - 모델 학습 완료
2025-06-24 11:05:00,842 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0034925160370634354, 'recall': 0.1814814814814815, 'f1': 0.006853146853146854, 'accuracy': 0.935720105005884, 'balanced_accuracy': 0.559062216247153, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:05:00,842 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:00,842 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:00,842 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:00,842 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:00,876 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:05:00,876 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:05:01,303 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = xgboost
2025-06-24 11:05:03,031 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:05:03,032 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:05:03,032 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:05:03,032 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:05:03,032 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:05:03,032 - src.training - INFO - 교차 검증 시작
2025-06-24 11:05:03,032 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:05:03,050 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:05:03,486 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:05:03,486 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:05:03,486 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:05:03,486 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:05:03,486 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:05:03,486 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:05:03,486 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:05:03,486 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:05:03,486 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:05:03,666 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:05:03,666 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:05:03,666 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:05:03,666 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:05:05,007 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:05:06,030 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:05:06,030 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:05:06,036 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:05:06,070 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:05:06,070 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:05:06,070 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:05:06,070 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:05:07,308 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:05:07,545 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:05:07,545 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:05:07,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:05:07,710 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:05:07,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:05:07,751 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:05:07,751 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:05:07,751 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:05:07,751 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:07,751 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:05:07,798 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:05:07,798 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:05:07,798 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:07,798 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:07,798 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:05:07,798 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:05:07,798 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:07,858 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:05:07,858 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:05:07,858 - src.training - INFO - 모델 학습 시작
2025-06-24 11:05:07,977 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:05:07,977 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:05:07,977 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:05:07,977 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:05:07,977 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:05:07,977 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:05:07,977 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:05:07,977 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:05:07,977 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:05:07,977 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:07,977 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:05:07,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:05:07,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:07,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:05:08,043 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:05:08,097 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:05:08,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:05:08,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:05:08,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:05:08,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:05:08,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:05:08,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:08,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:05:08,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:08,415 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:08,415 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:05:08,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:05:08,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:08,416 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:05:08,432 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:05:08,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:05:08,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:05:08,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:05:08,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:05:08,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:05:08,506 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:05:08,506 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:05:08,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:05:08,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:08,520 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:05:08,520 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:05:08,520 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   n_estimators: 618
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   learning_rate: 0.01351182947645082
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   subsample: 0.6783931449676581
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6180909155642152
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:05:08,538 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   reg_alpha: 3.148441347423712e-05
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   reg_lambda: 2.7678419414850017e-06
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:05:08,539 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:06:18,145 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:06:18,145 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:06:18,146 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:06:18,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:06:18,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:18,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:06:18,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:06:18,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:06:18,193 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:06:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:06:18,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:06:18,240 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:06:18,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:06:18,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:18,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:06:18,555 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:06:18,556 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:06:18,556 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:06:18,556 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:06:18,556 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:06:18,556 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:06:18,556 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:06:18,556 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:06:18,560 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:06:18,564 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:06:18,564 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:06:18,564 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:06:19,810 - src.training - INFO -   precision: 0.002715155504360704
2025-06-24 11:06:19,810 - src.training - INFO -   recall: 0.12222222222222222
2025-06-24 11:06:19,810 - src.training - INFO -   f1: 0.005312298776561494
2025-06-24 11:06:19,810 - src.training - INFO -   accuracy: 0.9440662623336652
2025-06-24 11:06:19,810 - src.training - INFO -   balanced_accuracy: 0.5336470244658943
2025-06-24 11:06:19,810 - src.training - INFO -   positive_samples: 270
2025-06-24 11:06:19,810 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:06:19,810 - src.training - INFO -   total_samples: 220940
2025-06-24 11:06:19,810 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:06:19,810 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:06:19,810 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:06:19,810 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:06:19,811 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:06:19,820 - src.training - INFO - 모델 학습 완료
2025-06-24 11:06:19,820 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002715155504360704, 'recall': 0.12222222222222222, 'f1': 0.005312298776561494, 'accuracy': 0.9440662623336652, 'balanced_accuracy': 0.5336470244658943, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:06:19,820 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:19,820 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:19,820 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:19,820 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:19,855 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:06:19,855 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:06:20,274 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = xgboost
2025-06-24 11:06:21,998 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:06:21,998 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:06:21,998 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:06:21,998 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:06:21,998 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:06:21,998 - src.training - INFO - 교차 검증 시작
2025-06-24 11:06:21,998 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:06:22,017 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:06:22,452 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:06:22,452 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:06:22,452 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:06:22,452 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:06:22,452 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:06:22,452 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:06:22,452 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:06:22,452 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:06:22,452 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:06:22,631 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:06:22,632 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:06:22,632 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:06:22,632 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:06:22,632 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:06:22,632 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:06:22,632 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:06:22,632 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:06:22,632 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:06:22,632 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:06:23,963 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:06:24,985 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:06:24,985 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:06:24,991 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:06:25,023 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:06:25,023 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:06:25,023 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:06:25,023 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:06:26,240 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:06:26,490 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:06:26,490 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:06:26,650 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:06:26,650 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:06:26,690 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:06:26,690 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:06:26,690 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:06:26,691 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:06:26,691 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:26,691 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:06:26,736 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:06:26,736 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:06:26,736 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:26,736 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:26,736 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:06:26,736 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:06:26,736 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:26,794 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:06:26,794 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:06:26,794 - src.training - INFO - 모델 학습 시작
2025-06-24 11:06:26,923 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:06:26,923 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:06:26,923 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:06:26,923 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:06:26,923 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:06:26,923 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:06:26,923 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:06:26,923 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:06:26,923 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:06:26,923 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:26,923 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:06:26,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:06:26,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:26,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:06:26,999 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:06:27,053 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:06:27,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:06:27,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:06:27,220 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:06:27,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:06:27,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:06:27,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:27,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:06:27,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:27,377 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:27,377 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:06:27,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:06:27,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:27,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:06:27,394 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:06:27,408 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:06:27,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:06:27,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:06:27,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:06:27,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:06:27,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:06:27,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:27,484 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:06:27,485 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:27,485 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:06:27,485 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:27,485 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   n_estimators: 389
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   learning_rate: 0.06333268775321842
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   subsample: 0.6563696899899051
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9208787923016158
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   reg_alpha: 7.620481786158549
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   reg_lambda: 0.08916674715636537
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:06:27,501 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:06:51,168 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:06:51,169 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:06:51,169 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:06:51,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:06:51,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:51,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:06:51,188 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:06:51,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:06:51,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:06:51,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:06:51,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:06:51,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:06:51,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:06:51,273 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:51,275 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:06:51,335 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:06:51,335 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:06:51,335 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:06:51,335 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:06:51,336 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:06:51,336 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:06:51,336 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:06:51,336 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:06:51,339 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:06:51,343 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:06:51,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:06:51,344 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:06:52,740 - src.training - INFO -   precision: 0.002962601512669478
2025-06-24 11:06:52,740 - src.training - INFO -   recall: 0.3148148148148148
2025-06-24 11:06:52,740 - src.training - INFO -   f1: 0.005869963053761956
2025-06-24 11:06:52,740 - src.training - INFO -   accuracy: 0.8696886032406989
2025-06-24 11:06:52,740 - src.training - INFO -   balanced_accuracy: 0.5925911659609036
2025-06-24 11:06:52,740 - src.training - INFO -   positive_samples: 270
2025-06-24 11:06:52,740 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:06:52,740 - src.training - INFO -   total_samples: 220940
2025-06-24 11:06:52,740 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:06:52,740 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:06:52,740 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:06:52,740 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:06:52,740 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:06:52,741 - src.training - INFO - 모델 학습 완료
2025-06-24 11:06:52,741 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002962601512669478, 'recall': 0.3148148148148148, 'f1': 0.005869963053761956, 'accuracy': 0.8696886032406989, 'balanced_accuracy': 0.5925911659609036, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:06:52,741 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:52,741 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:52,741 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:06:52,741 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:06:52,777 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:06:52,777 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:06:53,220 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = xgboost
2025-06-24 11:06:55,168 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:06:55,168 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:06:55,168 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:06:55,168 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:06:55,168 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:06:55,168 - src.training - INFO - 교차 검증 시작
2025-06-24 11:06:55,168 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:06:55,184 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:06:55,651 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:06:55,651 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:06:55,652 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:06:55,652 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:06:55,652 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:06:55,652 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:06:55,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:06:55,652 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:06:55,652 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:06:55,823 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:06:55,823 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:06:55,823 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:06:55,823 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:06:57,286 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:06:58,419 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:06:58,419 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:06:58,426 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:06:58,458 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:06:58,458 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:06:58,458 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:06:58,458 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:06:59,828 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:07:00,096 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:07:00,096 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:07:00,265 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:07:00,265 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:07:00,308 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:07:00,308 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:07:00,308 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:07:00,309 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:07:00,309 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:00,309 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:07:00,358 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:07:00,358 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:07:00,358 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:00,358 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:00,358 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:07:00,358 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:07:00,358 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:00,424 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:07:00,424 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:07:00,424 - src.training - INFO - 모델 학습 시작
2025-06-24 11:07:00,556 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:07:00,556 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:07:00,556 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:07:00,556 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:07:00,556 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:07:00,556 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:07:00,557 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:07:00,557 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:07:00,557 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:07:00,557 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:00,557 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:07:00,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:07:00,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:00,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:07:00,644 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:07:00,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:07:00,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:07:00,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:07:00,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:07:00,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:07:00,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:07:00,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:01,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:07:01,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:01,059 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:01,059 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:07:01,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:07:01,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:01,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:07:01,077 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:07:01,092 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:07:01,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:07:01,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:07:01,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:07:01,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:07:01,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:07:01,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:01,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:07:01,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:01,176 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:07:01,176 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:01,176 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   n_estimators: 55
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   subsample: 0.8916028672163949
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:07:01,194 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:07:07,796 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:07:07,796 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:07:07,796 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:07:07,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:07:07,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:07,797 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:07:07,815 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:07:07,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:07:07,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:07:07,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:07:07,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:07:07,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:07:07,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:07:07,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:07,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:07:07,925 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:07:07,926 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:07:07,926 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:07:07,926 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:07:07,926 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:07:07,926 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:07:07,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:07:07,926 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:07:07,929 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:07:07,933 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:07:07,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:07:07,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:07:09,148 - src.training - INFO -   precision: 0.003018632247319663
2025-06-24 11:07:09,148 - src.training - INFO -   recall: 0.10740740740740741
2025-06-24 11:07:09,148 - src.training - INFO -   f1: 0.005872228409436063
2025-06-24 11:07:09,148 - src.training - INFO -   accuracy: 0.9555580700642708
2025-06-24 11:07:09,148 - src.training - INFO -   balanced_accuracy: 0.532001614611394
2025-06-24 11:07:09,148 - src.training - INFO -   positive_samples: 270
2025-06-24 11:07:09,148 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:07:09,148 - src.training - INFO -   total_samples: 220940
2025-06-24 11:07:09,148 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:07:09,148 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:07:09,148 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:07:09,148 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:07:09,149 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:07:09,150 - src.training - INFO - 모델 학습 완료
2025-06-24 11:07:09,150 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003018632247319663, 'recall': 0.10740740740740741, 'f1': 0.005872228409436063, 'accuracy': 0.9555580700642708, 'balanced_accuracy': 0.532001614611394, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:07:09,150 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:09,150 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:09,151 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:09,151 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:09,185 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:07:09,185 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:07:09,616 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = xgboost
2025-06-24 11:07:11,404 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:07:11,404 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:07:11,404 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:07:11,404 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:07:11,404 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:07:11,404 - src.training - INFO - 교차 검증 시작
2025-06-24 11:07:11,404 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:07:11,421 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:07:11,855 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:07:11,855 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:07:11,855 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:07:11,855 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:07:11,855 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:07:11,855 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:07:11,855 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:07:11,855 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:07:11,855 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:07:12,036 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:07:12,036 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:07:12,036 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:07:12,036 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:07:13,361 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:07:14,376 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:07:14,376 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:07:14,382 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:07:14,413 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:07:14,413 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:07:14,413 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:07:14,413 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:07:15,648 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:07:15,895 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:07:15,895 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:07:16,055 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:07:16,055 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:07:16,096 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:07:16,096 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:07:16,096 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:07:16,096 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:07:16,096 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:16,096 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,142 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:07:16,142 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:07:16,142 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,142 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,142 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:07:16,142 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:07:16,142 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,200 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:07:16,200 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:07:16,200 - src.training - INFO - 모델 학습 시작
2025-06-24 11:07:16,328 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:07:16,328 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:07:16,328 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:07:16,329 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:07:16,329 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:07:16,329 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:07:16,329 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:07:16,329 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:07:16,329 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:07:16,329 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,329 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:07:16,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:07:16,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:16,329 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:07:16,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:07:16,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:07:16,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:07:16,572 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:07:16,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:07:16,699 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:07:16,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:07:16,712 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:16,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:07:16,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,783 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,783 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:07:16,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:07:16,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:16,783 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:07:16,800 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:07:16,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:07:16,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:07:16,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:07:16,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:07:16,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:07:16,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:07:16,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:16,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:07:16,889 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,889 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:07:16,889 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:07:16,889 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   n_estimators: 642
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   learning_rate: 0.012413189635294229
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   subsample: 0.7243929286862649
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7300733288106989
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   reg_alpha: 0.005470376807480391
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   reg_lambda: 0.9658611176861268
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:07:16,905 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:07:58,919 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:07:58,919 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:07:58,920 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:07:58,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:07:58,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:58,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:07:58,937 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:07:58,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:07:58,966 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:07:58,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:07:58,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:07:59,017 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:07:59,019 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:07:59,019 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:07:59,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:07:59,140 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:07:59,140 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:07:59,140 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:07:59,140 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:07:59,140 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:07:59,140 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:07:59,140 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:07:59,140 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:07:59,144 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:07:59,148 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:07:59,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:07:59,149 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:08:00,386 - src.training - INFO -   precision: 0.0027699472974629246
2025-06-24 11:08:00,386 - src.training - INFO -   recall: 0.4185185185185185
2025-06-24 11:08:00,386 - src.training - INFO -   f1: 0.0055034701083647875
2025-06-24 11:08:00,386 - src.training - INFO -   accuracy: 0.8151579614374943
2025-06-24 11:08:00,386 - src.training - INFO -   balanced_accuracy: 0.6170808933735475
2025-06-24 11:08:00,386 - src.training - INFO -   positive_samples: 270
2025-06-24 11:08:00,387 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:08:00,387 - src.training - INFO -   total_samples: 220940
2025-06-24 11:08:00,387 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:08:00,387 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:08:00,387 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:08:00,387 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:08:00,387 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:08:00,389 - src.training - INFO - 모델 학습 완료
2025-06-24 11:08:00,389 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027699472974629246, 'recall': 0.4185185185185185, 'f1': 0.0055034701083647875, 'accuracy': 0.8151579614374943, 'balanced_accuracy': 0.6170808933735475, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:08:00,389 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:00,389 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:00,389 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:00,389 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:00,424 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:08:00,424 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:08:00,864 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = xgboost
2025-06-24 11:08:02,631 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:08:02,631 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:08:02,631 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:08:02,631 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:08:02,631 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:08:02,631 - src.training - INFO - 교차 검증 시작
2025-06-24 11:08:02,631 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:08:02,649 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:08:03,079 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:08:03,080 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:08:03,080 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:08:03,080 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:08:03,080 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:08:03,080 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:08:03,080 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:08:03,080 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:08:03,080 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:08:03,254 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:03,254 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:03,255 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:03,255 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:03,255 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:03,255 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:08:03,255 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:08:03,255 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:08:03,255 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:08:03,255 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:08:04,574 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:08:05,587 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:08:05,587 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:08:05,593 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:08:05,624 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:08:05,624 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:08:05,624 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:08:05,624 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:06,862 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:08:07,099 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:08:07,099 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:08:07,260 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:08:07,260 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:08:07,285 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:08:07,285 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:08:07,285 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:08:07,285 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:08:07,285 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:07,285 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,342 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:08:07,342 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:08:07,342 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,342 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,342 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:08:07,342 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:08:07,342 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,400 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:08:07,400 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:08:07,400 - src.training - INFO - 모델 학습 시작
2025-06-24 11:08:07,529 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:08:07,529 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:08:07,529 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:08:07,529 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:08:07,529 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:08:07,529 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:08:07,530 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:08:07,530 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:08:07,530 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:08:07,530 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,530 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:08:07,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:08:07,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:07,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:07,606 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:07,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:07,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:07,771 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:07,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:07,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:07,912 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:08:07,912 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:07,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:08:07,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,985 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:07,985 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:08:07,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:08:07,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:07,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:08,002 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:08,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:08,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:08,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:08,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:08,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:08,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:08:08,079 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:08,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:08:08,093 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:08,093 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:08:08,093 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:08,093 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   n_estimators: 259
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   learning_rate: 0.25215417296101006
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   subsample: 0.8714739456560304
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7398939640097985
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   reg_alpha: 1.66551035792772e-08
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   reg_lambda: 0.0349486075512524
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:08:08,110 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:08:17,180 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:08:17,180 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:08:17,181 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:08:17,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:08:17,181 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:17,182 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:17,200 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:17,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:17,229 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:17,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:17,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:17,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:17,278 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:08:17,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:17,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:08:17,316 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:08:17,317 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:08:17,317 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:08:17,317 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:08:17,317 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:08:17,317 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:08:17,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:08:17,317 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:08:17,320 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:08:17,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:08:17,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:08:17,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:08:18,490 - src.training - INFO -   precision: 0.0026469031233456856
2025-06-24 11:08:18,490 - src.training - INFO -   recall: 0.037037037037037035
2025-06-24 11:08:18,490 - src.training - INFO -   f1: 0.004940711462450593
2025-06-24 11:08:18,490 - src.training - INFO -   accuracy: 0.9817688060106816
2025-06-24 11:08:18,490 - src.training - INFO -   balanced_accuracy: 0.5099808831353672
2025-06-24 11:08:18,490 - src.training - INFO -   positive_samples: 270
2025-06-24 11:08:18,490 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:08:18,490 - src.training - INFO -   total_samples: 220940
2025-06-24 11:08:18,490 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:08:18,490 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:08:18,490 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:08:18,490 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:08:18,490 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:08:18,492 - src.training - INFO - 모델 학습 완료
2025-06-24 11:08:18,492 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026469031233456856, 'recall': 0.037037037037037035, 'f1': 0.004940711462450593, 'accuracy': 0.9817688060106816, 'balanced_accuracy': 0.5099808831353672, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:08:18,492 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:18,492 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:18,492 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:18,492 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:18,527 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:08:18,527 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:08:18,975 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = xgboost
2025-06-24 11:08:20,797 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:08:20,797 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:08:20,797 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:08:20,797 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:08:20,797 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:08:20,797 - src.training - INFO - 교차 검증 시작
2025-06-24 11:08:20,797 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:08:20,813 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:08:21,276 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:08:21,276 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:08:21,276 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:08:21,276 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:08:21,276 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:08:21,277 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:08:21,277 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:08:21,277 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:08:21,277 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:08:21,443 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:08:21,443 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:08:21,443 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:08:21,443 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:08:22,908 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:08:24,032 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:08:24,033 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:08:24,039 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:08:24,071 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:08:24,071 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:08:24,071 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:08:24,071 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:25,436 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:08:25,688 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:08:25,688 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:08:25,856 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:08:25,856 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:08:25,882 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:08:25,882 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:08:25,882 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:08:25,882 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:08:25,882 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:25,882 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:08:25,944 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:08:25,944 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:08:25,944 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:25,944 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:25,944 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:08:25,944 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:08:25,944 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:26,010 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:08:26,010 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:08:26,010 - src.training - INFO - 모델 학습 시작
2025-06-24 11:08:26,142 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:08:26,143 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:08:26,143 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:08:26,143 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:08:26,143 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:08:26,143 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:08:26,143 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:08:26,143 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:08:26,143 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:08:26,143 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:26,143 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:08:26,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:08:26,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:26,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:26,230 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:26,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:26,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:26,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:26,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:26,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:26,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:08:26,580 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:26,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:08:26,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:26,644 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:26,644 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:08:26,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:08:26,644 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:26,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:26,663 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:26,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:26,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:26,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:26,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:26,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:26,748 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:08:26,749 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:26,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:08:26,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:26,764 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:08:26,764 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:26,764 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   n_estimators: 859
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   learning_rate: 0.16619712900276942
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   subsample: 0.906414979716988
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6846380115914509
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   reg_alpha: 2.164462781760349e-06
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   reg_lambda: 5.673825668236114e-06
2025-06-24 11:08:26,779 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:08:26,780 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:08:26,780 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:08:39,683 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:08:39,683 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:08:39,684 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:08:39,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:08:39,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:39,684 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:39,702 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:39,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:39,733 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:39,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:39,764 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:39,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:39,784 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:08:39,784 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:39,787 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:08:39,814 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:08:39,814 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:08:39,814 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:08:39,814 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:08:39,814 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:08:39,814 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:08:39,814 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:08:39,814 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:08:39,817 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:08:39,821 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:08:39,822 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:08:39,822 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:08:41,070 - src.training - INFO -   precision: 0.002738553701326487
2025-06-24 11:08:41,070 - src.training - INFO -   recall: 0.4740740740740741
2025-06-24 11:08:41,070 - src.training - INFO -   f1: 0.005445649861731547
2025-06-24 11:08:41,070 - src.training - INFO -   accuracy: 0.7883859871458314
2025-06-24 11:08:41,070 - src.training - INFO -   balanced_accuracy: 0.6314223182261429
2025-06-24 11:08:41,070 - src.training - INFO -   positive_samples: 270
2025-06-24 11:08:41,070 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:08:41,070 - src.training - INFO -   total_samples: 220940
2025-06-24 11:08:41,070 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:08:41,070 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:08:41,070 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:08:41,070 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:08:41,071 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:08:41,071 - src.training - INFO - 모델 학습 완료
2025-06-24 11:08:41,071 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002738553701326487, 'recall': 0.4740740740740741, 'f1': 0.005445649861731547, 'accuracy': 0.7883859871458314, 'balanced_accuracy': 0.6314223182261429, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:08:41,071 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:41,071 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:41,071 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:41,071 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:41,106 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:08:41,106 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:08:41,543 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = xgboost
2025-06-24 11:08:43,287 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:08:43,287 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:08:43,287 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:08:43,287 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:08:43,287 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:08:43,287 - src.training - INFO - 교차 검증 시작
2025-06-24 11:08:43,287 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:08:43,305 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:08:43,744 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:08:43,744 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:08:43,744 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:08:43,744 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:08:43,744 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:08:43,744 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:08:43,744 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:08:43,744 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:08:43,744 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:08:43,923 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:43,923 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:43,923 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:43,924 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:43,924 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:43,924 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:08:43,924 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:08:43,924 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:08:43,924 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:08:43,924 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:08:45,241 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:08:46,250 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:08:46,250 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:08:46,256 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:08:46,287 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:08:46,288 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:08:46,288 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:08:46,288 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:47,527 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:08:47,780 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:08:47,780 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:08:47,946 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:08:47,946 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:08:47,988 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:08:47,988 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:08:47,988 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:08:47,988 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:08:47,988 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:47,988 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,034 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:08:48,034 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:08:48,034 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,034 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,034 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:08:48,034 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:08:48,034 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,093 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:08:48,093 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:08:48,093 - src.training - INFO - 모델 학습 시작
2025-06-24 11:08:48,221 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:08:48,221 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:08:48,221 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:08:48,221 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:08:48,221 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:08:48,221 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:08:48,221 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:08:48,221 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:08:48,221 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:08:48,221 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,221 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:08:48,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:08:48,221 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:48,222 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:48,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:48,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:48,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:48,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:48,519 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:48,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:48,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:08:48,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:08:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,676 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,676 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:08:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:08:48,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:48,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:48,694 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:48,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:48,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:48,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:48,750 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:48,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:48,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:08:48,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:48,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:08:48,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,784 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:08:48,784 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:48,784 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   n_estimators: 429
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   learning_rate: 0.29881597988597297
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   subsample: 0.9073635142784622
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   colsample_bytree: 0.858807554910628
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   reg_alpha: 1.5901493705752808e-08
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   reg_lambda: 3.115507888129302e-05
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:08:48,802 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:08:55,589 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:08:55,589 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:08:55,590 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:08:55,590 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:08:55,590 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:55,591 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:08:55,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:08:55,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:08:55,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:08:55,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:08:55,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:08:55,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:08:55,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:08:55,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:55,695 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:08:55,708 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:08:55,708 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:08:55,708 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:08:55,708 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:08:55,708 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:08:55,708 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:08:55,708 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:08:55,708 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:08:55,712 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:08:55,716 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:08:55,716 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:08:55,716 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:08:56,968 - src.training - INFO -   precision: 0.0028934282793630995
2025-06-24 11:08:56,968 - src.training - INFO -   recall: 0.6185185185185185
2025-06-24 11:08:56,968 - src.training - INFO -   f1: 0.005759911704347526
2025-06-24 11:08:56,968 - src.training - INFO -   accuracy: 0.739055852267584
2025-06-24 11:08:56,968 - src.training - INFO -   balanced_accuracy: 0.6788609269077841
2025-06-24 11:08:56,968 - src.training - INFO -   positive_samples: 270
2025-06-24 11:08:56,968 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:08:56,968 - src.training - INFO -   total_samples: 220940
2025-06-24 11:08:56,968 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:08:56,968 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:08:56,968 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:08:56,968 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:08:56,968 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:08:56,969 - src.training - INFO - 모델 학습 완료
2025-06-24 11:08:56,969 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028934282793630995, 'recall': 0.6185185185185185, 'f1': 0.005759911704347526, 'accuracy': 0.739055852267584, 'balanced_accuracy': 0.6788609269077841, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:08:56,969 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:56,969 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:56,969 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:08:56,969 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:08:57,004 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:08:57,004 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:08:57,439 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = xgboost
2025-06-24 11:08:59,182 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:08:59,182 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:08:59,182 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:08:59,182 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:08:59,182 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:08:59,182 - src.training - INFO - 교차 검증 시작
2025-06-24 11:08:59,182 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:08:59,199 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:08:59,639 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:08:59,639 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:08:59,639 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:08:59,639 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:08:59,639 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:08:59,639 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:08:59,639 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:08:59,639 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:08:59,639 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:08:59,816 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:08:59,816 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:08:59,816 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:08:59,816 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:09:01,168 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:09:02,189 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:09:02,189 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:09:02,195 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:09:02,226 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:09:02,226 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:09:02,226 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:09:02,226 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:09:03,473 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:09:03,730 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:09:03,730 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:09:03,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:09:03,891 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:09:03,932 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:09:03,932 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:09:03,932 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:09:03,932 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:09:03,932 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:03,932 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:09:03,989 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:09:03,989 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:09:03,989 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:03,989 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:03,989 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:09:03,989 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:09:03,989 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:04,047 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:09:04,047 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:09:04,047 - src.training - INFO - 모델 학습 시작
2025-06-24 11:09:04,166 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:09:04,166 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:09:04,166 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:09:04,166 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:09:04,166 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:09:04,166 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:09:04,166 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:09:04,166 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:09:04,166 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:09:04,166 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:04,166 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:09:04,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:09:04,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:04,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:09:04,233 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:09:04,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:09:04,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:09:04,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:09:04,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:09:04,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:09:04,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:09:04,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:04,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:09:04,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:04,599 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:04,599 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:09:04,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:09:04,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:04,600 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:09:04,617 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:09:04,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:09:04,644 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:09:04,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:09:04,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:09:04,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:09:04,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:09:04,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:04,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:09:04,705 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:04,705 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:09:04,705 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:04,705 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   n_estimators: 721
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   learning_rate: 0.18180855008657992
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   subsample: 0.884455784923078
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6588150274420255
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   reg_alpha: 1.2875809534152138e-08
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   reg_lambda: 0.0008627190145973294
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:09:04,721 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:09:04,722 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:09:24,734 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:09:24,734 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:09:24,734 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:09:24,734 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:09:24,734 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:24,735 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:09:24,753 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:09:24,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:09:24,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:09:24,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:09:24,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:09:24,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:09:24,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:09:24,834 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:24,838 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:09:24,922 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:09:24,922 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:09:24,922 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:09:24,922 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:09:24,922 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:09:24,922 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:09:24,922 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:09:24,922 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:09:24,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:09:24,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:09:24,931 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:09:24,931 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:09:26,312 - src.training - INFO -   precision: 0.0019357960961445394
2025-06-24 11:09:26,312 - src.training - INFO -   recall: 0.044444444444444446
2025-06-24 11:09:26,312 - src.training - INFO -   f1: 0.0037100015458339775
2025-06-24 11:09:26,312 - src.training - INFO -   accuracy: 0.9708291843939532
2025-06-24 11:09:26,312 - src.training - INFO -   balanced_accuracy: 0.5082035518093886
2025-06-24 11:09:26,312 - src.training - INFO -   positive_samples: 270
2025-06-24 11:09:26,312 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:09:26,312 - src.training - INFO -   total_samples: 220940
2025-06-24 11:09:26,312 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:09:26,312 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:09:26,312 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:09:26,312 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:09:26,312 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:09:26,313 - src.training - INFO - 모델 학습 완료
2025-06-24 11:09:26,313 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0019357960961445394, 'recall': 0.044444444444444446, 'f1': 0.0037100015458339775, 'accuracy': 0.9708291843939532, 'balanced_accuracy': 0.5082035518093886, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:09:26,313 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:26,314 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:26,314 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:26,314 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:26,350 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:09:26,351 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:09:26,808 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = xgboost
2025-06-24 11:09:28,678 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:09:28,678 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:09:28,678 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:09:28,678 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:09:28,678 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:09:28,678 - src.training - INFO - 교차 검증 시작
2025-06-24 11:09:28,678 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:09:28,694 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:09:29,162 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:09:29,162 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:09:29,162 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:09:29,162 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:09:29,162 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:09:29,162 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:09:29,162 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:09:29,163 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:09:29,163 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:09:29,327 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:09:29,327 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:09:29,327 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:09:29,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:09:30,791 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:09:31,911 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:09:31,911 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:09:31,917 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:09:31,950 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:09:31,950 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:09:31,950 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:09:31,950 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:09:33,311 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:09:33,579 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:09:33,579 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:09:33,747 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:09:33,747 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:09:33,790 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:09:33,790 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:09:33,790 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:09:33,790 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:09:33,790 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:33,790 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:09:33,839 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:09:33,839 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:09:33,839 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:33,839 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:33,839 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:09:33,839 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:09:33,840 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:33,905 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:09:33,905 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:09:33,905 - src.training - INFO - 모델 학습 시작
2025-06-24 11:09:34,037 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:09:34,037 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:09:34,037 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:09:34,037 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:09:34,037 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:09:34,037 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:09:34,037 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:09:34,037 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:09:34,037 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:09:34,037 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:34,037 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:09:34,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:09:34,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:34,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:09:34,122 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:09:34,185 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:09:34,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:09:34,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:09:34,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:09:34,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:09:34,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:09:34,476 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:34,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:09:34,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:34,541 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:34,541 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:09:34,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:09:34,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:34,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:09:34,559 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:09:34,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:09:34,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:09:34,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:09:34,622 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:09:34,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:09:34,643 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:09:34,643 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:09:34,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:09:34,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:34,657 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:09:34,657 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:09:34,657 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   n_estimators: 693
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   learning_rate: 0.02537172596029802
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   subsample: 0.8951229906883252
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   colsample_bytree: 0.737604432645112
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   reg_alpha: 1.970606804021277e-08
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   reg_lambda: 0.6133799194535356
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:09:34,674 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:10:41,489 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:10:41,489 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:10:41,490 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:10:41,490 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:10:41,490 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:41,491 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:10:41,509 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:10:41,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:10:41,542 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:10:41,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:10:41,575 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:10:41,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:10:41,596 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:10:41,596 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:41,599 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:10:41,879 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:10:41,880 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:10:41,880 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:10:41,880 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:10:41,880 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:10:41,880 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:10:41,880 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:10:41,880 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:10:41,883 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:10:41,888 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:10:41,888 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:10:41,888 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:10:43,268 - src.training - INFO -   precision: 0.0027247956403269754
2025-06-24 11:10:43,268 - src.training - INFO -   recall: 0.040740740740740744
2025-06-24 11:10:43,268 - src.training - INFO -   f1: 0.005107963779893197
2025-06-24 11:10:43,268 - src.training - INFO -   accuracy: 0.9806055942789897
2025-06-24 11:10:43,268 - src.training - INFO -   balanced_accuracy: 0.5112481516727676
2025-06-24 11:10:43,268 - src.training - INFO -   positive_samples: 270
2025-06-24 11:10:43,268 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:10:43,268 - src.training - INFO -   total_samples: 220940
2025-06-24 11:10:43,268 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:10:43,268 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:10:43,268 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:10:43,268 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:10:43,268 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:10:43,274 - src.training - INFO - 모델 학습 완료
2025-06-24 11:10:43,275 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027247956403269754, 'recall': 0.040740740740740744, 'f1': 0.005107963779893197, 'accuracy': 0.9806055942789897, 'balanced_accuracy': 0.5112481516727676, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:10:43,275 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:43,275 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:43,275 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:43,275 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:43,312 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:10:43,312 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:10:43,776 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = xgboost
2025-06-24 11:10:45,738 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:10:45,738 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:10:45,739 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:10:45,739 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:10:45,739 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:10:45,739 - src.training - INFO - 교차 검증 시작
2025-06-24 11:10:45,739 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:10:45,756 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:10:46,223 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:10:46,223 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:10:46,223 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:10:46,223 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:10:46,223 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:10:46,223 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:10:46,223 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:10:46,223 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:10:46,223 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:10:46,390 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:10:46,390 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:10:46,390 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:10:46,390 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:10:47,851 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:10:48,973 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:10:48,974 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:10:48,980 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:10:49,013 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:10:49,013 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:10:49,013 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:10:49,013 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:10:50,381 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:10:50,654 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:10:50,654 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:10:50,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:10:50,823 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:10:50,866 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:10:50,866 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:10:50,866 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:10:50,866 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:10:50,866 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:50,866 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:10:50,916 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:10:50,916 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:10:50,916 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:50,916 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:50,916 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:10:50,916 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:10:50,916 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:50,982 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:10:50,982 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:10:50,982 - src.training - INFO - 모델 학습 시작
2025-06-24 11:10:51,114 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:10:51,115 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:10:51,115 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:10:51,115 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:10:51,115 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:10:51,115 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:10:51,115 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:10:51,115 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:10:51,115 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:10:51,115 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:51,115 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:10:51,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:10:51,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:51,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:10:51,204 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:10:51,268 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:10:51,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:10:51,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:10:51,467 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:10:51,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:10:51,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:10:51,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:10:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:51,619 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:51,619 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:10:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:10:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:51,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:10:51,637 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:10:51,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:10:51,668 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:10:51,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:10:51,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:10:51,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:10:51,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:10:51,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:10:51,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:10:51,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:51,736 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:10:51,736 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:10:51,736 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   n_estimators: 510
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   learning_rate: 0.09541381458467652
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   subsample: 0.8373769278285045
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6376787718760416
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   reg_alpha: 1.2658691167838047e-06
2025-06-24 11:10:51,751 - src.models.xgboost_model - INFO -   reg_lambda: 0.005648807148544488
2025-06-24 11:10:51,752 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:10:51,752 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:10:51,752 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:11:21,174 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:11:21,174 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:11:21,175 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:11:21,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:11:21,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:21,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:11:21,194 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:11:21,208 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:11:21,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:11:21,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:11:21,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:11:21,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:11:21,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:11:21,272 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:21,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:11:21,393 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:11:21,393 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:11:21,393 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:11:21,393 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:11:21,393 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:11:21,393 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:11:21,393 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:11:21,393 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:11:21,397 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:11:21,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:11:21,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:11:21,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:11:22,635 - src.training - INFO -   precision: 0.003096846846846847
2025-06-24 11:11:22,635 - src.training - INFO -   recall: 0.08148148148148149
2025-06-24 11:11:22,635 - src.training - INFO -   f1: 0.005966910767561703
2025-06-24 11:11:22,635 - src.training - INFO -   accuracy: 0.9668235720105006
2025-06-24 11:11:22,636 - src.training - INFO -   balanced_accuracy: 0.5246941553417286
2025-06-24 11:11:22,636 - src.training - INFO -   positive_samples: 270
2025-06-24 11:11:22,636 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:11:22,636 - src.training - INFO -   total_samples: 220940
2025-06-24 11:11:22,636 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:11:22,636 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:11:22,636 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:11:22,636 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:11:22,636 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:11:22,638 - src.training - INFO - 모델 학습 완료
2025-06-24 11:11:22,638 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003096846846846847, 'recall': 0.08148148148148149, 'f1': 0.005966910767561703, 'accuracy': 0.9668235720105006, 'balanced_accuracy': 0.5246941553417286, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:11:22,638 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:22,638 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:22,638 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:22,638 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:22,674 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:11:22,674 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:11:23,110 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = xgboost
2025-06-24 11:11:24,884 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:11:24,884 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:11:24,884 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:11:24,884 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:11:24,884 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:11:24,884 - src.training - INFO - 교차 검증 시작
2025-06-24 11:11:24,884 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:11:24,901 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:11:25,347 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:11:25,347 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:11:25,347 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:11:25,347 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:11:25,347 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:11:25,347 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:11:25,347 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:11:25,347 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:11:25,347 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:11:25,524 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:11:25,524 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:11:25,525 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:11:25,525 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:11:25,525 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:11:25,525 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:11:25,525 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:11:25,525 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:11:25,525 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:11:25,525 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:11:26,842 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:11:27,912 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:11:27,912 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:11:27,918 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:11:27,950 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:11:27,951 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:11:27,951 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:11:27,951 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:11:29,321 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:11:29,588 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:11:29,589 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:11:29,757 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:11:29,758 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:11:29,801 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:11:29,801 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:11:29,801 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:11:29,801 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:11:29,801 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:29,801 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:11:29,851 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:11:29,851 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:11:29,851 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:29,851 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:29,851 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:11:29,851 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:11:29,851 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:29,918 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:11:29,918 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:11:29,918 - src.training - INFO - 모델 학습 시작
2025-06-24 11:11:30,051 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:11:30,051 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:11:30,051 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:11:30,051 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:11:30,051 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:11:30,051 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:11:30,051 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:11:30,051 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:11:30,051 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:11:30,051 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:30,051 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:11:30,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:11:30,051 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:30,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:11:30,140 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:11:30,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:11:30,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:11:30,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:11:30,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:11:30,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:11:30,493 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:11:30,493 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:30,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:11:30,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:30,556 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:30,556 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:11:30,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:11:30,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:30,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:11:30,574 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:11:30,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:11:30,605 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:11:30,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:11:30,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:11:30,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:11:30,658 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:11:30,658 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:11:30,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:11:30,673 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:30,673 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:11:30,673 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:11:30,673 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   n_estimators: 528
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   learning_rate: 0.18765955445298974
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   subsample: 0.7783164850055796
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6743747673024677
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   reg_alpha: 2.3542607815281803e-08
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   reg_lambda: 6.663084718825128e-08
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:11:30,689 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:11:30,690 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:12:00,501 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:12:00,501 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:12:00,501 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:12:00,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:12:00,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:00,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:00,521 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:00,535 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:00,549 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:00,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:00,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:00,597 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:00,600 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:12:00,600 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:00,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:12:00,680 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:12:00,681 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:12:00,681 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:12:00,681 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:12:00,681 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:12:00,681 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:12:00,681 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:12:00,681 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:12:00,684 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:12:00,689 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:12:00,689 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:12:00,689 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:12:01,871 - src.training - INFO -   precision: 0.0031831537708129284
2025-06-24 11:12:01,872 - src.training - INFO -   recall: 0.14444444444444443
2025-06-24 11:12:01,872 - src.training - INFO -   f1: 0.006229036895064686
2025-06-24 11:12:01,872 - src.training - INFO -   accuracy: 0.9436770163845388
2025-06-24 11:12:01,872 - src.training - INFO -   balanced_accuracy: 0.544549679511387
2025-06-24 11:12:01,872 - src.training - INFO -   positive_samples: 270
2025-06-24 11:12:01,872 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:12:01,872 - src.training - INFO -   total_samples: 220940
2025-06-24 11:12:01,872 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:12:01,872 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:12:01,872 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:12:01,872 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:12:01,872 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:12:01,873 - src.training - INFO - 모델 학습 완료
2025-06-24 11:12:01,873 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031831537708129284, 'recall': 0.14444444444444443, 'f1': 0.006229036895064686, 'accuracy': 0.9436770163845388, 'balanced_accuracy': 0.544549679511387, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:12:01,873 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:01,873 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:01,873 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:01,873 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:01,909 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:12:01,909 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:12:02,347 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = xgboost
2025-06-24 11:12:04,094 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:12:04,094 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:12:04,094 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:12:04,094 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:12:04,094 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:12:04,094 - src.training - INFO - 교차 검증 시작
2025-06-24 11:12:04,094 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:12:04,112 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:12:04,549 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:12:04,549 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:12:04,549 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:12:04,549 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:12:04,549 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:12:04,549 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:12:04,549 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:12:04,549 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:12:04,549 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:12:04,721 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:12:04,721 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:12:04,721 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:12:04,721 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:12:04,721 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:12:04,721 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:12:04,722 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:12:04,722 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:12:04,722 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:12:04,722 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:12:06,029 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:12:07,037 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:12:07,038 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:12:07,043 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:12:07,076 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:12:07,076 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:12:07,076 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:12:07,076 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:12:08,316 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:12:08,552 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:12:08,552 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:12:08,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:12:08,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:12:08,739 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:12:08,739 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:12:08,739 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:12:08,739 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:12:08,739 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:08,739 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:12:08,796 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:12:08,796 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:12:08,796 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:08,797 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:08,797 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:12:08,797 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:12:08,797 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:08,857 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:12:08,857 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:12:08,857 - src.training - INFO - 모델 학습 시작
2025-06-24 11:12:08,988 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:12:08,988 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:12:08,988 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:12:08,988 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:12:08,988 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:12:08,988 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:12:08,988 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:12:08,988 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:12:08,988 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:12:08,988 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:08,988 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:12:08,988 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:12:08,988 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:08,988 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:09,064 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:09,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:09,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:09,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:09,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:09,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:09,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:12:09,368 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:09,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:12:09,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:09,438 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:09,438 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:12:09,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:12:09,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:09,439 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:09,456 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:09,469 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:09,483 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:09,496 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:09,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:09,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:09,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:12:09,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:09,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:12:09,544 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:09,544 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:12:09,544 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:09,544 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   n_estimators: 308
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   learning_rate: 0.0885138685416574
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   subsample: 0.9969505034695316
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6293828088732968
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   reg_alpha: 1.8187496497212238e-07
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   reg_lambda: 8.51867827925266
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:12:09,560 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:12:09,561 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:12:37,370 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:12:37,370 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:12:37,382 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:12:37,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:12:37,382 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:37,383 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:37,401 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:37,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:37,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:37,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:37,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:37,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:37,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:12:37,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:37,483 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:12:37,603 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:12:37,603 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:12:37,603 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:12:37,603 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:12:37,603 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:12:37,603 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:12:37,603 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:12:37,603 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:12:37,607 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:12:37,611 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:12:37,612 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:12:37,612 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:12:38,850 - src.training - INFO -   precision: 0.002687187003786491
2025-06-24 11:12:38,850 - src.training - INFO -   recall: 0.08148148148148149
2025-06-24 11:12:38,850 - src.training - INFO -   f1: 0.005202790587678846
2025-06-24 11:12:38,850 - src.training - INFO -   accuracy: 0.9619217887209197
2025-06-24 11:12:38,850 - src.training - INFO -   balanced_accuracy: 0.5222402649171127
2025-06-24 11:12:38,850 - src.training - INFO -   positive_samples: 270
2025-06-24 11:12:38,850 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:12:38,850 - src.training - INFO -   total_samples: 220940
2025-06-24 11:12:38,850 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:12:38,850 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:12:38,850 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:12:38,850 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:12:38,851 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:12:38,853 - src.training - INFO - 모델 학습 완료
2025-06-24 11:12:38,853 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002687187003786491, 'recall': 0.08148148148148149, 'f1': 0.005202790587678846, 'accuracy': 0.9619217887209197, 'balanced_accuracy': 0.5222402649171127, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:12:38,853 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:38,853 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:38,853 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:38,853 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:38,889 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:12:38,889 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:12:39,336 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = xgboost
2025-06-24 11:12:41,082 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:12:41,082 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:12:41,082 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:12:41,082 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:12:41,082 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:12:41,082 - src.training - INFO - 교차 검증 시작
2025-06-24 11:12:41,082 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:12:41,101 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:12:41,537 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:12:41,537 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:12:41,537 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:12:41,537 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:12:41,537 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:12:41,537 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:12:41,537 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:12:41,537 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:12:41,537 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:12:41,712 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:12:41,712 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:12:41,712 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:12:41,712 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:12:43,016 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:12:44,015 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:12:44,015 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:12:44,021 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:12:44,054 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:12:44,054 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:12:44,054 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:12:44,054 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:12:45,293 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:12:45,531 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:12:45,531 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:12:45,693 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:12:45,693 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:12:45,719 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:12:45,719 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:12:45,719 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:12:45,719 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:12:45,719 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:45,719 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:12:45,777 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:12:45,777 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:12:45,777 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:45,777 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:45,777 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:12:45,777 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:12:45,777 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:45,836 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:12:45,836 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:12:45,836 - src.training - INFO - 모델 학습 시작
2025-06-24 11:12:45,964 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:12:45,964 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:12:45,964 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:12:45,964 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:12:45,964 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:12:45,964 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:12:45,964 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:12:45,964 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:12:45,964 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:12:45,964 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:45,964 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:12:45,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:12:45,964 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:45,965 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:46,039 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:46,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:46,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:46,202 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:46,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:46,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:46,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:12:46,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:46,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:12:46,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:46,412 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:46,412 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:12:46,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:12:46,412 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:46,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:46,429 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:46,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:46,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:46,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:46,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:46,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:46,505 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:12:46,505 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:46,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:12:46,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:46,520 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:12:46,520 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:46,520 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   n_estimators: 356
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   learning_rate: 0.11776809355297856
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   subsample: 0.9409679345539048
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6233034136420053
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   reg_alpha: 4.448060188198752e-05
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   reg_lambda: 9.290530295498803e-07
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:12:46,536 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:12:52,954 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:12:52,954 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:12:52,955 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:12:52,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:12:52,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:52,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:12:52,973 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:12:52,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:12:53,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:12:53,017 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:12:53,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:12:53,051 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:12:53,054 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:12:53,054 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:53,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:12:53,071 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:12:53,071 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:12:53,071 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:12:53,071 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:12:53,071 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:12:53,071 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:12:53,071 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:12:53,071 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:12:53,075 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:12:53,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:12:53,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:12:53,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:12:54,319 - src.training - INFO -   precision: 0.0026879767526334906
2025-06-24 11:12:54,319 - src.training - INFO -   recall: 0.6851851851851852
2025-06-24 11:12:54,319 - src.training - INFO -   f1: 0.005354946088718431
2025-06-24 11:12:54,319 - src.training - INFO -   accuracy: 0.688942699375396
2025-06-24 11:12:54,319 - src.training - INFO -   balanced_accuracy: 0.6870662410269063
2025-06-24 11:12:54,319 - src.training - INFO -   positive_samples: 270
2025-06-24 11:12:54,319 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:12:54,319 - src.training - INFO -   total_samples: 220940
2025-06-24 11:12:54,319 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:12:54,319 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:12:54,319 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:12:54,319 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:12:54,319 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:12:54,320 - src.training - INFO - 모델 학습 완료
2025-06-24 11:12:54,320 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026879767526334906, 'recall': 0.6851851851851852, 'f1': 0.005354946088718431, 'accuracy': 0.688942699375396, 'balanced_accuracy': 0.6870662410269063, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:12:54,320 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:54,320 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:54,320 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:12:54,320 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:12:54,357 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:12:54,357 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:12:54,783 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = xgboost
2025-06-24 11:12:56,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:12:56,541 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:12:56,541 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:12:56,541 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:12:56,541 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:12:56,541 - src.training - INFO - 교차 검증 시작
2025-06-24 11:12:56,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:12:56,559 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:12:56,994 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:12:56,994 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:12:56,994 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:12:56,994 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:12:56,994 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:12:56,994 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:12:56,994 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:12:56,994 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:12:56,994 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:12:57,170 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:12:57,170 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:12:57,170 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:12:57,170 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:12:58,457 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:12:59,457 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:12:59,457 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:12:59,463 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:12:59,497 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:12:59,497 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:12:59,497 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:12:59,497 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:13:00,728 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:13:00,966 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:13:00,966 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:13:01,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:13:01,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:13:01,157 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:13:01,157 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:13:01,157 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:13:01,157 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:13:01,157 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:01,157 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,214 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:13:01,214 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:13:01,214 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,214 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,214 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:13:01,214 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:13:01,214 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,271 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:13:01,272 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:13:01,272 - src.training - INFO - 모델 학습 시작
2025-06-24 11:13:01,400 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:13:01,400 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:13:01,400 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:13:01,400 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:13:01,400 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:13:01,400 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:13:01,400 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:13:01,400 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:13:01,400 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:13:01,400 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,400 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:13:01,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:13:01,400 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:01,401 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:13:01,476 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:13:01,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:13:01,586 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:13:01,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:13:01,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:13:01,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:13:01,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:13:01,778 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:01,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:13:01,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,848 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,848 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:13:01,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:13:01,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:01,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:13:01,865 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:13:01,878 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:13:01,892 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:13:01,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:13:01,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:13:01,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:13:01,939 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:13:01,939 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:01,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:13:01,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,954 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:13:01,954 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:01,954 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   n_estimators: 611
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   learning_rate: 0.2702491488938537
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   subsample: 0.9559273270000992
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8491755968965418
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   reg_alpha: 7.185740038068055e-07
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   reg_lambda: 2.9755186163332477e-08
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:13:01,970 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:13:21,093 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:13:21,093 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:13:21,094 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:13:21,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:13:21,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:21,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:13:21,112 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:13:21,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:13:21,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:13:21,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:13:21,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:13:21,191 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:13:21,195 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:13:21,195 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:21,199 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:13:21,265 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:13:21,266 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:13:21,266 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:13:21,266 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:13:21,266 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:13:21,266 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:13:21,266 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:13:21,266 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:13:21,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:13:21,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:13:21,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:13:21,274 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:13:22,500 - src.training - INFO -   precision: 0.0033071517155849523
2025-06-24 11:13:22,500 - src.training - INFO -   recall: 0.05925925925925926
2025-06-24 11:13:22,500 - src.training - INFO -   f1: 0.006264682850430697
2025-06-24 11:13:22,500 - src.training - INFO -   accuracy: 0.9770254367701638
2025-06-24 11:13:22,500 - src.training - INFO -   balanced_accuracy: 0.5187038127990682
2025-06-24 11:13:22,500 - src.training - INFO -   positive_samples: 270
2025-06-24 11:13:22,500 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:13:22,500 - src.training - INFO -   total_samples: 220940
2025-06-24 11:13:22,500 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:13:22,500 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:13:22,500 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:13:22,500 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:13:22,501 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:13:22,502 - src.training - INFO - 모델 학습 완료
2025-06-24 11:13:22,502 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0033071517155849523, 'recall': 0.05925925925925926, 'f1': 0.006264682850430697, 'accuracy': 0.9770254367701638, 'balanced_accuracy': 0.5187038127990682, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:13:22,502 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:22,502 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:22,502 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:22,502 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:22,537 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:13:22,538 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:13:22,973 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = xgboost
2025-06-24 11:13:24,712 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:13:24,713 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:13:24,713 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:13:24,713 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:13:24,713 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:13:24,713 - src.training - INFO - 교차 검증 시작
2025-06-24 11:13:24,713 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:13:24,731 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:13:25,174 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:13:25,174 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:13:25,174 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:13:25,174 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:13:25,174 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:13:25,174 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:13:25,174 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:13:25,174 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:13:25,174 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:13:25,347 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:13:25,347 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:13:25,348 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:13:25,348 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:13:25,348 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:13:25,348 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:13:25,348 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:13:25,348 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:13:25,348 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:13:25,348 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:13:26,650 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:13:27,651 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:13:27,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:13:27,657 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:13:27,689 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:13:27,689 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:13:27,689 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:13:27,690 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:13:28,914 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:13:29,148 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:13:29,148 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:13:29,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:13:29,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:13:29,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:13:29,334 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:13:29,334 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:13:29,334 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:13:29,334 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:29,334 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:13:29,391 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:13:29,391 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:13:29,391 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:29,391 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:29,391 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:13:29,391 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:13:29,391 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:29,450 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:13:29,450 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:13:29,450 - src.training - INFO - 모델 학습 시작
2025-06-24 11:13:29,579 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:13:29,579 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:13:29,579 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:13:29,579 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:13:29,579 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:13:29,579 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:13:29,579 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:13:29,579 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:13:29,579 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:13:29,580 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:29,580 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:13:29,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:13:29,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:29,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:13:29,655 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:13:29,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:13:29,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:13:29,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:13:29,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:13:29,943 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:13:29,958 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:13:29,958 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:30,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:13:30,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:30,028 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:30,028 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:13:30,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:13:30,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:30,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:13:30,045 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:13:30,058 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:13:30,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:13:30,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:13:30,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:13:30,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:13:30,119 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:13:30,119 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:30,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:13:30,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:30,134 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:13:30,134 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:30,134 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   n_estimators: 199
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   learning_rate: 0.07625240993861546
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   subsample: 0.7756844558685272
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   colsample_bytree: 0.807327274259362
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   reg_alpha: 4.801698200287993e-07
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   reg_lambda: 4.862216596960632
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:13:30,151 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:13:53,730 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:13:53,731 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:13:53,731 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:13:53,731 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:13:53,731 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:53,732 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:13:53,749 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:13:53,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:13:53,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:13:53,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:13:53,809 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:13:53,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:13:53,828 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:13:53,828 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:53,831 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:13:53,926 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:13:53,926 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:13:53,926 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:13:53,926 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:13:53,926 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:13:53,926 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:13:53,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:13:53,926 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:13:53,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:13:53,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:13:53,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:13:53,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:13:55,172 - src.training - INFO -   precision: 0.0032334554860961413
2025-06-24 11:13:55,172 - src.training - INFO -   recall: 0.05555555555555555
2025-06-24 11:13:55,172 - src.training - INFO -   f1: 0.006111224281931147
2025-06-24 11:13:55,172 - src.training - INFO -   accuracy: 0.9779170815606046
2025-06-24 11:13:55,172 - src.training - INFO -   balanced_accuracy: 0.5173005946536557
2025-06-24 11:13:55,172 - src.training - INFO -   positive_samples: 270
2025-06-24 11:13:55,172 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:13:55,172 - src.training - INFO -   total_samples: 220940
2025-06-24 11:13:55,172 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:13:55,172 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:13:55,172 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:13:55,172 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:13:55,173 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:13:55,175 - src.training - INFO - 모델 학습 완료
2025-06-24 11:13:55,175 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032334554860961413, 'recall': 0.05555555555555555, 'f1': 0.006111224281931147, 'accuracy': 0.9779170815606046, 'balanced_accuracy': 0.5173005946536557, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:13:55,175 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:55,175 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:55,175 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:13:55,175 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:13:55,211 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:13:55,211 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:13:55,656 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = xgboost
2025-06-24 11:13:57,493 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:13:57,493 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:13:57,493 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:13:57,493 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:13:57,493 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:13:57,493 - src.training - INFO - 교차 검증 시작
2025-06-24 11:13:57,493 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:13:57,511 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:13:57,959 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:13:57,959 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:13:57,959 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:13:57,959 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:13:57,959 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:13:57,959 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:13:57,959 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:13:57,959 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:13:57,959 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:13:58,139 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:13:58,139 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:13:58,139 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:13:58,139 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:13:59,429 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:14:00,441 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:14:00,441 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:14:00,447 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:14:00,480 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:14:00,481 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:14:00,481 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:14:00,481 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:14:01,699 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:14:01,922 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:14:01,922 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:14:02,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:14:02,094 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:14:02,119 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:14:02,119 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:14:02,119 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:14:02,119 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:14:02,119 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:02,119 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,176 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:14:02,176 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:14:02,176 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,176 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,176 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:14:02,176 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:14:02,176 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,235 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:14:02,235 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:14:02,235 - src.training - INFO - 모델 학습 시작
2025-06-24 11:14:02,350 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:14:02,350 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:14:02,350 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:14:02,350 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:14:02,350 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:14:02,350 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:14:02,351 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:14:02,351 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:14:02,351 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:14:02,351 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,351 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:14:02,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:14:02,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:02,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:14:02,417 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:14:02,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:14:02,526 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:14:02,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:14:02,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:14:02,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:14:02,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:14:02,716 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:02,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:14:02,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,795 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,795 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:14:02,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:14:02,795 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:02,796 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:14:02,813 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:14:02,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:14:02,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:14:02,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:14:02,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:14:02,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:14:02,887 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:14:02,887 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:02,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:14:02,901 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,901 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:14:02,901 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:02,901 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   n_estimators: 616
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   learning_rate: 0.08080698397568403
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   subsample: 0.6321360888775868
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7079770615977192
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   reg_alpha: 2.463043880643913e-06
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   reg_lambda: 0.23906560367981458
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:14:02,917 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:14:46,725 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:14:46,725 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:14:46,725 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:14:46,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:14:46,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:46,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:14:46,744 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:14:46,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:14:46,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:14:46,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:14:46,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:14:46,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:14:46,831 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:14:46,831 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:46,834 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:14:46,961 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:14:46,962 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:14:46,962 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:14:46,962 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:14:46,962 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:14:46,962 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:14:46,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:14:46,962 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:14:46,965 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:14:46,969 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:14:46,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:14:46,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:14:48,349 - src.training - INFO -   precision: 0.003784742755765819
2025-06-24 11:14:48,349 - src.training - INFO -   recall: 0.11851851851851852
2025-06-24 11:14:48,349 - src.training - INFO -   f1: 0.007335243553008596
2025-06-24 11:14:48,349 - src.training - INFO -   accuracy: 0.9607993120304155
2025-06-24 11:14:48,349 - src.training - INFO -   balanced_accuracy: 0.5401742001211798
2025-06-24 11:14:48,349 - src.training - INFO -   positive_samples: 270
2025-06-24 11:14:48,349 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:14:48,349 - src.training - INFO -   total_samples: 220940
2025-06-24 11:14:48,349 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:14:48,349 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:14:48,349 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:14:48,349 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:14:48,349 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:14:48,350 - src.training - INFO - 모델 학습 완료
2025-06-24 11:14:48,350 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003784742755765819, 'recall': 0.11851851851851852, 'f1': 0.007335243553008596, 'accuracy': 0.9607993120304155, 'balanced_accuracy': 0.5401742001211798, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:14:48,350 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:48,350 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:48,350 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:48,350 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:48,388 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:14:48,388 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:14:48,851 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = xgboost
2025-06-24 11:14:50,790 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:14:50,790 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:14:50,790 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:14:50,790 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:14:50,790 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:14:50,790 - src.training - INFO - 교차 검증 시작
2025-06-24 11:14:50,790 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:14:50,806 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:14:51,278 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:14:51,278 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:14:51,278 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:14:51,278 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:14:51,278 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:14:51,278 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:14:51,278 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:14:51,278 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:14:51,278 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:14:51,436 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:14:51,436 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:14:51,436 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:14:51,436 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:14:52,875 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:14:53,990 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:14:53,990 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:14:53,996 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:14:54,029 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:14:54,030 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:14:54,030 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:14:54,030 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:14:55,376 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:14:55,617 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:14:55,617 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:14:55,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:14:55,787 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:14:55,813 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:14:55,813 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:14:55,813 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:14:55,813 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:14:55,813 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:55,813 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:14:55,875 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:14:55,875 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:14:55,875 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:55,875 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:55,875 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:14:55,875 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:14:55,875 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:55,941 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:14:55,941 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:14:55,941 - src.training - INFO - 모델 학습 시작
2025-06-24 11:14:56,060 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:14:56,060 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:14:56,060 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:14:56,060 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:14:56,060 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:14:56,060 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:14:56,060 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:14:56,060 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:14:56,060 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:14:56,060 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:56,060 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:14:56,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:14:56,060 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:56,061 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:14:56,138 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:14:56,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:14:56,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:14:56,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:14:56,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:14:56,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:14:56,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:14:56,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:56,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:14:56,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:56,558 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:56,558 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:14:56,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:14:56,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:56,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:14:56,576 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:14:56,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:14:56,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:14:56,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:14:56,641 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:14:56,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:14:56,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:14:56,662 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:14:56,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:14:56,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:56,676 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:14:56,676 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:14:56,677 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:14:56,692 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   n_estimators: 373
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   learning_rate: 0.11085448642522
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   subsample: 0.6999173953911981
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7238803118866866
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   reg_alpha: 0.00045873311841405315
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   reg_lambda: 0.003721166657033529
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:14:56,693 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:15:29,370 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:15:29,370 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:15:29,371 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:15:29,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:15:29,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:29,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:15:29,389 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:15:29,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:15:29,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:15:29,432 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:15:29,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:15:29,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:15:29,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:15:29,469 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:29,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:15:29,582 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:15:29,582 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:15:29,582 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:15:29,582 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:15:29,582 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:15:29,582 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:15:29,582 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:15:29,582 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:15:29,586 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:15:29,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:15:29,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:15:29,591 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:15:30,839 - src.training - INFO -   precision: 0.0032959789057350032
2025-06-24 11:15:30,839 - src.training - INFO -   recall: 0.05555555555555555
2025-06-24 11:15:30,839 - src.training - INFO -   f1: 0.006222775357809583
2025-06-24 11:15:30,839 - src.training - INFO -   accuracy: 0.9783153797411062
2025-06-24 11:15:30,839 - src.training - INFO -   balanced_accuracy: 0.5174999874120734
2025-06-24 11:15:30,839 - src.training - INFO -   positive_samples: 270
2025-06-24 11:15:30,839 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:15:30,839 - src.training - INFO -   total_samples: 220940
2025-06-24 11:15:30,839 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:15:30,839 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:15:30,839 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:15:30,839 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:15:30,839 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:15:30,841 - src.training - INFO - 모델 학습 완료
2025-06-24 11:15:30,841 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032959789057350032, 'recall': 0.05555555555555555, 'f1': 0.006222775357809583, 'accuracy': 0.9783153797411062, 'balanced_accuracy': 0.5174999874120734, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:15:30,841 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:30,841 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:30,841 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:30,841 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:30,877 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:15:30,877 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:15:31,320 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = xgboost
2025-06-24 11:15:33,063 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:15:33,063 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:15:33,063 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:15:33,063 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:15:33,063 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:15:33,063 - src.training - INFO - 교차 검증 시작
2025-06-24 11:15:33,063 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:15:33,081 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:15:33,519 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:15:33,520 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:15:33,520 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:15:33,520 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:15:33,520 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:15:33,520 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:15:33,520 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:15:33,520 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:15:33,520 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:15:33,695 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:15:33,695 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:15:33,695 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:15:33,695 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:15:35,073 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:15:36,187 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:15:36,187 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:15:36,193 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:15:36,226 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:15:36,226 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:15:36,226 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:15:36,226 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:15:37,589 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:15:37,858 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:15:37,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:15:38,027 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:15:38,027 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:15:38,071 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:15:38,071 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:15:38,071 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:15:38,071 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:15:38,071 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:38,071 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,121 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:15:38,121 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:15:38,121 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,121 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,121 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:15:38,121 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:15:38,121 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,187 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:15:38,188 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:15:38,188 - src.training - INFO - 모델 학습 시작
2025-06-24 11:15:38,319 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:15:38,319 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:15:38,319 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:15:38,319 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:15:38,319 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:15:38,319 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:15:38,319 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:15:38,319 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:15:38,319 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:15:38,319 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,319 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:15:38,319 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:15:38,319 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:38,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:15:38,407 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:15:38,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:15:38,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:15:38,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:15:38,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:15:38,747 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:15:38,760 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:15:38,760 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:15:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,823 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,823 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:15:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:15:38,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:38,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:15:38,841 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:15:38,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:15:38,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:15:38,887 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:15:38,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:15:38,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:15:38,926 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:15:38,926 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:38,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:15:38,941 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,941 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:15:38,941 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:38,941 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   n_estimators: 412
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   learning_rate: 0.061456202265883685
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   subsample: 0.6324190284492907
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6863219373886931
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   reg_alpha: 0.00999864219767453
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   reg_lambda: 0.01675606517320793
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:15:38,957 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:15:38,958 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:15:45,984 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:15:45,985 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:15:45,985 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:15:45,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:15:45,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:45,986 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:15:46,006 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:15:46,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:15:46,039 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:15:46,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:15:46,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:15:46,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:15:46,095 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:15:46,095 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:46,098 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:15:46,111 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:15:46,111 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:15:46,111 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:15:46,111 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:15:46,111 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:15:46,111 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:15:46,111 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:15:46,111 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:15:46,115 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:15:46,119 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:15:46,120 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:15:46,120 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:15:47,507 - src.training - INFO -   precision: 0.002835497520757296
2025-06-24 11:15:47,507 - src.training - INFO -   recall: 0.7222222222222222
2025-06-24 11:15:47,507 - src.training - INFO -   f1: 0.005648817369389204
2025-06-24 11:15:47,507 - src.training - INFO -   accuracy: 0.6892776319362723
2025-06-24 11:15:47,507 - src.training - INFO -   balanced_accuracy: 0.7057297724606375
2025-06-24 11:15:47,507 - src.training - INFO -   positive_samples: 270
2025-06-24 11:15:47,507 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:15:47,507 - src.training - INFO -   total_samples: 220940
2025-06-24 11:15:47,507 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:15:47,507 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:15:47,507 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:15:47,507 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:15:47,507 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:15:47,508 - src.training - INFO - 모델 학습 완료
2025-06-24 11:15:47,508 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002835497520757296, 'recall': 0.7222222222222222, 'f1': 0.005648817369389204, 'accuracy': 0.6892776319362723, 'balanced_accuracy': 0.7057297724606375, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:15:47,508 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:47,508 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:47,508 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:47,508 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:47,546 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:15:47,546 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:15:47,984 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = xgboost
2025-06-24 11:15:49,954 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:15:49,954 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:15:49,954 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:15:49,955 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:15:49,955 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:15:49,955 - src.training - INFO - 교차 검증 시작
2025-06-24 11:15:49,955 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:15:49,970 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:15:50,444 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:15:50,444 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:15:50,444 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:15:50,444 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:15:50,444 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:15:50,444 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:15:50,444 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:15:50,444 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:15:50,444 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:15:50,611 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:15:50,611 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:15:50,611 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:15:50,611 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:15:52,045 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:15:53,149 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:15:53,149 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:15:53,155 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:15:53,187 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:15:53,188 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:15:53,188 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:15:53,188 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:15:54,543 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:15:54,792 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:15:54,792 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:15:54,961 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:15:54,961 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:15:54,988 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:15:54,988 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:15:54,988 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:15:54,988 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:15:54,988 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:54,988 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,037 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:15:55,037 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:15:55,037 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,037 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,037 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:15:55,037 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:15:55,037 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,104 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:15:55,104 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:15:55,104 - src.training - INFO - 모델 학습 시작
2025-06-24 11:15:55,236 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:15:55,236 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:15:55,236 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:15:55,236 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:15:55,236 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:15:55,236 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:15:55,236 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:15:55,236 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:15:55,236 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:15:55,236 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,236 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:15:55,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:15:55,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:55,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:15:55,324 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:15:55,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:15:55,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:15:55,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:15:55,589 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:15:55,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:15:55,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:15:55,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:55,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:15:55,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,750 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,750 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:15:55,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:15:55,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:55,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:15:55,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:15:55,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:15:55,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:15:55,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:15:55,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:15:55,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:15:55,852 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:15:55,852 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:15:55,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:15:55,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,867 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:15:55,867 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:15:55,867 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   n_estimators: 918
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   learning_rate: 0.12661274250582832
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   subsample: 0.8117908754240956
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7600703808112637
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   reg_alpha: 0.00022845638735505361
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   reg_lambda: 1.81348058685489
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:15:55,886 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:16:16,336 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:16:16,336 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:16:16,340 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:16:16,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:16:16,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:16,341 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:16:16,359 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:16:16,373 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:16:16,388 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:16:16,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:16:16,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:16:16,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:16:16,439 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:16:16,439 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:16,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:16:16,524 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:16:16,524 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:16:16,524 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:16:16,524 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:16:16,524 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:16:16,524 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:16:16,524 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:16:16,524 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:16:16,528 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:16:16,532 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:16:16,532 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:16:16,533 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:16:17,695 - src.training - INFO -   precision: 0.00322234156820623
2025-06-24 11:16:17,696 - src.training - INFO -   recall: 0.044444444444444446
2025-06-24 11:16:17,696 - src.training - INFO -   f1: 0.006009013520280421
2025-06-24 11:16:17,696 - src.training - INFO -   accuracy: 0.9820313207205577
2025-06-24 11:16:17,696 - src.training - INFO -   balanced_accuracy: 0.5138114731398821
2025-06-24 11:16:17,696 - src.training - INFO -   positive_samples: 270
2025-06-24 11:16:17,696 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:16:17,696 - src.training - INFO -   total_samples: 220940
2025-06-24 11:16:17,696 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:16:17,696 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:16:17,696 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:16:17,696 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:16:17,696 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:16:17,698 - src.training - INFO - 모델 학습 완료
2025-06-24 11:16:17,698 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.00322234156820623, 'recall': 0.044444444444444446, 'f1': 0.006009013520280421, 'accuracy': 0.9820313207205577, 'balanced_accuracy': 0.5138114731398821, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:16:17,698 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:17,698 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:17,699 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:17,699 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:17,735 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:16:17,735 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:16:18,190 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = xgboost
2025-06-24 11:16:20,144 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:16:20,144 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:16:20,144 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:16:20,144 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:16:20,144 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:16:20,144 - src.training - INFO - 교차 검증 시작
2025-06-24 11:16:20,144 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:16:20,160 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:16:20,636 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:16:20,636 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:16:20,636 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:16:20,636 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:16:20,636 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:16:20,636 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:16:20,636 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:16:20,636 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:16:20,636 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:16:20,803 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:16:20,803 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:16:20,803 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:16:20,803 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:16:22,238 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:16:23,341 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:16:23,341 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:16:23,347 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:16:23,380 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:16:23,380 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:16:23,380 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:16:23,380 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:16:24,723 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:16:24,977 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:16:24,977 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:16:25,146 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:16:25,146 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:16:25,172 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:16:25,172 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:16:25,172 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:16:25,172 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:16:25,173 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:25,173 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,222 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:16:25,222 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:16:25,222 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,222 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,222 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:16:25,222 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:16:25,222 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,289 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:16:25,289 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:16:25,289 - src.training - INFO - 모델 학습 시작
2025-06-24 11:16:25,421 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:16:25,421 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:16:25,421 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:16:25,421 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:16:25,421 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:16:25,421 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:16:25,421 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:16:25,421 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:16:25,421 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:16:25,421 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,421 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:16:25,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:16:25,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:25,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:16:25,510 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:16:25,576 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:16:25,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:16:25,710 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:16:25,776 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:16:25,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:16:25,869 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:16:25,870 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:25,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:16:25,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,937 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:25,937 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:16:25,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:16:25,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:25,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:16:25,955 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:16:25,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:16:25,987 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:16:26,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:16:26,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:16:26,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:16:26,039 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:16:26,040 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:26,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:16:26,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:26,055 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:16:26,055 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:26,055 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   n_estimators: 582
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   learning_rate: 0.10303600554992384
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   subsample: 0.7443367481854752
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6290892562218044
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   reg_alpha: 6.921019451579801e-08
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   reg_lambda: 8.301071159117088
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:16:26,074 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:16:55,893 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:16:55,893 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:16:55,897 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:16:55,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:16:55,897 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:55,898 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:16:55,916 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:16:55,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:16:55,945 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:16:55,959 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:16:55,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:16:55,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:16:55,995 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:16:55,995 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:56,000 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:16:56,113 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:16:56,114 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:16:56,114 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:16:56,114 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:16:56,114 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:16:56,114 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:16:56,114 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:16:56,114 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:16:56,117 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:16:56,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:16:56,122 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:16:56,122 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:16:57,434 - src.training - INFO -   precision: 0.0032849712565015056
2025-06-24 11:16:57,434 - src.training - INFO -   recall: 0.08888888888888889
2025-06-24 11:16:57,434 - src.training - INFO -   f1: 0.006335797254487857
2025-06-24 11:16:57,434 - src.training - INFO -   accuracy: 0.9659274011043723
2025-06-24 11:16:57,434 - src.training - INFO -   balanced_accuracy: 0.5279446936853924
2025-06-24 11:16:57,434 - src.training - INFO -   positive_samples: 270
2025-06-24 11:16:57,434 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:16:57,434 - src.training - INFO -   total_samples: 220940
2025-06-24 11:16:57,434 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:16:57,434 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:16:57,434 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:16:57,434 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:16:57,435 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:16:57,437 - src.training - INFO - 모델 학습 완료
2025-06-24 11:16:57,437 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032849712565015056, 'recall': 0.08888888888888889, 'f1': 0.006335797254487857, 'accuracy': 0.9659274011043723, 'balanced_accuracy': 0.5279446936853924, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:16:57,437 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:57,437 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:57,437 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:16:57,437 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:16:57,474 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:16:57,474 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:16:57,933 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = xgboost
2025-06-24 11:16:59,894 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:16:59,894 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:16:59,894 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:16:59,894 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:16:59,894 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:16:59,894 - src.training - INFO - 교차 검증 시작
2025-06-24 11:16:59,894 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:16:59,909 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:17:00,386 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:17:00,386 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:17:00,386 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:17:00,386 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:17:00,386 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:17:00,386 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:17:00,386 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:17:00,386 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:17:00,386 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:17:00,552 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:17:00,553 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:17:00,553 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:17:00,553 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:17:00,553 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:17:00,553 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:17:00,553 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:17:00,553 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:17:00,553 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:17:00,553 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:17:01,991 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:17:03,102 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:17:03,102 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:17:03,108 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:17:03,141 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:17:03,141 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:17:03,141 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:17:03,141 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:17:04,477 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:17:04,729 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:17:04,729 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:17:04,899 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:17:04,899 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:17:04,925 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:17:04,925 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:17:04,925 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:17:04,925 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:17:04,925 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:04,925 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:17:04,975 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:17:04,975 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:17:04,975 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:04,975 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:04,975 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:17:04,975 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:17:04,975 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:05,043 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:17:05,043 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:17:05,043 - src.training - INFO - 모델 학습 시작
2025-06-24 11:17:05,176 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:17:05,176 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:17:05,176 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:17:05,176 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:17:05,176 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:17:05,176 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:17:05,176 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:17:05,176 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:17:05,176 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:17:05,176 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:05,176 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:17:05,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:17:05,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:05,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:17:05,264 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:17:05,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:17:05,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:17:05,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:17:05,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:17:05,602 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:17:05,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:17:05,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:05,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:17:05,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:05,686 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:05,686 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:17:05,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:17:05,686 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:05,687 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:17:05,704 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:17:05,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:17:05,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:17:05,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:17:05,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:17:05,787 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:17:05,790 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:17:05,790 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:05,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:17:05,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:05,805 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:17:05,805 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:05,805 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   n_estimators: 649
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   learning_rate: 0.25843904889252545
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   subsample: 0.9279124741932271
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   colsample_bytree: 0.699891662059685
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   reg_alpha: 2.180587176277352e-06
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   reg_lambda: 4.472538951229534e-05
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:17:05,824 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:17:33,826 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:17:33,826 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:17:33,828 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:17:33,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:17:33,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:33,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:17:33,846 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:17:33,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:17:33,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:17:33,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:17:33,905 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:17:33,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:17:33,928 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:17:33,928 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:33,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:17:33,999 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:17:33,999 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:17:33,999 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:17:33,999 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:17:33,999 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:17:33,999 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:17:33,999 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:17:33,999 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:17:34,003 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:17:34,007 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:17:34,007 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:17:34,007 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:17:35,235 - src.training - INFO -   precision: 0.0030231335436382754
2025-06-24 11:17:35,235 - src.training - INFO -   recall: 0.17037037037037037
2025-06-24 11:17:35,236 - src.training - INFO -   f1: 0.0059408497998191916
2025-06-24 11:17:35,236 - src.training - INFO -   accuracy: 0.9303249751063637
2025-06-24 11:17:35,236 - src.training - INFO -   balanced_accuracy: 0.5508125926261603
2025-06-24 11:17:35,236 - src.training - INFO -   positive_samples: 270
2025-06-24 11:17:35,236 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:17:35,236 - src.training - INFO -   total_samples: 220940
2025-06-24 11:17:35,236 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:17:35,236 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:17:35,236 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:17:35,236 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:17:35,236 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:17:35,237 - src.training - INFO - 모델 학습 완료
2025-06-24 11:17:35,237 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0030231335436382754, 'recall': 0.17037037037037037, 'f1': 0.0059408497998191916, 'accuracy': 0.9303249751063637, 'balanced_accuracy': 0.5508125926261603, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:17:35,237 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:35,237 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:35,237 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:35,237 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:35,273 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:17:35,273 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:17:35,711 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = xgboost
2025-06-24 11:17:37,432 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:17:37,432 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:17:37,432 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:17:37,432 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:17:37,432 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:17:37,432 - src.training - INFO - 교차 검증 시작
2025-06-24 11:17:37,432 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:17:37,448 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:17:37,893 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:17:37,893 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:17:37,893 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:17:37,893 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:17:37,893 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:17:37,893 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:17:37,893 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:17:37,893 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:17:37,893 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:17:38,068 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:17:38,069 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:17:38,069 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:17:38,069 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:17:38,069 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:17:38,069 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:17:38,069 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:17:38,069 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:17:38,069 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:17:38,069 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:17:39,374 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:17:40,380 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:17:40,380 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:17:40,386 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:17:40,417 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:17:40,417 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:17:40,417 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:17:40,417 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:17:41,637 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:17:41,871 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:17:41,871 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:17:42,031 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:17:42,031 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:17:42,057 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:17:42,057 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:17:42,057 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:17:42,057 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:17:42,057 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:42,057 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,102 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:17:42,102 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:17:42,102 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,102 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,102 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:17:42,102 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:17:42,102 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,161 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:17:42,161 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:17:42,161 - src.training - INFO - 모델 학습 시작
2025-06-24 11:17:42,290 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:17:42,290 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:17:42,290 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:17:42,290 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:17:42,290 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:17:42,290 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:17:42,290 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:17:42,290 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:17:42,290 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:17:42,290 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,290 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:17:42,290 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:17:42,290 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:42,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:17:42,365 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:17:42,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:17:42,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:17:42,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:17:42,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:17:42,657 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:17:42,674 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:17:42,674 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:42,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:17:42,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,751 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,751 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:17:42,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:17:42,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:42,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:17:42,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:17:42,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:17:42,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:17:42,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:17:42,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:17:42,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:17:42,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:17:42,844 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:17:42,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:17:42,859 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,859 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:17:42,859 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:17:42,859 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   n_estimators: 744
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   learning_rate: 0.19386606772000092
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   subsample: 0.9336594364104578
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6720400142324919
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:17:42,877 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:17:42,888 - src.models.xgboost_model - INFO -   reg_alpha: 2.3585243546672064e-07
2025-06-24 11:17:42,888 - src.models.xgboost_model - INFO -   reg_lambda: 2.8970976999941537e-06
2025-06-24 11:17:42,888 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:17:42,888 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:17:42,888 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:18:09,756 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:18:09,756 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:18:09,758 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:18:09,758 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:18:09,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:09,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:18:09,778 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:18:09,793 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:18:09,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:18:09,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:18:09,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:18:09,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:18:09,860 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:18:09,860 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:09,864 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:18:09,926 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:18:09,926 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:18:09,926 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:18:09,926 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:18:09,926 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:18:09,926 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:18:09,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:18:09,926 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:18:09,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:18:09,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:18:09,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:18:09,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:18:11,188 - src.training - INFO -   precision: 0.0026875770702248078
2025-06-24 11:18:11,188 - src.training - INFO -   recall: 0.3148148148148148
2025-06-24 11:18:11,188 - src.training - INFO -   f1: 0.005329654826472709
2025-06-24 11:18:11,188 - src.training - INFO -   accuracy: 0.856399927582149
2025-06-24 11:18:11,188 - src.training - INFO -   balanced_accuracy: 0.5859386984755182
2025-06-24 11:18:11,188 - src.training - INFO -   positive_samples: 270
2025-06-24 11:18:11,188 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:18:11,188 - src.training - INFO -   total_samples: 220940
2025-06-24 11:18:11,188 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:18:11,188 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:18:11,188 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:18:11,188 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:18:11,189 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:18:11,189 - src.training - INFO - 모델 학습 완료
2025-06-24 11:18:11,189 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026875770702248078, 'recall': 0.3148148148148148, 'f1': 0.005329654826472709, 'accuracy': 0.856399927582149, 'balanced_accuracy': 0.5859386984755182, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:18:11,189 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:11,189 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:11,189 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:11,189 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:11,226 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:18:11,226 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:18:11,648 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = xgboost
2025-06-24 11:18:13,350 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:18:13,350 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:18:13,350 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:18:13,350 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:18:13,350 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:18:13,350 - src.training - INFO - 교차 검증 시작
2025-06-24 11:18:13,350 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:18:13,367 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:18:13,822 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:18:13,822 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:18:13,822 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:18:13,822 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:18:13,822 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:18:13,822 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:18:13,822 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:18:13,822 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:18:13,822 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:18:13,994 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:18:13,995 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:18:13,995 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:18:13,995 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:18:13,995 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:18:13,995 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:18:13,995 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:18:13,995 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:18:13,995 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:18:13,995 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:18:15,307 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:18:16,303 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:18:16,303 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:18:16,309 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:18:16,340 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:18:16,340 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:18:16,340 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:18:16,340 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:18:17,543 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:18:17,774 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:18:17,774 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:18:17,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:18:17,937 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:18:17,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:18:17,980 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:18:17,980 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:18:17,980 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:18:17,980 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:17,980 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,025 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:18:18,025 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:18:18,026 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,026 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,026 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:18:18,026 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:18:18,026 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,084 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:18:18,084 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:18:18,085 - src.training - INFO - 모델 학습 시작
2025-06-24 11:18:18,204 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:18:18,204 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:18:18,204 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:18:18,204 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:18:18,204 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:18:18,204 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:18:18,204 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:18:18,204 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:18:18,204 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:18:18,204 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,204 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:18:18,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:18:18,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:18,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:18:18,271 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:18:18,327 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:18:18,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:18:18,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:18:18,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:18:18,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:18:18,573 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:18:18,573 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:18,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:18:18,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,641 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,641 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:18:18,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:18:18,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:18,641 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:18:18,659 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:18:18,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:18:18,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:18:18,701 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:18:18,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:18:18,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:18:18,734 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:18:18,734 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:18:18,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:18:18,751 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,751 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:18:18,751 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:18:18,751 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   n_estimators: 678
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   learning_rate: 0.040740155209711505
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   subsample: 0.6690357510979812
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7407852665750437
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   reg_alpha: 0.0008530738250913986
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   reg_lambda: 0.7210928442062176
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:18:18,769 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:18:18,770 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:19:03,976 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:19:03,976 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:19:03,977 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:19:03,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:19:03,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:03,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:19:03,995 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:19:04,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:19:04,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:19:04,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:19:04,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:19:04,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:19:04,082 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:19:04,082 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:04,085 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:19:04,212 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:19:04,212 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:19:04,212 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:19:04,212 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:19:04,212 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:19:04,212 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:19:04,212 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:19:04,212 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:19:04,216 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:19:04,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:19:04,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:19:04,220 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:19:05,615 - src.training - INFO -   precision: 0.003347418098008012
2025-06-24 11:19:05,615 - src.training - INFO -   recall: 0.22592592592592592
2025-06-24 11:19:05,615 - src.training - INFO -   f1: 0.0065970907911101495
2025-06-24 11:19:05,615 - src.training - INFO -   accuracy: 0.9168507287046257
2025-06-24 11:19:05,615 - src.training - INFO -   balanced_accuracy: 0.5718110166177416
2025-06-24 11:19:05,615 - src.training - INFO -   positive_samples: 270
2025-06-24 11:19:05,615 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:19:05,615 - src.training - INFO -   total_samples: 220940
2025-06-24 11:19:05,615 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:19:05,615 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:19:05,615 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:19:05,615 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:19:05,615 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:19:05,616 - src.training - INFO - 모델 학습 완료
2025-06-24 11:19:05,616 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003347418098008012, 'recall': 0.22592592592592592, 'f1': 0.0065970907911101495, 'accuracy': 0.9168507287046257, 'balanced_accuracy': 0.5718110166177416, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:19:05,616 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:05,616 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:05,616 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:05,616 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:05,654 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:19:05,655 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:19:06,108 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = xgboost
2025-06-24 11:19:08,042 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:19:08,042 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:19:08,042 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:19:08,042 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:19:08,042 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:19:08,042 - src.training - INFO - 교차 검증 시작
2025-06-24 11:19:08,042 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:19:08,060 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:19:08,526 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:19:08,526 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:19:08,526 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:19:08,526 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:19:08,526 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:19:08,526 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:19:08,526 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:19:08,526 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:19:08,526 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:19:08,687 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:19:08,687 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:19:08,687 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:19:08,687 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:19:10,130 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:19:11,238 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:19:11,238 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:19:11,244 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:19:11,276 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:19:11,276 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:19:11,276 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:19:11,276 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:19:12,610 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:19:12,859 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:19:12,860 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:19:13,029 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:19:13,029 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:19:13,072 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:19:13,072 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:19:13,072 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:19:13,072 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:19:13,072 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:13,072 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,122 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:19:13,122 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:19:13,122 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,122 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,122 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:19:13,122 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:19:13,122 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,186 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:19:13,186 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:19:13,186 - src.training - INFO - 모델 학습 시작
2025-06-24 11:19:13,306 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:19:13,306 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:19:13,306 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:19:13,306 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:19:13,306 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:19:13,306 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:19:13,306 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:19:13,306 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:19:13,306 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:19:13,306 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,306 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:19:13,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:19:13,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:13,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:19:13,384 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:19:13,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:19:13,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:19:13,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:19:13,647 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:19:13,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:19:13,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:19:13,733 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:13,792 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:19:13,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,793 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,793 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:19:13,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:19:13,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:13,793 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:19:13,811 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:19:13,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:19:13,842 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:19:13,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:19:13,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:19:13,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:19:13,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:19:13,895 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:13,911 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:19:13,912 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,912 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:19:13,912 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:13,912 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   n_estimators: 350
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   learning_rate: 0.22015629760352146
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   subsample: 0.60011574006151
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7620034521304817
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:19:13,927 - src.models.xgboost_model - INFO -   reg_alpha: 5.5339667232558274e-05
2025-06-24 11:19:13,928 - src.models.xgboost_model - INFO -   reg_lambda: 0.5001481434097121
2025-06-24 11:19:13,928 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:19:13,928 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:19:13,928 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:19:41,035 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:19:41,035 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:19:41,035 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:19:41,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:19:41,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:41,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:19:41,054 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:19:41,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:19:41,088 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:19:41,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:19:41,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:19:41,139 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:19:41,141 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:19:41,141 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:41,143 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:19:41,225 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:19:41,225 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:19:41,225 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:19:41,225 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:19:41,225 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:19:41,225 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:19:41,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:19:41,225 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:19:41,229 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:19:41,233 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:19:41,233 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:19:41,233 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:19:42,629 - src.training - INFO -   precision: 0.0036196117143797303
2025-06-24 11:19:42,629 - src.training - INFO -   recall: 0.08148148148148149
2025-06-24 11:19:42,629 - src.training - INFO -   f1: 0.006931316950220542
2025-06-24 11:19:42,629 - src.training - INFO -   accuracy: 0.971467366705893
2025-06-24 11:19:42,629 - src.training - INFO -   balanced_accuracy: 0.5270188936387332
2025-06-24 11:19:42,629 - src.training - INFO -   positive_samples: 270
2025-06-24 11:19:42,629 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:19:42,629 - src.training - INFO -   total_samples: 220940
2025-06-24 11:19:42,629 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:19:42,629 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:19:42,629 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:19:42,629 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:19:42,629 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:19:42,630 - src.training - INFO - 모델 학습 완료
2025-06-24 11:19:42,630 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0036196117143797303, 'recall': 0.08148148148148149, 'f1': 0.006931316950220542, 'accuracy': 0.971467366705893, 'balanced_accuracy': 0.5270188936387332, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:19:42,630 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:42,630 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:42,630 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:42,630 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:42,668 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:19:42,668 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:19:43,127 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = xgboost
2025-06-24 11:19:45,008 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:19:45,008 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:19:45,008 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:19:45,008 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:19:45,008 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:19:45,008 - src.training - INFO - 교차 검증 시작
2025-06-24 11:19:45,008 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:19:45,023 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:19:45,488 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:19:45,488 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:19:45,488 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:19:45,488 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:19:45,488 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:19:45,488 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:19:45,488 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:19:45,488 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:19:45,488 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:19:45,650 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:19:45,650 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:19:45,650 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:19:45,650 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:19:47,092 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:19:48,193 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:19:48,193 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:19:48,199 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:19:48,231 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:19:48,232 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:19:48,232 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:19:48,232 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:19:49,573 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:19:49,843 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:19:49,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:19:50,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:19:50,012 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:19:50,038 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:19:50,038 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:19:50,038 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:19:50,038 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:19:50,038 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:50,038 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,100 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:19:50,100 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:19:50,100 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,100 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,101 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:19:50,101 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:19:50,101 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,166 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:19:50,166 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:19:50,166 - src.training - INFO - 모델 학습 시작
2025-06-24 11:19:50,299 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:19:50,299 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:19:50,299 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:19:50,299 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:19:50,299 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:19:50,299 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:19:50,299 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:19:50,299 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:19:50,299 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:19:50,299 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,299 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:19:50,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:19:50,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:50,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:19:50,388 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:19:50,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:19:50,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:19:50,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:19:50,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:19:50,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:19:50,740 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:19:50,740 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:50,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:19:50,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,804 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,804 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:19:50,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:19:50,804 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:50,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:19:50,823 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:19:50,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:19:50,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:19:50,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:19:50,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:19:50,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:19:50,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:19:50,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:19:50,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:19:50,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,925 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:19:50,925 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:19:50,925 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   n_estimators: 875
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   learning_rate: 0.15791588720567978
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   subsample: 0.9494001767252641
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8207961455196641
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   reg_alpha: 0.0013262058869862518
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   reg_lambda: 0.020959101601016668
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:19:50,940 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:20:23,826 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:20:23,826 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:20:23,827 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:20:23,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:20:23,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:23,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:20:23,847 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:20:23,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:20:23,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:20:23,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:20:23,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:20:23,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:20:23,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:20:23,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:23,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:20:24,014 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:20:24,014 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:20:24,014 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:20:24,014 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:20:24,014 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:20:24,014 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:20:24,014 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:20:24,014 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:20:24,017 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:20:24,021 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:20:24,022 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:20:24,022 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:20:25,339 - src.training - INFO -   precision: 0.0026932572381288275
2025-06-24 11:20:25,339 - src.training - INFO -   recall: 0.3111111111111111
2025-06-24 11:20:25,339 - src.training - INFO -   f1: 0.005340284179408118
2025-06-24 11:20:25,339 - src.training - INFO -   accuracy: 0.8583733140219064
2025-06-24 11:20:25,339 - src.training - INFO -   balanced_accuracy: 0.5850770129353535
2025-06-24 11:20:25,339 - src.training - INFO -   positive_samples: 270
2025-06-24 11:20:25,339 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:20:25,339 - src.training - INFO -   total_samples: 220940
2025-06-24 11:20:25,339 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:20:25,339 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:20:25,340 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:20:25,340 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:20:25,340 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:20:25,340 - src.training - INFO - 모델 학습 완료
2025-06-24 11:20:25,340 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026932572381288275, 'recall': 0.3111111111111111, 'f1': 0.005340284179408118, 'accuracy': 0.8583733140219064, 'balanced_accuracy': 0.5850770129353535, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:20:25,340 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:25,340 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:25,340 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:25,340 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:25,379 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:20:25,379 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:20:25,830 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = xgboost
2025-06-24 11:20:27,770 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:20:27,770 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:20:27,770 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:20:27,771 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:20:27,771 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:20:27,771 - src.training - INFO - 교차 검증 시작
2025-06-24 11:20:27,771 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:20:27,788 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:20:28,255 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:20:28,255 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:20:28,255 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:20:28,255 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:20:28,255 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:20:28,255 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:20:28,255 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:20:28,255 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:20:28,255 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:20:28,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:20:28,415 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:20:28,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:20:28,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:20:28,416 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:20:28,416 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:20:28,416 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:20:28,416 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:20:28,416 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:20:28,416 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:20:29,724 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:20:30,725 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:20:30,725 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:20:30,731 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:20:30,762 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:20:30,762 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:20:30,762 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:20:30,762 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:20:31,973 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:20:32,214 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:20:32,214 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:20:32,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:20:32,374 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:20:32,415 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:20:32,416 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:20:32,416 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:20:32,416 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:20:32,416 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:32,416 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:20:32,462 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:20:32,463 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:20:32,463 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:32,463 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:32,463 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:20:32,463 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:20:32,463 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:32,522 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:20:32,523 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:20:32,523 - src.training - INFO - 모델 학습 시작
2025-06-24 11:20:32,639 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:20:32,639 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:20:32,639 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:20:32,639 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:20:32,639 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:20:32,639 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:20:32,639 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:20:32,639 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:20:32,639 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:20:32,639 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:32,639 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:20:32,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:20:32,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:32,639 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:20:32,705 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:20:32,759 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:20:32,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:20:32,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:20:32,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:20:32,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:20:33,003 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:20:33,003 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:33,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:20:33,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:33,070 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:33,070 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:20:33,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:20:33,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:33,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:20:33,088 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:20:33,101 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:20:33,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:20:33,129 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:20:33,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:20:33,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:20:33,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:20:33,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:20:33,177 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:20:33,178 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:33,178 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:20:33,178 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:20:33,178 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   n_estimators: 589
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   learning_rate: 0.01752985040409572
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   subsample: 0.7358650087988696
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7242704072295301
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   reg_alpha: 2.3807340851202023
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   reg_lambda: 4.93695624718404
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:20:33,193 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:21:30,983 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:21:30,983 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:21:30,983 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:21:30,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:21:30,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:30,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:21:31,002 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:21:31,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:21:31,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:21:31,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:21:31,061 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:21:31,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:21:31,081 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:21:31,081 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:31,084 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:21:31,292 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:21:31,293 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:21:31,293 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:21:31,293 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:21:31,293 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:21:31,293 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:21:31,293 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:21:31,293 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:21:31,296 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:21:31,300 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:21:31,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:21:31,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:21:32,531 - src.training - INFO -   precision: 0.004100041000410004
2025-06-24 11:21:32,531 - src.training - INFO -   recall: 0.14814814814814814
2025-06-24 11:21:32,531 - src.training - INFO -   f1: 0.007979253939756632
2025-06-24 11:21:32,531 - src.training - INFO -   accuracy: 0.9549832533719562
2025-06-24 11:21:32,531 - src.training - INFO -   balanced_accuracy: 0.5520593008833368
2025-06-24 11:21:32,531 - src.training - INFO -   positive_samples: 270
2025-06-24 11:21:32,531 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:21:32,531 - src.training - INFO -   total_samples: 220940
2025-06-24 11:21:32,531 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:21:32,531 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:21:32,531 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:21:32,531 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:21:32,532 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:21:32,535 - src.training - INFO - 모델 학습 완료
2025-06-24 11:21:32,535 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.004100041000410004, 'recall': 0.14814814814814814, 'f1': 0.007979253939756632, 'accuracy': 0.9549832533719562, 'balanced_accuracy': 0.5520593008833368, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:21:32,535 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:32,535 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:32,535 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:32,535 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:32,572 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:21:32,572 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:21:32,994 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = xgboost
2025-06-24 11:21:34,736 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:21:34,736 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:21:34,736 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:21:34,736 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:21:34,736 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:21:34,736 - src.training - INFO - 교차 검증 시작
2025-06-24 11:21:34,736 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:21:34,753 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:21:35,187 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:21:35,187 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:21:35,187 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:21:35,188 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:21:35,188 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:21:35,188 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:21:35,188 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:21:35,188 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:21:35,188 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:21:35,363 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:21:35,363 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:21:35,363 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:21:35,363 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:21:36,663 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:21:37,659 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:21:37,659 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:21:37,665 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:21:37,696 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:21:37,696 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:21:37,696 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:21:37,696 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:21:38,905 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:21:39,140 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:21:39,140 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:21:39,300 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:21:39,300 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:21:39,325 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:21:39,326 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:21:39,326 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:21:39,326 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:21:39,326 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:39,326 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:21:39,371 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:21:39,371 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:21:39,371 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:39,371 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:39,371 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:21:39,371 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:21:39,371 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:39,430 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:21:39,430 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:21:39,430 - src.training - INFO - 모델 학습 시작
2025-06-24 11:21:39,558 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:21:39,558 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:21:39,558 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:21:39,558 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:21:39,558 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:21:39,558 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:21:39,558 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:21:39,558 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:21:39,558 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:21:39,558 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:39,558 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:21:39,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:21:39,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:39,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:21:39,633 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:21:39,686 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:21:39,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:21:39,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:21:39,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:21:39,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:21:39,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:21:39,940 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:40,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:21:40,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:40,014 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:40,014 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:21:40,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:21:40,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:40,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:21:40,031 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:21:40,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:21:40,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:21:40,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:21:40,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:21:40,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:21:40,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:21:40,105 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:21:40,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:21:40,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:40,120 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:21:40,120 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:21:40,120 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   n_estimators: 391
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   learning_rate: 0.015297458697669082
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   subsample: 0.9025921757330445
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6119425165805752
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   reg_alpha: 0.006134353166247106
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   reg_lambda: 4.323545161049353
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:21:40,138 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:21:40,139 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:22:11,276 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:22:11,276 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:22:11,280 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:22:11,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:22:11,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:11,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:22:11,298 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:22:11,314 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:22:11,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:22:11,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:22:11,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:22:11,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:22:11,383 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:22:11,383 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:11,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:22:11,505 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:22:11,506 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:22:11,506 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:22:11,506 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:22:11,506 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:22:11,506 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:22:11,506 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:22:11,506 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:22:11,509 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:22:11,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:22:11,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:22:11,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:22:12,904 - src.training - INFO -   precision: 0.0027658045977011496
2025-06-24 11:22:12,904 - src.training - INFO -   recall: 0.2851851851851852
2025-06-24 11:22:12,904 - src.training - INFO -   f1: 0.005478477410174315
2025-06-24 11:22:12,904 - src.training - INFO -   accuracy: 0.8734679098397755
2025-06-24 11:22:12,904 - src.training - INFO -   balanced_accuracy: 0.5796864431386568
2025-06-24 11:22:12,904 - src.training - INFO -   positive_samples: 270
2025-06-24 11:22:12,904 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:22:12,904 - src.training - INFO -   total_samples: 220940
2025-06-24 11:22:12,904 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:22:12,904 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:22:12,904 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:22:12,904 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:22:12,905 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:22:12,906 - src.training - INFO - 모델 학습 완료
2025-06-24 11:22:12,906 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027658045977011496, 'recall': 0.2851851851851852, 'f1': 0.005478477410174315, 'accuracy': 0.8734679098397755, 'balanced_accuracy': 0.5796864431386568, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:22:12,906 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:12,906 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:12,906 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:12,906 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:12,945 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:22:12,945 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:22:13,400 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = xgboost
2025-06-24 11:22:15,265 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:22:15,265 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:22:15,265 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:22:15,265 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:22:15,265 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:22:15,265 - src.training - INFO - 교차 검증 시작
2025-06-24 11:22:15,265 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:22:15,280 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:22:15,743 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:22:15,743 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:22:15,744 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:22:15,744 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:22:15,744 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:22:15,744 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:22:15,744 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:22:15,744 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:22:15,744 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:22:15,910 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:22:15,910 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:22:15,910 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:22:15,910 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:22:17,350 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:22:18,465 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:22:18,465 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:22:18,471 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:22:18,504 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:22:18,504 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:22:18,504 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:22:18,504 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:22:19,841 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:22:20,097 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:22:20,097 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:22:20,266 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:22:20,266 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:22:20,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:22:20,293 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:22:20,293 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:22:20,293 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:22:20,293 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:20,293 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:22:20,342 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:22:20,342 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:22:20,342 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:20,342 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:20,342 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:22:20,342 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:22:20,342 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:20,408 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:22:20,408 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:22:20,408 - src.training - INFO - 모델 학습 시작
2025-06-24 11:22:20,541 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:22:20,541 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:22:20,541 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:22:20,541 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:22:20,541 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:22:20,541 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:22:20,541 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:22:20,541 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:22:20,541 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:22:20,541 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:20,541 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:22:20,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:22:20,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:20,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:22:20,629 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:22:20,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:22:20,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:22:20,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:22:20,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:22:20,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:22:20,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:22:20,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:21,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:22:21,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:21,055 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:21,055 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:22:21,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:22:21,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:21,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:22:21,073 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:22:21,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:22:21,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:22:21,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:22:21,140 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:22:21,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:22:21,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:22:21,160 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:21,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:22:21,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:21,176 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:22:21,176 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:21,176 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   n_estimators: 223
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   learning_rate: 0.18950083788177602
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   subsample: 0.788865698031678
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6469334596470011
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   reg_alpha: 1.003694659253724e-06
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   reg_lambda: 0.3416922752536984
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:22:21,194 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:22:39,325 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:22:39,325 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:22:39,328 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:22:39,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:22:39,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:39,328 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:22:39,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:22:39,362 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:22:39,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:22:39,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:22:39,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:22:39,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:22:39,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:22:39,427 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:39,431 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:22:39,505 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:22:39,505 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:22:39,505 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:22:39,505 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:22:39,505 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:22:39,505 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:22:39,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:22:39,505 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:22:39,509 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:22:39,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:22:39,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:22:39,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:22:40,754 - src.training - INFO -   precision: 0.002874049027895182
2025-06-24 11:22:40,754 - src.training - INFO -   recall: 0.06296296296296296
2025-06-24 11:22:40,754 - src.training - INFO -   f1: 0.00549717057396928
2025-06-24 11:22:40,754 - src.training - INFO -   accuracy: 0.9721598624060831
2025-06-24 11:22:40,754 - src.training - INFO -   balanced_accuracy: 0.5181176350139054
2025-06-24 11:22:40,754 - src.training - INFO -   positive_samples: 270
2025-06-24 11:22:40,754 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:22:40,754 - src.training - INFO -   total_samples: 220940
2025-06-24 11:22:40,754 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:22:40,754 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:22:40,754 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:22:40,754 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:22:40,754 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:22:40,756 - src.training - INFO - 모델 학습 완료
2025-06-24 11:22:40,756 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002874049027895182, 'recall': 0.06296296296296296, 'f1': 0.00549717057396928, 'accuracy': 0.9721598624060831, 'balanced_accuracy': 0.5181176350139054, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:22:40,756 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:40,756 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:40,756 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:40,756 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:40,794 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:22:40,794 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:22:41,222 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = xgboost
2025-06-24 11:22:42,925 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:22:42,925 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:22:42,925 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:22:42,925 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:22:42,925 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:22:42,925 - src.training - INFO - 교차 검증 시작
2025-06-24 11:22:42,926 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:22:42,944 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:22:43,371 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:22:43,371 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:22:43,371 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:22:43,371 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:22:43,371 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:22:43,371 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:22:43,371 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:22:43,372 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:22:43,372 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:22:43,544 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:22:43,544 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:22:43,544 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:22:43,544 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:22:44,840 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:22:45,832 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:22:45,832 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:22:45,838 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:22:45,869 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:22:45,869 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:22:45,869 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:22:45,869 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:22:47,074 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:22:47,309 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:22:47,309 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:22:47,469 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:22:47,469 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:22:47,495 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:22:47,495 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:22:47,495 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:22:47,495 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:22:47,495 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:47,495 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:22:47,541 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:22:47,541 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:22:47,541 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:47,541 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:47,541 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:22:47,541 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:22:47,542 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:47,602 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:22:47,602 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:22:47,602 - src.training - INFO - 모델 학습 시작
2025-06-24 11:22:47,733 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:22:47,733 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:22:47,733 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:22:47,733 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:22:47,733 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:22:47,733 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:22:47,733 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:22:47,733 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:22:47,733 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:22:47,733 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:47,733 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:22:47,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:22:47,733 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:47,734 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:22:47,808 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:22:47,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:22:47,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:22:47,973 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:22:48,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:22:48,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:22:48,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:22:48,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:48,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:22:48,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:48,191 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:48,191 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:22:48,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:22:48,191 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:48,192 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:22:48,209 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:22:48,222 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:22:48,236 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:22:48,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:22:48,264 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:22:48,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:22:48,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:22:48,282 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:22:48,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:22:48,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:48,297 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:22:48,297 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:22:48,297 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:22:48,314 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   n_estimators: 391
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   learning_rate: 0.015234690047250213
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   subsample: 0.9063531024520378
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8178829973484265
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   reg_alpha: 1.4541566597273223
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   reg_lambda: 0.08043711629448283
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:22:48,315 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:23:14,643 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:23:14,643 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:23:14,645 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:23:14,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:23:14,645 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:14,646 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:23:14,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:23:14,679 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:23:14,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:23:14,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:23:14,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:23:14,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:23:14,746 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:23:14,746 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:14,750 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:23:14,840 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:23:14,840 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:23:14,840 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:23:14,840 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:23:14,840 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:23:14,840 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:23:14,840 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:23:14,840 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:23:14,844 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:23:14,847 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:23:14,848 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:23:14,848 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:23:16,095 - src.training - INFO -   precision: 0.0026463777704267286
2025-06-24 11:23:16,096 - src.training - INFO -   recall: 0.3851851851851852
2025-06-24 11:23:16,096 - src.training - INFO -   f1: 0.00525664029922414
2025-06-24 11:23:16,096 - src.training - INFO -   accuracy: 0.8218475604236444
2025-06-24 11:23:16,096 - src.training - INFO -   balanced_accuracy: 0.6037835111587774
2025-06-24 11:23:16,096 - src.training - INFO -   positive_samples: 270
2025-06-24 11:23:16,096 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:23:16,096 - src.training - INFO -   total_samples: 220940
2025-06-24 11:23:16,096 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:23:16,096 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:23:16,096 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:23:16,096 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:23:16,096 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:23:16,097 - src.training - INFO - 모델 학습 완료
2025-06-24 11:23:16,097 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026463777704267286, 'recall': 0.3851851851851852, 'f1': 0.00525664029922414, 'accuracy': 0.8218475604236444, 'balanced_accuracy': 0.6037835111587774, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:23:16,097 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:16,097 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:16,097 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:16,097 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:16,135 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:23:16,135 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:23:16,571 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = xgboost
2025-06-24 11:23:18,282 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:23:18,282 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:23:18,282 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:23:18,282 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:23:18,282 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:23:18,282 - src.training - INFO - 교차 검증 시작
2025-06-24 11:23:18,282 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:23:18,298 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:23:18,767 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:23:18,767 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:23:18,767 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:23:18,767 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:23:18,767 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:23:18,767 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:23:18,767 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:23:18,767 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:23:18,767 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:23:18,934 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:23:18,934 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:23:18,934 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:23:18,934 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:23:20,374 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:23:21,473 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:23:21,473 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:23:21,479 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:23:21,512 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:23:21,512 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:23:21,512 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:23:21,512 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:23:22,844 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:23:23,096 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:23:23,096 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:23:23,264 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:23:23,265 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:23:23,291 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:23:23,291 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:23:23,291 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:23:23,291 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:23:23,291 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:23,291 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:23:23,340 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:23:23,340 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:23:23,340 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:23,340 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:23,340 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:23:23,340 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:23:23,340 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:23,406 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:23:23,406 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:23:23,406 - src.training - INFO - 모델 학습 시작
2025-06-24 11:23:23,539 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:23:23,539 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:23:23,539 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:23:23,539 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:23:23,539 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:23:23,539 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:23:23,539 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:23:23,539 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:23:23,539 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:23:23,539 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:23,539 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:23:23,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:23:23,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:23,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:23:23,628 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:23:23,693 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:23:23,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:23:23,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:23:23,893 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:23:23,969 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:23:23,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:23:23,987 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:24,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:23:24,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:24,053 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:24,053 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:23:24,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:23:24,053 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:24,054 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:23:24,071 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:23:24,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:23:24,102 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:23:24,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:23:24,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:23:24,153 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:23:24,156 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:23:24,156 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:24,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:23:24,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:24,171 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:23:24,171 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:24,171 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   n_estimators: 264
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   learning_rate: 0.02466494384808259
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   subsample: 0.7689490940081205
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6189338591758899
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   reg_alpha: 2.855682295938181
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   reg_lambda: 0.004995135323881774
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:23:24,189 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:23:24,190 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:23:42,648 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:23:42,648 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:23:42,650 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:23:42,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:23:42,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:42,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:23:42,669 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:23:42,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:23:42,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:23:42,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:23:42,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:23:42,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:23:42,756 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:23:42,756 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:42,759 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:23:42,829 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:23:42,829 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:23:42,829 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:23:42,829 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:23:42,829 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:23:42,829 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:23:42,829 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:23:42,829 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:23:42,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:23:42,837 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:23:42,837 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:23:42,837 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:23:44,086 - src.training - INFO -   precision: 0.0026327978352551134
2025-06-24 11:23:44,086 - src.training - INFO -   recall: 0.4
2025-06-24 11:23:44,086 - src.training - INFO -   f1: 0.005231164176212734
2025-06-24 11:23:44,086 - src.training - INFO -   accuracy: 0.8140897981352403
2025-06-24 11:23:44,086 - src.training - INFO -   balanced_accuracy: 0.6072982281234423
2025-06-24 11:23:44,086 - src.training - INFO -   positive_samples: 270
2025-06-24 11:23:44,086 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:23:44,086 - src.training - INFO -   total_samples: 220940
2025-06-24 11:23:44,086 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:23:44,087 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:23:44,087 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:23:44,087 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:23:44,087 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:23:44,088 - src.training - INFO - 모델 학습 완료
2025-06-24 11:23:44,088 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026327978352551134, 'recall': 0.4, 'f1': 0.005231164176212734, 'accuracy': 0.8140897981352403, 'balanced_accuracy': 0.6072982281234423, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:23:44,088 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:44,088 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:44,088 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:44,088 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:44,130 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:23:44,130 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:23:44,571 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = xgboost
2025-06-24 11:23:46,312 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:23:46,312 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:23:46,312 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:23:46,312 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:23:46,312 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:23:46,312 - src.training - INFO - 교차 검증 시작
2025-06-24 11:23:46,312 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:23:46,330 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:23:46,768 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:23:46,768 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:23:46,768 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:23:46,768 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:23:46,768 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:23:46,768 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:23:46,768 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:23:46,768 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:23:46,769 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:23:46,941 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:23:46,941 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:23:46,941 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:23:46,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:23:48,272 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:23:49,270 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:23:49,270 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:23:49,276 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:23:49,308 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:23:49,308 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:23:49,308 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:23:49,308 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:23:50,633 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:23:50,888 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:23:50,888 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:23:51,057 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:23:51,057 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:23:51,084 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:23:51,084 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:23:51,084 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:23:51,084 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:23:51,084 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:51,084 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,133 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:23:51,133 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:23:51,133 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,133 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,133 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:23:51,133 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:23:51,133 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,200 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:23:51,200 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:23:51,200 - src.training - INFO - 모델 학습 시작
2025-06-24 11:23:51,333 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:23:51,333 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:23:51,333 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:23:51,333 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:23:51,334 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:23:51,334 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:23:51,334 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:23:51,334 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:23:51,334 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:23:51,334 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,334 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:23:51,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:23:51,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:51,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:23:51,421 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:23:51,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:23:51,555 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:23:51,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:23:51,685 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:23:51,762 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:23:51,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:23:51,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:51,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:23:51,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,848 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,848 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:23:51,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:23:51,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:51,849 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:23:51,866 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:23:51,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:23:51,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:23:51,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:23:51,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:23:51,949 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:23:51,951 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:23:51,951 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:23:51,967 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:23:51,967 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,967 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:23:51,967 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:23:51,967 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   n_estimators: 649
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   learning_rate: 0.01430475054212183
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   subsample: 0.8684578161570494
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7447862093111429
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   reg_alpha: 1.6138592150461308
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   reg_lambda: 0.4026844042000047
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:23:51,985 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:24:46,785 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:24:46,785 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:24:46,786 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:24:46,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:24:46,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:46,786 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:24:46,804 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:24:46,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:24:46,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:24:46,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:24:46,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:24:46,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:24:46,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:24:46,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:46,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:24:47,090 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:24:47,090 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:24:47,090 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:24:47,090 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:24:47,090 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:24:47,090 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:24:47,090 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:24:47,090 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:24:47,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:24:47,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:24:47,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:24:47,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:24:48,271 - src.training - INFO -   precision: 0.003620161514898357
2025-06-24 11:24:48,271 - src.training - INFO -   recall: 0.1925925925925926
2025-06-24 11:24:48,271 - src.training - INFO -   f1: 0.007106737734044007
2025-06-24 11:24:48,271 - src.training - INFO -   accuracy: 0.9342355390603784
2025-06-24 11:24:48,271 - src.training - INFO -   balanced_accuracy: 0.5638677831318426
2025-06-24 11:24:48,271 - src.training - INFO -   positive_samples: 270
2025-06-24 11:24:48,271 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:24:48,271 - src.training - INFO -   total_samples: 220940
2025-06-24 11:24:48,271 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:24:48,271 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:24:48,271 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:24:48,271 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:24:48,271 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:24:48,274 - src.training - INFO - 모델 학습 완료
2025-06-24 11:24:48,274 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003620161514898357, 'recall': 0.1925925925925926, 'f1': 0.007106737734044007, 'accuracy': 0.9342355390603784, 'balanced_accuracy': 0.5638677831318426, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:24:48,274 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:48,274 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:48,274 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:48,274 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:48,312 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:24:48,312 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:24:48,743 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = xgboost
2025-06-24 11:24:50,435 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:24:50,435 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:24:50,435 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:24:50,435 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:24:50,435 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:24:50,435 - src.training - INFO - 교차 검증 시작
2025-06-24 11:24:50,435 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:24:50,450 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:24:50,879 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:24:50,879 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:24:50,879 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:24:50,879 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:24:50,879 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:24:50,879 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:24:50,879 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:24:50,879 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:24:50,879 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:24:51,052 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:24:51,052 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:24:51,052 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:24:51,052 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:24:52,345 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:24:53,338 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:24:53,338 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:24:53,344 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:24:53,375 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:24:53,375 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:24:53,375 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:24:53,375 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:24:54,581 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:24:54,812 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:24:54,812 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:24:54,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:24:54,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:24:54,998 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:24:54,998 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:24:54,998 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:24:54,998 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:24:54,998 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:54,998 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,048 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:24:55,048 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:24:55,048 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,048 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,048 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:24:55,048 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:24:55,048 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,114 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:24:55,114 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:24:55,114 - src.training - INFO - 모델 학습 시작
2025-06-24 11:24:55,247 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:24:55,247 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:24:55,247 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:24:55,247 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:24:55,247 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:24:55,247 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:24:55,247 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:24:55,247 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:24:55,247 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:24:55,247 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,247 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:24:55,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:24:55,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:55,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:24:55,335 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:24:55,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:24:55,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:24:55,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:24:55,598 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:24:55,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:24:55,696 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:24:55,696 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:55,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:24:55,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,763 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,763 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:24:55,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:24:55,763 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:55,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:24:55,781 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:24:55,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:24:55,812 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:24:55,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:24:55,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:24:55,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:24:55,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:24:55,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:24:55,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:24:55,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,879 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:24:55,879 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:24:55,879 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   n_estimators: 640
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   learning_rate: 0.016158467062314302
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   subsample: 0.8265250812761483
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6358375228626587
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   reg_alpha: 5.409170949129667
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   reg_lambda: 2.5106372580182477
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:24:55,897 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:24:55,898 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:25:21,234 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:25:21,234 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:25:21,236 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:25:21,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:25:21,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:21,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:25:21,257 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:25:21,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:25:21,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:25:21,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:25:21,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:25:21,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:25:21,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:25:21,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:21,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:25:21,401 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:25:21,401 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:25:21,401 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:25:21,401 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:25:21,401 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:25:21,401 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:25:21,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:25:21,401 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:25:21,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:25:21,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:25:21,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:25:21,409 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:25:22,812 - src.training - INFO -   precision: 0.002811924917188075
2025-06-24 11:25:22,812 - src.training - INFO -   recall: 0.7074074074074074
2025-06-24 11:25:22,812 - src.training - INFO -   f1: 0.005601583693819195
2025-06-24 11:25:22,812 - src.training - INFO -   accuracy: 0.6930705168824115
2025-06-24 11:25:22,812 - src.training - INFO -   balanced_accuracy: 0.7002301912189981
2025-06-24 11:25:22,812 - src.training - INFO -   positive_samples: 270
2025-06-24 11:25:22,812 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:25:22,812 - src.training - INFO -   total_samples: 220940
2025-06-24 11:25:22,812 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:25:22,812 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:25:22,812 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:25:22,812 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:25:22,812 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:25:22,813 - src.training - INFO - 모델 학습 완료
2025-06-24 11:25:22,813 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002811924917188075, 'recall': 0.7074074074074074, 'f1': 0.005601583693819195, 'accuracy': 0.6930705168824115, 'balanced_accuracy': 0.7002301912189981, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:25:22,813 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:22,813 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:22,813 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:22,813 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:22,853 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:25:22,853 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:25:23,305 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = xgboost
2025-06-24 11:25:25,166 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:25:25,166 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:25:25,166 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:25:25,166 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:25:25,166 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:25:25,166 - src.training - INFO - 교차 검증 시작
2025-06-24 11:25:25,166 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:25:25,183 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:25:25,645 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:25:25,645 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:25:25,645 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:25:25,645 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:25:25,645 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:25:25,645 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:25:25,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:25:25,645 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:25:25,645 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:25:25,812 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:25:25,812 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:25:25,812 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:25:25,812 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:25:27,226 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:25:28,325 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:25:28,325 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:25:28,331 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:25:28,363 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:25:28,363 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:25:28,363 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:25:28,363 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:25:29,673 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:25:29,926 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:25:29,926 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:25:30,095 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:25:30,095 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:25:30,121 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:25:30,121 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:25:30,121 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:25:30,121 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:25:30,121 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:30,121 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,171 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:25:30,171 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:25:30,171 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,171 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,171 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:25:30,171 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:25:30,171 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,236 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:25:30,236 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:25:30,237 - src.training - INFO - 모델 학습 시작
2025-06-24 11:25:30,369 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:25:30,370 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:25:30,370 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:25:30,370 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:25:30,370 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:25:30,370 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:25:30,370 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:25:30,370 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:25:30,370 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:25:30,370 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,370 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:25:30,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:25:30,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:30,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:25:30,458 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:25:30,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:25:30,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:25:30,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:25:30,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:25:30,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:25:30,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:25:30,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:30,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:25:30,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,883 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:30,883 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:25:30,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:25:30,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:30,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:25:30,901 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:25:30,916 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:25:30,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:25:30,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:25:30,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:25:30,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:25:30,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:25:30,986 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:31,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:25:31,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:31,001 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:25:31,001 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:31,001 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   n_estimators: 648
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   learning_rate: 0.15048808735484048
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   subsample: 0.7460177310157895
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7169312543208309
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   reg_alpha: 0.00015914732583045758
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   reg_lambda: 0.13987774668186895
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:25:31,019 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:25:31,020 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:25:34,943 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:25:34,943 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:25:34,946 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:25:34,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:25:34,946 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:34,947 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:25:34,966 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:25:34,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:25:34,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:25:35,013 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:25:35,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:25:35,048 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:25:35,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:25:35,052 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:35,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:25:35,063 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:25:35,063 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:25:35,063 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:25:35,063 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:25:35,063 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:25:35,063 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:25:35,063 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:25:35,063 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:25:35,067 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:25:35,071 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:25:35,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:25:35,072 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:25:36,400 - src.training - INFO -   precision: 0.0027997055979680488
2025-06-24 11:25:36,400 - src.training - INFO -   recall: 0.7185185185185186
2025-06-24 11:25:36,400 - src.training - INFO -   f1: 0.005577677788479508
2025-06-24 11:25:36,400 - src.training - INFO -   accuracy: 0.6869059473160134
2025-06-24 11:25:36,400 - src.training - INFO -   balanced_accuracy: 0.7026928931922815
2025-06-24 11:25:36,400 - src.training - INFO -   positive_samples: 270
2025-06-24 11:25:36,400 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:25:36,400 - src.training - INFO -   total_samples: 220940
2025-06-24 11:25:36,400 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:25:36,400 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:25:36,400 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:25:36,400 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:25:36,400 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:25:36,401 - src.training - INFO - 모델 학습 완료
2025-06-24 11:25:36,401 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027997055979680488, 'recall': 0.7185185185185186, 'f1': 0.005577677788479508, 'accuracy': 0.6869059473160134, 'balanced_accuracy': 0.7026928931922815, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:25:36,401 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:36,401 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:36,401 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:36,401 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:36,439 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:25:36,439 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:25:36,900 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = xgboost
2025-06-24 11:25:38,770 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:25:38,770 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:25:38,770 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:25:38,770 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:25:38,770 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:25:38,770 - src.training - INFO - 교차 검증 시작
2025-06-24 11:25:38,770 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:25:38,787 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:25:39,248 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:25:39,248 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:25:39,248 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:25:39,248 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:25:39,248 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:25:39,248 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:25:39,248 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:25:39,248 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:25:39,248 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:25:39,415 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:25:39,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:25:39,416 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:25:39,416 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:25:39,416 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:25:39,416 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:25:39,416 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:25:39,416 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:25:39,416 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:25:39,416 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:25:40,847 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:25:41,946 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:25:41,946 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:25:41,952 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:25:41,984 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:25:41,984 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:25:41,984 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:25:41,984 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:25:43,320 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:25:43,574 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:25:43,574 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:25:43,742 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:25:43,743 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:25:43,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:25:43,769 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:25:43,769 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:25:43,769 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:25:43,769 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:43,769 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:25:43,818 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:25:43,818 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:25:43,818 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:43,818 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:43,818 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:25:43,818 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:25:43,818 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:43,883 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:25:43,884 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:25:43,884 - src.training - INFO - 모델 학습 시작
2025-06-24 11:25:44,016 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:25:44,016 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:25:44,016 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:25:44,016 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:25:44,016 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:25:44,016 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:25:44,016 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:25:44,016 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:25:44,016 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:25:44,016 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:44,016 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:25:44,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:25:44,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:44,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:25:44,104 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:25:44,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:25:44,237 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:25:44,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:25:44,369 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:25:44,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:25:44,463 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:25:44,463 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:44,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:25:44,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:44,530 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:44,530 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:25:44,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:25:44,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:44,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:25:44,548 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:25:44,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:25:44,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:25:44,596 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:25:44,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:25:44,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:25:44,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:25:44,634 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:25:44,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:25:44,650 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:44,650 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:25:44,650 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:25:44,650 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   n_estimators: 271
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   learning_rate: 0.13531102522797436
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   subsample: 0.6917624441909098
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8160615568761472
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   reg_alpha: 5.352303052541705e-07
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   reg_lambda: 0.0013888595123022526
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:25:44,668 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:26:00,504 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:26:00,504 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:26:00,506 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:26:00,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:26:00,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:00,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:26:00,525 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:26:00,539 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:26:00,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:26:00,570 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:26:00,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:26:00,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:26:00,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:26:00,608 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:00,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:26:00,651 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:26:00,652 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:26:00,652 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:26:00,652 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:26:00,652 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:26:00,652 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:26:00,652 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:26:00,652 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:26:00,655 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:26:00,659 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:26:00,660 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:26:00,660 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:26:01,899 - src.training - INFO -   precision: 0.002749770852428964
2025-06-24 11:26:01,899 - src.training - INFO -   recall: 0.25555555555555554
2025-06-24 11:26:01,899 - src.training - INFO -   f1: 0.005440996727516461
2025-06-24 11:26:01,899 - src.training - INFO -   accuracy: 0.8858287317823843
2025-06-24 11:26:01,899 - src.training - INFO -   balanced_accuracy: 0.5710777279295882
2025-06-24 11:26:01,899 - src.training - INFO -   positive_samples: 270
2025-06-24 11:26:01,899 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:26:01,899 - src.training - INFO -   total_samples: 220940
2025-06-24 11:26:01,899 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:26:01,899 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:26:01,899 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:26:01,899 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:26:01,899 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:26:01,900 - src.training - INFO - 모델 학습 완료
2025-06-24 11:26:01,900 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002749770852428964, 'recall': 0.25555555555555554, 'f1': 0.005440996727516461, 'accuracy': 0.8858287317823843, 'balanced_accuracy': 0.5710777279295882, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:26:01,900 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:01,900 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:01,900 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:01,900 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:01,937 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:26:01,937 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:26:02,367 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = xgboost
2025-06-24 11:26:04,058 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:26:04,058 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:26:04,058 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:26:04,058 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:26:04,058 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:26:04,058 - src.training - INFO - 교차 검증 시작
2025-06-24 11:26:04,058 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:26:04,075 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:26:04,507 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:26:04,507 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:26:04,507 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:26:04,507 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:26:04,507 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:26:04,507 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:26:04,507 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:26:04,507 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:26:04,507 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:26:04,680 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:26:04,680 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:26:04,680 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:26:04,680 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:26:05,977 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:26:06,965 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:26:06,965 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:26:06,971 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:26:07,002 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:26:07,002 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:26:07,002 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:26:07,002 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:26:08,209 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:26:08,443 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:26:08,443 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:26:08,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:26:08,604 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:26:08,629 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:26:08,629 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:26:08,629 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:26:08,629 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:26:08,629 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:08,629 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:26:08,675 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:26:08,675 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:26:08,675 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:08,675 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:08,675 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:26:08,675 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:26:08,675 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:08,734 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:26:08,734 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:26:08,734 - src.training - INFO - 모델 학습 시작
2025-06-24 11:26:08,862 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:26:08,863 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:26:08,863 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:26:08,863 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:26:08,863 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:26:08,863 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:26:08,863 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:26:08,863 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:26:08,863 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:26:08,863 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:08,863 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:26:08,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:26:08,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:08,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:26:08,945 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:26:09,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:26:09,078 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:26:09,142 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:26:09,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:26:09,292 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:26:09,309 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:26:09,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:09,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:26:09,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:09,377 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:09,377 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:26:09,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:26:09,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:09,378 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:26:09,395 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:26:09,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:26:09,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:26:09,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:26:09,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:26:09,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:26:09,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:26:09,479 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:09,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:26:09,495 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:09,495 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:26:09,495 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:09,495 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   n_estimators: 415
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   learning_rate: 0.010003830680673374
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   subsample: 0.8346392572155024
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6738144280810033
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   reg_alpha: 4.839049827359635
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   reg_lambda: 0.8872456069348141
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:26:09,513 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:26:42,022 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:26:42,022 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:26:42,025 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:26:42,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:26:42,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:42,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:26:42,044 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:26:42,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:26:42,075 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:26:42,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:26:42,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:26:42,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:26:42,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:26:42,131 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:42,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:26:42,253 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:26:42,253 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:26:42,253 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:26:42,253 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:26:42,253 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:26:42,253 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:26:42,253 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:26:42,253 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:26:42,257 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:26:42,261 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:26:42,262 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:26:42,262 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:26:43,650 - src.training - INFO -   precision: 0.0027758699633699635
2025-06-24 11:26:43,650 - src.training - INFO -   recall: 0.3592592592592593
2025-06-24 11:26:43,650 - src.training - INFO -   f1: 0.005509172488214914
2025-06-24 11:26:43,650 - src.training - INFO -   accuracy: 0.8414954286231556
2025-06-24 11:26:43,650 - src.training - INFO -   balanced_accuracy: 0.6006723631230815
2025-06-24 11:26:43,650 - src.training - INFO -   positive_samples: 270
2025-06-24 11:26:43,650 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:26:43,650 - src.training - INFO -   total_samples: 220940
2025-06-24 11:26:43,650 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:26:43,650 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:26:43,650 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:26:43,650 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:26:43,651 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:26:43,652 - src.training - INFO - 모델 학습 완료
2025-06-24 11:26:43,652 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027758699633699635, 'recall': 0.3592592592592593, 'f1': 0.005509172488214914, 'accuracy': 0.8414954286231556, 'balanced_accuracy': 0.6006723631230815, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:26:43,652 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:43,652 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:43,652 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:43,652 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:43,692 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:26:43,692 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:26:44,144 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = xgboost
2025-06-24 11:26:46,008 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:26:46,009 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:26:46,009 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:26:46,009 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:26:46,009 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:26:46,009 - src.training - INFO - 교차 검증 시작
2025-06-24 11:26:46,009 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:26:46,024 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:26:46,486 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:26:46,486 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:26:46,486 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:26:46,486 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:26:46,486 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:26:46,486 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:26:46,486 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:26:46,486 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:26:46,486 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:26:46,652 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:26:46,652 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:26:46,653 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:26:46,653 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:26:46,653 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:26:46,653 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:26:46,653 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:26:46,653 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:26:46,653 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:26:46,653 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:26:48,087 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:26:49,184 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:26:49,184 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:26:49,190 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:26:49,222 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:26:49,222 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:26:49,222 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:26:49,223 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:26:50,557 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:26:50,810 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:26:50,810 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:26:50,979 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:26:50,980 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:26:51,006 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:26:51,006 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:26:51,006 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:26:51,006 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:26:51,006 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:51,006 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,055 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:26:51,055 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:26:51,055 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,055 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,055 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:26:51,055 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:26:51,055 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,121 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:26:51,121 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:26:51,121 - src.training - INFO - 모델 학습 시작
2025-06-24 11:26:51,254 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:26:51,254 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:26:51,254 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:26:51,254 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:26:51,254 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:26:51,254 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:26:51,254 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:26:51,254 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:26:51,254 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:26:51,254 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,254 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:26:51,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:26:51,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:51,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:26:51,343 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:26:51,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:26:51,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:26:51,546 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:26:51,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:26:51,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:26:51,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:26:51,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:51,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:26:51,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,776 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,776 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:26:51,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:26:51,776 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:51,777 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:26:51,794 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:26:51,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:26:51,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:26:51,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:26:51,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:26:51,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:26:51,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:26:51,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:26:51,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:26:51,895 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,895 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:26:51,895 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:26:51,895 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   n_estimators: 553
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   learning_rate: 0.11027392384240234
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   subsample: 0.7982857551829311
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6483218169833771
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   reg_alpha: 1.4874389039542886e-08
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   reg_lambda: 0.17386786276012592
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:26:51,913 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:26:51,914 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:27:00,283 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:27:00,283 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:27:00,286 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:27:00,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:27:00,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:00,286 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:00,305 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:00,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:00,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:00,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:00,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:00,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:00,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:27:00,395 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:00,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:27:00,415 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:27:00,415 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:27:00,415 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:27:00,416 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:27:00,416 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:27:00,416 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:27:00,416 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:27:00,416 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:27:00,419 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:27:00,423 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:27:00,424 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:27:00,424 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:27:01,840 - src.training - INFO -   precision: 0.002723483401697195
2025-06-24 11:27:01,840 - src.training - INFO -   recall: 0.6074074074074074
2025-06-24 11:27:01,840 - src.training - INFO -   f1: 0.005422652801428406
2025-06-24 11:27:01,840 - src.training - INFO -   accuracy: 0.7277134063546664
2025-06-24 11:27:01,840 - src.training - INFO -   balanced_accuracy: 0.6676340068713296
2025-06-24 11:27:01,840 - src.training - INFO -   positive_samples: 270
2025-06-24 11:27:01,840 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:27:01,840 - src.training - INFO -   total_samples: 220940
2025-06-24 11:27:01,840 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:27:01,840 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:27:01,840 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:27:01,840 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:27:01,841 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:27:01,841 - src.training - INFO - 모델 학습 완료
2025-06-24 11:27:01,841 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002723483401697195, 'recall': 0.6074074074074074, 'f1': 0.005422652801428406, 'accuracy': 0.7277134063546664, 'balanced_accuracy': 0.6676340068713296, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:27:01,841 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:01,841 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:01,841 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:01,841 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:01,881 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:27:01,881 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:27:02,340 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = xgboost
2025-06-24 11:27:04,277 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:27:04,277 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:27:04,277 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:27:04,277 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:27:04,277 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:27:04,277 - src.training - INFO - 교차 검증 시작
2025-06-24 11:27:04,277 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:27:04,294 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:27:04,754 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:27:04,754 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:27:04,754 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:27:04,754 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:27:04,754 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:27:04,754 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:27:04,754 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:27:04,754 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:27:04,754 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:27:04,921 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:27:04,921 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:27:04,921 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:27:04,921 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:27:06,350 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:27:07,448 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:27:07,448 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:27:07,455 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:27:07,487 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:27:07,487 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:27:07,487 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:27:07,487 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:27:08,813 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:27:09,066 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:27:09,066 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:27:09,234 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:27:09,234 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:27:09,261 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:27:09,261 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:27:09,261 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:27:09,261 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:27:09,261 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:09,261 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:27:09,310 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:27:09,310 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:27:09,310 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:09,310 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:09,310 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:27:09,310 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:27:09,310 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:09,378 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:27:09,378 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:27:09,378 - src.training - INFO - 모델 학습 시작
2025-06-24 11:27:09,512 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:27:09,512 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:27:09,512 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:27:09,512 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:27:09,512 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:27:09,512 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:27:09,512 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:27:09,512 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:27:09,512 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:27:09,512 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:09,512 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:27:09,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:27:09,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:09,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:09,600 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:09,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:09,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:09,796 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:09,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:09,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:09,954 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:27:09,954 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:10,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:27:10,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:10,022 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:10,022 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:27:10,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:27:10,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:10,022 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:10,040 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:10,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:10,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:10,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:10,104 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:10,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:10,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:27:10,125 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:10,141 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:27:10,141 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:10,141 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:27:10,141 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:10,141 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:27:10,158 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:27:10,158 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:27:10,158 - src.models.xgboost_model - INFO -   n_estimators: 443
2025-06-24 11:27:10,158 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 11:27:10,158 - src.models.xgboost_model - INFO -   learning_rate: 0.04482132825666499
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   subsample: 0.733505622164025
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6055301320816188
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   reg_alpha: 2.9068717909168273e-08
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   reg_lambda: 0.3544907003061432
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:27:10,159 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:27:37,885 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:27:37,885 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:27:37,887 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:27:37,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:27:37,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:37,888 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:37,907 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:37,923 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:37,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:37,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:37,974 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:37,992 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:37,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:27:37,996 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:37,999 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:27:38,083 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:27:38,083 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:27:38,083 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:27:38,083 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:27:38,083 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:27:38,083 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:27:38,084 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:27:38,084 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:27:38,087 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:27:38,091 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:27:38,092 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:27:38,092 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:27:39,498 - src.training - INFO -   precision: 0.002647039834721415
2025-06-24 11:27:39,498 - src.training - INFO -   recall: 0.3037037037037037
2025-06-24 11:27:39,498 - src.training - INFO -   f1: 0.005248335893497184
2025-06-24 11:27:39,498 - src.training - INFO -   accuracy: 0.8593102199692224
2025-06-24 11:27:39,498 - src.training - INFO -   balanced_accuracy: 0.5818468670328913
2025-06-24 11:27:39,498 - src.training - INFO -   positive_samples: 270
2025-06-24 11:27:39,498 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:27:39,498 - src.training - INFO -   total_samples: 220940
2025-06-24 11:27:39,499 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:27:39,499 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:27:39,499 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:27:39,499 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:27:39,499 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:27:39,499 - src.training - INFO - 모델 학습 완료
2025-06-24 11:27:39,500 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002647039834721415, 'recall': 0.3037037037037037, 'f1': 0.005248335893497184, 'accuracy': 0.8593102199692224, 'balanced_accuracy': 0.5818468670328913, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:27:39,500 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:39,500 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:39,500 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:39,500 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:39,538 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:27:39,539 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:27:39,994 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = xgboost
2025-06-24 11:27:41,890 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:27:41,890 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:27:41,890 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:27:41,890 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:27:41,890 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:27:41,890 - src.training - INFO - 교차 검증 시작
2025-06-24 11:27:41,890 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:27:41,906 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:27:42,367 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:27:42,367 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:27:42,368 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:27:42,368 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:27:42,368 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:27:42,368 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:27:42,368 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:27:42,368 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:27:42,368 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:27:42,534 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:27:42,534 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:27:42,535 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:27:42,535 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:27:42,535 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:27:42,535 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:27:42,535 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:27:42,535 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:27:42,535 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:27:42,535 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:27:43,957 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:27:45,049 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:27:45,049 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:27:45,055 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:27:45,087 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:27:45,087 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:27:45,087 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:27:45,087 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:27:46,395 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:27:46,651 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:27:46,651 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:27:46,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:27:46,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:27:46,847 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:27:46,847 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:27:46,847 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:27:46,847 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:27:46,847 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:46,847 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:27:46,896 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:27:46,897 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:27:46,897 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:46,897 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:46,897 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:27:46,897 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:27:46,897 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:46,963 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:27:46,963 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:27:46,963 - src.training - INFO - 모델 학습 시작
2025-06-24 11:27:47,096 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:27:47,096 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:27:47,096 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:27:47,096 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:27:47,096 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:27:47,096 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:27:47,096 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:27:47,097 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:27:47,097 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:27:47,097 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:47,097 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:27:47,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:27:47,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:47,097 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:47,184 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:47,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:47,318 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:47,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:47,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:47,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:47,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:27:47,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:27:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:47,612 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:47,612 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:27:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:27:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:47,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:47,630 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:47,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:47,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:47,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:47,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:47,712 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:47,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:27:47,715 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:47,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:27:47,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:47,730 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:27:47,730 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:47,730 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   n_estimators: 251
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   learning_rate: 0.197265408885662
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   subsample: 0.9026175105215989
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6218222212567165
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:27:47,748 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:27:47,749 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:27:47,749 - src.models.xgboost_model - INFO -   reg_alpha: 1.0833366030801605e-08
2025-06-24 11:27:47,749 - src.models.xgboost_model - INFO -   reg_lambda: 4.476829164619913
2025-06-24 11:27:47,749 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:27:47,749 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:27:47,749 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:27:55,596 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:27:55,596 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:27:55,598 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:27:55,598 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:27:55,598 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:55,598 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:27:55,617 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:27:55,631 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:27:55,646 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:27:55,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:27:55,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:27:55,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:27:55,699 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:27:55,699 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:55,703 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:27:55,721 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:27:55,721 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:27:55,721 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:27:55,721 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:27:55,721 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:27:55,721 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:27:55,721 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:27:55,721 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:27:55,725 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:27:55,729 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:27:55,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:27:55,730 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:27:56,990 - src.training - INFO -   precision: 0.002728461969725285
2025-06-24 11:27:56,990 - src.training - INFO -   recall: 0.5407407407407407
2025-06-24 11:27:56,990 - src.training - INFO -   f1: 0.005429527705466716
2025-06-24 11:27:56,990 - src.training - INFO -   accuracy: 0.7579071241060922
2025-06-24 11:27:56,990 - src.training - INFO -   balanced_accuracy: 0.64945678900453
2025-06-24 11:27:56,990 - src.training - INFO -   positive_samples: 270
2025-06-24 11:27:56,990 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:27:56,990 - src.training - INFO -   total_samples: 220940
2025-06-24 11:27:56,990 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:27:56,990 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:27:56,990 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:27:56,990 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:27:56,991 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:27:56,991 - src.training - INFO - 모델 학습 완료
2025-06-24 11:27:56,991 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002728461969725285, 'recall': 0.5407407407407407, 'f1': 0.005429527705466716, 'accuracy': 0.7579071241060922, 'balanced_accuracy': 0.64945678900453, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:27:56,991 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:56,991 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:56,991 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:27:56,991 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:27:57,029 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:27:57,029 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:27:57,465 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = xgboost
2025-06-24 11:27:59,161 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:27:59,161 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:27:59,161 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:27:59,161 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:27:59,161 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:27:59,161 - src.training - INFO - 교차 검증 시작
2025-06-24 11:27:59,161 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:27:59,178 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:27:59,610 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:27:59,610 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:27:59,610 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:27:59,610 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:27:59,610 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:27:59,610 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:27:59,610 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:27:59,610 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:27:59,610 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:27:59,782 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:27:59,783 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:27:59,783 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:27:59,783 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:27:59,783 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:27:59,783 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:27:59,783 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:27:59,783 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:27:59,783 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:27:59,783 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:28:01,075 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:28:02,069 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:28:02,069 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:28:02,075 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:28:02,106 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:28:02,106 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:28:02,106 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:28:02,106 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:28:03,304 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:28:03,540 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:28:03,540 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:28:03,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:28:03,701 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:28:03,726 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:28:03,726 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:28:03,727 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:28:03,727 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:28:03,727 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:03,727 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:28:03,772 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:28:03,772 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:28:03,772 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:03,772 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:03,772 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:28:03,772 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:28:03,772 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:03,830 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:28:03,830 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:28:03,830 - src.training - INFO - 모델 학습 시작
2025-06-24 11:28:03,958 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:28:03,959 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:28:03,959 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:28:03,959 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:28:03,959 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:28:03,959 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:28:03,959 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:28:03,959 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:28:03,959 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:28:03,959 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:03,959 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:28:03,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:28:03,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:03,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:04,034 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:04,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:04,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:04,197 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:04,254 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:04,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:04,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:28:04,342 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:04,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:28:04,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:04,419 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:04,419 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:28:04,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:28:04,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:04,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:04,436 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:04,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:04,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:04,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:04,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:04,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:04,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:28:04,510 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:04,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:28:04,525 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:04,525 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:28:04,525 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:04,525 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   n_estimators: 408
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   learning_rate: 0.10739148081268353
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   subsample: 0.8166149102095263
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6581504303406847
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   reg_alpha: 6.220983342475366e-07
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   reg_lambda: 1.906185258733688
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:28:04,543 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:28:26,423 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:28:26,423 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:28:26,425 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:28:26,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:28:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:26,426 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:26,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:26,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:26,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:26,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:26,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:26,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:26,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:28:26,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:26,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:28:26,599 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:28:26,599 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:28:26,599 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:28:26,599 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:28:26,599 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:28:26,599 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:28:26,599 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:28:26,599 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:28:26,603 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:28:26,607 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:28:26,607 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:28:26,607 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:28:27,996 - src.training - INFO -   precision: 0.0027982701602645636
2025-06-24 11:28:27,996 - src.training - INFO -   recall: 0.2851851851851852
2025-06-24 11:28:27,996 - src.training - INFO -   f1: 0.005542160002879044
2025-06-24 11:28:27,996 - src.training - INFO -   accuracy: 0.8749298452068435
2025-06-24 11:28:27,996 - src.training - INFO -   balanced_accuracy: 0.5804183051951213
2025-06-24 11:28:27,996 - src.training - INFO -   positive_samples: 270
2025-06-24 11:28:27,996 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:28:27,996 - src.training - INFO -   total_samples: 220940
2025-06-24 11:28:27,996 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:28:27,996 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:28:27,996 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:28:27,996 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:28:27,997 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:28:27,997 - src.training - INFO - 모델 학습 완료
2025-06-24 11:28:27,997 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027982701602645636, 'recall': 0.2851851851851852, 'f1': 0.005542160002879044, 'accuracy': 0.8749298452068435, 'balanced_accuracy': 0.5804183051951213, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:28:27,997 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:27,997 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:27,997 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:27,997 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:28,036 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:28:28,036 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:28:28,492 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = xgboost
2025-06-24 11:28:30,361 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:28:30,361 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:28:30,361 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:28:30,361 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:28:30,361 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:28:30,361 - src.training - INFO - 교차 검증 시작
2025-06-24 11:28:30,361 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:28:30,379 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:28:30,844 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:28:30,844 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:28:30,844 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:28:30,844 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:28:30,844 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:28:30,844 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:28:30,844 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:28:30,844 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:28:30,844 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:28:31,011 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:28:31,011 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:28:31,011 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:28:31,011 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:28:31,011 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:28:31,012 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:28:31,012 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:28:31,012 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:28:31,012 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:28:31,012 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:28:32,443 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:28:33,543 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:28:33,543 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:28:33,549 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:28:33,581 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:28:33,581 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:28:33,581 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:28:33,581 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:28:34,903 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:28:35,159 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:28:35,159 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:28:35,327 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:28:35,327 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:28:35,354 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:28:35,354 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:28:35,354 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:28:35,354 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:28:35,354 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:35,354 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:28:35,403 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:28:35,403 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:28:35,403 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:35,403 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:35,403 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:28:35,403 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:28:35,403 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:35,469 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:28:35,469 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:28:35,469 - src.training - INFO - 모델 학습 시작
2025-06-24 11:28:35,602 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:28:35,602 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:28:35,602 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:28:35,602 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:28:35,602 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:28:35,602 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:28:35,602 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:28:35,602 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:28:35,602 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:28:35,602 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:35,602 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:28:35,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:28:35,602 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:35,603 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:35,690 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:35,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:35,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:35,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:35,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:36,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:36,048 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:28:36,048 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:36,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:28:36,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:36,115 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:36,115 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:28:36,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:28:36,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:36,116 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:36,133 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:36,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:36,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:36,181 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:36,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:36,216 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:36,218 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:28:36,219 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:36,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:28:36,234 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:36,234 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:28:36,234 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:36,234 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   n_estimators: 181
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   learning_rate: 0.29110374450728954
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   subsample: 0.6530653748884221
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6397231239506155
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   reg_alpha: 2.4793772570414718e-08
2025-06-24 11:28:36,252 - src.models.xgboost_model - INFO -   reg_lambda: 0.28306750473390807
2025-06-24 11:28:36,253 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:28:36,253 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:28:36,253 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:28:42,336 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:28:42,336 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:28:42,338 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:28:42,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:28:42,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:42,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:42,358 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:42,374 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:42,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:42,407 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:42,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:42,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:42,447 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:28:42,447 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:42,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:28:42,462 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:28:42,463 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:28:42,463 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:28:42,463 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:28:42,463 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:28:42,463 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:28:42,463 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:28:42,463 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:28:42,466 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:28:42,471 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:28:42,471 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:28:42,471 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:28:43,863 - src.training - INFO -   precision: 0.0026431242807825085
2025-06-24 11:28:43,863 - src.training - INFO -   recall: 0.5444444444444444
2025-06-24 11:28:43,863 - src.training - INFO -   f1: 0.005260709301077193
2025-06-24 11:28:43,863 - src.training - INFO -   accuracy: 0.7483841766995565
2025-06-24 11:28:43,863 - src.training - INFO -   balanced_accuracy: 0.6465390754419621
2025-06-24 11:28:43,863 - src.training - INFO -   positive_samples: 270
2025-06-24 11:28:43,863 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:28:43,863 - src.training - INFO -   total_samples: 220940
2025-06-24 11:28:43,863 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:28:43,863 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:28:43,863 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:28:43,863 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:28:43,863 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:28:43,864 - src.training - INFO - 모델 학습 완료
2025-06-24 11:28:43,864 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026431242807825085, 'recall': 0.5444444444444444, 'f1': 0.005260709301077193, 'accuracy': 0.7483841766995565, 'balanced_accuracy': 0.6465390754419621, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:28:43,864 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:43,864 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:43,864 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:43,864 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:43,903 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:28:43,904 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:28:44,362 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = xgboost
2025-06-24 11:28:46,230 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:28:46,231 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:28:46,231 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:28:46,231 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:28:46,231 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:28:46,231 - src.training - INFO - 교차 검증 시작
2025-06-24 11:28:46,231 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:28:46,246 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:28:46,708 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:28:46,708 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:28:46,708 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:28:46,708 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:28:46,708 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:28:46,708 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:28:46,708 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:28:46,708 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:28:46,708 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:28:46,874 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:28:46,875 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:28:46,875 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:28:46,875 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:28:46,875 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:28:46,875 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:28:46,875 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:28:46,875 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:28:46,875 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:28:46,875 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:28:48,302 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:28:49,402 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:28:49,402 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:28:49,408 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:28:49,440 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:28:49,440 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:28:49,440 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:28:49,441 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:28:50,769 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:28:51,026 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:28:51,026 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:28:51,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:28:51,195 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:28:51,222 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:28:51,222 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:28:51,222 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:28:51,222 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:28:51,222 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:51,222 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,271 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:28:51,271 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:28:51,271 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,271 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,271 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:28:51,271 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:28:51,271 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,337 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:28:51,337 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:28:51,337 - src.training - INFO - 모델 학습 시작
2025-06-24 11:28:51,470 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:28:51,470 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:28:51,470 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:28:51,470 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:28:51,470 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:28:51,470 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:28:51,470 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:28:51,470 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:28:51,470 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:28:51,470 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,470 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:28:51,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:28:51,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:51,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:51,558 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:51,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:51,691 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:51,755 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:51,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:51,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:51,915 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:28:51,915 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:51,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:28:51,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,982 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:51,982 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:28:51,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:28:51,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:51,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:28:52,000 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:28:52,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:28:52,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:28:52,047 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:28:52,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:28:52,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:28:52,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:28:52,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:28:52,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:28:52,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:52,101 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:28:52,101 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:28:52,101 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   n_estimators: 857
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   learning_rate: 0.012724176871367211
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   subsample: 0.8727055000534768
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6021407909295546
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   reg_alpha: 2.6008314901232925
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   reg_lambda: 5.23125009738056
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:28:52,119 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:28:52,120 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:29:54,003 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:29:54,003 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:29:54,007 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:29:54,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:29:54,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:29:54,007 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:29:54,026 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:29:54,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:29:54,060 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:29:54,077 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:29:54,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:29:54,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:29:54,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:29:54,117 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:29:54,121 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:29:54,346 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:29:54,346 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:29:54,347 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:29:54,347 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:29:54,347 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:29:54,347 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:29:54,347 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:29:54,347 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:29:54,350 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:29:54,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:29:54,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:29:54,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:29:55,675 - src.training - INFO -   precision: 0.0029620612700344898
2025-06-24 11:29:55,675 - src.training - INFO -   recall: 0.27037037037037037
2025-06-24 11:29:55,675 - src.training - INFO -   f1: 0.005859923740718443
2025-06-24 11:29:55,675 - src.training - INFO -   accuracy: 0.8878926405358921
2025-06-24 11:29:55,675 - src.training - INFO -   balanced_accuracy: 0.5795092890506857
2025-06-24 11:29:55,675 - src.training - INFO -   positive_samples: 270
2025-06-24 11:29:55,675 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:29:55,675 - src.training - INFO -   total_samples: 220940
2025-06-24 11:29:55,675 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:29:55,675 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:29:55,675 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:29:55,675 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:29:55,675 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:29:55,678 - src.training - INFO - 모델 학습 완료
2025-06-24 11:29:55,678 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029620612700344898, 'recall': 0.27037037037037037, 'f1': 0.005859923740718443, 'accuracy': 0.8878926405358921, 'balanced_accuracy': 0.5795092890506857, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:29:55,678 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:29:55,678 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:29:55,678 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:29:55,678 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:29:55,717 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:29:55,717 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:29:56,168 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = xgboost
2025-06-24 11:29:58,036 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:29:58,036 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:29:58,036 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:29:58,036 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:29:58,036 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:29:58,036 - src.training - INFO - 교차 검증 시작
2025-06-24 11:29:58,036 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:29:58,054 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:29:58,517 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:29:58,517 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:29:58,517 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:29:58,517 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:29:58,517 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:29:58,517 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:29:58,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:29:58,517 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:29:58,517 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:29:58,684 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:29:58,684 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:29:58,684 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:29:58,684 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:30:00,112 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:30:01,202 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:30:01,202 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:30:01,208 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:30:01,240 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:30:01,241 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:30:01,241 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:30:01,241 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:30:02,564 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:30:02,820 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:30:02,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:30:02,990 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:30:02,990 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:30:03,016 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:30:03,016 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:30:03,017 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:30:03,017 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:30:03,017 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:03,017 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,066 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:30:03,066 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:30:03,066 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,066 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,066 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:30:03,066 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:30:03,066 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,132 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:30:03,132 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:30:03,132 - src.training - INFO - 모델 학습 시작
2025-06-24 11:30:03,264 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:30:03,265 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:30:03,265 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:30:03,265 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:30:03,265 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:30:03,265 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:30:03,265 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:30:03,265 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:30:03,265 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:30:03,265 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,265 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:30:03,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:30:03,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:03,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:03,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:03,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:03,488 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:03,554 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:03,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:03,696 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:03,713 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:30:03,713 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:03,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:30:03,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,784 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,784 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:30:03,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:30:03,784 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:03,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:03,802 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:03,818 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:03,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:03,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:03,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:03,885 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:03,888 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:30:03,888 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:03,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:30:03,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,903 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:30:03,903 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:03,903 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   n_estimators: 198
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   learning_rate: 0.06718908170160187
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   subsample: 0.7099377165971219
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7864423298034517
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   reg_alpha: 0.005319832136728562
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   reg_lambda: 1.496972689420816
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:30:03,922 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:30:17,121 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:30:17,121 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:30:17,123 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:30:17,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:30:17,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:17,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:17,143 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:17,160 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:17,176 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:17,192 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:17,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:17,228 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:17,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:30:17,232 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:17,235 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:30:17,273 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:30:17,273 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:30:17,273 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:30:17,273 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:30:17,273 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:30:17,273 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:30:17,273 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:30:17,273 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:30:17,276 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:30:17,281 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:30:17,281 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:30:17,281 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:30:18,674 - src.training - INFO -   precision: 0.0026336416366201597
2025-06-24 11:30:18,674 - src.training - INFO -   recall: 0.3111111111111111
2025-06-24 11:30:18,674 - src.training - INFO -   f1: 0.005223068552774755
2025-06-24 11:30:18,674 - src.training - INFO -   accuracy: 0.8551778763465194
2025-06-24 11:30:18,674 - src.training - INFO -   balanced_accuracy: 0.5834773392144127
2025-06-24 11:30:18,674 - src.training - INFO -   positive_samples: 270
2025-06-24 11:30:18,674 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:30:18,674 - src.training - INFO -   total_samples: 220940
2025-06-24 11:30:18,674 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:30:18,674 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:30:18,674 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:30:18,674 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:30:18,675 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:30:18,675 - src.training - INFO - 모델 학습 완료
2025-06-24 11:30:18,675 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026336416366201597, 'recall': 0.3111111111111111, 'f1': 0.005223068552774755, 'accuracy': 0.8551778763465194, 'balanced_accuracy': 0.5834773392144127, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:30:18,675 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:18,675 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:18,675 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:18,675 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:18,715 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:30:18,716 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:30:19,172 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = xgboost
2025-06-24 11:30:21,046 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:30:21,046 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:30:21,046 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:30:21,046 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:30:21,046 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:30:21,046 - src.training - INFO - 교차 검증 시작
2025-06-24 11:30:21,046 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:30:21,063 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:30:21,528 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:30:21,528 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:30:21,528 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:30:21,528 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:30:21,528 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:30:21,528 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:30:21,528 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:30:21,528 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:30:21,528 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:30:21,695 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:30:21,695 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:30:21,695 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:30:21,695 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:30:23,126 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:30:24,217 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:30:24,217 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:30:24,223 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:30:24,255 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:30:24,255 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:30:24,255 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:30:24,255 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:30:25,580 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:30:25,834 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:30:25,834 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:30:26,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:30:26,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:30:26,028 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:30:26,028 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:30:26,028 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:30:26,028 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:30:26,028 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:26,028 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,078 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:30:26,078 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:30:26,078 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,078 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,078 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:30:26,078 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:30:26,078 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,143 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:30:26,143 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:30:26,143 - src.training - INFO - 모델 학습 시작
2025-06-24 11:30:26,276 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:30:26,276 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:30:26,276 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:30:26,276 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:30:26,276 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:30:26,276 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:30:26,276 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:30:26,276 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:30:26,276 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:30:26,276 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,276 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:30:26,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:30:26,276 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:26,277 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:26,365 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:26,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:26,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:26,564 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:26,630 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:26,707 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:26,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:30:26,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:30:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,794 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,794 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:30:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:30:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:26,794 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:26,812 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:26,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:26,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:26,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:26,878 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:26,895 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:26,898 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:30:26,898 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:26,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:30:26,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,913 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:30:26,913 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:26,913 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:30:26,931 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   n_estimators: 429
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   learning_rate: 0.20432732983831123
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   subsample: 0.9551935351905542
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   colsample_bytree: 0.640427386628771
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   reg_alpha: 6.0449404027519604e-06
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   reg_lambda: 0.001956154744954092
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:30:26,932 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:30:45,335 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:30:45,335 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:30:45,337 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:30:45,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:30:45,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:45,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:45,356 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:45,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:45,384 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:45,400 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:45,415 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:45,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:45,437 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:30:45,437 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:45,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:30:45,488 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:30:45,489 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:30:45,489 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:30:45,489 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:30:45,489 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:30:45,489 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:30:45,489 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:30:45,489 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:30:45,492 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:30:45,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:30:45,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:30:45,497 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:30:46,669 - src.training - INFO -   precision: 0.002627575715668649
2025-06-24 11:30:46,669 - src.training - INFO -   recall: 0.2814814814814815
2025-06-24 11:30:46,669 - src.training - INFO -   f1: 0.005206549290950195
2025-06-24 11:30:46,669 - src.training - INFO -   accuracy: 0.8685525482031321
2025-06-24 11:30:46,669 - src.training - INFO -   balanced_accuracy: 0.5753761692085887
2025-06-24 11:30:46,669 - src.training - INFO -   positive_samples: 270
2025-06-24 11:30:46,669 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:30:46,669 - src.training - INFO -   total_samples: 220940
2025-06-24 11:30:46,669 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:30:46,669 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:30:46,669 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:30:46,669 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:30:46,670 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:30:46,671 - src.training - INFO - 모델 학습 완료
2025-06-24 11:30:46,671 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002627575715668649, 'recall': 0.2814814814814815, 'f1': 0.005206549290950195, 'accuracy': 0.8685525482031321, 'balanced_accuracy': 0.5753761692085887, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:30:46,671 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:46,671 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:46,671 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:46,671 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:46,709 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:30:46,709 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:30:47,143 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = xgboost
2025-06-24 11:30:48,837 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:30:48,837 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:30:48,837 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:30:48,837 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:30:48,837 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:30:48,837 - src.training - INFO - 교차 검증 시작
2025-06-24 11:30:48,837 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:30:48,854 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:30:49,283 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:30:49,283 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:30:49,283 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:30:49,283 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:30:49,283 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:30:49,283 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:30:49,283 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:30:49,283 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:30:49,283 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:30:49,455 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:30:49,455 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:30:49,455 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:30:49,455 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:30:49,455 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:30:49,455 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:30:49,456 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:30:49,456 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:30:49,456 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:30:49,456 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:30:50,878 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:30:51,965 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:30:51,965 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:30:51,968 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:30:52,000 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:30:52,000 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:30:52,000 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:30:52,001 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:30:53,322 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:30:53,583 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:30:53,583 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:30:53,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:30:53,751 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:30:53,778 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:30:53,778 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:30:53,778 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:30:53,778 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:30:53,778 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:53,778 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:30:53,827 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:30:53,827 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:30:53,827 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:53,827 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:53,827 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:30:53,827 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:30:53,827 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:53,892 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:30:53,892 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:30:53,892 - src.training - INFO - 모델 학습 시작
2025-06-24 11:30:54,025 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:30:54,025 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:30:54,025 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:30:54,025 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:30:54,025 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:30:54,025 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:30:54,025 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:30:54,025 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:30:54,025 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:30:54,025 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:54,025 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:30:54,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:30:54,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:54,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:54,113 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:54,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:54,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:54,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:54,377 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:54,453 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:54,471 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:30:54,471 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:54,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:30:54,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:54,538 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:54,538 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:30:54,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:30:54,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:54,539 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:30:54,556 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:30:54,571 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:30:54,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:30:54,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:30:54,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:30:54,638 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:30:54,641 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:30:54,641 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:30:54,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:30:54,657 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:54,657 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:30:54,657 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:30:54,657 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   n_estimators: 472
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   learning_rate: 0.129105746997292
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   subsample: 0.8402577509501822
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6775575780243155
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   reg_alpha: 2.3746473088612515e-07
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   reg_lambda: 0.0661239258368938
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:30:54,675 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:31:11,689 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:31:11,689 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:31:11,693 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:31:11,693 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:31:11,693 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:11,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:31:11,714 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:31:11,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:31:11,745 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:31:11,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:31:11,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:31:11,795 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:31:11,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:31:11,799 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:11,803 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:31:11,871 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:31:11,872 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:31:11,872 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:31:11,872 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:31:11,872 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:31:11,872 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:31:11,872 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:31:11,872 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:31:11,875 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:31:11,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:31:11,880 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:31:11,880 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:31:13,121 - src.training - INFO -   precision: 0.0026795284030010718
2025-06-24 11:31:13,121 - src.training - INFO -   recall: 0.037037037037037035
2025-06-24 11:31:13,121 - src.training - INFO -   f1: 0.004997501249375313
2025-06-24 11:31:13,121 - src.training - INFO -   accuracy: 0.9819770073323074
2025-06-24 11:31:13,121 - src.training - INFO -   balanced_accuracy: 0.5100851111681763
2025-06-24 11:31:13,121 - src.training - INFO -   positive_samples: 270
2025-06-24 11:31:13,121 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:31:13,121 - src.training - INFO -   total_samples: 220940
2025-06-24 11:31:13,121 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:31:13,121 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:31:13,121 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:31:13,121 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:31:13,122 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:31:13,124 - src.training - INFO - 모델 학습 완료
2025-06-24 11:31:13,124 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026795284030010718, 'recall': 0.037037037037037035, 'f1': 0.004997501249375313, 'accuracy': 0.9819770073323074, 'balanced_accuracy': 0.5100851111681763, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:31:13,124 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:13,124 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:13,124 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:13,124 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:13,163 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:31:13,163 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:31:13,620 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = xgboost
2025-06-24 11:31:15,481 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:31:15,481 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:31:15,481 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:31:15,482 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:31:15,482 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:31:15,482 - src.training - INFO - 교차 검증 시작
2025-06-24 11:31:15,482 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:31:15,497 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:31:15,958 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:31:15,958 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:31:15,958 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:31:15,958 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:31:15,958 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:31:15,958 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:31:15,958 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:31:15,958 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:31:15,958 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:31:16,124 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:31:16,124 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:31:16,124 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:31:16,124 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:31:17,543 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:31:18,631 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:31:18,631 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:31:18,637 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:31:18,669 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:31:18,669 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:31:18,669 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:31:18,669 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:31:19,981 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:31:20,237 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:31:20,237 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:31:20,406 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:31:20,406 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:31:20,432 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:31:20,432 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:31:20,432 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:31:20,432 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:31:20,432 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:20,432 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:31:20,481 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:31:20,482 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:31:20,482 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:20,482 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:20,482 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:31:20,482 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:31:20,482 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:20,547 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:31:20,548 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:31:20,548 - src.training - INFO - 모델 학습 시작
2025-06-24 11:31:20,680 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:31:20,680 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:31:20,680 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:31:20,680 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:31:20,680 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:31:20,680 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:31:20,680 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:31:20,680 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:31:20,680 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:31:20,680 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:20,680 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:31:20,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:31:20,680 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:20,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:31:20,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:31:20,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:31:20,902 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:31:20,967 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:31:21,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:31:21,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:31:21,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:31:21,126 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:21,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:31:21,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:21,193 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:21,193 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:31:21,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:31:21,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:21,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:31:21,211 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:31:21,226 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:31:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:31:21,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:31:21,275 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:31:21,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:31:21,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:31:21,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:21,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:31:21,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:21,312 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:31:21,312 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:21,312 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:31:21,329 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   n_estimators: 532
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   learning_rate: 0.13036472463279924
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   subsample: 0.8554159176974658
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6627949231142443
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   reg_alpha: 4.728362081161036e-08
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   reg_lambda: 8.774388669635764
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:31:21,330 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:31:52,301 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:31:52,301 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:31:52,305 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:31:52,305 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:31:52,305 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:52,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:31:52,324 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:31:52,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:31:52,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:31:52,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:31:52,382 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:31:52,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:31:52,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:31:52,403 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:52,407 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:31:52,533 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:31:52,533 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:31:52,533 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:31:52,533 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:31:52,533 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:31:52,533 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:31:52,533 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:31:52,533 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:31:52,536 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:31:52,540 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:31:52,541 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:31:52,541 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:31:53,777 - src.training - INFO -   precision: 0.002734107997265892
2025-06-24 11:31:53,777 - src.training - INFO -   recall: 0.05925925925925926
2025-06-24 11:31:53,777 - src.training - INFO -   f1: 0.005227049983665469
2025-06-24 11:31:53,777 - src.training - INFO -   accuracy: 0.9724359554630216
2025-06-24 11:31:53,777 - src.training - INFO -   balanced_accuracy: 0.516406264423666
2025-06-24 11:31:53,777 - src.training - INFO -   positive_samples: 270
2025-06-24 11:31:53,777 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:31:53,777 - src.training - INFO -   total_samples: 220940
2025-06-24 11:31:53,777 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:31:53,777 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:31:53,777 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:31:53,777 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:31:53,777 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:31:53,780 - src.training - INFO - 모델 학습 완료
2025-06-24 11:31:53,780 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002734107997265892, 'recall': 0.05925925925925926, 'f1': 0.005227049983665469, 'accuracy': 0.9724359554630216, 'balanced_accuracy': 0.516406264423666, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:31:53,780 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:53,780 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:53,780 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:31:53,780 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:31:53,818 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:31:53,818 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:31:54,247 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = xgboost
2025-06-24 11:31:56,019 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:31:56,019 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:31:56,019 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:31:56,019 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:31:56,019 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:31:56,019 - src.training - INFO - 교차 검증 시작
2025-06-24 11:31:56,019 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:31:56,036 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:31:56,465 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:31:56,465 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:31:56,466 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:31:56,466 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:31:56,466 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:31:56,466 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:31:56,466 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:31:56,466 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:31:56,466 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:31:56,644 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:31:56,644 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:31:56,644 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:31:56,644 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:31:57,933 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:31:58,921 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:31:58,922 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:31:58,927 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:31:58,958 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:31:58,958 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:31:58,958 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:31:58,958 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:32:00,149 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:32:00,381 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:32:00,381 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:32:00,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:32:00,542 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:32:00,567 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:32:00,567 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:32:00,567 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:32:00,567 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:32:00,567 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:00,567 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:32:00,613 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:32:00,614 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:32:00,614 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:00,614 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:00,614 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:32:00,614 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:32:00,614 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:00,674 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:32:00,674 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:32:00,674 - src.training - INFO - 모델 학습 시작
2025-06-24 11:32:00,806 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:32:00,806 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:32:00,806 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:32:00,806 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:32:00,806 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:32:00,806 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:32:00,806 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:32:00,806 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:32:00,806 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:32:00,806 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:00,806 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:32:00,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:32:00,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:00,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:32:00,881 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:32:00,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:32:00,990 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:32:01,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:32:01,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:32:01,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:32:01,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:32:01,187 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:01,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:32:01,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:01,263 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:01,263 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:32:01,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:32:01,263 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:01,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:32:01,280 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:32:01,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:32:01,308 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:32:01,322 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:32:01,336 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:32:01,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:32:01,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:32:01,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:01,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:32:01,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:01,370 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:32:01,370 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:01,370 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   n_estimators: 614
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   learning_rate: 0.03325043554067705
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   subsample: 0.7606174204617988
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6130997056226117
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:32:01,387 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:32:01,388 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:32:01,388 - src.models.xgboost_model - INFO -   reg_alpha: 0.049937628983777835
2025-06-24 11:32:01,388 - src.models.xgboost_model - INFO -   reg_lambda: 1.3236030253798081
2025-06-24 11:32:01,388 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:32:01,388 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:32:01,388 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:32:16,680 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:32:16,680 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:32:16,682 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:32:16,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:32:16,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:16,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:32:16,701 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:32:16,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:32:16,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:32:16,743 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:32:16,760 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:32:16,777 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:32:16,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:32:16,781 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:16,785 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:32:16,820 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:32:16,820 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:32:16,820 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:32:16,820 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:32:16,820 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:32:16,820 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:32:16,820 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:32:16,820 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:32:16,823 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:32:16,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:32:16,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:32:16,828 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:32:18,080 - src.training - INFO -   precision: 0.002856331534902367
2025-06-24 11:32:18,080 - src.training - INFO -   recall: 0.6333333333333333
2025-06-24 11:32:18,080 - src.training - INFO -   f1: 0.005687014649882768
2025-06-24 11:32:18,080 - src.training - INFO -   accuracy: 0.7293609124649226
2025-06-24 11:32:18,080 - src.training - INFO -   balanced_accuracy: 0.6814058700019636
2025-06-24 11:32:18,080 - src.training - INFO -   positive_samples: 270
2025-06-24 11:32:18,080 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:32:18,080 - src.training - INFO -   total_samples: 220940
2025-06-24 11:32:18,080 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:32:18,080 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:32:18,080 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:32:18,080 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:32:18,081 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:32:18,081 - src.training - INFO - 모델 학습 완료
2025-06-24 11:32:18,081 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002856331534902367, 'recall': 0.6333333333333333, 'f1': 0.005687014649882768, 'accuracy': 0.7293609124649226, 'balanced_accuracy': 0.6814058700019636, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:32:18,081 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:18,081 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:18,082 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:18,082 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:18,122 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:32:18,122 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:32:18,557 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = xgboost
2025-06-24 11:32:20,268 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:32:20,268 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:32:20,268 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:32:20,268 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:32:20,268 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:32:20,268 - src.training - INFO - 교차 검증 시작
2025-06-24 11:32:20,268 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:32:20,285 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:32:20,718 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:32:20,718 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:32:20,718 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:32:20,718 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:32:20,718 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:32:20,718 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:32:20,718 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:32:20,718 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:32:20,718 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:32:20,895 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:32:20,895 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:32:20,895 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:32:20,895 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:32:22,199 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:32:23,185 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:32:23,185 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:32:23,191 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:32:23,222 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:32:23,222 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:32:23,222 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:32:23,222 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:32:24,407 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:32:24,649 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:32:24,649 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:32:24,814 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:32:24,814 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:32:24,839 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:32:24,839 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:32:24,839 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:32:24,839 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:32:24,839 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:24,839 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:32:24,885 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:32:24,885 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:32:24,885 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:24,885 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:24,885 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:32:24,885 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:32:24,885 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:24,946 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:32:24,946 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:32:24,946 - src.training - INFO - 모델 학습 시작
2025-06-24 11:32:25,076 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:32:25,076 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:32:25,076 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:32:25,076 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:32:25,076 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:32:25,076 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:32:25,076 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:32:25,076 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:32:25,076 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:32:25,077 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:25,077 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:32:25,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:32:25,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:25,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:32:25,152 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:32:25,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:32:25,261 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:32:25,315 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:32:25,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:32:25,441 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:32:25,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:32:25,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:25,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:32:25,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:25,532 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:25,532 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:32:25,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:32:25,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:25,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:32:25,550 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:32:25,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:32:25,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:32:25,590 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:32:25,604 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:32:25,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:32:25,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:32:25,623 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:32:25,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:32:25,638 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:25,638 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:32:25,638 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:32:25,638 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   n_estimators: 877
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   max_depth: 7
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   learning_rate: 0.13594599024195853
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   subsample: 0.9517751553987598
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6212860285583952
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   reg_alpha: 1.0760981814676716
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   reg_lambda: 1.4469874833540355
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:32:25,656 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:33:14,422 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:33:14,422 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:33:14,424 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:33:14,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:33:14,424 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:14,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:33:14,443 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:33:14,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:33:14,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:33:14,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:33:14,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:33:14,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:33:14,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:33:14,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:14,534 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:33:14,697 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:33:14,697 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:33:14,697 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:33:14,697 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:33:14,697 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:33:14,697 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:33:14,697 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:33:14,697 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:33:14,701 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:33:14,705 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:33:14,706 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:33:14,706 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:33:16,088 - src.training - INFO -   precision: 0.0034205009378792894
2025-06-24 11:33:16,088 - src.training - INFO -   recall: 0.11481481481481481
2025-06-24 11:33:16,088 - src.training - INFO -   f1: 0.006643094396228437
2025-06-24 11:33:16,088 - src.training - INFO -   accuracy: 0.9580383814610302
2025-06-24 11:33:16,088 - src.training - INFO -   balanced_accuracy: 0.5369424597480065
2025-06-24 11:33:16,088 - src.training - INFO -   positive_samples: 270
2025-06-24 11:33:16,088 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:33:16,088 - src.training - INFO -   total_samples: 220940
2025-06-24 11:33:16,088 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:33:16,088 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:33:16,088 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:33:16,088 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:33:16,088 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:33:16,089 - src.training - INFO - 모델 학습 완료
2025-06-24 11:33:16,089 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0034205009378792894, 'recall': 0.11481481481481481, 'f1': 0.006643094396228437, 'accuracy': 0.9580383814610302, 'balanced_accuracy': 0.5369424597480065, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:33:16,089 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:16,089 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:16,089 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:16,089 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:16,130 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:33:16,130 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:33:16,580 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = xgboost
2025-06-24 11:33:18,401 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:33:18,401 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:33:18,401 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:33:18,401 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:33:18,401 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:33:18,401 - src.training - INFO - 교차 검증 시작
2025-06-24 11:33:18,401 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:33:18,418 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:33:18,856 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:33:18,856 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:33:18,856 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:33:18,856 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:33:18,856 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:33:18,856 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:33:18,856 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:33:18,856 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:33:18,856 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:33:19,028 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:33:19,028 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:33:19,028 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:33:19,028 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:33:20,300 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:33:21,284 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:33:21,284 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:33:21,290 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:33:21,321 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:33:21,321 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:33:21,321 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:33:21,321 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:33:22,511 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:33:22,746 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:33:22,746 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:33:22,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:33:22,907 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:33:22,932 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:33:22,932 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:33:22,932 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:33:22,932 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:33:22,932 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:22,932 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:33:22,977 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:33:22,977 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:33:22,977 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:22,977 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:22,977 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:33:22,977 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:33:22,977 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:23,036 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:33:23,036 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:33:23,036 - src.training - INFO - 모델 학습 시작
2025-06-24 11:33:23,164 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:33:23,164 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:33:23,164 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:33:23,164 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:33:23,164 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:33:23,164 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:33:23,164 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:33:23,164 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:33:23,164 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:33:23,164 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:23,164 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:33:23,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:33:23,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:23,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:33:23,239 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:33:23,293 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:33:23,349 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:33:23,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:33:23,460 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:33:23,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:33:23,546 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:33:23,547 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:23,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:33:23,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:23,622 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:23,622 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:33:23,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:33:23,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:23,622 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:33:23,639 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:33:23,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:33:23,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:33:23,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:33:23,694 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:33:23,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:33:23,713 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:33:23,713 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:33:23,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:33:23,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:23,728 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:33:23,728 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:33:23,728 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   n_estimators: 658
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   learning_rate: 0.11116534266739268
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   subsample: 0.8011236880251785
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7078425952703362
2025-06-24 11:33:23,745 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   reg_alpha: 0.017567126428386017
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   reg_lambda: 0.1405465197061455
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:33:23,746 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:34:03,936 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:34:03,936 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:34:03,938 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:34:03,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:34:03,938 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:03,939 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:34:03,957 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:34:03,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:34:03,988 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:34:04,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:34:04,019 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:34:04,036 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:34:04,041 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:34:04,041 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:04,045 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:34:04,173 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:34:04,173 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:34:04,173 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:34:04,173 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:34:04,173 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:34:04,173 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:34:04,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:34:04,173 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:34:04,176 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:34:04,180 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:34:04,181 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:34:04,181 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:34:05,412 - src.training - INFO -   precision: 0.0035897435897435897
2025-06-24 11:34:05,412 - src.training - INFO -   recall: 0.07777777777777778
2025-06-24 11:34:05,412 - src.training - INFO -   f1: 0.006862745098039216
2025-06-24 11:34:05,412 - src.training - INFO -   accuracy: 0.9724902688512719
2025-06-24 11:34:05,412 - src.training - INFO -   balanced_accuracy: 0.5256813844705266
2025-06-24 11:34:05,412 - src.training - INFO -   positive_samples: 270
2025-06-24 11:34:05,412 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:34:05,412 - src.training - INFO -   total_samples: 220940
2025-06-24 11:34:05,412 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:34:05,412 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:34:05,412 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:34:05,412 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:34:05,413 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:34:05,415 - src.training - INFO - 모델 학습 완료
2025-06-24 11:34:05,415 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0035897435897435897, 'recall': 0.07777777777777778, 'f1': 0.006862745098039216, 'accuracy': 0.9724902688512719, 'balanced_accuracy': 0.5256813844705266, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:34:05,415 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:05,415 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:05,415 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:05,415 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:05,453 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:34:05,453 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:34:05,886 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = xgboost
2025-06-24 11:34:07,589 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:34:07,589 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:34:07,589 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:34:07,589 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:34:07,589 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:34:07,589 - src.training - INFO - 교차 검증 시작
2025-06-24 11:34:07,589 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:34:07,606 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:34:08,034 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:34:08,034 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:34:08,034 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:34:08,034 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:34:08,034 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:34:08,034 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:34:08,034 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:34:08,034 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:34:08,034 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:34:08,207 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:34:08,207 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:34:08,207 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:34:08,207 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:34:09,485 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:34:10,460 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:34:10,461 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:34:10,466 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:34:10,498 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:34:10,498 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:34:10,498 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:34:10,498 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:34:11,682 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:34:11,916 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:34:11,916 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:34:12,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:34:12,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:34:12,104 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:34:12,104 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:34:12,104 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:34:12,104 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:34:12,104 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:12,104 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,150 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:34:12,150 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:34:12,150 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,150 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,150 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:34:12,150 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:34:12,150 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,209 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:34:12,209 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:34:12,209 - src.training - INFO - 모델 학습 시작
2025-06-24 11:34:12,337 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:34:12,337 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:34:12,337 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:34:12,337 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:34:12,337 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:34:12,337 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:34:12,337 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:34:12,337 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:34:12,337 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:34:12,337 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,337 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:34:12,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:34:12,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:12,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:34:12,412 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:34:12,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:34:12,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:34:12,577 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:34:12,634 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:34:12,704 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:34:12,721 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:34:12,721 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:12,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:34:12,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,800 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,800 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:34:12,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:34:12,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:12,801 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:34:12,817 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:34:12,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:34:12,845 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:34:12,859 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:34:12,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:34:12,890 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:34:12,892 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:34:12,892 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:34:12,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:34:12,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,906 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:34:12,906 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:34:12,906 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   n_estimators: 621
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   learning_rate: 0.060801099686849006
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   subsample: 0.7899079926078594
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   colsample_bytree: 0.77381995299718
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   reg_alpha: 1.9880480605051085
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   reg_lambda: 4.563432312153374
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:34:12,925 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:34:12,926 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:35:02,224 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:35:02,224 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:35:02,228 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:35:02,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:35:02,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:02,228 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:35:02,246 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:35:02,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:35:02,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:35:02,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:35:02,313 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:35:02,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:35:02,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:35:02,335 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:02,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:35:02,504 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:35:02,504 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:35:02,504 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:35:02,504 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:35:02,504 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:35:02,504 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:35:02,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:35:02,504 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:35:02,508 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:35:02,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:35:02,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:35:02,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:35:03,829 - src.training - INFO -   precision: 0.004437869822485207
2025-06-24 11:35:03,829 - src.training - INFO -   recall: 0.1
2025-06-24 11:35:03,829 - src.training - INFO -   f1: 0.0084985835694051
2025-06-24 11:35:03,829 - src.training - INFO -   accuracy: 0.971485471168643
2025-06-24 11:35:03,829 - src.training - INFO -   balanced_accuracy: 0.5362758870711923
2025-06-24 11:35:03,829 - src.training - INFO -   positive_samples: 270
2025-06-24 11:35:03,829 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:35:03,829 - src.training - INFO -   total_samples: 220940
2025-06-24 11:35:03,829 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:35:03,829 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:35:03,829 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:35:03,829 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:35:03,829 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:35:03,831 - src.training - INFO - 모델 학습 완료
2025-06-24 11:35:03,831 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.004437869822485207, 'recall': 0.1, 'f1': 0.0084985835694051, 'accuracy': 0.971485471168643, 'balanced_accuracy': 0.5362758870711923, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:35:03,831 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:03,831 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:03,831 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:03,831 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:03,872 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:35:03,872 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:35:04,322 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = xgboost
2025-06-24 11:35:06,191 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:35:06,192 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:35:06,192 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:35:06,192 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:35:06,192 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:35:06,192 - src.training - INFO - 교차 검증 시작
2025-06-24 11:35:06,192 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:35:06,209 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:35:06,669 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:35:06,669 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:35:06,669 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:35:06,669 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:35:06,669 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:35:06,669 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:35:06,669 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:35:06,669 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:35:06,669 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:35:06,835 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:35:06,836 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:35:06,836 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:35:06,836 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:35:06,836 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:35:06,836 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:35:06,836 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:35:06,836 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:35:06,836 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:35:06,836 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:35:08,250 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:35:09,340 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:35:09,340 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:35:09,346 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:35:09,378 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:35:09,378 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:35:09,378 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:35:09,378 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:35:10,692 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:35:10,943 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:35:10,943 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:35:11,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:35:11,112 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:35:11,138 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:35:11,139 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:35:11,139 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:35:11,139 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:35:11,139 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:11,139 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,188 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:35:11,188 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:35:11,188 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,188 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,188 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:35:11,188 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:35:11,188 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,252 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:35:11,252 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:35:11,252 - src.training - INFO - 모델 학습 시작
2025-06-24 11:35:11,384 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:35:11,384 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:35:11,384 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:35:11,384 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:35:11,384 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:35:11,384 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:35:11,384 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:35:11,384 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:35:11,384 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:35:11,384 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,384 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:35:11,384 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:35:11,384 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:11,385 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:35:11,473 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:35:11,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:35:11,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:35:11,673 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:35:11,739 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:35:11,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:35:11,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:35:11,833 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:11,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:35:11,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,903 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:11,903 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:35:11,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:35:11,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:11,903 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:35:11,921 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:35:11,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:35:11,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:35:11,968 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:35:11,985 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:35:12,003 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:35:12,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:35:12,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:12,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:35:12,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:12,021 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:35:12,021 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:12,021 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   n_estimators: 713
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   learning_rate: 0.02272046952985376
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   subsample: 0.9200151798169199
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6875716642651658
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   reg_alpha: 0.26751677468280516
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   reg_lambda: 0.043831937174600724
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:35:12,040 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:35:48,973 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:35:48,973 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:35:48,975 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:35:48,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:35:48,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:48,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:35:48,994 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:35:49,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:35:49,022 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:35:49,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:35:49,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:35:49,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:35:49,075 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:35:49,075 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:49,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:35:49,186 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:35:49,186 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:35:49,186 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:35:49,186 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:35:49,186 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:35:49,186 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:35:49,186 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:35:49,186 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:35:49,190 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:35:49,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:35:49,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:35:49,194 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:35:50,375 - src.training - INFO -   precision: 0.002685364762046845
2025-06-24 11:35:50,375 - src.training - INFO -   recall: 0.4
2025-06-24 11:35:50,375 - src.training - INFO -   f1: 0.005334914048606995
2025-06-24 11:35:50,375 - src.training - INFO -   accuracy: 0.8177242690323164
2025-06-24 11:35:50,375 - src.training - INFO -   balanced_accuracy: 0.6091176870440024
2025-06-24 11:35:50,375 - src.training - INFO -   positive_samples: 270
2025-06-24 11:35:50,375 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:35:50,375 - src.training - INFO -   total_samples: 220940
2025-06-24 11:35:50,375 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:35:50,375 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:35:50,375 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:35:50,375 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:35:50,375 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:35:50,376 - src.training - INFO - 모델 학습 완료
2025-06-24 11:35:50,377 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002685364762046845, 'recall': 0.4, 'f1': 0.005334914048606995, 'accuracy': 0.8177242690323164, 'balanced_accuracy': 0.6091176870440024, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:35:50,377 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:50,377 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:50,377 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:50,377 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:50,415 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:35:50,415 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:35:50,849 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = xgboost
2025-06-24 11:35:52,550 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:35:52,550 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:35:52,550 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:35:52,550 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:35:52,550 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:35:52,550 - src.training - INFO - 교차 검증 시작
2025-06-24 11:35:52,550 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:35:52,567 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:35:52,996 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:35:52,996 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:35:52,996 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:35:52,996 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:35:52,996 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:35:52,996 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:35:52,996 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:35:52,996 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:35:52,996 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:35:53,167 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:35:53,167 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:35:53,167 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:35:53,167 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:35:54,450 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:35:55,439 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:35:55,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:35:55,445 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:35:55,476 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:35:55,476 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:35:55,476 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:35:55,476 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:35:56,663 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:35:56,904 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:35:56,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:35:57,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:35:57,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:35:57,090 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:35:57,090 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:35:57,090 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:35:57,090 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:35:57,090 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:57,090 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,136 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:35:57,136 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:35:57,136 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,136 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,136 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:35:57,136 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:35:57,136 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,194 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:35:57,194 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:35:57,194 - src.training - INFO - 모델 학습 시작
2025-06-24 11:35:57,321 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:35:57,321 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:35:57,321 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:35:57,321 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:35:57,321 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:35:57,321 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:35:57,321 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:35:57,321 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:35:57,321 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:35:57,321 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,321 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:35:57,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:35:57,321 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:57,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:35:57,396 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:35:57,450 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:35:57,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:35:57,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:35:57,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:35:57,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:35:57,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:35:57,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:57,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:35:57,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,782 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,782 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:35:57,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:35:57,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:57,782 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:35:57,799 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:35:57,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:35:57,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:35:57,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:35:57,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:35:57,870 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:35:57,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:35:57,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:35:57,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:35:57,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,887 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:35:57,888 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:35:57,888 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   n_estimators: 755
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   learning_rate: 0.11515976409581594
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   subsample: 0.774676032967104
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6524085006924775
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   reg_alpha: 0.013511109709805545
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   reg_lambda: 0.2650923152797764
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:35:57,906 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:36:31,064 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:36:31,064 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:36:31,067 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:36:31,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:36:31,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:31,067 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:36:31,086 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:36:31,100 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:36:31,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:36:31,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:36:31,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:36:31,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:36:31,168 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:36:31,168 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:31,172 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:36:31,282 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:36:31,283 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:36:31,283 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:36:31,283 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:36:31,283 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:36:31,283 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:36:31,283 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:36:31,283 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:36:31,286 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:36:31,290 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:36:31,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:36:31,291 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:36:32,534 - src.training - INFO -   precision: 0.003561969129600877
2025-06-24 11:36:32,534 - src.training - INFO -   recall: 0.14444444444444443
2025-06-24 11:36:32,534 - src.training - INFO -   f1: 0.006952491309385863
2025-06-24 11:36:32,534 - src.training - INFO -   accuracy: 0.9495745451253734
2025-06-24 11:36:32,534 - src.training - INFO -   balanced_accuracy: 0.5475020518320468
2025-06-24 11:36:32,534 - src.training - INFO -   positive_samples: 270
2025-06-24 11:36:32,534 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:36:32,534 - src.training - INFO -   total_samples: 220940
2025-06-24 11:36:32,534 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:36:32,534 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:36:32,534 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:36:32,534 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:36:32,535 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:36:32,536 - src.training - INFO - 모델 학습 완료
2025-06-24 11:36:32,536 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003561969129600877, 'recall': 0.14444444444444443, 'f1': 0.006952491309385863, 'accuracy': 0.9495745451253734, 'balanced_accuracy': 0.5475020518320468, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:36:32,536 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:32,536 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:32,536 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:32,536 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:32,574 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:36:32,574 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:36:33,004 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = xgboost
2025-06-24 11:36:34,710 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:36:34,710 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:36:34,710 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:36:34,710 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:36:34,710 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:36:34,710 - src.training - INFO - 교차 검증 시작
2025-06-24 11:36:34,710 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:36:34,727 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:36:35,156 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:36:35,156 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:36:35,156 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:36:35,156 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:36:35,156 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:36:35,156 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:36:35,156 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:36:35,156 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:36:35,156 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:36:35,329 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:36:35,329 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:36:35,329 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:36:35,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:36:36,613 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:36:37,696 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:36:37,696 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:36:37,702 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:36:37,734 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:36:37,734 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:36:37,735 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:36:37,735 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:36:39,023 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:36:39,275 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:36:39,275 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:36:39,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:36:39,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:36:39,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:36:39,470 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:36:39,470 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:36:39,470 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:36:39,470 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:39,470 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:36:39,520 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:36:39,520 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:36:39,520 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:39,520 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:39,520 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:36:39,520 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:36:39,520 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:39,586 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:36:39,586 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:36:39,586 - src.training - INFO - 모델 학습 시작
2025-06-24 11:36:39,717 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:36:39,717 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:36:39,717 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:36:39,717 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:36:39,717 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:36:39,717 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:36:39,717 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:36:39,717 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:36:39,717 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:36:39,717 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:39,717 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:36:39,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:36:39,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:39,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:36:39,806 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:36:39,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:36:39,941 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:36:40,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:36:40,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:36:40,149 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:36:40,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:36:40,166 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:40,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:36:40,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:40,236 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:40,236 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:36:40,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:36:40,236 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:40,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:36:40,254 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:36:40,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:36:40,286 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:36:40,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:36:40,319 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:36:40,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:36:40,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:36:40,340 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:40,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:36:40,355 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:40,355 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:36:40,355 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:40,355 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   n_estimators: 544
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   learning_rate: 0.2612601673750713
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   subsample: 0.8143443908858846
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6070916184162892
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   reg_alpha: 2.074474638023645e-05
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   reg_lambda: 1.8407186708364125e-08
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:36:40,374 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:36:43,385 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:36:43,385 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:36:43,387 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:36:43,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:36:43,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:43,387 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:36:43,406 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:36:43,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:36:43,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:36:43,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:36:43,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:36:43,484 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:36:43,489 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:36:43,489 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:43,493 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:36:43,499 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:36:43,500 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:36:43,500 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:36:43,500 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:36:43,500 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:36:43,500 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:36:43,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:36:43,500 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:36:43,503 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:36:43,507 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:36:43,508 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:36:43,508 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:36:44,751 - src.training - INFO -   precision: 0.002606326264660585
2025-06-24 11:36:44,751 - src.training - INFO -   recall: 0.6518518518518519
2025-06-24 11:36:44,751 - src.training - INFO -   f1: 0.005191893566181893
2025-06-24 11:36:44,751 - src.training - INFO -   accuracy: 0.6947316013397302
2025-06-24 11:36:44,751 - src.training - INFO -   balanced_accuracy: 0.6733179592788965
2025-06-24 11:36:44,751 - src.training - INFO -   positive_samples: 270
2025-06-24 11:36:44,751 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:36:44,751 - src.training - INFO -   total_samples: 220940
2025-06-24 11:36:44,751 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:36:44,751 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:36:44,751 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:36:44,751 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:36:44,751 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:36:44,752 - src.training - INFO - 모델 학습 완료
2025-06-24 11:36:44,752 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002606326264660585, 'recall': 0.6518518518518519, 'f1': 0.005191893566181893, 'accuracy': 0.6947316013397302, 'balanced_accuracy': 0.6733179592788965, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:36:44,752 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:44,752 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:44,752 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:44,752 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:44,790 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:36:44,790 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:36:45,226 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = xgboost
2025-06-24 11:36:46,922 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:36:46,922 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:36:46,922 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:36:46,922 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:36:46,922 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:36:46,922 - src.training - INFO - 교차 검증 시작
2025-06-24 11:36:46,922 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:36:46,939 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:36:47,369 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:36:47,369 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:36:47,369 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:36:47,369 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:36:47,369 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:36:47,369 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:36:47,369 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:36:47,369 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:36:47,369 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:36:47,542 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:36:47,542 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:36:47,542 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:36:47,542 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:36:48,840 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:36:49,833 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:36:49,833 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:36:49,839 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:36:49,870 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:36:49,870 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:36:49,870 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:36:49,870 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:36:51,056 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:36:51,293 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:36:51,293 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:36:51,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:36:51,453 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:36:51,479 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:36:51,479 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:36:51,479 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:36:51,479 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:36:51,479 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:51,479 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:36:51,524 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:36:51,525 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:36:51,525 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:51,525 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:51,525 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:36:51,525 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:36:51,525 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:51,582 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:36:51,582 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:36:51,582 - src.training - INFO - 모델 학습 시작
2025-06-24 11:36:51,710 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:36:51,710 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:36:51,710 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:36:51,710 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:36:51,710 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:36:51,710 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:36:51,710 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:36:51,710 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:36:51,710 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:36:51,710 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:51,710 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:36:51,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:36:51,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:51,711 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:36:51,786 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:36:51,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:36:51,896 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:36:51,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:36:52,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:36:52,127 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:36:52,145 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:36:52,145 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:52,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:36:52,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:52,215 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:52,215 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:36:52,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:36:52,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:52,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:36:52,233 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:36:52,248 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:36:52,265 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:36:52,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:36:52,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:36:52,316 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:36:52,319 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:36:52,319 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:36:52,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:36:52,334 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:52,334 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:36:52,334 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:36:52,334 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   n_estimators: 465
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   learning_rate: 0.04201247793057575
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   subsample: 0.8075325882878023
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7959129031194437
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   reg_alpha: 5.3108969844290984e-05
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   reg_lambda: 6.492108150874975
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:36:52,353 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:36:52,354 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:37:14,355 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:37:14,355 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:37:14,357 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:37:14,357 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:37:14,357 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:14,358 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:37:14,376 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:37:14,390 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:37:14,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:37:14,420 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:37:14,435 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:37:14,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:37:14,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:37:14,458 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:14,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:37:14,513 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:37:14,513 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:37:14,513 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:37:14,513 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:37:14,513 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:37:14,513 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:37:14,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:37:14,513 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:37:14,517 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:37:14,521 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:37:14,521 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:37:14,522 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:37:15,779 - src.training - INFO -   precision: 0.002720247295208655
2025-06-24 11:37:15,779 - src.training - INFO -   recall: 0.4888888888888889
2025-06-24 11:37:15,779 - src.training - INFO -   f1: 0.005410390408853366
2025-06-24 11:37:15,779 - src.training - INFO -   accuracy: 0.7803430795691138
2025-06-24 11:37:15,779 - src.training - INFO -   balanced_accuracy: 0.6347942881023952
2025-06-24 11:37:15,779 - src.training - INFO -   positive_samples: 270
2025-06-24 11:37:15,779 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:37:15,779 - src.training - INFO -   total_samples: 220940
2025-06-24 11:37:15,779 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:37:15,779 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:37:15,779 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:37:15,779 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:37:15,779 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:37:15,780 - src.training - INFO - 모델 학습 완료
2025-06-24 11:37:15,780 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002720247295208655, 'recall': 0.4888888888888889, 'f1': 0.005410390408853366, 'accuracy': 0.7803430795691138, 'balanced_accuracy': 0.6347942881023952, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:37:15,780 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:15,780 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:15,780 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:15,780 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:15,819 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:37:15,819 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:37:16,253 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = xgboost
2025-06-24 11:37:18,135 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:37:18,136 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:37:18,136 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:37:18,136 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:37:18,136 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:37:18,136 - src.training - INFO - 교차 검증 시작
2025-06-24 11:37:18,136 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:37:18,152 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:37:18,619 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:37:18,619 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:37:18,619 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:37:18,619 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:37:18,619 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:37:18,619 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:37:18,619 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:37:18,619 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:37:18,619 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:37:18,786 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:37:18,786 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:37:18,786 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:37:18,786 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:37:20,216 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:37:21,307 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:37:21,308 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:37:21,312 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:37:21,344 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:37:21,344 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:37:21,344 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:37:21,344 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:37:22,658 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:37:22,913 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:37:22,913 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:37:23,082 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:37:23,082 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:37:23,108 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:37:23,108 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:37:23,108 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:37:23,108 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:37:23,108 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:23,108 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,158 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:37:23,158 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:37:23,158 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,158 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,158 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:37:23,158 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:37:23,158 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,223 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:37:23,223 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:37:23,223 - src.training - INFO - 모델 학습 시작
2025-06-24 11:37:23,356 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:37:23,356 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:37:23,356 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:37:23,356 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:37:23,356 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:37:23,356 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:37:23,356 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:37:23,356 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:37:23,356 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:37:23,356 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,356 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:37:23,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:37:23,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:23,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:37:23,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:37:23,511 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:37:23,579 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:37:23,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:37:23,711 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:37:23,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:37:23,805 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:37:23,805 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:23,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:37:23,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,874 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,874 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:37:23,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:37:23,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:23,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:37:23,893 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:37:23,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:37:23,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:37:23,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:37:23,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:37:23,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:37:23,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:37:23,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:23,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:37:23,992 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,992 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:37:23,992 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:23,992 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   n_estimators: 713
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   learning_rate: 0.22364539872566191
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   subsample: 0.9886084565143556
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6910813964303807
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   reg_alpha: 0.01554060302305341
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   reg_lambda: 1.603278049675562e-07
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:37:24,011 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:37:45,947 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:37:45,948 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:37:45,950 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:37:45,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:37:45,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:45,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:37:45,969 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:37:45,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:37:45,998 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:37:46,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:37:46,029 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:37:46,046 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:37:46,050 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:37:46,050 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:46,054 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:37:46,094 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:37:46,094 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:37:46,094 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:37:46,094 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:37:46,094 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:37:46,094 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:37:46,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:37:46,094 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:37:46,098 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:37:46,102 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:37:46,102 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:37:46,102 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:37:47,334 - src.training - INFO -   precision: 0.002586350742532955
2025-06-24 11:37:47,334 - src.training - INFO -   recall: 0.45925925925925926
2025-06-24 11:37:47,334 - src.training - INFO -   f1: 0.005143734185091467
2025-06-24 11:37:47,334 - src.training - INFO -   accuracy: 0.7829003349325608
2025-06-24 11:37:47,334 - src.training - INFO -   balanced_accuracy: 0.6212777920440946
2025-06-24 11:37:47,334 - src.training - INFO -   positive_samples: 270
2025-06-24 11:37:47,334 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:37:47,334 - src.training - INFO -   total_samples: 220940
2025-06-24 11:37:47,334 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:37:47,334 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:37:47,334 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:37:47,334 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:37:47,334 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:37:47,335 - src.training - INFO - 모델 학습 완료
2025-06-24 11:37:47,335 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002586350742532955, 'recall': 0.45925925925925926, 'f1': 0.005143734185091467, 'accuracy': 0.7829003349325608, 'balanced_accuracy': 0.6212777920440946, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:37:47,335 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:47,335 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:47,335 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:47,335 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:47,374 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:37:47,374 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:37:47,803 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = xgboost
2025-06-24 11:37:49,495 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:37:49,495 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:37:49,495 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:37:49,495 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:37:49,495 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:37:49,495 - src.training - INFO - 교차 검증 시작
2025-06-24 11:37:49,495 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:37:49,511 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:37:49,956 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:37:49,956 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:37:49,956 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:37:49,956 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:37:49,956 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:37:49,956 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:37:49,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:37:49,956 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:37:49,956 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:37:50,127 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:37:50,127 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:37:50,127 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:37:50,127 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:37:51,423 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:37:52,405 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:37:52,405 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:37:52,411 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:37:52,442 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:37:52,442 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:37:52,442 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:37:52,442 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:37:53,624 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:37:53,876 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:37:53,876 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:37:54,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:37:54,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:37:54,074 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:37:54,074 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:37:54,074 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:37:54,074 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:37:54,074 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:54,074 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,123 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:37:54,123 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:37:54,123 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,123 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,123 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:37:54,123 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:37:54,123 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,190 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:37:54,190 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:37:54,190 - src.training - INFO - 모델 학습 시작
2025-06-24 11:37:54,322 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:37:54,322 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:37:54,322 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:37:54,322 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:37:54,322 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:37:54,322 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:37:54,322 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:37:54,322 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:37:54,322 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:37:54,322 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,322 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:37:54,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:37:54,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:54,322 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:37:54,410 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:37:54,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:37:54,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:37:54,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:37:54,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:37:54,753 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:37:54,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:37:54,770 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:54,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:37:54,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,841 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,841 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:37:54,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:37:54,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:54,842 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:37:54,859 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:37:54,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:37:54,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:37:54,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:37:54,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:37:54,942 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:37:54,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:37:54,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:37:54,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:37:54,959 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,959 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:37:54,959 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:37:54,959 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   n_estimators: 504
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   learning_rate: 0.1489649274970929
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   subsample: 0.7196295253540522
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   colsample_bytree: 0.761533529216834
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   reg_alpha: 3.0561092973727595e-05
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   reg_lambda: 0.07731813846825929
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:37:54,978 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:37:54,979 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:38:08,164 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:38:08,164 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:38:08,166 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:38:08,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:38:08,166 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:08,167 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:38:08,184 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:38:08,198 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:38:08,213 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:38:08,227 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:38:08,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:38:08,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:38:08,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:38:08,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:08,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:38:08,293 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:38:08,293 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:38:08,293 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:38:08,293 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:38:08,293 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:38:08,293 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:38:08,293 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:38:08,293 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:38:08,297 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:38:08,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:38:08,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:38:08,301 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:38:09,548 - src.training - INFO -   precision: 0.002704791344667697
2025-06-24 11:38:09,548 - src.training - INFO -   recall: 0.4925925925925926
2025-06-24 11:38:09,548 - src.training - INFO -   f1: 0.00538004126046681
2025-06-24 11:38:09,548 - src.training - INFO -   accuracy: 0.7774237349506653
2025-06-24 11:38:09,548 - src.training - INFO -   balanced_accuracy: 0.6351824158413183
2025-06-24 11:38:09,548 - src.training - INFO -   positive_samples: 270
2025-06-24 11:38:09,548 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:38:09,548 - src.training - INFO -   total_samples: 220940
2025-06-24 11:38:09,548 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:38:09,548 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:38:09,548 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:38:09,548 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:38:09,548 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:38:09,549 - src.training - INFO - 모델 학습 완료
2025-06-24 11:38:09,549 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002704791344667697, 'recall': 0.4925925925925926, 'f1': 0.00538004126046681, 'accuracy': 0.7774237349506653, 'balanced_accuracy': 0.6351824158413183, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:38:09,549 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:09,549 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:09,549 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:09,549 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:09,588 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:38:09,588 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:38:10,017 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = xgboost
2025-06-24 11:38:11,774 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:38:11,774 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:38:11,774 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:38:11,774 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:38:11,774 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:38:11,774 - src.training - INFO - 교차 검증 시작
2025-06-24 11:38:11,774 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:38:11,791 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:38:12,221 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:38:12,221 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:38:12,221 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:38:12,221 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:38:12,221 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:38:12,221 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:38:12,221 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:38:12,221 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:38:12,221 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:38:12,397 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:38:12,397 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:38:12,397 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:38:12,397 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:38:12,397 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:38:12,398 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:38:12,398 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:38:12,398 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:38:12,398 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:38:12,398 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:38:13,698 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:38:14,689 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:38:14,689 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:38:14,694 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:38:14,725 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:38:14,725 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:38:14,725 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:38:14,725 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:38:15,906 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:38:16,142 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:38:16,142 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:38:16,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:38:16,303 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:38:16,329 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:38:16,329 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:38:16,329 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:38:16,329 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:38:16,329 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:16,329 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:38:16,374 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:38:16,374 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:38:16,374 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:16,374 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:16,374 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:38:16,374 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:38:16,374 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:16,433 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:38:16,433 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:38:16,433 - src.training - INFO - 모델 학습 시작
2025-06-24 11:38:16,560 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:38:16,560 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:38:16,560 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:38:16,560 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:38:16,560 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:38:16,560 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:38:16,560 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:38:16,560 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:38:16,560 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:38:16,560 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:16,560 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:38:16,560 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:38:16,560 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:16,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:38:16,635 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:38:16,689 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:38:16,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:38:16,800 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:38:16,857 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:38:16,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:38:16,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:38:16,944 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:17,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:38:17,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:17,021 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:17,021 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:38:17,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:38:17,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:17,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:38:17,038 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:38:17,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:38:17,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:38:17,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:38:17,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:38:17,110 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:38:17,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:38:17,112 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:38:17,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:38:17,126 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:17,126 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:38:17,126 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:38:17,126 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   n_estimators: 573
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   learning_rate: 0.014988887360564527
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   subsample: 0.6312379357250655
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6413616555265561
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:38:17,144 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   reg_alpha: 9.428842621707823e-06
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   reg_lambda: 1.1532957033442247e-06
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:38:17,145 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:39:24,631 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:39:24,631 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:39:24,632 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:39:24,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:39:24,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:24,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:39:24,651 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:39:24,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:39:24,684 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:39:24,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:39:24,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:39:24,735 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:39:24,738 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:39:24,738 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:24,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:39:25,037 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:39:25,037 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:39:25,037 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:39:25,037 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:39:25,037 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:39:25,037 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:39:25,037 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:39:25,037 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:39:25,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:39:25,045 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:39:25,046 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:39:25,046 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:39:26,339 - src.training - INFO -   precision: 0.002949355355186652
2025-06-24 11:39:26,339 - src.training - INFO -   recall: 0.12962962962962962
2025-06-24 11:39:26,339 - src.training - INFO -   f1: 0.005767487847079179
2025-06-24 11:39:26,339 - src.training - INFO -   accuracy: 0.9453833619987327
2025-06-24 11:39:26,339 - src.training - INFO -   balanced_accuracy: 0.5380055521148556
2025-06-24 11:39:26,339 - src.training - INFO -   positive_samples: 270
2025-06-24 11:39:26,339 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:39:26,339 - src.training - INFO -   total_samples: 220940
2025-06-24 11:39:26,339 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:39:26,339 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:39:26,339 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:39:26,339 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:39:26,339 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:39:26,347 - src.training - INFO - 모델 학습 완료
2025-06-24 11:39:26,347 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002949355355186652, 'recall': 0.12962962962962962, 'f1': 0.005767487847079179, 'accuracy': 0.9453833619987327, 'balanced_accuracy': 0.5380055521148556, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:39:26,347 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:26,347 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:26,347 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:26,347 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:26,388 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:39:26,388 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:39:26,840 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = xgboost
2025-06-24 11:39:28,707 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:39:28,707 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:39:28,707 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:39:28,707 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:39:28,707 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:39:28,707 - src.training - INFO - 교차 검증 시작
2025-06-24 11:39:28,707 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:39:28,724 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:39:29,188 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:39:29,188 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:39:29,188 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:39:29,188 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:39:29,188 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:39:29,188 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:39:29,188 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:39:29,188 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:39:29,188 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:39:29,346 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:39:29,347 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:39:29,347 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:39:29,347 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:39:29,347 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:39:29,347 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:39:29,347 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:39:29,347 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:39:29,347 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:39:29,347 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:39:30,728 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:39:31,797 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:39:31,797 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:39:31,803 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:39:31,836 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:39:31,836 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:39:31,836 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:39:31,836 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:39:33,137 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:39:33,378 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:39:33,378 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:39:33,547 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:39:33,547 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:39:33,573 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:39:33,573 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:39:33,573 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:39:33,573 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:39:33,573 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:33,573 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:39:33,622 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:39:33,622 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:39:33,622 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:33,622 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:33,622 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:39:33,622 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:39:33,622 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:33,689 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:39:33,689 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:39:33,689 - src.training - INFO - 모델 학습 시작
2025-06-24 11:39:33,809 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:39:33,809 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:39:33,809 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:39:33,809 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:39:33,809 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:39:33,809 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:39:33,809 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:39:33,809 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:39:33,809 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:39:33,809 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:33,809 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:39:33,809 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:39:33,809 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:33,810 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:39:33,887 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:39:33,952 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:39:34,020 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:39:34,083 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:39:34,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:39:34,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:39:34,233 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:39:34,233 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:34,297 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:39:34,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:34,298 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:34,298 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:39:34,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:39:34,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:34,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:39:34,316 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:39:34,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:39:34,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:39:34,362 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:39:34,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:39:34,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:39:34,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:39:34,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:39:34,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:39:34,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:34,414 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:39:34,414 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:39:34,414 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   n_estimators: 670
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   learning_rate: 0.0211167747500629
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   subsample: 0.6265578758197884
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6428311251214268
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:39:34,430 - src.models.xgboost_model - INFO -   reg_alpha: 0.1658092882181092
2025-06-24 11:39:34,431 - src.models.xgboost_model - INFO -   reg_lambda: 3.9730862601765225e-05
2025-06-24 11:39:34,431 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:39:34,431 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:39:34,431 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:40:34,424 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:40:34,424 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:40:34,425 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:40:34,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:40:34,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:34,425 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:40:34,443 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:40:34,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:40:34,476 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:40:34,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:40:34,509 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:40:34,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:40:34,529 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:40:34,530 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:34,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:40:34,783 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:40:34,783 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:40:34,783 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:40:34,783 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:40:34,783 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:40:34,783 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:40:34,783 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:40:34,783 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:40:34,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:40:34,791 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:40:34,791 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:40:34,791 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:40:36,162 - src.training - INFO -   precision: 0.002701350675337669
2025-06-24 11:40:36,162 - src.training - INFO -   recall: 0.1
2025-06-24 11:40:36,162 - src.training - INFO -   f1: 0.005260594252313688
2025-06-24 11:40:36,162 - src.training - INFO -   accuracy: 0.9537838327147642
2025-06-24 11:40:36,162 - src.training - INFO -   balanced_accuracy: 0.5274142384556124
2025-06-24 11:40:36,162 - src.training - INFO -   positive_samples: 270
2025-06-24 11:40:36,162 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:40:36,162 - src.training - INFO -   total_samples: 220940
2025-06-24 11:40:36,162 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:40:36,162 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:40:36,162 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:40:36,163 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:40:36,163 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:40:36,168 - src.training - INFO - 모델 학습 완료
2025-06-24 11:40:36,168 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002701350675337669, 'recall': 0.1, 'f1': 0.005260594252313688, 'accuracy': 0.9537838327147642, 'balanced_accuracy': 0.5274142384556124, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:40:36,168 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:36,168 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:36,168 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:36,168 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:36,209 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:40:36,209 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:40:36,656 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = xgboost
2025-06-24 11:40:38,527 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:40:38,528 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:40:38,528 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:40:38,528 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:40:38,528 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:40:38,528 - src.training - INFO - 교차 검증 시작
2025-06-24 11:40:38,528 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:40:38,545 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:40:39,008 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:40:39,008 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:40:39,008 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:40:39,008 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:40:39,008 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:40:39,008 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:40:39,008 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:40:39,008 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:40:39,008 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:40:39,172 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:40:39,172 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:40:39,172 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:40:39,172 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:40:40,556 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:40:41,623 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:40:41,623 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:40:41,629 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:40:41,662 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:40:41,662 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:40:41,662 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:40:41,662 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:40:42,962 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:40:43,172 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:40:43,172 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:40:43,341 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:40:43,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:40:43,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:40:43,368 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:40:43,368 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:40:43,368 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:40:43,368 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:43,368 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:40:43,417 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:40:43,417 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:40:43,417 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:43,417 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:43,417 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:40:43,417 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:40:43,417 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:43,483 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:40:43,483 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:40:43,483 - src.training - INFO - 모델 학습 시작
2025-06-24 11:40:43,592 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:40:43,592 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:40:43,592 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:40:43,592 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:40:43,592 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:40:43,592 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:40:43,592 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:40:43,592 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:40:43,592 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:40:43,592 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:43,592 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:40:43,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:40:43,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:43,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:40:43,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:40:43,736 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:40:43,804 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:40:43,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:40:43,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:40:44,007 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:40:44,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:40:44,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:44,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:40:44,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:44,087 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:44,087 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:40:44,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:40:44,087 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:44,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:40:44,105 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:40:44,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:40:44,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:40:44,152 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:40:44,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:40:44,187 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:40:44,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:40:44,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:40:44,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:40:44,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:44,206 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:40:44,206 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:40:44,206 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   n_estimators: 807
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   learning_rate: 0.015571308134663855
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   subsample: 0.7331858706267436
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6144882388558486
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   reg_alpha: 0.002209734781434849
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   reg_lambda: 7.765045953979809e-08
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:40:44,224 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:42:10,259 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:42:10,259 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:42:10,260 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:42:10,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:42:10,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:10,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:42:10,279 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:42:10,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:42:10,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:42:10,328 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:42:10,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:42:10,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:42:10,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:42:10,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:10,368 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:42:10,735 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:42:10,735 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:42:10,735 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:42:10,735 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:42:10,735 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:42:10,735 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:42:10,735 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:42:10,735 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:42:10,739 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:42:10,743 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:42:10,744 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:42:10,744 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:42:12,116 - src.training - INFO -   precision: 0.0032122780405103952
2025-06-24 11:42:12,116 - src.training - INFO -   recall: 0.13333333333333333
2025-06-24 11:42:12,116 - src.training - INFO -   f1: 0.006273416398013418
2025-06-24 11:42:12,116 - src.training - INFO -   accuracy: 0.948379650583869
2025-06-24 11:42:12,116 - src.training - INFO -   balanced_accuracy: 0.5413551154816393
2025-06-24 11:42:12,116 - src.training - INFO -   positive_samples: 270
2025-06-24 11:42:12,116 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:42:12,116 - src.training - INFO -   total_samples: 220940
2025-06-24 11:42:12,116 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:42:12,116 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:42:12,116 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:42:12,116 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:42:12,116 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:42:12,124 - src.training - INFO - 모델 학습 완료
2025-06-24 11:42:12,124 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032122780405103952, 'recall': 0.13333333333333333, 'f1': 0.006273416398013418, 'accuracy': 0.948379650583869, 'balanced_accuracy': 0.5413551154816393, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:42:12,124 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:12,124 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:12,124 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:12,124 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:12,162 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:42:12,162 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:42:12,604 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = xgboost
2025-06-24 11:42:14,485 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:42:14,485 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:42:14,485 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:42:14,485 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:42:14,485 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:42:14,485 - src.training - INFO - 교차 검증 시작
2025-06-24 11:42:14,485 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:42:14,501 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:42:14,965 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:42:14,965 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:42:14,965 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:42:14,965 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:42:14,965 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:42:14,965 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:42:14,965 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:42:14,965 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:42:14,965 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:42:15,123 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:42:15,123 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:42:15,123 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:42:15,123 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:42:16,510 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:42:17,580 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:42:17,580 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:42:17,585 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:42:17,618 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:42:17,618 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:42:17,618 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:42:17,618 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:42:18,935 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:42:19,151 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:42:19,151 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:42:19,321 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:42:19,321 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:42:19,347 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:42:19,347 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:42:19,347 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:42:19,347 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:42:19,347 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:19,347 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:42:19,397 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:42:19,397 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:42:19,397 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:19,397 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:19,397 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:42:19,397 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:42:19,397 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:19,462 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:42:19,462 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:42:19,462 - src.training - INFO - 모델 학습 시작
2025-06-24 11:42:19,571 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:42:19,571 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:42:19,571 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:42:19,571 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:42:19,571 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:42:19,571 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:42:19,571 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:42:19,571 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:42:19,571 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:42:19,571 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:19,571 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:42:19,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:42:19,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:19,571 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:42:19,649 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:42:19,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:42:19,782 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:42:19,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:42:19,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:42:19,989 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:42:20,004 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:42:20,004 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:20,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:42:20,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:20,071 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:20,071 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:42:20,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:42:20,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:20,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:42:20,089 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:42:20,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:42:20,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:42:20,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:42:20,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:42:20,175 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:42:20,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:42:20,177 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:20,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:42:20,193 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:20,193 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:42:20,193 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:20,193 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   n_estimators: 674
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   learning_rate: 0.20171640228480955
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   subsample: 0.970853556522909
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6286819327909711
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   reg_alpha: 5.220990520323265e-07
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   reg_lambda: 1.1832057957765688e-08
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:42:20,211 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:42:20,212 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:42:48,886 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:42:48,886 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:42:48,886 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:42:48,886 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:42:48,886 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:48,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:42:48,905 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:42:48,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:42:48,934 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:42:48,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:42:48,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:42:48,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:42:48,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:42:48,982 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:48,985 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:42:49,057 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:42:49,057 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:42:49,057 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:42:49,057 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:42:49,058 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:42:49,058 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:42:49,058 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:42:49,058 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:42:49,061 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:42:49,065 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:42:49,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:42:49,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:42:50,300 - src.training - INFO -   precision: 0.0028358274071811876
2025-06-24 11:42:50,300 - src.training - INFO -   recall: 0.24074074074074073
2025-06-24 11:42:50,300 - src.training - INFO -   f1: 0.005605622870941313
2025-06-24 11:42:50,300 - src.training - INFO -   accuracy: 0.8956232461301711
2025-06-24 11:42:50,300 - src.training - INFO -   balanced_accuracy: 0.5685826330250131
2025-06-24 11:42:50,300 - src.training - INFO -   positive_samples: 270
2025-06-24 11:42:50,300 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:42:50,300 - src.training - INFO -   total_samples: 220940
2025-06-24 11:42:50,300 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:42:50,300 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:42:50,300 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:42:50,300 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:42:50,301 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:42:50,301 - src.training - INFO - 모델 학습 완료
2025-06-24 11:42:50,301 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028358274071811876, 'recall': 0.24074074074074073, 'f1': 0.005605622870941313, 'accuracy': 0.8956232461301711, 'balanced_accuracy': 0.5685826330250131, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:42:50,302 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:50,302 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:50,302 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:50,302 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:50,339 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:42:50,339 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:42:50,761 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = xgboost
2025-06-24 11:42:52,460 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:42:52,461 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:42:52,461 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:42:52,461 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:42:52,461 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:42:52,461 - src.training - INFO - 교차 검증 시작
2025-06-24 11:42:52,461 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:42:52,477 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:42:52,920 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:42:52,920 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:42:52,920 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:42:52,920 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:42:52,920 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:42:52,920 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:42:52,920 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:42:52,920 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:42:52,920 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:42:53,087 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:42:53,087 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:42:53,087 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:42:53,087 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:42:54,343 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:42:55,319 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:42:55,319 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:42:55,325 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:42:55,356 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:42:55,357 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:42:55,357 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:42:55,357 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:42:56,553 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:42:56,751 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:42:56,752 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:42:56,912 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:42:56,912 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:42:56,938 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:42:56,938 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:42:56,938 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:42:56,938 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:42:56,938 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:56,938 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:42:56,984 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:42:56,984 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:42:56,984 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:56,984 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:56,984 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:42:56,984 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:42:56,984 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:57,045 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:42:57,045 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:42:57,045 - src.training - INFO - 모델 학습 시작
2025-06-24 11:42:57,153 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:42:57,153 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:42:57,153 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:42:57,153 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:42:57,153 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:42:57,153 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:42:57,153 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:42:57,153 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:42:57,153 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:42:57,153 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:57,153 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:42:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:42:57,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:57,154 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:42:57,220 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:42:57,273 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:42:57,329 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:42:57,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:42:57,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:42:57,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:42:57,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:42:57,528 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:57,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:42:57,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:57,592 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:57,592 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:42:57,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:42:57,592 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:57,593 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:42:57,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:42:57,623 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:42:57,637 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:42:57,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:42:57,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:42:57,680 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:42:57,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:42:57,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:42:57,698 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:42:57,699 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:57,699 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:42:57,699 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:42:57,699 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   n_estimators: 890
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   learning_rate: 0.014440678333860722
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   subsample: 0.7421833165701723
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6026476791973084
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   reg_alpha: 0.00012260346286643785
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   reg_lambda: 0.0024846448437396756
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:42:57,715 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:44:12,417 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:44:12,417 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:44:12,419 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:44:12,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:44:12,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:12,420 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:44:12,438 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:44:12,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:44:12,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:44:12,479 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:44:12,493 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:44:12,510 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:44:12,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:44:12,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:12,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:44:12,790 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:44:12,790 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:44:12,790 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:44:12,790 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:44:12,790 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:44:12,790 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:44:12,790 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:44:12,790 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:44:12,794 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:44:12,798 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:44:12,798 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:44:12,798 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:44:14,043 - src.training - INFO -   precision: 0.003244755244755245
2025-06-24 11:44:14,043 - src.training - INFO -   recall: 0.21481481481481482
2025-06-24 11:44:14,043 - src.training - INFO -   f1: 0.006392945715073023
2025-06-24 11:44:14,043 - src.training - INFO -   accuracy: 0.9183986602697565
2025-06-24 11:44:14,043 - src.training - INFO -   balanced_accuracy: 0.5670371713082548
2025-06-24 11:44:14,043 - src.training - INFO -   positive_samples: 270
2025-06-24 11:44:14,043 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:44:14,043 - src.training - INFO -   total_samples: 220940
2025-06-24 11:44:14,043 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:44:14,043 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:44:14,043 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:44:14,043 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:44:14,043 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:44:14,048 - src.training - INFO - 모델 학습 완료
2025-06-24 11:44:14,048 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003244755244755245, 'recall': 0.21481481481481482, 'f1': 0.006392945715073023, 'accuracy': 0.9183986602697565, 'balanced_accuracy': 0.5670371713082548, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:44:14,048 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:14,048 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:14,048 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:14,048 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:14,085 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:44:14,085 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:44:14,503 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = xgboost
2025-06-24 11:44:16,183 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:44:16,183 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:44:16,183 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:44:16,183 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:44:16,183 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:44:16,183 - src.training - INFO - 교차 검증 시작
2025-06-24 11:44:16,183 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:44:16,200 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:44:16,631 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:44:16,631 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:44:16,631 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:44:16,631 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:44:16,631 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:44:16,631 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:44:16,631 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:44:16,631 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:44:16,631 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:44:16,804 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:44:16,804 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:44:16,804 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:44:16,804 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:44:18,062 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:44:19,027 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:44:19,028 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:44:19,033 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:44:19,065 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:44:19,065 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:44:19,065 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:44:19,065 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:44:20,272 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:44:20,470 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:44:20,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:44:20,632 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:44:20,632 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:44:20,657 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:44:20,657 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:44:20,657 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:44:20,657 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:44:20,657 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:20,657 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:44:20,703 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:44:20,703 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:44:20,703 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:20,703 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:20,703 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:44:20,703 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:44:20,703 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:20,761 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:44:20,761 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:44:20,761 - src.training - INFO - 모델 학습 시작
2025-06-24 11:44:20,867 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:44:20,867 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:44:20,867 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:44:20,867 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:44:20,867 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:44:20,867 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:44:20,867 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:44:20,867 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:44:20,867 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:44:20,867 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:20,867 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:44:20,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:44:20,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:20,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:44:20,935 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:44:20,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:44:21,049 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:44:21,105 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:44:21,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:44:21,233 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:44:21,248 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:44:21,248 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:21,325 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:44:21,325 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:21,325 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:21,325 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:44:21,325 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:44:21,325 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:21,325 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:44:21,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:44:21,356 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:44:21,370 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:44:21,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:44:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:44:21,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:44:21,416 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:44:21,416 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:44:21,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:44:21,432 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:21,432 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:44:21,432 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:44:21,432 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   n_estimators: 639
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   learning_rate: 0.012009345506568006
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   subsample: 0.6176887052058646
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7085664413653411
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   reg_alpha: 1.1950518427258865e-06
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   reg_lambda: 0.00024254935500167142
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:44:21,450 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:45:38,812 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:45:38,812 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:45:38,812 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:45:38,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:45:38,812 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:38,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:45:38,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:45:38,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:45:38,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:45:38,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:45:38,891 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:45:38,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:45:38,910 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:45:38,911 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:38,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:45:39,250 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:45:39,250 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:45:39,250 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:45:39,250 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:45:39,250 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:45:39,250 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:45:39,250 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:45:39,250 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:45:39,254 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:45:39,258 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:45:39,258 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:45:39,258 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:45:40,408 - src.training - INFO -   precision: 0.003304692663582287
2025-06-24 11:45:40,408 - src.training - INFO -   recall: 0.09259259259259259
2025-06-24 11:45:40,408 - src.training - INFO -   f1: 0.006381620931716656
2025-06-24 11:45:40,408 - src.training - INFO -   accuracy: 0.9647641893726804
2025-06-24 11:45:40,408 - src.training - INFO -   balanced_accuracy: 0.5292119622227929
2025-06-24 11:45:40,408 - src.training - INFO -   positive_samples: 270
2025-06-24 11:45:40,408 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:45:40,408 - src.training - INFO -   total_samples: 220940
2025-06-24 11:45:40,408 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:45:40,408 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:45:40,409 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:45:40,409 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:45:40,409 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:45:40,419 - src.training - INFO - 모델 학습 완료
2025-06-24 11:45:40,419 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003304692663582287, 'recall': 0.09259259259259259, 'f1': 0.006381620931716656, 'accuracy': 0.9647641893726804, 'balanced_accuracy': 0.5292119622227929, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:45:40,419 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:40,419 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:40,419 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:40,419 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:40,456 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:45:40,456 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:45:40,881 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = xgboost
2025-06-24 11:45:42,563 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:45:42,564 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:45:42,564 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:45:42,564 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:45:42,564 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:45:42,564 - src.training - INFO - 교차 검증 시작
2025-06-24 11:45:42,564 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:45:42,579 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:45:43,009 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:45:43,009 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:45:43,010 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:45:43,010 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:45:43,010 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:45:43,010 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:45:43,010 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:45:43,010 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:45:43,010 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:45:43,180 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:45:43,180 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:45:43,180 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:45:43,180 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:45:44,425 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:45:45,389 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:45:45,389 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:45:45,395 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:45:45,426 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:45:45,426 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:45:45,426 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:45:45,426 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:45:46,595 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:45:46,790 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:45:46,790 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:45:46,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:45:46,950 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:45:46,976 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:45:46,976 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:45:46,976 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:45:46,976 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:45:46,976 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:46,976 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,021 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:45:47,021 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:45:47,021 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,021 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,022 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:45:47,022 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:45:47,022 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,079 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:45:47,079 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:45:47,079 - src.training - INFO - 모델 학습 시작
2025-06-24 11:45:47,186 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:45:47,186 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:45:47,186 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:45:47,186 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:45:47,186 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:45:47,186 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:45:47,186 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:45:47,186 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:45:47,186 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:45:47,186 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,186 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:45:47,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:45:47,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:47,186 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:45:47,252 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:45:47,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:45:47,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:45:47,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:45:47,470 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:45:47,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:45:47,546 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:45:47,546 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:47,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:45:47,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,610 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,610 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:45:47,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:45:47,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:47,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:45:47,627 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:45:47,640 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:45:47,654 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:45:47,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:45:47,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:45:47,698 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:45:47,701 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:45:47,701 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:47,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:45:47,715 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,715 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:45:47,715 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:47,715 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   n_estimators: 774
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   learning_rate: 0.2981776464802834
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   subsample: 0.9146845431434745
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6500616748726956
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   reg_alpha: 1.5388648571579617e-07
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   reg_lambda: 0.00011990662761960599
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:45:47,729 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:45:55,426 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:45:55,426 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:45:55,426 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:45:55,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:45:55,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:55,427 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:45:55,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:45:55,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:45:55,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:45:55,488 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:45:55,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:45:55,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:45:55,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:45:55,524 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:55,528 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:45:55,545 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:45:55,545 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:45:55,545 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:45:55,546 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:45:55,546 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:45:55,546 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:45:55,546 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:45:55,546 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:45:55,549 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:45:55,553 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:45:55,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:45:55,554 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:45:56,792 - src.training - INFO -   precision: 0.0025587057901035864
2025-06-24 11:45:56,792 - src.training - INFO -   recall: 0.45925925925925926
2025-06-24 11:45:56,792 - src.training - INFO -   f1: 0.005089058524173028
2025-06-24 11:45:56,792 - src.training - INFO -   accuracy: 0.7805558070064271
2025-06-24 11:45:56,792 - src.training - INFO -   balanced_accuracy: 0.6201040937615914
2025-06-24 11:45:56,792 - src.training - INFO -   positive_samples: 270
2025-06-24 11:45:56,792 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:45:56,792 - src.training - INFO -   total_samples: 220940
2025-06-24 11:45:56,792 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:45:56,792 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:45:56,792 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:45:56,792 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:45:56,793 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:45:56,793 - src.training - INFO - 모델 학습 완료
2025-06-24 11:45:56,793 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0025587057901035864, 'recall': 0.45925925925925926, 'f1': 0.005089058524173028, 'accuracy': 0.7805558070064271, 'balanced_accuracy': 0.6201040937615914, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:45:56,793 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:56,793 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:56,793 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:45:56,793 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:45:56,830 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:45:56,830 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:45:57,251 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = xgboost
2025-06-24 11:45:58,938 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:45:58,938 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:45:58,938 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:45:58,938 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:45:58,938 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:45:58,938 - src.training - INFO - 교차 검증 시작
2025-06-24 11:45:58,938 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:45:58,955 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:45:59,383 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:45:59,383 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:45:59,383 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:45:59,383 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:45:59,383 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:45:59,383 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:45:59,383 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:45:59,383 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:45:59,383 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:45:59,554 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:45:59,554 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:45:59,554 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:45:59,554 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:45:59,554 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:45:59,555 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:45:59,555 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:45:59,555 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:45:59,555 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:45:59,555 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:46:00,813 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:46:01,781 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:01,781 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:46:01,786 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:46:01,817 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:46:01,817 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:46:01,819 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:46:01,819 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:02,997 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:03,205 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:46:03,205 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:03,367 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:03,368 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:03,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:03,393 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:03,393 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:03,393 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:46:03,393 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:03,393 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:03,439 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:46:03,439 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:46:03,439 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:03,439 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:03,439 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:46:03,439 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:46:03,439 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:03,497 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:03,497 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:03,497 - src.training - INFO - 모델 학습 시작
2025-06-24 11:46:03,604 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:46:03,604 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:46:03,604 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:46:03,604 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:46:03,604 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:46:03,604 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:46:03,604 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:46:03,604 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:46:03,604 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:46:03,604 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:03,604 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:46:03,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:46:03,604 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:03,605 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:03,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:03,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:03,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:03,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:03,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:03,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:03,974 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:46:03,974 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:04,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:46:04,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:04,043 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:04,043 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:46:04,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:04,043 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:04,044 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:04,061 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:04,074 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:04,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:04,103 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:04,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:04,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:04,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:04,137 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:04,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:46:04,151 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:04,151 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:46:04,151 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:04,151 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   n_estimators: 703
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   learning_rate: 0.21194264905519633
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   subsample: 0.7793668247213312
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   colsample_bytree: 0.791022545649861
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   reg_alpha: 1.5704807013506513e-07
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   reg_lambda: 1.5984892107006324e-05
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:46:04,166 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:46:07,319 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:46:07,319 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:46:07,320 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:46:07,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:07,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:07,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:07,340 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:07,356 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:07,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:07,387 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:07,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:07,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:07,424 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:07,424 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:07,428 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:46:07,434 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:46:07,434 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:46:07,434 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:46:07,434 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:46:07,434 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:07,434 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:46:07,434 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:46:07,434 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:46:07,438 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:46:07,442 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:46:07,443 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:46:07,443 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:46:08,828 - src.training - INFO -   precision: 0.0026828225651911145
2025-06-24 11:46:08,828 - src.training - INFO -   recall: 0.674074074074074
2025-06-24 11:46:08,828 - src.training - INFO -   f1: 0.005344374458588439
2025-06-24 11:46:08,828 - src.training - INFO -   accuracy: 0.6933782927491626
2025-06-24 11:46:08,828 - src.training - INFO -   balanced_accuracy: 0.6837379932159466
2025-06-24 11:46:08,828 - src.training - INFO -   positive_samples: 270
2025-06-24 11:46:08,828 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:46:08,828 - src.training - INFO -   total_samples: 220940
2025-06-24 11:46:08,828 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:46:08,828 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:46:08,828 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:46:08,828 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:46:08,828 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:46:08,828 - src.training - INFO - 모델 학습 완료
2025-06-24 11:46:08,828 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026828225651911145, 'recall': 0.674074074074074, 'f1': 0.005344374458588439, 'accuracy': 0.6933782927491626, 'balanced_accuracy': 0.6837379932159466, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:46:08,828 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:08,828 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:08,828 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:08,828 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:08,868 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:46:08,868 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:46:09,310 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = xgboost
2025-06-24 11:46:11,206 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:46:11,206 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:46:11,206 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:46:11,206 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:46:11,206 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:46:11,206 - src.training - INFO - 교차 검증 시작
2025-06-24 11:46:11,206 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:46:11,222 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:46:11,683 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:46:11,683 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:46:11,683 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:46:11,683 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:46:11,683 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:46:11,683 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:46:11,683 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:46:11,683 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:46:11,683 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:46:11,848 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:46:11,848 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:46:11,848 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:46:11,848 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:46:13,246 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:46:14,329 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:14,329 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:46:14,333 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:46:14,365 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:46:14,365 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:46:14,365 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:46:14,365 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:15,669 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:15,883 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:46:15,883 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:16,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:16,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:16,078 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:16,078 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:16,078 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:16,078 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:46:16,078 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:16,078 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,127 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:46:16,127 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:46:16,127 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,127 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,127 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:46:16,127 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:46:16,127 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,192 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:16,192 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:16,192 - src.training - INFO - 모델 학습 시작
2025-06-24 11:46:16,301 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:46:16,301 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:46:16,301 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:46:16,301 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:46:16,301 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:46:16,301 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:46:16,301 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:46:16,301 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:46:16,301 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:46:16,301 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,301 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:46:16,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:46:16,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:16,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:16,379 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:16,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:16,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:16,578 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:16,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:16,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:16,731 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:46:16,731 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:16,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:46:16,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,799 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,799 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:46:16,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:16,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:16,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:16,817 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:16,832 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:16,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:16,864 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:16,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:16,899 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:16,901 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:16,902 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:46:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,918 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:46:16,918 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:16,918 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   n_estimators: 225
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   learning_rate: 0.06743536057499266
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   subsample: 0.6462351434732656
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   colsample_bytree: 0.707521035812647
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   reg_alpha: 9.058211131954224e-06
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   reg_lambda: 0.013682705611959702
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:46:16,936 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:46:16,937 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:46:30,568 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:46:30,568 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:46:30,568 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:46:30,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:30,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:30,569 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:30,587 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:30,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:30,620 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:30,636 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:30,653 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:30,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:30,673 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:30,673 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:30,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:46:30,709 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:46:30,709 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:46:30,709 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:46:30,709 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:46:30,709 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:30,709 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:46:30,709 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:46:30,709 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:46:30,713 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:46:30,717 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:46:30,718 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:46:30,718 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:46:32,082 - src.training - INFO -   precision: 0.0029895366218236174
2025-06-24 11:46:32,082 - src.training - INFO -   recall: 0.45185185185185184
2025-06-24 11:46:32,082 - src.training - INFO -   f1: 0.005939774580685995
2025-06-24 11:46:32,082 - src.training - INFO -   accuracy: 0.8151760659002444
2025-06-24 11:46:32,082 - src.training - INFO -   balanced_accuracy: 0.6337362309062132
2025-06-24 11:46:32,082 - src.training - INFO -   positive_samples: 270
2025-06-24 11:46:32,082 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:46:32,082 - src.training - INFO -   total_samples: 220940
2025-06-24 11:46:32,082 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:46:32,082 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:46:32,082 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:46:32,082 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:46:32,082 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:46:32,083 - src.training - INFO - 모델 학습 완료
2025-06-24 11:46:32,083 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029895366218236174, 'recall': 0.45185185185185184, 'f1': 0.005939774580685995, 'accuracy': 0.8151760659002444, 'balanced_accuracy': 0.6337362309062132, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:46:32,083 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:32,083 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:32,083 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:32,083 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:32,122 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:46:32,122 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:46:32,565 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = xgboost
2025-06-24 11:46:34,402 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:46:34,402 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:46:34,402 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:46:34,402 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:46:34,402 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:46:34,402 - src.training - INFO - 교차 검증 시작
2025-06-24 11:46:34,402 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:46:34,418 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:46:34,880 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:46:34,880 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:46:34,880 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:46:34,880 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:46:34,880 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:46:34,880 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:46:34,880 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:46:34,880 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:46:34,880 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:46:35,045 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:46:35,045 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:46:35,045 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:46:35,045 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:46:36,425 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:46:37,498 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:37,498 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:46:37,504 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:46:37,536 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:46:37,536 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:46:37,536 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:46:37,536 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:38,856 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:39,071 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:46:39,071 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:39,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:39,247 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:39,273 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:39,273 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:39,273 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:39,273 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:46:39,273 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:39,273 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,322 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:46:39,322 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:46:39,322 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,322 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,322 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:46:39,323 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:46:39,323 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,389 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:39,390 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:39,390 - src.training - INFO - 모델 학습 시작
2025-06-24 11:46:39,498 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:46:39,498 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:46:39,499 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:46:39,499 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:46:39,499 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:46:39,499 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:46:39,499 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:46:39,499 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:46:39,499 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:46:39,499 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,499 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:46:39,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:46:39,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:39,499 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:39,579 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:39,645 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:39,715 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:39,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:39,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:39,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:39,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:46:39,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:39,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:46:39,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,995 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:39,995 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:46:39,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:39,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:39,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:40,013 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:40,028 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:40,043 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:40,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:40,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:40,094 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:40,096 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:40,096 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:40,112 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:46:40,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:40,113 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:46:40,113 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:40,113 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   n_estimators: 356
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   max_depth: 3
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   learning_rate: 0.14310436224283452
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   subsample: 0.746917198136757
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7551634279794245
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   reg_alpha: 3.816342967653068e-08
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   reg_lambda: 0.015321824387350162
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:46:40,130 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:46:40,131 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:46:44,024 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:46:44,024 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:46:44,027 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:46:44,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:44,027 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:44,028 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:44,046 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:44,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:44,079 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:44,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:44,112 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:44,130 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:44,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:44,132 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:44,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:46:44,142 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:46:44,142 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:46:44,142 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:46:44,142 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:46:44,142 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:44,142 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:46:44,142 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:46:44,142 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:46:44,146 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:46:44,150 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:46:44,151 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:46:44,151 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:46:45,514 - src.training - INFO -   precision: 0.0027116430285219414
2025-06-24 11:46:45,514 - src.training - INFO -   recall: 0.7074074074074074
2025-06-24 11:46:45,514 - src.training - INFO -   f1: 0.00540257683114826
2025-06-24 11:46:45,514 - src.training - INFO -   accuracy: 0.6817009142753688
2025-06-24 11:46:45,514 - src.training - INFO -   balanced_accuracy: 0.6945384342968972
2025-06-24 11:46:45,514 - src.training - INFO -   positive_samples: 270
2025-06-24 11:46:45,514 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:46:45,514 - src.training - INFO -   total_samples: 220940
2025-06-24 11:46:45,514 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:46:45,514 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:46:45,514 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:46:45,514 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:46:45,514 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:46:45,514 - src.training - INFO - 모델 학습 완료
2025-06-24 11:46:45,515 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027116430285219414, 'recall': 0.7074074074074074, 'f1': 0.00540257683114826, 'accuracy': 0.6817009142753688, 'balanced_accuracy': 0.6945384342968972, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:46:45,515 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:45,515 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:45,515 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:45,515 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:45,554 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:46:45,554 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:46:45,995 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = xgboost
2025-06-24 11:46:47,836 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:46:47,836 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:46:47,836 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:46:47,836 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:46:47,836 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:46:47,836 - src.training - INFO - 교차 검증 시작
2025-06-24 11:46:47,836 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:46:47,853 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:46:48,322 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:46:48,322 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:46:48,322 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:46:48,322 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:46:48,322 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:46:48,322 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:46:48,322 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:46:48,322 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:46:48,322 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:46:48,487 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:46:48,487 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:46:48,487 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:46:48,487 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:46:49,880 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:46:50,953 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:50,953 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:46:50,958 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:46:50,990 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:46:50,990 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:46:50,990 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:46:50,990 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:46:52,311 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:46:52,527 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:46:52,527 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:52,697 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:52,697 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:46:52,724 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:46:52,724 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:52,724 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:46:52,724 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:46:52,724 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:52,724 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:46:52,773 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:46:52,773 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:46:52,773 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:52,773 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:52,773 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:46:52,773 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:46:52,773 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:52,841 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:52,841 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:46:52,841 - src.training - INFO - 모델 학습 시작
2025-06-24 11:46:52,950 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:46:52,950 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:46:52,950 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:46:52,950 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:46:52,950 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:46:52,950 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:46:52,950 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:46:52,950 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:46:52,950 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:46:52,950 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:52,950 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:46:52,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:46:52,950 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:52,951 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:53,028 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:53,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:53,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:53,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:53,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:53,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:53,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:46:53,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:53,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:46:53,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:53,441 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:53,441 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:46:53,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:46:53,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:53,441 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:46:53,459 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:46:53,475 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:46:53,491 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:46:53,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:46:53,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:46:53,544 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:46:53,546 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:46:53,546 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:46:53,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:46:53,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:53,562 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:46:53,562 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:46:53,562 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   n_estimators: 495
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   learning_rate: 0.07034594252130377
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   subsample: 0.662337916572604
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9701956604425575
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:46:53,580 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   reg_alpha: 2.781325354494727
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   reg_lambda: 0.00854496542506185
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:46:53,581 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:47:23,706 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:47:23,706 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:47:23,707 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:47:23,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:47:23,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:23,707 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:47:23,726 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:47:23,741 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:47:23,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:47:23,770 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:47:23,785 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:47:23,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:47:23,804 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:47:23,804 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:23,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:47:23,878 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:47:23,878 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:47:23,878 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:47:23,878 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:47:23,879 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:47:23,879 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:47:23,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:47:23,879 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:47:23,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:47:23,886 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:47:23,887 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:47:23,887 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:47:25,118 - src.training - INFO -   precision: 0.0029202806956370136
2025-06-24 11:47:25,118 - src.training - INFO -   recall: 0.24814814814814815
2025-06-24 11:47:25,118 - src.training - INFO -   f1: 0.005772627407056391
2025-06-24 11:47:25,118 - src.training - INFO -   accuracy: 0.8955417760477958
2025-06-24 11:47:25,118 - src.training - INFO -   balanced_accuracy: 0.5722410201927127
2025-06-24 11:47:25,118 - src.training - INFO -   positive_samples: 270
2025-06-24 11:47:25,118 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:47:25,118 - src.training - INFO -   total_samples: 220940
2025-06-24 11:47:25,118 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:47:25,118 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:47:25,118 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:47:25,118 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:47:25,119 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:47:25,120 - src.training - INFO - 모델 학습 완료
2025-06-24 11:47:25,120 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029202806956370136, 'recall': 0.24814814814814815, 'f1': 0.005772627407056391, 'accuracy': 0.8955417760477958, 'balanced_accuracy': 0.5722410201927127, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:47:25,120 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:25,120 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:25,120 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:25,120 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:25,157 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:47:25,157 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:47:25,585 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = xgboost
2025-06-24 11:47:27,260 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:47:27,260 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:47:27,260 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:47:27,260 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:47:27,260 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:47:27,260 - src.training - INFO - 교차 검증 시작
2025-06-24 11:47:27,260 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:47:27,278 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:47:27,706 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:47:27,706 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:47:27,706 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:47:27,706 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:47:27,706 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:47:27,706 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:47:27,706 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:47:27,706 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:47:27,706 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:47:27,877 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:47:27,877 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:47:27,877 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:47:27,877 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:47:29,140 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:47:30,104 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:47:30,104 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:47:30,109 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:47:30,140 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:47:30,140 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:47:30,140 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:47:30,140 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:47:31,328 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:47:31,526 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:47:31,526 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:47:31,687 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:47:31,687 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:47:31,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:47:31,713 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:47:31,713 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:47:31,713 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:47:31,713 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:31,713 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:47:31,758 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:47:31,758 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:47:31,758 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:31,758 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:31,758 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:47:31,758 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:47:31,758 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:31,816 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:47:31,817 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:47:31,817 - src.training - INFO - 모델 학습 시작
2025-06-24 11:47:31,923 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:47:31,923 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:47:31,923 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:47:31,923 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:47:31,923 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:47:31,923 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:47:31,923 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:47:31,923 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:47:31,923 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:47:31,923 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:31,923 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:47:31,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:47:31,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:31,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:47:31,990 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:47:32,044 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:47:32,099 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:47:32,159 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:47:32,215 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:47:32,282 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:47:32,300 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:47:32,300 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:32,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:47:32,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:32,364 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:32,364 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:47:32,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:47:32,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:32,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:47:32,381 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:47:32,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:47:32,409 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:47:32,422 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:47:32,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:47:32,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:47:32,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:47:32,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:47:32,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:47:32,470 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:32,470 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:47:32,470 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:47:32,470 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   n_estimators: 380
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   learning_rate: 0.03895659558117692
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   subsample: 0.6247143519057831
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8888171488159805
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   reg_alpha: 0.7067200179100779
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   reg_lambda: 0.0018977436935061882
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:47:32,488 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:48:02,250 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:48:02,250 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:48:02,254 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:48:02,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:48:02,254 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:02,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:48:02,272 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:48:02,288 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:48:02,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:48:02,321 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:48:02,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:48:02,356 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:48:02,358 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:48:02,358 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:02,360 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:48:02,448 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:48:02,448 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:48:02,448 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:48:02,448 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:48:02,448 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:48:02,448 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:48:02,448 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:48:02,448 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:48:02,452 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:48:02,456 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:48:02,457 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:48:02,457 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:48:03,830 - src.training - INFO -   precision: 0.0031573962005999054
2025-06-24 11:48:03,830 - src.training - INFO -   recall: 0.2222222222222222
2025-06-24 11:48:03,830 - src.training - INFO -   f1: 0.006226326985938878
2025-06-24 11:48:03,830 - src.training - INFO -   accuracy: 0.9133113062369874
2025-06-24 11:48:03,830 - src.training - INFO -   balanced_accuracy: 0.568189554034934
2025-06-24 11:48:03,830 - src.training - INFO -   positive_samples: 270
2025-06-24 11:48:03,830 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:48:03,830 - src.training - INFO -   total_samples: 220940
2025-06-24 11:48:03,830 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:48:03,830 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:48:03,830 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:48:03,830 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:48:03,830 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:48:03,831 - src.training - INFO - 모델 학습 완료
2025-06-24 11:48:03,831 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0031573962005999054, 'recall': 0.2222222222222222, 'f1': 0.006226326985938878, 'accuracy': 0.9133113062369874, 'balanced_accuracy': 0.568189554034934, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:48:03,831 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:03,831 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:03,831 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:03,831 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:03,870 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:48:03,870 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:48:04,308 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = xgboost
2025-06-24 11:48:05,996 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:48:05,996 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:48:05,996 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:48:05,996 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:48:05,996 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:48:05,996 - src.training - INFO - 교차 검증 시작
2025-06-24 11:48:05,996 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:48:06,012 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:48:06,446 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:48:06,446 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:48:06,446 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:48:06,446 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:48:06,446 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:48:06,446 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:48:06,446 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:48:06,446 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:48:06,446 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:48:06,621 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:48:06,621 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:48:06,621 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:48:06,621 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:48:07,910 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:48:08,890 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:48:08,890 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:48:08,896 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:48:08,927 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:48:08,927 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:48:08,927 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:48:08,927 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:48:10,124 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:48:10,324 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:48:10,324 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:48:10,485 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:48:10,485 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:48:10,511 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:48:10,511 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:48:10,511 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:48:10,511 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:48:10,511 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:10,511 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:48:10,557 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:48:10,558 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:48:10,558 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:10,558 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:10,558 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:48:10,558 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:48:10,558 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:10,619 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:48:10,619 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:48:10,619 - src.training - INFO - 모델 학습 시작
2025-06-24 11:48:10,728 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:48:10,728 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:48:10,728 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:48:10,728 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:48:10,728 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:48:10,728 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:48:10,728 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:48:10,728 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:48:10,728 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:48:10,728 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:10,728 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:48:10,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:48:10,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:10,728 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:48:10,796 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:48:10,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:48:10,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:48:10,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:48:11,018 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:48:11,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:48:11,100 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:48:11,100 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:11,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:48:11,175 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:11,175 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:11,176 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:48:11,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:48:11,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:11,176 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:48:11,193 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:48:11,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:48:11,221 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:48:11,235 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:48:11,250 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:48:11,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:48:11,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:48:11,269 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:48:11,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:48:11,284 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:11,284 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:48:11,284 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:48:11,284 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   n_estimators: 686
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   learning_rate: 0.012586518728948927
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   subsample: 0.704296883529472
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6311409785308992
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   reg_alpha: 4.5523678787179586e-05
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   reg_lambda: 0.00012309736278121012
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:48:11,301 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:48:11,302 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:49:24,405 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:49:24,406 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:49:24,406 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:49:24,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:49:24,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:24,407 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:49:24,424 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:49:24,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:49:24,452 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:49:24,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:49:24,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:49:24,498 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:49:24,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:49:24,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:24,503 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:49:24,867 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:49:24,868 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:49:24,868 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:49:24,868 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:49:24,868 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:49:24,868 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:49:24,868 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:49:24,868 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:49:24,871 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:49:24,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:49:24,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:49:24,876 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:49:26,081 - src.training - INFO -   precision: 0.0029709891646277527
2025-06-24 11:49:26,081 - src.training - INFO -   recall: 0.1259259259259259
2025-06-24 11:49:26,081 - src.training - INFO -   f1: 0.005805019634625235
2025-06-24 11:49:26,081 - src.training - INFO -   accuracy: 0.9472888567031773
2025-06-24 11:49:26,081 - src.training - INFO -   balanced_accuracy: 0.5371098791726879
2025-06-24 11:49:26,082 - src.training - INFO -   positive_samples: 270
2025-06-24 11:49:26,082 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:49:26,082 - src.training - INFO -   total_samples: 220940
2025-06-24 11:49:26,082 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:49:26,082 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:49:26,082 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:49:26,082 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:49:26,082 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:49:26,093 - src.training - INFO - 모델 학습 완료
2025-06-24 11:49:26,093 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029709891646277527, 'recall': 0.1259259259259259, 'f1': 0.005805019634625235, 'accuracy': 0.9472888567031773, 'balanced_accuracy': 0.5371098791726879, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:49:26,093 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:26,093 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:26,093 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:26,093 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:26,130 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:49:26,130 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:49:26,559 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = xgboost
2025-06-24 11:49:28,245 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:49:28,245 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:49:28,245 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:49:28,245 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:49:28,245 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:49:28,245 - src.training - INFO - 교차 검증 시작
2025-06-24 11:49:28,245 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:49:28,263 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:49:28,695 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:49:28,695 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:49:28,695 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:49:28,695 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:49:28,695 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:49:28,695 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:49:28,695 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:49:28,695 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:49:28,695 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:49:28,867 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:49:28,867 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:49:28,867 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:49:28,867 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:49:30,127 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:49:31,106 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:49:31,106 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:49:31,112 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:49:31,143 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:49:31,143 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:49:31,143 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:49:31,143 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:49:32,334 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:49:32,543 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:49:32,543 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:49:32,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:49:32,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:49:32,731 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:49:32,731 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:49:32,731 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:49:32,731 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:49:32,731 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:32,731 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:49:32,777 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:49:32,777 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:49:32,777 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:32,777 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:32,777 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:49:32,777 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:49:32,777 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:32,836 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:49:32,836 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:49:32,836 - src.training - INFO - 모델 학습 시작
2025-06-24 11:49:32,943 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:49:32,943 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:49:32,943 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:49:32,943 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:49:32,944 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:49:32,944 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:49:32,944 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:49:32,944 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:49:32,944 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:49:32,944 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:32,944 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:49:32,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:49:32,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:32,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:49:33,011 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:49:33,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:49:33,121 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:49:33,174 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:49:33,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:49:33,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:49:33,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:49:33,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:33,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:49:33,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:33,371 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:33,371 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:49:33,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:49:33,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:33,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:49:33,389 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:49:33,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:49:33,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:49:33,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:49:33,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:49:33,459 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:49:33,462 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:49:33,462 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:33,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:49:33,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:33,477 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:49:33,477 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:33,477 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   n_estimators: 641
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   learning_rate: 0.19837149131988924
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   subsample: 0.6327584395668427
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8748249636591827
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   reg_alpha: 2.511901559478275
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   reg_lambda: 0.011262082674566132
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:49:33,492 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:49:56,516 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:49:56,516 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:49:56,516 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:49:56,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:49:56,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:56,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:49:56,535 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:49:56,551 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:49:56,568 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:49:56,584 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:49:56,601 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:49:56,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:49:56,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:49:56,622 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:56,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:49:56,677 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:49:56,677 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:49:56,677 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:49:56,677 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:49:56,677 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:49:56,677 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:49:56,677 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:49:56,677 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:49:56,681 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:49:56,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:49:56,686 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:49:56,686 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:49:58,047 - src.training - INFO -   precision: 0.003039308388491152
2025-06-24 11:49:58,047 - src.training - INFO -   recall: 0.16666666666666666
2025-06-24 11:49:58,047 - src.training - INFO -   f1: 0.005969753250198992
2025-06-24 11:49:58,047 - src.training - INFO -   accuracy: 0.9321716303068707
2025-06-24 11:49:58,047 - src.training - INFO -   balanced_accuracy: 0.5498874639355901
2025-06-24 11:49:58,047 - src.training - INFO -   positive_samples: 270
2025-06-24 11:49:58,047 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:49:58,047 - src.training - INFO -   total_samples: 220940
2025-06-24 11:49:58,047 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:49:58,047 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:49:58,047 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:49:58,047 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:49:58,047 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:49:58,048 - src.training - INFO - 모델 학습 완료
2025-06-24 11:49:58,048 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003039308388491152, 'recall': 0.16666666666666666, 'f1': 0.005969753250198992, 'accuracy': 0.9321716303068707, 'balanced_accuracy': 0.5498874639355901, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:49:58,048 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:58,048 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:58,048 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:49:58,048 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:49:58,088 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:49:58,088 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:49:58,521 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = xgboost
2025-06-24 11:50:00,269 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:50:00,269 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:50:00,269 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:50:00,269 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:50:00,269 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:50:00,269 - src.training - INFO - 교차 검증 시작
2025-06-24 11:50:00,269 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:50:00,286 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:50:00,727 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:50:00,727 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:50:00,727 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:50:00,727 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:50:00,727 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:50:00,727 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:50:00,727 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:50:00,727 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:50:00,727 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:50:00,901 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:50:00,901 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:50:00,901 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:50:00,901 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:50:02,175 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:50:03,143 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:50:03,143 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:50:03,149 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:50:03,180 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:50:03,181 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:50:03,181 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:50:03,181 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:50:04,366 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:50:04,564 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:50:04,564 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:50:04,725 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:50:04,725 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:50:04,750 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:50:04,750 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:50:04,750 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:50:04,750 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:50:04,750 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:04,750 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:50:04,796 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:50:04,796 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:50:04,796 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:04,796 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:04,796 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:50:04,796 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:50:04,796 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:04,854 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:50:04,854 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:50:04,854 - src.training - INFO - 모델 학습 시작
2025-06-24 11:50:04,961 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:50:04,961 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:50:04,961 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:50:04,961 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:50:04,961 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:50:04,961 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:50:04,961 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:50:04,961 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:50:04,961 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:50:04,961 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:04,961 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:50:04,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:50:04,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:04,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:50:05,028 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:50:05,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:50:05,137 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:50:05,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:50:05,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:50:05,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:50:05,320 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:50:05,320 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:50:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:05,386 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:05,386 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:50:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:50:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:05,386 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:50:05,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:50:05,416 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:50:05,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:50:05,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:50:05,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:50:05,474 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:50:05,477 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:50:05,477 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:05,492 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:50:05,492 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:05,492 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:50:05,492 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:05,493 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:50:05,507 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   n_estimators: 616
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   learning_rate: 0.07496026855536786
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   subsample: 0.770806693272509
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9585622660755176
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   reg_alpha: 1.6976993653305215
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   reg_lambda: 0.7455222135111679
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:50:05,508 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:50:36,361 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:50:36,361 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:50:36,361 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:50:36,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:50:36,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:36,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:50:36,381 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:50:36,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:50:36,411 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:50:36,425 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:50:36,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:50:36,458 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:50:36,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:50:36,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:36,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:50:36,530 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:50:36,530 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:50:36,530 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:50:36,530 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:50:36,530 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:50:36,530 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:50:36,530 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:50:36,530 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:50:36,533 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:50:36,537 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:50:36,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:50:36,538 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:50:37,761 - src.training - INFO -   precision: 0.0028792339296690498
2025-06-24 11:50:37,761 - src.training - INFO -   recall: 0.3296296296296296
2025-06-24 11:50:37,761 - src.training - INFO -   f1: 0.005708604598954492
2025-06-24 11:50:37,761 - src.training - INFO -   accuracy: 0.8596768353399112
2025-06-24 11:50:37,761 - src.training - INFO -   balanced_accuracy: 0.5949775011790691
2025-06-24 11:50:37,761 - src.training - INFO -   positive_samples: 270
2025-06-24 11:50:37,761 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:50:37,761 - src.training - INFO -   total_samples: 220940
2025-06-24 11:50:37,761 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:50:37,761 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:50:37,761 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:50:37,761 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:50:37,761 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:50:37,762 - src.training - INFO - 모델 학습 완료
2025-06-24 11:50:37,762 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028792339296690498, 'recall': 0.3296296296296296, 'f1': 0.005708604598954492, 'accuracy': 0.8596768353399112, 'balanced_accuracy': 0.5949775011790691, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:50:37,762 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:37,762 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:37,762 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:37,762 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:37,800 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:50:37,800 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:50:38,208 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = xgboost
2025-06-24 11:50:39,888 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:50:39,888 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:50:39,888 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:50:39,888 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:50:39,888 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:50:39,888 - src.training - INFO - 교차 검증 시작
2025-06-24 11:50:39,888 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:50:39,905 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:50:40,334 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:50:40,334 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:50:40,334 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:50:40,334 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:50:40,334 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:50:40,334 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:50:40,334 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:50:40,334 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:50:40,334 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:50:40,505 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:50:40,506 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:50:40,506 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:50:40,506 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:50:40,506 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:50:40,506 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:50:40,506 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:50:40,506 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:50:40,506 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:50:40,506 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:50:41,771 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:50:42,740 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:50:42,740 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:50:42,747 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:50:42,777 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:50:42,778 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:50:42,778 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:50:42,778 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:50:43,969 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:50:44,169 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:50:44,169 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:50:44,329 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:50:44,329 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:50:44,355 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:50:44,355 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:50:44,355 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:50:44,355 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:50:44,355 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:44,355 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,400 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:50:44,401 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:50:44,401 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,401 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,401 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:50:44,401 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:50:44,401 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,459 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:50:44,459 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:50:44,459 - src.training - INFO - 모델 학습 시작
2025-06-24 11:50:44,565 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:50:44,565 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:50:44,565 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:50:44,565 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:50:44,565 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:50:44,565 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:50:44,565 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:50:44,565 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:50:44,565 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:50:44,565 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,566 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:50:44,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:50:44,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:44,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:50:44,632 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:50:44,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:50:44,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:50:44,798 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:50:44,855 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:50:44,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:50:44,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:50:44,929 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:44,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:50:44,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,994 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:44,994 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:50:44,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:50:44,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:44,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:50:45,011 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:50:45,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:50:45,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:50:45,052 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:50:45,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:50:45,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:50:45,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:50:45,085 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:45,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:50:45,100 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:45,100 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:50:45,100 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:45,100 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   n_estimators: 197
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   learning_rate: 0.054736098460617236
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   subsample: 0.7136611719503776
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6270375843272205
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   reg_alpha: 1.1651862565284305e-08
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   reg_lambda: 1.889010205971044
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:50:45,115 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:50:53,377 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:50:53,377 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:50:53,377 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:50:53,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:50:53,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:53,377 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:50:53,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:50:53,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:50:53,430 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:50:53,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:50:53,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:50:53,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:50:53,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:50:53,484 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:53,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:50:53,503 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:50:53,504 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:50:53,504 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:50:53,504 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:50:53,504 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:50:53,504 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:50:53,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:50:53,504 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:50:53,507 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:50:53,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:50:53,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:50:53,512 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:50:54,884 - src.training - INFO -   precision: 0.0028010360821637253
2025-06-24 11:50:54,884 - src.training - INFO -   recall: 0.6888888888888889
2025-06-24 11:50:54,884 - src.training - INFO -   f1: 0.005579386267510574
2025-06-24 11:50:54,884 - src.training - INFO -   accuracy: 0.6999094776862497
2025-06-24 11:50:54,884 - src.training - INFO -   balanced_accuracy: 0.694405925388841
2025-06-24 11:50:54,884 - src.training - INFO -   positive_samples: 270
2025-06-24 11:50:54,884 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:50:54,884 - src.training - INFO -   total_samples: 220940
2025-06-24 11:50:54,884 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:50:54,884 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:50:54,884 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:50:54,884 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:50:54,884 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:50:54,885 - src.training - INFO - 모델 학습 완료
2025-06-24 11:50:54,885 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028010360821637253, 'recall': 0.6888888888888889, 'f1': 0.005579386267510574, 'accuracy': 0.6999094776862497, 'balanced_accuracy': 0.694405925388841, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:50:54,885 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:54,885 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:54,885 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:50:54,885 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:50:54,925 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:50:54,925 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:50:55,366 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = xgboost
2025-06-24 11:50:57,203 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:50:57,203 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:50:57,203 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:50:57,203 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:50:57,203 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:50:57,203 - src.training - INFO - 교차 검증 시작
2025-06-24 11:50:57,203 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:50:57,221 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:50:57,683 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:50:57,683 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:50:57,683 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:50:57,683 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:50:57,683 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:50:57,683 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:50:57,683 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:50:57,683 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:50:57,683 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:50:57,848 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:50:57,848 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:50:57,848 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:50:57,848 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:50:59,240 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:51:00,317 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:51:00,317 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:51:00,320 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:51:00,352 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:51:00,352 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:51:00,352 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:51:00,352 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:51:01,656 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:51:01,869 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:51:01,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:51:02,039 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:51:02,039 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:51:02,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:51:02,065 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:51:02,065 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:51:02,065 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:51:02,065 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:02,065 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,115 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:51:02,115 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:51:02,115 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,115 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,115 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:51:02,115 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:51:02,115 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,182 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:51:02,182 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:51:02,182 - src.training - INFO - 모델 학습 시작
2025-06-24 11:51:02,291 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:51:02,291 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:51:02,291 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:51:02,291 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:51:02,291 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:51:02,291 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:51:02,291 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:51:02,291 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:51:02,291 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:51:02,291 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,291 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:51:02,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:51:02,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:02,291 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:02,369 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:02,434 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:02,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:02,565 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:02,629 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:02,702 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:02,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:51:02,709 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:02,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:51:02,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,768 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,768 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:51:02,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:51:02,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:02,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:02,786 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:02,801 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:02,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:02,833 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:02,850 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:02,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:02,871 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:51:02,871 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:02,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:51:02,887 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,887 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:51:02,887 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:02,887 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   n_estimators: 305
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   learning_rate: 0.06112042972182742
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   subsample: 0.6520075734245622
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8639065234109267
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   reg_alpha: 0.005483987477068556
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   reg_lambda: 9.297223825859831
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:51:02,902 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:51:02,903 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:51:16,956 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:51:16,956 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:51:16,957 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:51:16,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:51:16,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:16,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:16,975 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:16,991 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:17,008 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:17,023 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:17,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:17,059 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:17,061 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:51:17,061 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:17,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:51:17,089 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:51:17,089 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:51:17,089 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:51:17,089 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:51:17,089 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:51:17,089 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:51:17,089 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:51:17,089 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:51:17,092 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:51:17,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:51:17,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:51:17,097 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:51:18,482 - src.training - INFO -   precision: 0.002782023320911542
2025-06-24 11:51:18,482 - src.training - INFO -   recall: 0.6
2025-06-24 11:51:18,482 - src.training - INFO -   f1: 0.005538366865523666
2025-06-24 11:51:18,482 - src.training - INFO -   accuracy: 0.736684167647325
2025-06-24 11:51:18,482 - src.training - INFO -   balanced_accuracy: 0.6684257035392214
2025-06-24 11:51:18,482 - src.training - INFO -   positive_samples: 270
2025-06-24 11:51:18,482 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:51:18,482 - src.training - INFO -   total_samples: 220940
2025-06-24 11:51:18,482 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:51:18,482 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:51:18,482 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:51:18,482 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:51:18,482 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:51:18,483 - src.training - INFO - 모델 학습 완료
2025-06-24 11:51:18,483 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002782023320911542, 'recall': 0.6, 'f1': 0.005538366865523666, 'accuracy': 0.736684167647325, 'balanced_accuracy': 0.6684257035392214, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:51:18,483 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:18,483 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:18,483 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:18,483 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:18,523 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:51:18,523 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:51:18,966 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = xgboost
2025-06-24 11:51:20,803 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:51:20,803 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:51:20,803 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:51:20,803 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:51:20,803 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:51:20,803 - src.training - INFO - 교차 검증 시작
2025-06-24 11:51:20,803 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:51:20,818 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:51:21,279 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:51:21,279 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:51:21,279 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:51:21,279 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:51:21,279 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:51:21,279 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:51:21,279 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:51:21,279 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:51:21,279 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:51:21,444 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:51:21,444 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:51:21,444 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:51:21,444 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:51:22,831 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:51:23,898 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:51:23,898 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:51:23,904 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:51:23,936 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:51:23,936 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:51:23,936 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:51:23,936 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:51:25,250 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:51:25,464 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:51:25,464 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:51:25,634 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:51:25,634 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:51:25,660 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:51:25,660 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:51:25,660 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:51:25,660 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:51:25,660 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:25,660 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:51:25,709 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:51:25,710 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:51:25,710 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:25,710 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:25,710 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:51:25,710 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:51:25,710 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:25,775 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:51:25,775 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:51:25,775 - src.training - INFO - 모델 학습 시작
2025-06-24 11:51:25,884 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:51:25,884 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:51:25,884 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:51:25,885 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:51:25,885 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:51:25,885 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:51:25,885 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:51:25,885 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:51:25,885 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:51:25,885 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:25,885 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:51:25,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:51:25,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:25,885 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:25,963 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:26,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:26,093 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:26,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:26,224 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:26,298 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:26,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:51:26,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:26,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:51:26,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:26,364 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:26,364 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:51:26,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:51:26,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:26,365 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:26,382 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:26,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:26,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:26,429 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:26,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:26,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:26,466 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:51:26,466 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:26,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:51:26,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:26,482 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:51:26,482 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:26,482 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   n_estimators: 241
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   learning_rate: 0.03702365468817272
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   subsample: 0.8859886265992724
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7329104296399478
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   reg_alpha: 1.2274639693482558e-08
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   reg_lambda: 0.7222049563512167
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:51:26,497 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:51:26,498 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:51:36,214 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:51:36,214 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:51:36,214 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:51:36,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:51:36,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:36,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:36,233 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:36,247 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:36,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:36,276 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:36,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:36,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:36,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:51:36,310 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:36,313 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:51:36,333 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:51:36,333 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:51:36,333 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:51:36,333 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:51:36,333 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:51:36,333 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:51:36,333 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:51:36,333 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:51:36,336 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:51:36,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:51:36,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:51:36,341 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:51:37,529 - src.training - INFO -   precision: 0.0028037923459359464
2025-06-24 11:51:37,529 - src.training - INFO -   recall: 0.7185185185185186
2025-06-24 11:51:37,529 - src.training - INFO -   f1: 0.00558578791281564
2025-06-24 11:51:37,529 - src.training - INFO -   accuracy: 0.6873630850004526
2025-06-24 11:51:37,529 - src.training - INFO -   balanced_accuracy: 0.7029217416991016
2025-06-24 11:51:37,529 - src.training - INFO -   positive_samples: 270
2025-06-24 11:51:37,529 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:51:37,529 - src.training - INFO -   total_samples: 220940
2025-06-24 11:51:37,529 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:51:37,529 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:51:37,529 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:51:37,529 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:51:37,530 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:51:37,530 - src.training - INFO - 모델 학습 완료
2025-06-24 11:51:37,530 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028037923459359464, 'recall': 0.7185185185185186, 'f1': 0.00558578791281564, 'accuracy': 0.6873630850004526, 'balanced_accuracy': 0.7029217416991016, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:51:37,530 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:37,530 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:37,530 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:37,530 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:37,569 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:51:37,569 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:51:37,990 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = xgboost
2025-06-24 11:51:39,679 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:51:39,679 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:51:39,679 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:51:39,679 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:51:39,679 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:51:39,679 - src.training - INFO - 교차 검증 시작
2025-06-24 11:51:39,679 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:51:39,697 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:51:40,135 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:51:40,135 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:51:40,135 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:51:40,135 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:51:40,135 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:51:40,135 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:51:40,135 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:51:40,135 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:51:40,135 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:51:40,308 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:51:40,308 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:51:40,308 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:51:40,308 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:51:41,553 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:51:42,515 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:51:42,515 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:51:42,521 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:51:42,552 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:51:42,552 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:51:42,552 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:51:42,552 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:51:43,720 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:51:43,917 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:51:43,917 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:51:44,082 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:51:44,082 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:51:44,107 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:51:44,108 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:51:44,108 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:51:44,108 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:51:44,108 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:44,108 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,153 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:51:44,154 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:51:44,154 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,154 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,154 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:51:44,154 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:51:44,154 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,211 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:51:44,211 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:51:44,211 - src.training - INFO - 모델 학습 시작
2025-06-24 11:51:44,319 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:51:44,319 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:51:44,319 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:51:44,319 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:51:44,319 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:51:44,319 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:51:44,319 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:51:44,319 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:51:44,319 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:51:44,319 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,319 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:51:44,319 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:51:44,319 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:44,320 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:44,386 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:44,440 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:44,497 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:44,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:44,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:44,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:44,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:51:44,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:44,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:51:44,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,749 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,749 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:51:44,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:51:44,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:44,749 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:51:44,766 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:51:44,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:51:44,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:51:44,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:51:44,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:51:44,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:51:44,842 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:51:44,842 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:51:44,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:51:44,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,857 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:51:44,857 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:51:44,857 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   n_estimators: 385
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   learning_rate: 0.07037478542743371
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   subsample: 0.705827237013454
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9441803048288847
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   reg_alpha: 0.38300829804770764
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   reg_lambda: 0.0726042353399321
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:51:44,872 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:51:44,873 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:52:04,767 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:52:04,767 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:52:04,767 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:52:04,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:52:04,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:04,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:52:04,787 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:52:04,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:52:04,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:52:04,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:52:04,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:52:04,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:52:04,865 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:52:04,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:04,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:52:04,917 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:52:04,918 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:52:04,918 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:52:04,918 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:52:04,918 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:52:04,918 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:52:04,918 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:52:04,918 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:52:04,921 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:52:04,925 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:52:04,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:52:04,926 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:52:06,100 - src.training - INFO -   precision: 0.0027973377061830808
2025-06-24 11:52:06,101 - src.training - INFO -   recall: 0.42962962962962964
2025-06-24 11:52:06,101 - src.training - INFO -   f1: 0.005558483875604964
2025-06-24 11:52:06,101 - src.training - INFO -   accuracy: 0.8121390422739205
2025-06-24 11:52:06,101 - src.training - INFO -   balanced_accuracy: 0.6211183449729696
2025-06-24 11:52:06,101 - src.training - INFO -   positive_samples: 270
2025-06-24 11:52:06,101 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:52:06,101 - src.training - INFO -   total_samples: 220940
2025-06-24 11:52:06,101 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:52:06,101 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:52:06,101 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:52:06,101 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:52:06,101 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:52:06,102 - src.training - INFO - 모델 학습 완료
2025-06-24 11:52:06,102 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0027973377061830808, 'recall': 0.42962962962962964, 'f1': 0.005558483875604964, 'accuracy': 0.8121390422739205, 'balanced_accuracy': 0.6211183449729696, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:52:06,102 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:06,102 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:06,102 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:06,102 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:06,141 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:52:06,141 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:52:06,560 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = xgboost
2025-06-24 11:52:08,256 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:52:08,256 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:52:08,256 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:52:08,256 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:52:08,256 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:52:08,256 - src.training - INFO - 교차 검증 시작
2025-06-24 11:52:08,256 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:52:08,273 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:52:08,703 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:52:08,703 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:52:08,703 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:52:08,703 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:52:08,703 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:52:08,703 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:52:08,703 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:52:08,703 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:52:08,703 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:52:08,877 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:52:08,877 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:52:08,877 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:52:08,877 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:52:10,122 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:52:11,091 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:52:11,091 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:52:11,097 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:52:11,128 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:52:11,128 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:52:11,128 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:52:11,128 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:52:12,315 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:52:12,518 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:52:12,518 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:52:12,679 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:52:12,680 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:52:12,705 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:52:12,705 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:52:12,705 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:52:12,705 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:52:12,705 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:12,705 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:52:12,751 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:52:12,751 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:52:12,751 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:12,751 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:12,751 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:52:12,751 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:52:12,751 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:12,810 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:52:12,810 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:52:12,810 - src.training - INFO - 모델 학습 시작
2025-06-24 11:52:12,917 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:52:12,917 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:52:12,917 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:52:12,917 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:52:12,917 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:52:12,917 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:52:12,917 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:52:12,917 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:52:12,917 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:52:12,917 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:12,917 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:52:12,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:52:12,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:12,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:52:12,984 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:52:13,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:52:13,095 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:52:13,148 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:52:13,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:52:13,271 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:52:13,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:52:13,279 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:13,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:52:13,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:13,344 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:13,344 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:52:13,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:52:13,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:13,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:52:13,361 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:52:13,375 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:52:13,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:52:13,402 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:52:13,417 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:52:13,433 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:52:13,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:52:13,436 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:13,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:52:13,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:13,451 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:52:13,451 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:13,451 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   n_estimators: 370
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   learning_rate: 0.021217327380123083
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   subsample: 0.7396827063685728
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6623821092040608
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   min_child_weight: 5
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   reg_alpha: 0.00011996171693507791
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   reg_lambda: 3.7735473955281834e-07
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:52:13,466 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:52:53,648 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:52:53,648 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:52:53,648 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:52:53,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:52:53,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:53,649 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:52:53,666 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:52:53,681 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:52:53,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:52:53,709 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:52:53,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:52:53,740 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:52:53,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:52:53,743 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:53,746 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:52:53,919 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:52:53,920 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:52:53,920 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:52:53,920 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:52:53,920 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:52:53,920 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:52:53,920 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:52:53,920 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:52:53,923 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:52:53,927 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:52:53,928 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:52:53,928 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:52:55,147 - src.training - INFO -   precision: 0.002958788305741458
2025-06-24 11:52:55,147 - src.training - INFO -   recall: 0.15555555555555556
2025-06-24 11:52:55,147 - src.training - INFO -   f1: 0.005807120636017974
2025-06-24 11:52:55,147 - src.training - INFO -   accuracy: 0.9349099302978184
2025-06-24 11:52:55,147 - src.training - INFO -   balanced_accuracy: 0.5457095310745558
2025-06-24 11:52:55,147 - src.training - INFO -   positive_samples: 270
2025-06-24 11:52:55,147 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:52:55,147 - src.training - INFO -   total_samples: 220940
2025-06-24 11:52:55,147 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:52:55,147 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:52:55,147 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:52:55,147 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:52:55,148 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:52:55,153 - src.training - INFO - 모델 학습 완료
2025-06-24 11:52:55,153 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002958788305741458, 'recall': 0.15555555555555556, 'f1': 0.005807120636017974, 'accuracy': 0.9349099302978184, 'balanced_accuracy': 0.5457095310745558, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:52:55,153 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:55,153 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:55,153 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:52:55,153 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:52:55,191 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:52:55,191 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:52:55,622 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = xgboost
2025-06-24 11:52:57,311 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:52:57,311 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:52:57,311 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:52:57,311 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:52:57,311 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:52:57,311 - src.training - INFO - 교차 검증 시작
2025-06-24 11:52:57,311 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:52:57,328 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:52:57,760 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:52:57,760 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:52:57,760 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:52:57,760 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:52:57,760 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:52:57,760 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:52:57,760 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:52:57,760 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:52:57,760 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:52:57,934 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:52:57,934 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:52:57,934 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:52:57,934 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:52:59,204 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:53:00,181 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:53:00,181 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:53:00,187 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:53:00,218 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:53:00,219 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:53:00,219 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:53:00,219 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:53:01,402 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:53:01,603 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:53:01,603 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:53:01,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:53:01,768 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:53:01,793 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:53:01,793 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:53:01,793 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:53:01,793 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:53:01,793 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:01,793 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:53:01,839 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:53:01,839 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:53:01,839 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:01,839 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:01,839 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:53:01,839 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:53:01,839 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:01,895 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:53:01,895 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:53:01,895 - src.training - INFO - 모델 학습 시작
2025-06-24 11:53:02,002 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:53:02,002 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:53:02,002 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:53:02,002 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:53:02,002 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:53:02,002 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:53:02,002 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:53:02,002 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:53:02,002 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:53:02,002 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:02,002 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:53:02,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:53:02,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:02,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:02,068 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:02,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:02,178 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:02,231 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:02,287 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:02,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:02,367 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:53:02,367 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:02,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:53:02,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:02,436 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:02,436 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:53:02,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:53:02,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:02,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:02,453 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:02,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:02,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:02,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:02,508 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:02,525 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:02,527 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:53:02,527 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:02,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:53:02,541 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:02,541 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:53:02,541 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:02,541 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   n_estimators: 150
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   learning_rate: 0.15343884763892982
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   subsample: 0.810326632921663
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9488249460526356
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   reg_alpha: 2.054103604334144e-05
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   reg_lambda: 5.995629739376342e-07
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:53:02,557 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:53:02,558 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:53:14,539 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:53:14,539 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:53:14,540 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:53:14,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:53:14,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:14,540 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:14,558 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:14,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:14,591 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:14,607 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:14,624 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:14,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:14,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:53:14,645 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:14,648 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:53:14,694 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:53:14,694 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:53:14,694 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:53:14,694 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:53:14,694 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:53:14,694 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:53:14,694 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:53:14,694 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:53:14,698 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:53:14,703 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:53:14,703 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:53:14,703 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:53:16,072 - src.training - INFO -   precision: 0.003337969401947149
2025-06-24 11:53:16,072 - src.training - INFO -   recall: 0.044444444444444446
2025-06-24 11:53:16,072 - src.training - INFO -   f1: 0.006209573091849935
2025-06-24 11:53:16,072 - src.training - INFO -   accuracy: 0.9826151896442473
2025-06-24 11:53:16,072 - src.training - INFO -   balanced_accuracy: 0.5141037647971078
2025-06-24 11:53:16,072 - src.training - INFO -   positive_samples: 270
2025-06-24 11:53:16,073 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:53:16,073 - src.training - INFO -   total_samples: 220940
2025-06-24 11:53:16,073 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:53:16,073 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:53:16,073 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:53:16,073 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:53:16,073 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:53:16,075 - src.training - INFO - 모델 학습 완료
2025-06-24 11:53:16,075 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003337969401947149, 'recall': 0.044444444444444446, 'f1': 0.006209573091849935, 'accuracy': 0.9826151896442473, 'balanced_accuracy': 0.5141037647971078, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:53:16,075 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:16,075 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:16,075 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:16,075 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:16,115 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:53:16,116 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:53:16,556 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = xgboost
2025-06-24 11:53:18,404 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:53:18,404 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:53:18,404 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:53:18,404 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:53:18,404 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:53:18,404 - src.training - INFO - 교차 검증 시작
2025-06-24 11:53:18,404 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:53:18,421 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:53:18,889 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:53:18,889 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:53:18,889 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:53:18,889 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:53:18,889 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:53:18,889 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:53:18,889 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:53:18,889 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:53:18,889 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:53:19,054 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:53:19,054 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:53:19,054 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:53:19,054 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:53:20,435 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:53:21,507 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:53:21,507 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:53:21,513 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:53:21,545 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:53:21,545 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:53:21,545 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:53:21,545 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:53:22,844 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:53:23,057 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:53:23,057 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:53:23,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:53:23,227 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:53:23,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:53:23,253 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:53:23,253 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:53:23,253 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:53:23,253 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:23,253 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,303 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:53:23,303 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:53:23,303 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,303 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,303 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:53:23,303 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:53:23,303 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,368 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:53:23,369 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:53:23,369 - src.training - INFO - 모델 학습 시작
2025-06-24 11:53:23,477 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:53:23,477 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:53:23,477 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:53:23,477 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:53:23,477 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:53:23,477 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:53:23,477 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:53:23,477 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:53:23,477 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:53:23,477 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,477 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:53:23,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:53:23,477 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:23,478 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:23,555 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:23,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:23,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:23,749 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:23,813 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:23,886 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:23,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:53:23,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:23,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:53:23,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,962 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:23,962 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:53:23,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:53:23,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:23,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:23,980 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:23,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:24,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:24,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:24,045 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:24,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:24,064 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:53:24,064 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:24,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:53:24,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:24,079 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:53:24,079 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:24,079 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   n_estimators: 124
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   learning_rate: 0.03103590092347811
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   subsample: 0.9188308033084651
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9366705930747855
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   reg_alpha: 1.546294880333778e-05
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   reg_lambda: 1.55319957102012e-07
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:53:24,095 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:53:24,096 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:53:36,269 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:53:36,269 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:53:36,269 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:53:36,269 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:53:36,269 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:36,270 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:36,288 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:36,303 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:36,318 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:36,331 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:36,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:36,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:36,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:53:36,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:36,369 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:53:36,415 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:53:36,415 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:53:36,415 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:53:36,415 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:53:36,415 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:53:36,415 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:53:36,415 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:53:36,415 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:53:36,419 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:53:36,423 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:53:36,423 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:53:36,423 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:53:37,661 - src.training - INFO -   precision: 0.0026467098658391895
2025-06-24 11:53:37,661 - src.training - INFO -   recall: 0.21481481481481482
2025-06-24 11:53:37,661 - src.training - INFO -   f1: 0.005228993869455464
2025-06-24 11:53:37,661 - src.training - INFO -   accuracy: 0.9001176790078754
2025-06-24 11:53:37,661 - src.training - INFO -   balanced_accuracy: 0.5578854968622495
2025-06-24 11:53:37,661 - src.training - INFO -   positive_samples: 270
2025-06-24 11:53:37,661 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:53:37,661 - src.training - INFO -   total_samples: 220940
2025-06-24 11:53:37,661 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:53:37,661 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:53:37,661 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:53:37,661 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:53:37,662 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:53:37,663 - src.training - INFO - 모델 학습 완료
2025-06-24 11:53:37,663 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0026467098658391895, 'recall': 0.21481481481481482, 'f1': 0.005228993869455464, 'accuracy': 0.9001176790078754, 'balanced_accuracy': 0.5578854968622495, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:53:37,663 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:37,663 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:37,663 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:37,664 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:37,701 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:53:37,701 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:53:38,121 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = xgboost
2025-06-24 11:53:39,794 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:53:39,794 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:53:39,794 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:53:39,794 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:53:39,794 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:53:39,794 - src.training - INFO - 교차 검증 시작
2025-06-24 11:53:39,794 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:53:39,810 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:53:40,248 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:53:40,248 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:53:40,248 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:53:40,248 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:53:40,248 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:53:40,248 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:53:40,248 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:53:40,248 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:53:40,248 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:53:40,419 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:53:40,419 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:53:40,419 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:53:40,419 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:53:41,680 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:53:42,641 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:53:42,641 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:53:42,647 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:53:42,678 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:53:42,678 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:53:42,678 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:53:42,678 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:53:43,858 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:53:44,053 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:53:44,053 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:53:44,213 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:53:44,213 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:53:44,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:53:44,239 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:53:44,239 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:53:44,239 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:53:44,239 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:44,239 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,284 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:53:44,284 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:53:44,284 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,284 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,284 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:53:44,284 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:53:44,285 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,343 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:53:44,343 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:53:44,343 - src.training - INFO - 모델 학습 시작
2025-06-24 11:53:44,450 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:53:44,450 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:53:44,450 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:53:44,450 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:53:44,450 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:53:44,450 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:53:44,450 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:53:44,450 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:53:44,450 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:53:44,451 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,451 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:53:44,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:53:44,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:44,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:44,519 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:44,574 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:44,632 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:44,687 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:44,744 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:44,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:44,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:53:44,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:44,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:53:44,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,890 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,890 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:53:44,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:53:44,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:44,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:53:44,907 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:53:44,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:53:44,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:53:44,948 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:53:44,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:53:44,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:53:44,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:53:44,981 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:53:44,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:53:44,995 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,995 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:53:44,995 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:53:44,995 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   n_estimators: 987
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   learning_rate: 0.02374129847496739
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   subsample: 0.7051585696976133
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7239365894195054
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   min_child_weight: 9
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   reg_alpha: 0.0011744844795035748
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   reg_lambda: 3.10909151552201
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:53:45,011 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:53:45,012 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:54:57,771 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:54:57,771 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:54:57,771 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:54:57,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:54:57,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:54:57,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:54:57,789 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:54:57,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:54:57,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:54:57,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:54:57,856 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:54:57,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:54:57,877 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:54:57,877 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:54:57,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:54:58,100 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:54:58,100 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:54:58,100 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:54:58,100 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:54:58,100 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:54:58,100 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:54:58,100 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:54:58,100 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:54:58,104 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:54:58,108 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:54:58,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:54:58,109 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:54:59,494 - src.training - INFO -   precision: 0.0034218552406456893
2025-06-24 11:54:59,494 - src.training - INFO -   recall: 0.17037037037037037
2025-06-24 11:54:59,494 - src.training - INFO -   f1: 0.0067089622985488226
2025-06-24 11:54:59,494 - src.training - INFO -   accuracy: 0.9383497782203313
2025-06-24 11:54:59,494 - src.training - INFO -   balanced_accuracy: 0.554829903542914
2025-06-24 11:54:59,494 - src.training - INFO -   positive_samples: 270
2025-06-24 11:54:59,494 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:54:59,494 - src.training - INFO -   total_samples: 220940
2025-06-24 11:54:59,494 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:54:59,494 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:54:59,494 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:54:59,494 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:54:59,494 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:54:59,496 - src.training - INFO - 모델 학습 완료
2025-06-24 11:54:59,496 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0034218552406456893, 'recall': 0.17037037037037037, 'f1': 0.0067089622985488226, 'accuracy': 0.9383497782203313, 'balanced_accuracy': 0.554829903542914, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:54:59,496 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:54:59,496 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:54:59,496 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:54:59,496 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:54:59,536 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:54:59,536 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:54:59,972 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = xgboost
2025-06-24 11:55:01,701 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:55:01,701 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:55:01,701 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:55:01,701 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:55:01,701 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:55:01,701 - src.training - INFO - 교차 검증 시작
2025-06-24 11:55:01,701 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:55:01,718 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:55:02,152 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:55:02,152 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:55:02,152 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:55:02,152 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:55:02,152 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:55:02,152 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:55:02,152 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:55:02,152 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:55:02,152 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:55:02,325 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:55:02,325 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:55:02,325 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:55:02,325 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:55:03,593 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:55:04,552 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:55:04,552 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:55:04,558 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:55:04,589 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:55:04,589 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:55:04,589 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:55:04,589 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:55:05,766 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:55:05,965 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:55:05,965 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:55:06,127 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:55:06,127 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:55:06,152 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:55:06,152 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:55:06,152 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:55:06,152 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:55:06,152 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:06,152 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,199 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:55:06,200 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:55:06,200 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,200 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,200 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:55:06,200 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:55:06,200 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,262 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:55:06,262 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:55:06,262 - src.training - INFO - 모델 학습 시작
2025-06-24 11:55:06,373 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:55:06,374 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:55:06,374 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:55:06,374 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:55:06,374 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:55:06,374 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:55:06,374 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:55:06,374 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:55:06,374 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:55:06,374 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,374 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:55:06,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:55:06,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:06,374 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:06,440 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:06,494 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:06,550 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:06,603 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:06,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:06,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:06,739 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:55:06,739 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:06,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:55:06,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,808 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,808 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:55:06,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:55:06,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:06,809 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:06,826 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:06,839 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:06,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:06,867 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:06,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:06,897 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:06,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:55:06,900 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:06,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:55:06,914 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,914 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:55:06,914 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:06,914 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   n_estimators: 217
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   learning_rate: 0.07108644397477933
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   subsample: 0.9497269166017045
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7735010856887719
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   reg_alpha: 1.18635456537429e-06
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   reg_lambda: 1.1749247346653163e-05
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:55:06,930 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:55:28,681 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:55:28,681 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:55:28,681 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:55:28,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:55:28,681 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:28,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:28,700 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:28,714 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:28,728 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:28,742 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:28,756 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:28,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:28,776 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:55:28,776 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:28,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:55:28,870 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:55:28,870 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:55:28,870 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:55:28,870 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:55:28,870 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:55:28,870 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:55:28,870 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:55:28,870 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:55:28,874 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:55:28,878 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:55:28,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:55:28,879 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:55:30,051 - src.training - INFO -   precision: 0.0028862805464691167
2025-06-24 11:55:30,051 - src.training - INFO -   recall: 0.05555555555555555
2025-06-24 11:55:30,051 - src.training - INFO -   f1: 0.0054874702762026705
2025-06-24 11:55:30,051 - src.training - INFO -   accuracy: 0.9753915090069702
2025-06-24 11:55:30,051 - src.training - INFO -   balanced_accuracy: 0.5160362632991445
2025-06-24 11:55:30,051 - src.training - INFO -   positive_samples: 270
2025-06-24 11:55:30,051 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:55:30,051 - src.training - INFO -   total_samples: 220940
2025-06-24 11:55:30,051 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:55:30,051 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:55:30,051 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:55:30,051 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:55:30,052 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:55:30,055 - src.training - INFO - 모델 학습 완료
2025-06-24 11:55:30,055 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028862805464691167, 'recall': 0.05555555555555555, 'f1': 0.0054874702762026705, 'accuracy': 0.9753915090069702, 'balanced_accuracy': 0.5160362632991445, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:55:30,055 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:30,055 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:30,055 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:30,055 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:30,093 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:55:30,093 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:55:30,523 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = xgboost
2025-06-24 11:55:32,227 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:55:32,227 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:55:32,227 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:55:32,227 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:55:32,227 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:55:32,227 - src.training - INFO - 교차 검증 시작
2025-06-24 11:55:32,227 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:55:32,244 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:55:32,706 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:55:32,706 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:55:32,706 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:55:32,706 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:55:32,706 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:55:32,706 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:55:32,706 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:55:32,706 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:55:32,706 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:55:32,870 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:55:32,871 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:55:32,871 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:55:32,871 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:55:32,871 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:55:32,871 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:55:32,871 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:55:32,871 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:55:32,871 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:55:32,871 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:55:34,239 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:55:35,306 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:55:35,306 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:55:35,313 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:55:35,345 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:55:35,345 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:55:35,345 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:55:35,345 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:55:36,640 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:55:36,850 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:55:36,850 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:55:37,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:55:37,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:55:37,047 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:55:37,047 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:55:37,047 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:55:37,047 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:55:37,047 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:37,047 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,097 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:55:37,097 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:55:37,097 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,097 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,097 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:55:37,097 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:55:37,097 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,162 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:55:37,162 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:55:37,162 - src.training - INFO - 모델 학습 시작
2025-06-24 11:55:37,272 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:55:37,272 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:55:37,272 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:55:37,272 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:55:37,272 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:55:37,272 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:55:37,272 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:55:37,272 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:55:37,272 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:55:37,272 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,272 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:55:37,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:55:37,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:37,272 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:37,350 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:37,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:37,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:37,545 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:37,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:37,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:37,698 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:55:37,698 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:37,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:55:37,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,761 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,761 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:55:37,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:55:37,761 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:37,762 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:37,779 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:37,794 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:37,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:37,827 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:37,844 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:37,862 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:37,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:55:37,864 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:37,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:55:37,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,880 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:55:37,880 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:37,880 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   n_estimators: 237
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   max_depth: 11
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   learning_rate: 0.2961944927898986
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   subsample: 0.9014555241428268
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9263391657606543
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   reg_alpha: 0.0002618683860506214
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   reg_lambda: 4.692080526661669e-08
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:55:37,896 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:55:37,897 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:55:48,208 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:55:48,208 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:55:48,209 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:55:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:55:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:48,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:48,228 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:48,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:48,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:48,270 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:48,284 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:48,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:48,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:55:48,304 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:48,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:55:48,342 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:55:48,342 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:55:48,342 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:55:48,342 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:55:48,342 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:55:48,342 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:55:48,342 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:55:48,342 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:55:48,346 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:55:48,350 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:55:48,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:55:48,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:55:49,519 - src.training - INFO -   precision: 0.0037509377344336083
2025-06-24 11:55:49,520 - src.training - INFO -   recall: 0.05555555555555555
2025-06-24 11:55:49,520 - src.training - INFO -   f1: 0.007027406886858749
2025-06-24 11:55:49,520 - src.training - INFO -   accuracy: 0.9808137956006155
2025-06-24 11:55:49,520 - src.training - INFO -   balanced_accuracy: 0.5187507238057834
2025-06-24 11:55:49,520 - src.training - INFO -   positive_samples: 270
2025-06-24 11:55:49,520 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:55:49,520 - src.training - INFO -   total_samples: 220940
2025-06-24 11:55:49,520 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:55:49,520 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:55:49,520 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:55:49,520 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:55:49,520 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:55:49,521 - src.training - INFO - 모델 학습 완료
2025-06-24 11:55:49,521 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0037509377344336083, 'recall': 0.05555555555555555, 'f1': 0.007027406886858749, 'accuracy': 0.9808137956006155, 'balanced_accuracy': 0.5187507238057834, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:55:49,521 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:49,521 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:49,521 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:49,521 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:49,560 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:55:49,560 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:55:49,980 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = xgboost
2025-06-24 11:55:51,655 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:55:51,655 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:55:51,655 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:55:51,655 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:55:51,655 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:55:51,655 - src.training - INFO - 교차 검증 시작
2025-06-24 11:55:51,655 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:55:51,672 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:55:52,103 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:55:52,103 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:55:52,103 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:55:52,103 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:55:52,103 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:55:52,103 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:55:52,103 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:55:52,103 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:55:52,103 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:55:52,276 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:55:52,276 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:55:52,276 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:55:52,276 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:55:53,528 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:55:54,489 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:55:54,489 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:55:54,496 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:55:54,527 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:55:54,527 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:55:54,527 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:55:54,527 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:55:55,707 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:55:55,904 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:55:55,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:55:56,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:55:56,065 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:55:56,090 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:55:56,091 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:55:56,091 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:55:56,091 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:55:56,091 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:56,091 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,137 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:55:56,137 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:55:56,137 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,137 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,137 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:55:56,137 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:55:56,137 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,197 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:55:56,197 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:55:56,197 - src.training - INFO - 모델 학습 시작
2025-06-24 11:55:56,307 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:55:56,307 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:55:56,307 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:55:56,307 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:55:56,307 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:55:56,307 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:55:56,307 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:55:56,307 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:55:56,307 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:55:56,307 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,307 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:55:56,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:55:56,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:56,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:56,373 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:56,426 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:56,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:56,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:56,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:56,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:56,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:55:56,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:56,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:55:56,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,752 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,752 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:55:56,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:55:56,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:56,752 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:55:56,769 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:55:56,783 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:55:56,797 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:55:56,810 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:55:56,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:55:56,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:55:56,843 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:55:56,843 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:55:56,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:55:56,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,857 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:55:56,857 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:55:56,857 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   n_estimators: 459
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   learning_rate: 0.0635783246333184
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   subsample: 0.7533730634252042
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8246193736696797
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   reg_alpha: 9.371528015818567
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   reg_lambda: 0.13289499256264298
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:55:56,874 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:56:30,336 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:56:30,336 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:56:30,337 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:56:30,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:56:30,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:30,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:56:30,356 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:56:30,372 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:56:30,389 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:56:30,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:56:30,421 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:56:30,439 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:56:30,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:56:30,442 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:30,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:56:30,552 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:56:30,552 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:56:30,552 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:56:30,552 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:56:30,552 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:56:30,552 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:56:30,552 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:56:30,552 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:56:30,556 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:56:30,560 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:56:30,561 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:56:30,561 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:56:31,858 - src.training - INFO -   precision: 0.0034902452120995167
2025-06-24 11:56:31,858 - src.training - INFO -   recall: 0.14444444444444443
2025-06-24 11:56:31,858 - src.training - INFO -   f1: 0.006815798671793079
2025-06-24 11:56:31,858 - src.training - INFO -   accuracy: 0.9485561690956821
2025-06-24 11:56:31,858 - src.training - INFO -   balanced_accuracy: 0.5469922408020019
2025-06-24 11:56:31,858 - src.training - INFO -   positive_samples: 270
2025-06-24 11:56:31,858 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:56:31,858 - src.training - INFO -   total_samples: 220940
2025-06-24 11:56:31,858 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:56:31,858 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:56:31,858 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:56:31,858 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:56:31,858 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:56:31,859 - src.training - INFO - 모델 학습 완료
2025-06-24 11:56:31,859 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0034902452120995167, 'recall': 0.14444444444444443, 'f1': 0.006815798671793079, 'accuracy': 0.9485561690956821, 'balanced_accuracy': 0.5469922408020019, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:56:31,859 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:31,859 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:31,859 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:31,859 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:31,900 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:56:31,900 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:56:32,327 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = xgboost
2025-06-24 11:56:34,174 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:56:34,174 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:56:34,174 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:56:34,174 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:56:34,174 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:56:34,174 - src.training - INFO - 교차 검증 시작
2025-06-24 11:56:34,174 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:56:34,190 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:56:34,654 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:56:34,654 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:56:34,654 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:56:34,654 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:56:34,654 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:56:34,654 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:56:34,654 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:56:34,654 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:56:34,654 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:56:34,820 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:56:34,820 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:56:34,820 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:56:34,820 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:56:36,203 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:56:37,272 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:56:37,272 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:56:37,278 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:56:37,310 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:56:37,310 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:56:37,310 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:56:37,310 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:56:38,620 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:56:38,832 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:56:38,833 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:56:39,003 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:56:39,003 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:56:39,029 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:56:39,029 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:56:39,029 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:56:39,029 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:56:39,029 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:39,029 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,078 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:56:39,078 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:56:39,078 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,078 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,078 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:56:39,078 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:56:39,078 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,144 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:56:39,144 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:56:39,144 - src.training - INFO - 모델 학습 시작
2025-06-24 11:56:39,253 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:56:39,253 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:56:39,253 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:56:39,253 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:56:39,253 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:56:39,253 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:56:39,253 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:56:39,253 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:56:39,253 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:56:39,253 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,253 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:56:39,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:56:39,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:39,253 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:56:39,331 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:56:39,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:56:39,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:56:39,527 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:56:39,593 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:56:39,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:56:39,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:56:39,679 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:39,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:56:39,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,741 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,741 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:56:39,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:56:39,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:39,741 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:56:39,759 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:56:39,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:56:39,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:56:39,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:56:39,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:56:39,841 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:56:39,843 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:56:39,843 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:39,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:56:39,857 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,857 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:56:39,857 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:39,857 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   n_estimators: 189
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   learning_rate: 0.12622274307758022
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   subsample: 0.9197824106639708
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8755414198527185
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   reg_alpha: 0.0005138258939904685
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   reg_lambda: 4.039703917788516e-07
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:56:39,873 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:56:39,874 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:56:57,463 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:56:57,464 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:56:57,467 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:56:57,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:56:57,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:57,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:56:57,486 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:56:57,500 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:56:57,515 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:56:57,529 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:56:57,543 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:56:57,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:56:57,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:56:57,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:57,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:56:57,633 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:56:57,633 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:56:57,633 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:56:57,633 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:56:57,634 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:56:57,634 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:56:57,634 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:56:57,634 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:56:57,637 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:56:57,641 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:56:57,641 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:56:57,641 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:56:58,787 - src.training - INFO -   precision: 0.0028066236317709796
2025-06-24 11:56:58,787 - src.training - INFO -   recall: 0.037037037037037035
2025-06-24 11:56:58,787 - src.training - INFO -   f1: 0.0052178450300026085
2025-06-24 11:56:58,787 - src.training - INFO -   accuracy: 0.9827419208834978
2025-06-24 11:56:58,787 - src.training - INFO -   balanced_accuracy: 0.5104680358974101
2025-06-24 11:56:58,787 - src.training - INFO -   positive_samples: 270
2025-06-24 11:56:58,787 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:56:58,787 - src.training - INFO -   total_samples: 220940
2025-06-24 11:56:58,787 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:56:58,787 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:56:58,787 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:56:58,787 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:56:58,788 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:56:58,791 - src.training - INFO - 모델 학습 완료
2025-06-24 11:56:58,791 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028066236317709796, 'recall': 0.037037037037037035, 'f1': 0.0052178450300026085, 'accuracy': 0.9827419208834978, 'balanced_accuracy': 0.5104680358974101, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:56:58,791 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:58,791 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:58,791 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:56:58,791 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:56:58,830 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:56:58,830 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:56:59,248 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = xgboost
2025-06-24 11:57:00,927 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:57:00,927 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:57:00,927 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:57:00,927 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:57:00,927 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:57:00,927 - src.training - INFO - 교차 검증 시작
2025-06-24 11:57:00,927 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:57:00,944 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:57:01,373 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:57:01,373 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:57:01,373 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:57:01,373 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:57:01,373 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:57:01,373 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:57:01,373 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:57:01,373 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:57:01,373 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:57:01,545 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:57:01,546 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:57:01,546 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:57:01,546 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:57:01,546 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:57:01,546 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:57:01,546 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:57:01,546 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:57:01,546 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:57:01,546 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:57:02,798 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:57:03,763 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:57:03,763 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:57:03,769 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:57:03,800 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:57:03,800 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:57:03,800 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:57:03,800 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:57:04,972 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:57:05,172 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:57:05,172 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:57:05,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:57:05,337 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:57:05,363 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:57:05,363 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:57:05,363 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:57:05,363 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:57:05,363 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:57:05,363 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:57:05,409 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:57:05,409 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:57:05,409 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:05,409 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:05,409 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:57:05,409 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:57:05,409 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:05,467 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:57:05,467 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:57:05,467 - src.training - INFO - 모델 학습 시작
2025-06-24 11:57:05,574 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:57:05,574 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:57:05,574 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:57:05,574 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:57:05,574 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:57:05,574 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:57:05,574 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:57:05,575 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:57:05,575 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:57:05,575 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:05,575 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:57:05,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:57:05,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:57:05,575 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:57:05,641 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:57:05,695 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:57:05,752 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:57:05,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:57:05,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:57:05,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:57:05,948 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:57:05,948 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:57:06,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:57:06,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:06,024 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:06,024 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:57:06,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:57:06,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:57:06,024 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:57:06,041 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:57:06,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:57:06,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:57:06,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:57:06,096 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:57:06,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:57:06,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:57:06,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:57:06,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:57:06,129 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:06,129 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:57:06,129 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:57:06,129 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   n_estimators: 629
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   max_depth: 12
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   learning_rate: 0.02812502786802693
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   subsample: 0.9431926740742717
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6987609695984448
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   reg_alpha: 0.011118105050569357
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   reg_lambda: 6.324419777354496
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:57:06,146 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:58:08,409 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:58:08,409 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:58:08,410 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:58:08,410 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:58:08,410 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:08,410 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:58:08,428 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:58:08,442 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:58:08,457 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:58:08,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:58:08,485 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:58:08,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:58:08,504 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:58:08,505 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:08,508 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:58:08,756 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:58:08,756 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:58:08,756 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:58:08,756 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:58:08,756 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:58:08,756 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:58:08,756 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:58:08,756 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:58:08,760 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:58:08,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:58:08,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:58:08,764 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:58:09,998 - src.training - INFO -   precision: 0.0032282567413596656
2025-06-24 11:58:09,999 - src.training - INFO -   recall: 0.06296296296296296
2025-06-24 11:58:09,999 - src.training - INFO -   f1: 0.006141618497109827
2025-06-24 11:58:09,999 - src.training - INFO -   accuracy: 0.9750973114872816
2025-06-24 11:58:09,999 - src.training - INFO -   balanced_accuracy: 0.5195881566072349
2025-06-24 11:58:09,999 - src.training - INFO -   positive_samples: 270
2025-06-24 11:58:09,999 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:58:09,999 - src.training - INFO -   total_samples: 220940
2025-06-24 11:58:09,999 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:58:09,999 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:58:09,999 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:58:09,999 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:58:09,999 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:58:10,003 - src.training - INFO - 모델 학습 완료
2025-06-24 11:58:10,003 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0032282567413596656, 'recall': 0.06296296296296296, 'f1': 0.006141618497109827, 'accuracy': 0.9750973114872816, 'balanced_accuracy': 0.5195881566072349, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:58:10,003 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:10,004 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:10,004 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:10,004 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:10,042 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:58:10,042 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:58:10,466 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = xgboost
2025-06-24 11:58:12,144 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:58:12,144 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:58:12,144 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:58:12,144 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:58:12,144 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:58:12,144 - src.training - INFO - 교차 검증 시작
2025-06-24 11:58:12,144 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:58:12,162 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:58:12,598 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:58:12,598 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:58:12,598 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:58:12,598 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:58:12,598 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:58:12,598 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:58:12,598 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:58:12,598 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:58:12,598 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:58:12,775 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:58:12,775 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:58:12,775 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:58:12,775 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:58:14,034 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:58:15,000 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:58:15,000 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:58:15,006 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:58:15,037 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:58:15,037 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:58:15,037 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:58:15,037 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:58:16,198 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:58:16,397 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:58:16,397 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:58:16,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:58:16,562 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:58:16,587 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:58:16,587 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:58:16,587 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:58:16,588 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:58:16,588 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:16,588 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:58:16,633 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:58:16,633 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:58:16,634 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:16,634 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:16,634 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:58:16,634 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:58:16,634 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:16,692 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:58:16,692 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:58:16,692 - src.training - INFO - 모델 학습 시작
2025-06-24 11:58:16,799 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:58:16,799 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:58:16,799 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:58:16,799 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:58:16,799 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:58:16,799 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:58:16,799 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:58:16,799 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:58:16,799 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:58:16,799 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:16,799 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:58:16,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:58:16,799 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:16,800 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:58:16,872 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:58:16,938 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:58:17,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:58:17,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:58:17,143 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:58:17,223 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:58:17,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:58:17,238 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:17,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:58:17,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:17,302 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:17,302 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:58:17,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:58:17,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:17,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:58:17,320 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:58:17,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:58:17,351 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:58:17,366 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:58:17,383 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:58:17,401 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:58:17,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:58:17,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:17,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:58:17,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:17,418 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:58:17,418 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:17,418 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO -   n_estimators: 215
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO -   max_depth: 15
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO -   learning_rate: 0.03261590158970906
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO -   subsample: 0.9243175047221824
2025-06-24 11:58:17,435 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6620910677593805
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   reg_alpha: 1.7670034793163013e-07
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   reg_lambda: 0.052538737898184557
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:58:17,436 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:58:42,057 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:58:42,058 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:58:42,058 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:58:42,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:58:42,058 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:42,059 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:58:42,077 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:58:42,091 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:58:42,106 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:58:42,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:58:42,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:58:42,151 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:58:42,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:58:42,154 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:42,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:58:42,270 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:58:42,270 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:58:42,270 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:58:42,270 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:58:42,270 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:58:42,270 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:58:42,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:58:42,270 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:58:42,273 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:58:42,277 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:58:42,278 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:58:42,278 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:58:43,441 - src.training - INFO -   precision: 0.0028055120059410845
2025-06-24 11:58:43,441 - src.training - INFO -   recall: 0.1259259259259259
2025-06-24 11:58:43,441 - src.training - INFO -   f1: 0.005488740011300347
2025-06-24 11:58:43,441 - src.training - INFO -   accuracy: 0.9442337286141034
2025-06-24 11:58:43,441 - src.training - INFO -   balanced_accuracy: 0.5355804460825533
2025-06-24 11:58:43,441 - src.training - INFO -   positive_samples: 270
2025-06-24 11:58:43,441 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:58:43,441 - src.training - INFO -   total_samples: 220940
2025-06-24 11:58:43,441 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:58:43,441 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:58:43,441 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:58:43,441 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:58:43,442 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:58:43,445 - src.training - INFO - 모델 학습 완료
2025-06-24 11:58:43,445 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028055120059410845, 'recall': 0.1259259259259259, 'f1': 0.005488740011300347, 'accuracy': 0.9442337286141034, 'balanced_accuracy': 0.5355804460825533, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:58:43,445 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:43,445 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:43,445 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:43,445 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:43,483 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:58:43,483 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:58:43,906 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = xgboost
2025-06-24 11:58:45,589 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:58:45,589 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:58:45,589 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:58:45,589 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:58:45,589 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:58:45,589 - src.training - INFO - 교차 검증 시작
2025-06-24 11:58:45,589 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:58:45,606 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:58:46,040 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:58:46,040 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:58:46,040 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:58:46,040 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:58:46,040 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:58:46,040 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:58:46,040 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:58:46,040 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:58:46,040 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:58:46,211 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:58:46,211 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:58:46,211 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:58:46,211 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:58:47,460 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:58:48,442 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:58:48,442 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:58:48,448 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:58:48,479 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:58:48,479 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:58:48,479 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:58:48,479 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:58:49,646 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:58:49,841 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:58:49,841 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:58:50,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:58:50,002 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:58:50,027 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:58:50,028 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:58:50,028 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:58:50,028 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:58:50,028 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:50,028 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,073 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:58:50,073 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:58:50,073 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,073 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,073 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:58:50,073 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:58:50,073 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,130 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:58:50,130 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:58:50,130 - src.training - INFO - 모델 학습 시작
2025-06-24 11:58:50,237 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:58:50,237 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:58:50,237 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:58:50,237 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:58:50,237 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:58:50,237 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:58:50,237 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:58:50,237 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:58:50,237 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:58:50,237 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,237 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:58:50,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:58:50,237 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:50,238 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:58:50,303 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:58:50,357 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:58:50,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:58:50,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:58:50,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:58:50,592 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:58:50,606 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:58:50,607 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:50,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:58:50,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,674 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,674 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:58:50,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:58:50,674 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:50,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:58:50,691 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:58:50,705 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:58:50,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:58:50,732 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:58:50,746 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:58:50,763 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:58:50,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:58:50,765 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:58:50,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:58:50,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,779 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:58:50,779 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:58:50,779 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   n_estimators: 668
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   learning_rate: 0.2842317367788507
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   subsample: 0.6987011369654992
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6537101070036626
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   min_child_weight: 4
2025-06-24 11:58:50,795 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   reg_alpha: 0.01057138964052618
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   reg_lambda: 4.04990258783124e-05
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:58:50,796 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:59:12,437 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:59:12,437 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:59:12,438 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:59:12,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:59:12,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:12,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:59:12,456 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:59:12,473 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:59:12,489 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:59:12,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:59:12,523 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:59:12,541 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:59:12,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:59:12,543 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:12,546 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:59:12,618 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:59:12,618 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:59:12,618 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:59:12,618 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:59:12,618 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:59:12,618 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:59:12,618 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:59:12,618 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:59:12,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:59:12,626 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:59:12,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:59:12,627 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:59:13,918 - src.training - INFO -   precision: 0.0025842575643372457
2025-06-24 11:59:13,918 - src.training - INFO -   recall: 0.08888888888888889
2025-06-24 11:59:13,918 - src.training - INFO -   f1: 0.005022496599351261
2025-06-24 11:59:13,918 - src.training - INFO -   accuracy: 0.9569611659274011
2025-06-24 11:59:13,918 - src.training - INFO -   balanced_accuracy: 0.5234560907941974
2025-06-24 11:59:13,918 - src.training - INFO -   positive_samples: 270
2025-06-24 11:59:13,918 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:59:13,918 - src.training - INFO -   total_samples: 220940
2025-06-24 11:59:13,918 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:59:13,918 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:59:13,918 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:59:13,918 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:59:13,918 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:59:13,919 - src.training - INFO - 모델 학습 완료
2025-06-24 11:59:13,919 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0025842575643372457, 'recall': 0.08888888888888889, 'f1': 0.005022496599351261, 'accuracy': 0.9569611659274011, 'balanced_accuracy': 0.5234560907941974, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:59:13,919 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:13,919 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:13,919 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:13,919 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:13,963 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:59:13,963 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:59:14,402 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = xgboost
2025-06-24 11:59:16,262 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:59:16,262 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:59:16,262 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:59:16,262 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:59:16,262 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:59:16,262 - src.training - INFO - 교차 검증 시작
2025-06-24 11:59:16,262 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:59:16,277 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:59:16,741 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:59:16,741 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:59:16,741 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:59:16,742 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:59:16,742 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:59:16,742 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:59:16,742 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:59:16,742 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:59:16,742 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:59:16,909 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:59:16,909 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:59:16,909 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:59:16,909 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:59:18,279 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:59:19,332 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:59:19,332 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:59:19,339 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:59:19,371 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:59:19,371 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:59:19,371 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:59:19,371 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:59:20,637 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:59:20,848 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:59:20,848 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:59:21,018 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:59:21,018 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:59:21,044 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:59:21,044 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:59:21,044 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:59:21,044 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:59:21,044 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:21,044 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,093 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:59:21,094 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:59:21,094 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,094 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,094 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:59:21,094 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:59:21,094 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,161 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:59:21,161 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:59:21,161 - src.training - INFO - 모델 학습 시작
2025-06-24 11:59:21,281 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:59:21,281 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:59:21,281 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:59:21,281 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:59:21,281 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:59:21,281 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:59:21,281 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:59:21,281 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:59:21,281 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:59:21,282 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,282 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:59:21,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:59:21,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:21,282 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:59:21,359 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:59:21,424 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:59:21,492 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:59:21,552 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:59:21,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:59:21,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:59:21,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:59:21,705 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:21,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:59:21,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,772 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,772 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:59:21,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:59:21,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:21,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:59:21,790 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:59:21,805 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:59:21,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:59:21,836 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:59:21,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:59:21,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:59:21,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:59:21,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:21,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:59:21,891 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,891 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:59:21,891 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:21,891 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:59:21,907 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   n_estimators: 505
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   max_depth: 6
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   learning_rate: 0.058244689683918716
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   subsample: 0.71316899411001
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6229809570942609
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   min_child_weight: 7
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   reg_alpha: 0.000755911637841902
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   reg_lambda: 2.307444068305109
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:59:21,908 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 11:59:50,223 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 11:59:50,224 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 11:59:50,224 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 11:59:50,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:59:50,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:50,224 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:59:50,242 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:59:50,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:59:50,274 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:59:50,290 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:59:50,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:59:50,325 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:59:50,327 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:59:50,327 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:50,331 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 11:59:50,403 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 11:59:50,404 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 11:59:50,404 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 11:59:50,404 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 11:59:50,404 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 11:59:50,404 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 11:59:50,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 11:59:50,404 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 11:59:50,407 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 11:59:50,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 11:59:50,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 11:59:50,412 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 11:59:51,769 - src.training - INFO -   precision: 0.002718026654196867
2025-06-24 11:59:51,769 - src.training - INFO -   recall: 0.34444444444444444
2025-06-24 11:59:51,769 - src.training - INFO -   f1: 0.005393493011656905
2025-06-24 11:59:51,769 - src.training - INFO -   accuracy: 0.8447542319181678
2025-06-24 11:59:51,769 - src.training - INFO -   balanced_accuracy: 0.5949054143190183
2025-06-24 11:59:51,769 - src.training - INFO -   positive_samples: 270
2025-06-24 11:59:51,769 - src.training - INFO -   negative_samples: 220670
2025-06-24 11:59:51,769 - src.training - INFO -   total_samples: 220940
2025-06-24 11:59:51,769 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 11:59:51,769 - src.training - INFO -   roc_auc: 0.0
2025-06-24 11:59:51,769 - src.training - INFO -   pr_auc: 0.0
2025-06-24 11:59:51,769 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 11:59:51,769 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 11:59:51,770 - src.training - INFO - 모델 학습 완료
2025-06-24 11:59:51,770 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002718026654196867, 'recall': 0.34444444444444444, 'f1': 0.005393493011656905, 'accuracy': 0.8447542319181678, 'balanced_accuracy': 0.5949054143190183, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 11:59:51,770 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:51,770 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:51,770 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:51,770 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:51,814 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 11:59:51,814 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 11:59:52,240 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = xgboost
2025-06-24 11:59:54,092 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 11:59:54,092 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 11:59:54,092 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 11:59:54,092 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 11:59:54,092 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 11:59:54,093 - src.training - INFO - 교차 검증 시작
2025-06-24 11:59:54,093 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 11:59:54,108 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 11:59:54,573 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 11:59:54,573 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 11:59:54,573 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 11:59:54,573 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 11:59:54,573 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 11:59:54,573 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 11:59:54,573 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 11:59:54,573 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 11:59:54,573 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 11:59:54,739 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 11:59:54,739 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 11:59:54,739 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 11:59:54,739 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 11:59:56,108 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 11:59:57,168 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:59:57,168 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 11:59:57,173 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 11:59:57,205 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 11:59:57,206 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 11:59:57,206 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 11:59:57,206 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 11:59:58,476 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 11:59:58,691 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 11:59:58,691 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:59:58,861 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:59:58,861 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 11:59:58,888 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 11:59:58,888 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:59:58,888 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 11:59:58,888 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 11:59:58,888 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:58,888 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 11:59:58,937 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 11:59:58,937 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 11:59:58,937 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:58,937 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:58,937 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 11:59:58,937 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 11:59:58,937 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:59,003 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:59:59,003 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 11:59:59,003 - src.training - INFO - 모델 학습 시작
2025-06-24 11:59:59,124 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 11:59:59,124 - src.training - INFO - 모델 타입: xgboost
2025-06-24 11:59:59,124 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 11:59:59,124 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 11:59:59,124 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 11:59:59,124 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 11:59:59,124 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 11:59:59,124 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 11:59:59,124 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 11:59:59,124 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:59,124 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 11:59:59,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 11:59:59,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:59,125 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:59:59,202 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:59:59,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:59:59,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:59:59,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:59:59,462 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:59:59,536 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:59:59,551 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 11:59:59,551 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 11:59:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:59,617 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:59,617 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 11:59:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 11:59:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:59,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 11:59:59,635 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 11:59:59,650 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 11:59:59,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 11:59:59,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 11:59:59,700 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 11:59:59,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 11:59:59,720 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 11:59:59,720 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 11:59:59,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 11:59:59,736 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:59,736 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 11:59:59,736 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 11:59:59,736 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 11:59:59,752 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 11:59:59,752 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 11:59:59,752 - src.models.xgboost_model - INFO -   n_estimators: 621
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   max_depth: 13
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   learning_rate: 0.011861883528878018
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   subsample: 0.7699125466119884
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6055507243736148
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   min_child_weight: 3
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   reg_alpha: 2.420158652769256e-07
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   reg_lambda: 5.606686850331952e-08
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 11:59:59,753 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:01:06,093 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:01:06,093 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:01:06,094 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:01:06,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:01:06,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:06,094 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:01:06,112 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:01:06,126 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:01:06,141 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:01:06,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:01:06,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:01:06,186 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:01:06,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:01:06,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:06,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:01:06,496 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:01:06,496 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:01:06,496 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:01:06,496 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:01:06,496 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:01:06,496 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:01:06,496 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:01:06,496 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:01:06,500 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:01:06,504 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:01:06,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:01:06,505 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:01:07,735 - src.training - INFO -   precision: 0.002894356005788712
2025-06-24 12:01:07,736 - src.training - INFO -   recall: 0.15555555555555556
2025-06-24 12:01:07,736 - src.training - INFO -   f1: 0.005682971382179825
2025-06-24 12:01:07,736 - src.training - INFO -   accuracy: 0.9334796777405631
2025-06-24 12:01:07,736 - src.training - INFO -   balanced_accuracy: 0.5449935298056927
2025-06-24 12:01:07,736 - src.training - INFO -   positive_samples: 270
2025-06-24 12:01:07,736 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:01:07,736 - src.training - INFO -   total_samples: 220940
2025-06-24 12:01:07,736 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:01:07,736 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:01:07,736 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:01:07,736 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:01:07,736 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:01:07,745 - src.training - INFO - 모델 학습 완료
2025-06-24 12:01:07,746 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002894356005788712, 'recall': 0.15555555555555556, 'f1': 0.005682971382179825, 'accuracy': 0.9334796777405631, 'balanced_accuracy': 0.5449935298056927, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:01:07,746 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:07,746 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:07,746 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:07,746 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:07,789 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:01:07,789 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:01:08,215 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = xgboost
2025-06-24 12:01:09,969 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:01:09,969 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:01:09,969 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:01:09,969 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:01:09,969 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:01:09,969 - src.training - INFO - 교차 검증 시작
2025-06-24 12:01:09,969 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:01:09,986 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:01:10,421 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:01:10,421 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:01:10,421 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:01:10,421 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:01:10,421 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:01:10,421 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:01:10,421 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:01:10,421 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:01:10,421 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:01:10,587 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:01:10,587 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:01:10,587 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:01:10,587 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:01:11,858 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:01:12,833 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:01:12,833 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:01:12,838 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:01:12,860 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:01:12,860 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:01:12,860 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:01:12,860 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:01:14,030 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:01:14,228 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:01:14,228 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:01:14,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:01:14,390 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:01:14,431 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:01:14,431 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:01:14,431 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:01:14,431 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:01:14,431 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:14,431 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:01:14,477 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:01:14,477 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:01:14,477 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:14,477 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:14,477 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:01:14,477 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:01:14,477 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:14,535 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:01:14,535 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:01:14,535 - src.training - INFO - 모델 학습 시작
2025-06-24 12:01:14,652 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:01:14,652 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:01:14,652 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:01:14,652 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:01:14,652 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:01:14,652 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:01:14,652 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:01:14,652 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:01:14,652 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:01:14,652 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:14,652 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:01:14,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:01:14,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:14,652 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:01:14,718 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:01:14,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:01:14,830 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:01:14,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:01:14,940 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:01:15,010 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:01:15,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:01:15,022 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:15,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:01:15,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:15,088 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:15,088 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:01:15,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:01:15,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:15,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:01:15,105 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:01:15,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:01:15,133 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:01:15,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:01:15,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:01:15,177 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:01:15,180 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:01:15,180 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:01:15,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:01:15,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:15,194 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:01:15,194 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:01:15,194 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   n_estimators: 646
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   max_depth: 8
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   learning_rate: 0.010201176373896984
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   subsample: 0.7525859924525765
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7495314092187361
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   reg_alpha: 0.0039384547797195035
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   reg_lambda: 0.18314736183576397
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:01:15,213 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:02:01,774 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:02:01,774 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:02:01,778 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:02:01,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:02:01,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:01,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:02:01,797 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:02:01,811 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:02:01,826 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:02:01,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:02:01,854 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:02:01,871 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:02:01,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:02:01,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:01,878 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:02:02,026 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:02:02,026 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:02:02,026 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:02:02,026 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:02:02,026 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:02:02,026 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:02:02,026 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:02:02,026 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:02:02,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:02:02,034 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:02:02,035 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:02:02,035 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:02:03,221 - src.training - INFO -   precision: 0.002938719064219655
2025-06-24 12:02:03,221 - src.training - INFO -   recall: 0.37777777777777777
2025-06-24 12:02:03,222 - src.training - INFO -   f1: 0.005832070670974013
2025-06-24 12:02:03,222 - src.training - INFO -   accuracy: 0.8426043269665973
2025-06-24 12:02:03,222 - src.training - INFO -   balanced_accuracy: 0.6104754208143885
2025-06-24 12:02:03,222 - src.training - INFO -   positive_samples: 270
2025-06-24 12:02:03,222 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:02:03,222 - src.training - INFO -   total_samples: 220940
2025-06-24 12:02:03,222 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:02:03,222 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:02:03,222 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:02:03,222 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:02:03,222 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:02:03,225 - src.training - INFO - 모델 학습 완료
2025-06-24 12:02:03,225 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.002938719064219655, 'recall': 0.37777777777777777, 'f1': 0.005832070670974013, 'accuracy': 0.8426043269665973, 'balanced_accuracy': 0.6104754208143885, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:02:03,225 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:03,225 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:03,225 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:03,225 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:03,267 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:02:03,267 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:02:03,698 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = xgboost
2025-06-24 12:02:05,447 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:02:05,447 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:02:05,447 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:02:05,447 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:02:05,447 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:02:05,447 - src.training - INFO - 교차 검증 시작
2025-06-24 12:02:05,447 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:02:05,463 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:02:05,898 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:02:05,898 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:02:05,898 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:02:05,898 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:02:05,898 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:02:05,898 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:02:05,898 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:02:05,898 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:02:05,898 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:02:06,065 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:02:06,065 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:02:06,065 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:02:06,065 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:02:07,317 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:02:08,284 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:02:08,285 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:02:08,290 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:02:08,312 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:02:08,312 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:02:08,312 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:02:08,312 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:02:09,482 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:02:09,679 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:02:09,680 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:02:09,840 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:02:09,840 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:02:09,881 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:02:09,881 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:02:09,881 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:02:09,882 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:02:09,882 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:09,882 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:02:09,927 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:02:09,927 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:02:09,927 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:09,927 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:09,927 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:02:09,927 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:02:09,927 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:09,985 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:02:09,986 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:02:09,986 - src.training - INFO - 모델 학습 시작
2025-06-24 12:02:10,102 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:02:10,102 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:02:10,102 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:02:10,102 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:02:10,102 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:02:10,102 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:02:10,102 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:02:10,102 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:02:10,102 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:02:10,102 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:10,102 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:02:10,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:02:10,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:10,102 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:02:10,170 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:02:10,225 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:02:10,283 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:02:10,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:02:10,395 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:02:10,463 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:02:10,477 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:02:10,477 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:10,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:02:10,554 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:10,554 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:10,554 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:02:10,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:02:10,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:10,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:02:10,572 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:02:10,585 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:02:10,600 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:02:10,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:02:10,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:02:10,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:02:10,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:02:10,646 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:02:10,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:02:10,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:10,660 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:02:10,660 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:02:10,660 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   n_estimators: 726
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   learning_rate: 0.01906551382156032
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   subsample: 0.6883462352784706
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6379419335960527
2025-06-24 12:02:10,677 - src.models.xgboost_model - INFO -   min_child_weight: 8
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   reg_alpha: 0.013043363243703416
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   reg_lambda: 3.844956098425894
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:02:10,678 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:03:07,595 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:03:07,595 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:03:07,596 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:03:07,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:03:07,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:07,596 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:03:07,614 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:03:07,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:03:07,643 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:03:07,656 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:03:07,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:03:07,688 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:03:07,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:03:07,691 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:07,694 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:03:07,887 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:03:07,887 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:03:07,887 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:03:07,887 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:03:07,887 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:03:07,887 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:03:07,887 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:03:07,887 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:03:07,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:03:07,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:03:07,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:03:07,895 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:03:09,137 - src.training - INFO -   precision: 0.0029443739807936222
2025-06-24 12:03:09,137 - src.training - INFO -   recall: 0.24074074074074073
2025-06-24 12:03:09,137 - src.training - INFO -   f1: 0.00581759599033384
2025-06-24 12:03:09,137 - src.training - INFO -   accuracy: 0.8994478138861229
2025-06-24 12:03:09,137 - src.training - INFO -   balanced_accuracy: 0.5704972566711816
2025-06-24 12:03:09,137 - src.training - INFO -   positive_samples: 270
2025-06-24 12:03:09,137 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:03:09,137 - src.training - INFO -   total_samples: 220940
2025-06-24 12:03:09,137 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:03:09,137 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:03:09,137 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:03:09,137 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:03:09,138 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:03:09,140 - src.training - INFO - 모델 학습 완료
2025-06-24 12:03:09,140 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029443739807936222, 'recall': 0.24074074074074073, 'f1': 0.00581759599033384, 'accuracy': 0.8994478138861229, 'balanced_accuracy': 0.5704972566711816, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:03:09,140 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:09,140 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:09,140 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:09,140 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:09,182 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:03:09,183 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:03:09,618 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = xgboost
2025-06-24 12:03:11,317 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:03:11,317 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:03:11,317 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:03:11,317 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:03:11,317 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:03:11,317 - src.training - INFO - 교차 검증 시작
2025-06-24 12:03:11,317 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:03:11,335 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:03:11,768 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:03:11,768 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:03:11,768 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:03:11,768 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:03:11,768 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:03:11,768 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:03:11,768 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:03:11,768 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:03:11,768 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:03:11,939 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:03:11,939 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:03:11,939 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:03:11,939 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:03:13,200 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:03:14,160 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:03:14,160 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:03:14,166 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:03:14,197 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:03:14,197 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:03:14,197 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:03:14,197 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:03:15,474 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:03:15,687 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:03:15,687 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:03:15,856 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:03:15,857 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:03:15,883 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:03:15,883 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:03:15,883 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:03:15,883 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:03:15,883 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:15,883 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:03:15,932 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:03:15,932 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:03:15,932 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:15,932 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:15,932 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:03:15,932 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:03:15,932 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:15,998 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:03:15,998 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:03:15,998 - src.training - INFO - 모델 학습 시작
2025-06-24 12:03:16,117 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:03:16,117 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:03:16,117 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:03:16,118 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:03:16,118 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:03:16,118 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:03:16,118 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:03:16,118 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:03:16,118 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:03:16,118 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:16,118 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:03:16,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:03:16,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:16,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:03:16,195 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:03:16,259 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:03:16,323 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:03:16,385 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:03:16,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:03:16,528 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:03:16,544 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:03:16,544 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:16,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:03:16,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:16,609 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:16,609 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:03:16,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:03:16,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:16,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:03:16,627 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:03:16,642 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:03:16,658 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:03:16,674 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:03:16,690 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:03:16,708 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:03:16,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:03:16,711 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:16,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:03:16,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:16,727 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:03:16,727 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:16,728 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   n_estimators: 64
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   max_depth: 14
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   learning_rate: 0.26897381990199304
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   subsample: 0.9479678241717511
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   colsample_bytree: 0.8459061604443534
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   min_child_weight: 6
2025-06-24 12:03:16,743 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   reg_alpha: 4.861065139305967e-07
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   reg_lambda: 2.349994767382125e-07
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:03:16,744 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:03:24,739 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:03:24,739 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:03:24,740 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:03:24,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:03:24,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:24,740 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:03:24,759 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:03:24,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:03:24,788 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:03:24,802 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:03:24,817 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:03:24,834 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:03:24,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:03:24,837 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:24,842 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:03:24,876 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:03:24,876 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:03:24,877 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:03:24,877 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:03:24,877 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:03:24,877 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:03:24,877 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:03:24,877 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:03:24,880 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:03:24,884 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:03:24,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:03:24,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:03:26,096 - src.training - INFO -   precision: 0.0029427501337613697
2025-06-24 12:03:26,096 - src.training - INFO -   recall: 0.040740740740740744
2025-06-24 12:03:26,096 - src.training - INFO -   f1: 0.0054890219560878245
2025-06-24 12:03:26,096 - src.training - INFO -   accuracy: 0.9819589028695573
2025-06-24 12:03:26,096 - src.training - INFO -   balanced_accuracy: 0.5119256338860272
2025-06-24 12:03:26,096 - src.training - INFO -   positive_samples: 270
2025-06-24 12:03:26,096 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:03:26,096 - src.training - INFO -   total_samples: 220940
2025-06-24 12:03:26,096 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:03:26,096 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:03:26,096 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:03:26,096 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:03:26,096 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:03:26,098 - src.training - INFO - 모델 학습 완료
2025-06-24 12:03:26,098 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029427501337613697, 'recall': 0.040740740740740744, 'f1': 0.0054890219560878245, 'accuracy': 0.9819589028695573, 'balanced_accuracy': 0.5119256338860272, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:03:26,098 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:26,098 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:26,098 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:26,098 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:26,140 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:03:26,140 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:03:26,564 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = xgboost
2025-06-24 12:03:28,424 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:03:28,424 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:03:28,424 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:03:28,424 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:03:28,424 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:03:28,424 - src.training - INFO - 교차 검증 시작
2025-06-24 12:03:28,424 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:03:28,439 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:03:28,902 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:03:28,902 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:03:28,902 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:03:28,902 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:03:28,902 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:03:28,902 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:03:28,902 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:03:28,902 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:03:28,902 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:03:29,064 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:03:29,064 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:03:29,064 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:03:29,064 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:03:30,436 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:03:31,496 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:03:31,496 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:03:31,503 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:03:31,535 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:03:31,535 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:03:31,535 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:03:31,535 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:03:32,796 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:03:33,005 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:03:33,006 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:03:33,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:03:33,175 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:03:33,201 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:03:33,201 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:03:33,201 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:03:33,201 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:03:33,201 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:33,201 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,251 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:03:33,251 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:03:33,251 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,251 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,251 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:03:33,251 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:03:33,251 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,316 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:03:33,316 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:03:33,316 - src.training - INFO - 모델 학습 시작
2025-06-24 12:03:33,437 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:03:33,437 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:03:33,437 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:03:33,437 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:03:33,437 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:03:33,437 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:03:33,437 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:03:33,437 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:03:33,437 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:03:33,437 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,437 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:03:33,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:03:33,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:33,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:03:33,515 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:03:33,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:03:33,649 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:03:33,713 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:03:33,778 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:03:33,851 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:03:33,866 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:03:33,867 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:33,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:03:33,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,933 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:33,933 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:03:33,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:03:33,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:33,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:03:33,950 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:03:33,965 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:03:33,981 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:03:33,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:03:34,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:03:34,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:03:34,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:03:34,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:03:34,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:03:34,052 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:34,052 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:03:34,052 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:03:34,052 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   n_estimators: 817
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   max_depth: 5
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   learning_rate: 0.2872549372987892
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   subsample: 0.946399380296951
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   colsample_bytree: 0.6875166093180427
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   reg_alpha: 9.523968679277621e-06
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   reg_lambda: 1.0454594827938096e-05
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:03:34,068 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:04:10,840 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:04:10,841 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:04:10,841 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:04:10,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:04:10,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:10,841 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:04:10,860 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:04:10,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:04:10,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:04:10,903 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:04:10,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:04:10,935 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:04:10,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:04:10,938 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:10,944 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:04:11,032 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:04:11,033 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:04:11,033 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:04:11,033 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:04:11,033 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:04:11,033 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:04:11,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:04:11,033 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:04:11,036 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:04:11,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:04:11,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:04:11,041 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:04:12,256 - src.training - INFO -   precision: 0.0028229255774165954
2025-06-24 12:04:12,256 - src.training - INFO -   recall: 0.12222222222222222
2025-06-24 12:04:12,256 - src.training - INFO -   f1: 0.005518394648829431
2025-06-24 12:04:12,256 - src.training - INFO -   accuracy: 0.9461663800126732
2025-06-24 12:04:12,256 - src.training - INFO -   balanced_accuracy: 0.5346983681011868
2025-06-24 12:04:12,256 - src.training - INFO -   positive_samples: 270
2025-06-24 12:04:12,256 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:04:12,256 - src.training - INFO -   total_samples: 220940
2025-06-24 12:04:12,256 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:04:12,256 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:04:12,256 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:04:12,256 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:04:12,257 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:04:12,258 - src.training - INFO - 모델 학습 완료
2025-06-24 12:04:12,258 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0028229255774165954, 'recall': 0.12222222222222222, 'f1': 0.005518394648829431, 'accuracy': 0.9461663800126732, 'balanced_accuracy': 0.5346983681011868, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:04:12,258 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:12,258 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:12,258 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:12,258 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:12,300 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:04:12,301 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:04:12,727 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = xgboost
2025-06-24 12:04:14,459 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:04:14,459 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:04:14,459 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:04:14,459 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:04:14,459 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:04:14,459 - src.training - INFO - 교차 검증 시작
2025-06-24 12:04:14,459 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:04:14,477 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:04:14,916 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:04:14,916 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:04:14,917 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:04:14,917 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:04:14,917 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:04:14,917 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:04:14,917 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:04:14,917 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:04:14,917 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:04:15,092 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:04:15,092 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:04:15,092 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:04:15,092 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:04:16,348 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:04:17,307 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:04:17,307 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:04:17,312 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:04:17,344 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:04:17,344 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:04:17,344 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:04:17,344 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:04:18,512 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:04:18,715 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:04:18,716 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:04:18,881 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:04:18,881 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:04:18,906 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:04:18,906 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:04:18,906 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:04:18,906 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:04:18,906 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:18,906 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:04:18,952 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:04:18,952 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:04:18,952 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:18,952 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:18,952 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:04:18,952 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:04:18,952 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:19,010 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:04:19,010 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:04:19,010 - src.training - INFO - 모델 학습 시작
2025-06-24 12:04:19,126 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:04:19,126 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:04:19,127 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:04:19,127 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:04:19,127 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:04:19,127 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:04:19,127 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:04:19,127 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:04:19,127 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:04:19,127 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:19,127 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:04:19,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:04:19,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:19,127 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:04:19,193 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:04:19,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:04:19,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:04:19,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:04:19,410 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:04:19,477 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:04:19,492 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:04:19,492 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:19,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:04:19,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:19,563 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:19,563 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:04:19,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:04:19,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:19,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:04:19,581 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:04:19,594 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:04:19,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:04:19,621 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:04:19,635 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:04:19,652 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:04:19,654 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:04:19,654 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:19,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:04:19,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:19,670 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:04:19,670 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:19,670 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   n_estimators: 368
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   max_depth: 9
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   learning_rate: 0.01403022185431942
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   subsample: 0.6368269783727365
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   colsample_bytree: 0.7739368863893092
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   min_child_weight: 10
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   reg_alpha: 0.00034956888667435034
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   reg_lambda: 7.2836712531830345
2025-06-24 12:04:19,685 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:04:19,686 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:04:19,686 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:04:50,807 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:04:50,807 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:04:50,808 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:04:50,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:04:50,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:50,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:04:50,826 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:04:50,843 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:04:50,860 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:04:50,877 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:04:50,894 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:04:50,913 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:04:50,916 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:04:50,916 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:50,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:04:51,020 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:04:51,020 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:04:51,020 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:04:51,020 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:04:51,020 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:04:51,020 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:04:51,020 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:04:51,020 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:04:51,025 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:04:51,029 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:04:51,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:04:51,030 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:04:52,393 - src.training - INFO -   precision: 0.0029231024746719813
2025-06-24 12:04:52,393 - src.training - INFO -   recall: 0.32592592592592595
2025-06-24 12:04:52,394 - src.training - INFO -   f1: 0.005794238683127572
2025-06-24 12:04:52,394 - src.training - INFO -   accuracy: 0.863315832352675
2025-06-24 12:04:52,394 - src.training - INFO -   balanced_accuracy: 0.5949496399013778
2025-06-24 12:04:52,394 - src.training - INFO -   positive_samples: 270
2025-06-24 12:04:52,394 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:04:52,394 - src.training - INFO -   total_samples: 220940
2025-06-24 12:04:52,394 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:04:52,394 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:04:52,394 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:04:52,394 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:04:52,394 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:04:52,395 - src.training - INFO - 모델 학습 완료
2025-06-24 12:04:52,395 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0029231024746719813, 'recall': 0.32592592592592595, 'f1': 0.005794238683127572, 'accuracy': 0.863315832352675, 'balanced_accuracy': 0.5949496399013778, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:04:52,395 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:52,395 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:52,395 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:52,395 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:52,440 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:04:52,440 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:04:52,878 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = xgboost
2025-06-24 12:04:54,806 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:04:54,806 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:04:54,806 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:04:54,806 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:04:54,806 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:04:54,806 - src.training - INFO - 교차 검증 시작
2025-06-24 12:04:54,806 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:04:54,823 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:04:55,289 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:04:55,289 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:04:55,289 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:04:55,289 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:04:55,289 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:04:55,289 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:04:55,289 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:04:55,289 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:04:55,289 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:04:55,439 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:04:55,439 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:04:55,439 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:04:55,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:04:56,831 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:04:57,898 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:04:57,898 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:04:57,903 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:04:57,926 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:04:57,926 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:04:57,926 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:04:57,926 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:04:59,213 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:04:59,470 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:04:59,470 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:04:59,639 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:04:59,639 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:04:59,682 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:04:59,683 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:04:59,683 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:04:59,683 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:04:59,683 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:59,683 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:04:59,732 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:04:59,732 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:04:59,732 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:59,732 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:59,732 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:04:59,732 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:04:59,732 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:59,798 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:04:59,798 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:04:59,798 - src.training - INFO - 모델 학습 시작
2025-06-24 12:04:59,918 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:04:59,918 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:04:59,918 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:04:59,918 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:04:59,918 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:04:59,918 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:04:59,918 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:04:59,918 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:04:59,918 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:04:59,918 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:04:59,918 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:04:59,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:04:59,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:04:59,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:04:59,996 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:00,062 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:00,132 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:00,196 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:00,261 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:00,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:00,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:05:00,351 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:00,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:05:00,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:00,422 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:00,422 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:05:00,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:05:00,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:00,422 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:00,440 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:00,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:00,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:00,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:00,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:00,520 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:00,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:05:00,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:05:00,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:00,537 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:05:00,537 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:00,537 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:05:00,554 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   n_estimators: 87
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   max_depth: 10
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   learning_rate: 0.14838612867103765
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   subsample: 0.9008350347657071
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9775459227481438
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   min_child_weight: 2
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   reg_alpha: 9.113466045631422e-07
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   reg_lambda: 7.312530887641833e-08
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:05:00,555 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:05:08,296 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:05:08,296 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:05:08,301 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:05:08,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:05:08,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:08,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:08,321 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:08,335 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:08,350 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:08,364 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:08,379 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:08,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:08,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:05:08,400 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:08,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:05:08,432 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:05:08,432 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:05:08,432 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:05:08,432 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:05:08,432 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:08,432 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:05:08,432 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:05:08,432 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:05:08,436 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:05:08,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:05:08,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:05:08,440 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:05:09,658 - src.training - INFO -   precision: 0.003196089490505734
2025-06-24 12:05:09,658 - src.training - INFO -   recall: 0.1259259259259259
2025-06-24 12:05:09,658 - src.training - INFO -   f1: 0.0062339567290062336
2025-06-24 12:05:09,658 - src.training - INFO -   accuracy: 0.9509369059473161
2025-06-24 12:05:09,658 - src.training - INFO -   balanced_accuracy: 0.5389361355736486
2025-06-24 12:05:09,658 - src.training - INFO -   positive_samples: 270
2025-06-24 12:05:09,658 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:05:09,658 - src.training - INFO -   total_samples: 220940
2025-06-24 12:05:09,658 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:05:09,658 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:05:09,658 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:05:09,658 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:05:09,659 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:05:09,660 - src.training - INFO - 모델 학습 완료
2025-06-24 12:05:09,660 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.003196089490505734, 'recall': 0.1259259259259259, 'f1': 0.0062339567290062336, 'accuracy': 0.9509369059473161, 'balanced_accuracy': 0.5389361355736486, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:05:09,660 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:09,660 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:09,660 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:09,660 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:09,703 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:05:09,703 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:05:10,140 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = xgboost
2025-06-24 12:05:11,873 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:05:11,873 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:05:11,873 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:05:11,873 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:05:11,873 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:05:11,873 - src.training - INFO - 교차 검증 시작
2025-06-24 12:05:11,873 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 12:05:11,890 - src.splits - INFO - 그룹 K-Fold 분할: 228,938개 ID를 5개 폴드로 분할
2025-06-24 12:05:12,322 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 12:05:12,323 - src.splits - INFO -   - 훈련 데이터: 1,067,012 행 (183,151개 ID)
2025-06-24 12:05:12,323 - src.splits - INFO -   - 검증 데이터: 266,753 행 (45,787개 ID)
2025-06-24 12:05:12,323 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 12:05:12,323 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 12:05:12,323 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 12:05:12,323 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:05:12,323 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:05:12,323 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:05:12,487 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:05:12,487 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:05:12,487 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:05:12,487 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:05:13,746 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:05:14,710 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:05:14,710 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:05:14,715 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:05:14,737 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:05:14,737 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:05:14,737 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:05:14,737 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:15,890 - src.preprocessing - INFO - 데이터 변환 완료: (1067012, 33)
2025-06-24 12:05:16,125 - src.preprocessing - INFO - 데이터 변환 완료: (266753, 33)
2025-06-24 12:05:16,125 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:16,287 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:16,287 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:16,331 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:16,331 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:16,331 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:16,331 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:05:16,331 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:16,331 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,376 - src.training - INFO - [DEBUG] X_train shape: (1067012, 6), y_train shape: (1067012, 1)
2025-06-24 12:05:16,376 - src.training - INFO - [DEBUG] X_val shape: (266753, 6), y_val shape: (266753, 1)
2025-06-24 12:05:16,376 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,376 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,376 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 12:05:16,376 - src.training - INFO - [DEBUG] X_train_resampled shape: (1067012, 6), y_train_resampled shape: (1067012, 1)
2025-06-24 12:05:16,376 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,435 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:05:16,435 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 882743, (1.0,): 1032}
2025-06-24 12:05:16,435 - src.training - INFO - 모델 학습 시작
2025-06-24 12:05:16,551 - src.training - INFO - 결측 타겟 제거: train 1067012->883775, val 266753->220940
2025-06-24 12:05:16,552 - src.training - INFO - 모델 타입: xgboost
2025-06-24 12:05:16,552 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:05:16,552 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:05:16,552 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:05:16,552 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:05:16,552 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:05:16,552 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:05:16,552 - src.models.xgboost_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 12:05:16,552 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,552 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (883775, 6)
2025-06-24 12:05:16,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (883775, 6)
2025-06-24 12:05:16,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:16,552 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:16,619 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:16,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:16,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:16,781 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:16,838 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:16,904 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:16,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (883775, 6)
2025-06-24 12:05:16,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (883775, 6), y shape: (883775, 1)
2025-06-24 12:05:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,997 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:16,997 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (883775, 6)
2025-06-24 12:05:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:05:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:17,014 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:17,027 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:17,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:17,054 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:17,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:17,085 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:17,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:05:17,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:17,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6), y shape: (220940, 1)
2025-06-24 12:05:17,101 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:17,101 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X_val shape: (220940, 6)
2025-06-24 12:05:17,101 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:17,101 - src.models.xgboost_model - INFO - 타겟 suicide_a_next_year 모델 학습 중...
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   - scale_pos_weight: 855.37
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO - === suicide_a_next_year 모델 파라미터 ===
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   n_estimators: 472
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   max_depth: 4
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   learning_rate: 0.07379150167549546
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   subsample: 0.6101796244957102
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   colsample_bytree: 0.9443705506106336
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   min_child_weight: 1
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   scale_pos_weight: 855.3711240310078
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   early_stopping_rounds: 10
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   verbose: 0
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   n_jobs: 28
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   use_focal_loss: False
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   focal_loss: {'alpha': 0.25, 'gamma': 2.0}
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   reg_alpha: 5.303459491952345
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   reg_lambda: 0.001258846993140358
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   objective: binary:logistic
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO -   eval_metric: logloss
2025-06-24 12:05:17,119 - src.models.xgboost_model - INFO - model 인스턴스 타입: <class 'xgboost.sklearn.XGBClassifier'>
2025-06-24 12:05:28,750 - src.models.xgboost_model - INFO -   - suicide_a_next_year 모델 학습 완료
2025-06-24 12:05:28,750 - src.models.xgboost_model - INFO - 모든 모델 학습 완료 (1개)
2025-06-24 12:05:28,755 - src.models.xgboost_model - INFO - XGBoost 모델 예측 시작
2025-06-24 12:05:28,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (220940, 6)
2025-06-24 12:05:28,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:28,755 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:28,774 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:28,790 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:28,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:28,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:28,840 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:28,858 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:28,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (220940, 6)
2025-06-24 12:05:28,861 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:28,865 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (220940, 6)
2025-06-24 12:05:28,885 - src.models.xgboost_model - INFO -   - suicide_a_next_year 예측 완료
2025-06-24 12:05:28,885 - src.models.xgboost_model - INFO - 예측 완료: (220940, 1)
2025-06-24 12:05:28,885 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 12:05:28,885 - src.training - INFO - y_true shape: (220940, 1), y_pred shape: (220940, 1)
2025-06-24 12:05:28,885 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 12:05:28,885 - src.training - INFO - y_pred columns: ['suicide_a_next_year']
2025-06-24 12:05:28,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 12:05:28,885 - src.training - INFO -   접두사 제거 매칭: suicide_a_next_year
2025-06-24 12:05:28,889 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 220940
2025-06-24 12:05:28,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0 1.0]
2025-06-24 12:05:28,894 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0 1]
2025-06-24 12:05:28,894 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 12:05:30,263 - src.training - INFO -   precision: 0.00274861288945796
2025-06-24 12:05:30,263 - src.training - INFO -   recall: 0.5962962962962963
2025-06-24 12:05:30,263 - src.training - INFO -   f1: 0.005472002719007562
2025-06-24 12:05:30,263 - src.training - INFO -   accuracy: 0.7351181316194442
2025-06-24 12:05:30,263 - src.training - INFO -   balanced_accuracy: 0.6657921414413008
2025-06-24 12:05:30,263 - src.training - INFO -   positive_samples: 270
2025-06-24 12:05:30,263 - src.training - INFO -   negative_samples: 220670
2025-06-24 12:05:30,263 - src.training - INFO -   total_samples: 220940
2025-06-24 12:05:30,263 - src.training - INFO -   positive_ratio: 0.0012220512356295827
2025-06-24 12:05:30,263 - src.training - INFO -   roc_auc: 0.0
2025-06-24 12:05:30,263 - src.training - INFO -   pr_auc: 0.0
2025-06-24 12:05:30,263 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 12:05:30,263 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 12:05:30,264 - src.training - INFO - 모델 학습 완료
2025-06-24 12:05:30,264 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.00274861288945796, 'recall': 0.5962962962962963, 'f1': 0.005472002719007562, 'accuracy': 0.7351181316194442, 'balanced_accuracy': 0.6657921414413008, 'positive_samples': 270, 'negative_samples': 220670, 'total_samples': 220940, 'positive_ratio': 0.0012220512356295827, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 12:05:30,264 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:30,264 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:30,264 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:30,264 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:30,309 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 12:05:30,309 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 12:05:30,745 - src.hyperparameter_tuning - WARNING - 유효하지 않은 best_score: -inf
2025-06-24 12:05:30,749 - src.hyperparameter_tuning - INFO - 최적화 완료!
2025-06-24 12:05:30,749 - src.hyperparameter_tuning - INFO -   - 최고 성능: 0.0000
2025-06-24 12:05:30,749 - src.hyperparameter_tuning - INFO -   - 최적 파라미터: {'n_estimators': 406, 'max_depth': 15, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893, 'scale_pos_weight': 3.027182927734624}
2025-06-24 12:05:32,610 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 12:05:32,610 - src.splits - INFO -   - 전체 데이터: 1,569,071 행
2025-06-24 12:05:32,610 - src.splits - INFO -   - 훈련/검증 데이터: 1,333,765 행
2025-06-24 12:05:32,610 - src.splits - INFO -   - 테스트 데이터: 235,306 행
2025-06-24 12:05:32,610 - src.splits - INFO -   - 테스트 ID 수: 40,401개
2025-06-24 12:05:32,610 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 12:05:32,610 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 12:05:32,610 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 12:05:32,811 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:32,811 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:32,811 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 12:05:32,811 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 12:05:32,812 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 12:05:32,812 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 12:05:32,812 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 12:05:32,812 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 12:05:32,812 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 12:05:32,812 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 12:05:34,531 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 12:05:35,860 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 12:05:35,860 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 12:05:37,207 - src.preprocessing - INFO - 데이터 변환 완료: (1333765, 33)
2025-06-24 12:05:37,207 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 12:05:37,411 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 12:05:37,411 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 12:05:37,411 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 12:05:37,411 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 12:05:37,411 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 12:05:37,612 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 12:05:37,613 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 12:05:37,662 - src.models.model_factory - INFO - 모델 타입 'xgboost'으로 모델을 생성합니다.
2025-06-24 12:05:37,662 - src.models.base_model - INFO - XGBOOST 모델 초기화 완료
2025-06-24 12:05:37,662 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 12:05:37,662 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 12:05:37,662 - src.models.xgboost_model - INFO -   - Focal Loss 사용: False
2025-06-24 12:05:37,662 - src.models.xgboost_model - INFO - XGBoost 모델 학습 시작
2025-06-24 12:05:37,662 - src.models.xgboost_model - INFO - Early Stopping 비활성화
2025-06-24 12:05:37,662 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 X shape: (1333765, 6)
2025-06-24 12:05:37,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (1333765, 6)
2025-06-24 12:05:37,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:37,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 12:05:37,777 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 12:05:37,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 12:05:37,975 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 12:05:38,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 12:05:38,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 12:05:38,269 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 12:05:38,283 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (1333765, 6)
2025-06-24 12:05:38,283 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 12:05:38,299 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (1333765, 6)
2025-06-24 12:05:38,299 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 X shape: (1333765, 6)
2025-06-24 12:05:38,299 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 전 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 12:05:38,299 - src.models.xgboost_model - INFO - [DEBUG] _validate_input_data 호출 후 y 컬럼: []
2025-06-24 12:05:38,299 - src.models.xgboost_model - INFO - 사용 가능한 타겟 컬럼: []
2025-06-24 12:05:38,299 - src.models.xgboost_model - ERROR - y 데이터프레임에 컬럼이 없습니다! 타겟 컬럼 매칭을 확인하세요.
2025-06-24 12:05:38,300 - src.models.base_model - INFO - 모델이 models/best_tuned_model.joblib에 저장되었습니다.
2025-06-24 12:05:38,300 - src.hyperparameter_tuning - INFO - 최고 모델 저장 완료: models/best_tuned_model.joblib
2025-06-24 12:05:39,053 - src.hyperparameter_tuning - INFO - Study 저장 완료: models/optuna_study.pkl
2025-06-24 12:05:39,333 - matplotlib.legend - WARNING - No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
2025-06-24 12:05:39,484 - __main__ - INFO - === 하이퍼파라미터 튜닝 완료 ===
2025-06-24 12:05:39,484 - __main__ - INFO - 최고 성능: 0.0000
2025-06-24 12:05:39,484 - __main__ - INFO - 최적 파라미터:
2025-06-24 12:05:39,484 - __main__ - INFO -   n_estimators: 406
2025-06-24 12:05:39,484 - __main__ - INFO -   max_depth: 15
2025-06-24 12:05:39,484 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 12:05:39,484 - __main__ - INFO -   subsample: 0.8394633936788146
2025-06-24 12:05:39,484 - __main__ - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 12:05:39,484 - __main__ - INFO -   min_child_weight: 2
2025-06-24 12:05:39,484 - __main__ - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 12:05:39,484 - __main__ - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 12:05:39,484 - __main__ - INFO -   scale_pos_weight: 3.027182927734624

==================================================
튜닝 결과 요약
==================================================
모델 타입: xgboost
실험 타입: hyperparameter_tuning
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/8c40817daf4b491796e27834103c5a4f
최고 성능: 0.0
최적 파라미터: {'n_estimators': 406, 'max_depth': 15, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893, 'scale_pos_weight': 3.027182927734624}
튜닝 시간: N/A
==================================================
2025-06-24 12:05:39,484 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_120539.txt에 저장되었습니다.
2025-06-24 12:05:39,484 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 12:05:39,484 - __main__ - INFO - MLflow Run ID: 8c40817daf4b491796e27834103c5a4f
2025-06-24 12:05:39,484 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/8c40817daf4b491796e27834103c5a4f
