2025-06-24 09:37:16,779 - src.hyperparameter_tuning - INFO - MLflow 실험 설정: hyperparameter_tuning (ID: 765186397364671153)
2025-06-24 09:37:16,779 - src.hyperparameter_tuning - INFO - 데이터 로드 중: data/processed/processed_data_with_features.csv
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO - 테스트용 데이터 로드: 1,000 행
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO - 튜닝 설정 - 시도 횟수: 100, 타임아웃: 3600초
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO - 하이퍼파라미터 튜너 초기화 완료
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO -   - 튜닝 설정: {'data': {'file_path': 'data/processed_data.csv', 'encoding': 'utf-8', 'na_values': ['', 'nan', 'NaN', 'NULL', 'null']}, 'features': {'target_columns': ['suicide_a_next_year'], 'exclude_columns': ['id', 'patient_id', 'visit_date', 'visit_year'], 'categorical_columns': ['gender', 'marital_status', 'education_level', 'income_level', 'residence_type', 'insurance_type', 'primary_diagnosis', 'comorbidity', 'medication_type', 'treatment_type', 'follow_up_status'], 'selected_features': ['age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score'], 'validation': {'scope': 'sample', 'sample_size': 10}, 'enable_feature_engineering': False, 'enable_lagged_features': False, 'lag_periods': [1, 2, 3], 'lagged_features': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}, 'enable_rolling_stats': False, 'rolling_stats': {'window_sizes': [2, 3], 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp']}}, 'preprocessing': {'time_series_imputation': {'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp'], 'fallback_strategy': 'mean'}, 'numerical_imputation': {'strategy': 'mean', 'columns': ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']}, 'categorical_imputation': {'strategy': 'most_frequent', 'columns': ['sex']}, 'categorical_encoding': {'method': 'ordinal'}, 'missing_value_strategy': 'median', 'outlier_detection': {'method': 'iqr', 'threshold': 1.5}, 'scaling': {'method': 'robust', 'with_mean': True, 'with_std': True}, 'feature_selection': {'method': 'variance_threshold', 'threshold': 0.01}}, 'data_split': {'test_ids_ratio': 0.15, 'random_state': 42, 'method': 'stratified_kfold', 'n_splits': 5, 'test_size': 0.2, 'val_size': 0.2}, 'validation': {'strategy': 'group_kfold', 'num_cv_folds': 3, 'test_size': 0.15, 'random_state': 42, 'val_ids_ratio': 0.15, 'validation_start_year': 2021, 'min_train_years': 3, 'max_train_years': 8}, 'time_series': {'date_column': 'dov', 'year_column': 'yov', 'id_column': 'id'}, 'evaluation': {'regression_metrics': ['mae', 'rmse', 'r2'], 'classification_metrics': ['precision', 'recall', 'f1', 'roc_auc', 'balanced_accuracy'], 'cv_metrics': ['accuracy', 'f1', 'auc', 'rmse', 'r2'], 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True, 'primary_metric': 'f1_score', 'secondary_metrics': ['recall', 'precision', 'balanced_accuracy', 'roc_auc'], 'cv': {'strategy': 'group_kfold', 'n_folds': 5, 'shuffle': False}}, 'training': {'early_stopping': True, 'patience': 10, 'handle_imbalance': True, 'save_best_model': True, 'model_save_path': 'models/'}, 'logging': {'log_splits_info': True, 'log_fold_details': True, 'level': 'INFO', 'format': '%(asctime)s - %(name)s - %(levelname)s - %(message)s', 'file': 'logs/experiment.log'}, 'output': {'directory': 'results', 'save_model': True, 'save_predictions': True, 'save_feature_importance': True, 'save_confusion_matrix': True, 'save_roc_curve': True, 'save_precision_recall_curve': True}, 'mlflow': {'experiment_name': 'hyperparameter_tuning', 'experiment_description': '자살 위험 예측 모델 실험', 'tags': ['suicide_prediction', 'healthcare', 'classification', 'regression'], 'nested_runs': True, 'save_artifacts': True, 'log_params': True, 'log_metrics': True, 'log_model': True, 'tracking': {'tracking_uri': 'file:./mlruns', 'experiment_name': 'suicide_prediction', 'nested_runs': True, 'artifact_location': './mlruns'}, 'logging': {'param_logging_level': 'INFO', 'metric_logging_level': 'INFO', 'artifact_logging_level': 'INFO', 'log_experiment_info': True, 'log_fold_results': True, 'log_model_info': True}, 'log_optimization': True}, 'model': {'model_type': 'lightgbm', 'lightgbm': {'num_leaves': 31, 'learning_rate': 0.1, 'feature_fraction': 0.9, 'bagging_fraction': 0.8, 'bagging_freq': 5, 'min_data_in_leaf': 20, 'min_sum_hessian_in_leaf': '1e-3', 'lambda_l1': 0.1, 'lambda_l2': 0.1, 'num_threads': 28, 'verbose': -1, 'early_stopping_rounds': 10, 'max_cat_threshold': 32, 'cat_smooth': 10.0, 'cat_l2': 10.0, 'is_unbalance': True, 'scale_pos_weight': 1.0, 'class_weight': 'balanced', 'boosting_type': 'gbdt', 'objective': 'binary', 'metric': 'binary_logloss', 'max_depth': 6, 'min_gain_to_split': 0.0, 'min_child_samples': 20, 'bagging_seed': 42, 'feature_fraction_seed': 42, 'drop_seed': 42, 'data_random_seed': 42, 'use_focal_loss': False, 'focal_loss': {'alpha': 0.25, 'gamma': 2.0}}}, 'imbalanced_data': {'resampling': {'enabled': False, 'method': 'smote', 'smote': {'k_neighbors': 5, 'sampling_strategy': 'auto'}, 'borderline_smote': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'm_neighbors': 10}, 'adasyn': {'k_neighbors': 5, 'sampling_strategy': 'auto', 'n_neighbors': 5}, 'under_sampling': {'strategy': 'random', 'sampling_strategy': 'auto'}}, 'class_weight': 'balanced', 'scale_pos_weight': 1.0, 'is_unbalance': True}, 'experiment': {'name': 'hyperparameter_tuning_experiment', 'description': 'Optuna 기반 하이퍼파라미터 최적화 실험', 'tags': ['hyperparameter_tuning', 'optuna', 'optimization']}, 'tuning': {'direction': 'maximize', 'n_trials': 50, 'n_jobs': 1, 'early_stopping': {'enabled': True, 'patience': 20, 'min_trials': 30}}, 'sampler': {'type': 'tpe', 'tpe': {'n_startup_trials': 10, 'n_ei_candidates': 24, 'multivariate': True, 'group': False}, 'cmaes': {'x0': {'n_estimators': 100, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8, 'min_child_weight': 1, 'reg_alpha': 0.1, 'reg_lambda': 1.0}, 'sigma0': 0.1}}, 'xgboost_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 15, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'scale_pos_weight': {'type': 'float', 'low': 0.5, 'high': 10.0, 'log': True}}, 'lightgbm_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 1000, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 12, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'colsample_bytree': {'type': 'float', 'low': 0.6, 'high': 1.0, 'log': False}, 'min_child_weight': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'reg_alpha': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}, 'reg_lambda': {'type': 'float', 'low': '1e-8', 'high': 10.0, 'log': True}}, 'catboost_params': {'iterations': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'depth': {'type': 'int', 'low': 3, 'high': 10, 'log': False}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'l2_leaf_reg': {'type': 'float', 'low': 1, 'high': 10, 'log': True}, 'border_count': {'type': 'int', 'low': 32, 'high': 255, 'log': False}, 'bagging_temperature': {'type': 'float', 'low': 0.1, 'high': 1.0, 'log': False}, 'random_strength': {'type': 'float', 'low': 0.1, 'high': 10.0, 'log': True}}, 'random_forest_params': {'n_estimators': {'type': 'int', 'low': 50, 'high': 500, 'log': False}, 'max_depth': {'type': 'int', 'low': 3, 'high': 20, 'log': False}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20, 'log': False}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10, 'log': False}, 'max_features': {'type': 'categorical', 'choices': ['sqrt', 'log2', 'auto']}}, 'results': {'save_best_model': True, 'model_save_path': 'models/best_tuned_model.joblib', 'save_study': True, 'study_save_path': 'models/optuna_study.pkl', 'create_plots': True, 'plots_save_path': 'data/tuning_results/'}}
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO -   - 튜닝 횟수: 100
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO -   - 타임아웃: 3600초
2025-06-24 09:37:16,784 - __main__ - INFO - 하이퍼파라미터 최적화 실행 중...
2025-06-24 09:37:16,784 - src.hyperparameter_tuning - INFO - === 하이퍼파라미터 튜닝 시작 ===
2025-06-24 09:37:16,785 - src.hyperparameter_tuning - INFO - Trial 0: 모델 타입 = lightgbm
2025-06-24 09:37:16,789 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:16,789 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:16,790 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:16,790 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:16,790 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:16,790 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:16,790 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:16,790 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:16,790 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:16,791 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:16,791 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:16,791 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:16,791 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:16,791 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:16,791 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:16,791 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:16,791 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:16,791 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:16,792 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:16,792 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:16,792 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:16,792 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:16,797 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:16,799 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,799 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:16,799 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:16,799 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:16,799 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:16,799 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:16,799 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,801 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,803 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:16,803 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,803 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,803 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,803 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,803 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,803 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:16,803 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,804 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,804 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,804 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:16,805 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:16,805 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,805 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:16,805 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:16,805 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:16,805 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:16,805 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:16,805 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:16,805 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,805 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:16,805 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:16,805 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:16,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:16,805 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,806 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,806 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,806 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,807 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:16,808 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,808 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   n_estimators: 406
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   subsample: 0.8394633936788146
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6245760287469893
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:16,809 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:16,818 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:16,818 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:16,818 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:16,818 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:16,818 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:16,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,818 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,819 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,820 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,820 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:16,820 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:16,820 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:16,820 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:16,820 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:16,820 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,820 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,820 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:16,820 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:16,821 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:16,821 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:16,821 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:16,821 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:16,821 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,821 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,822 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,822 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,822 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:16,822 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:16,822 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:16,822 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:16,822 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:16,822 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:16,822 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:16,822 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:16,822 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:16,822 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:16,822 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,822 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,822 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,822 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,825 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:16,825 - src.hyperparameter_tuning - ERROR - Trial 0 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:16,826 - src.hyperparameter_tuning - INFO - Trial 1: 모델 타입 = lightgbm
2025-06-24 09:37:16,829 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:16,830 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:16,830 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:16,830 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:16,830 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:16,830 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:16,830 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:16,830 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:16,830 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:16,831 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:16,831 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:16,831 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:16,831 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:16,831 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:16,831 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:16,831 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:16,831 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:16,831 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:16,832 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:16,832 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:16,832 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:16,832 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:16,836 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:16,838 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,838 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:16,838 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:16,838 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:16,839 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:16,839 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:16,839 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,841 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,843 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:16,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,843 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,843 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,843 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:16,843 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,844 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,844 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,844 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:16,845 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:16,845 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,845 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:16,845 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:16,845 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:16,845 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:16,845 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:16,845 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:16,845 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,845 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:16,845 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:16,845 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:16,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:16,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,845 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,845 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:16,846 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,847 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,848 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,848 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,848 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:16,848 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,848 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,848 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,848 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:16,848 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   learning_rate: 0.010725209743171997
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   n_estimators: 621
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   subsample: 0.9879639408647978
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9329770563201687
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   reg_alpha: 4.329370014459266e-07
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO -   reg_lambda: 4.4734294104626844e-07
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:16,849 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:16,852 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:16,852 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:16,852 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:16,852 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:16,852 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:16,852 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,852 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,852 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,852 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,852 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,853 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:16,858 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:16,858 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:16,858 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:16,858 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:16,858 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,858 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,858 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:16,858 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:16,858 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:16,858 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:16,858 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:16,858 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:16,858 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,859 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,859 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,859 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,859 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:16,859 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:16,859 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:16,859 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:16,859 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:16,859 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:16,859 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:16,860 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:16,860 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:16,860 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:16,860 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,860 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,860 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,860 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,862 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:16,862 - src.hyperparameter_tuning - ERROR - Trial 1 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:16,863 - src.hyperparameter_tuning - INFO - Trial 2: 모델 타입 = lightgbm
2025-06-24 09:37:16,867 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:16,867 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:16,867 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:16,867 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:16,867 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:16,867 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:16,867 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:16,867 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:16,867 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:16,868 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:16,868 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:16,868 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:16,868 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:16,868 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:16,868 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:16,868 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:16,868 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:16,868 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:16,869 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:16,869 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:16,869 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:16,869 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:16,873 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:16,875 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,875 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:16,875 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:16,875 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:16,875 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:16,875 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:16,875 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,877 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,879 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:16,879 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,879 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,879 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,879 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,879 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,879 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,879 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:16,879 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,879 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,880 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:16,880 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:16,880 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,880 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,880 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:16,880 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:16,880 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,880 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,880 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,880 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:16,881 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:16,881 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,881 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:16,881 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:16,881 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:16,881 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:16,881 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:16,881 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:16,881 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,881 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:16,881 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:16,881 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:16,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:16,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,882 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,883 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:16,884 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,884 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,884 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,884 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   learning_rate: 0.04345454109729477
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   n_estimators: 339
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   subsample: 0.7164916560792167
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8447411578889518
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   reg_alpha: 4.258943089524393e-06
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9826980964985924e-05
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:16,885 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:16,888 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:16,888 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:16,888 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:16,888 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:16,888 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:16,888 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,888 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,888 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,889 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,890 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:16,892 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:16,892 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:16,892 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:16,892 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:16,892 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,892 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,892 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:16,892 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:16,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:16,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:16,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:16,893 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:16,893 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,893 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,893 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,894 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,894 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:16,894 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:16,894 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:16,894 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:16,894 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:16,894 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:16,894 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:16,894 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:16,894 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:16,894 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:16,894 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,894 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,894 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,894 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,896 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:16,897 - src.hyperparameter_tuning - ERROR - Trial 2 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:16,898 - src.hyperparameter_tuning - INFO - Trial 3: 모델 타입 = lightgbm
2025-06-24 09:37:16,901 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:16,902 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:16,902 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:16,902 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:16,902 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:16,902 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:16,902 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:16,902 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:16,902 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:16,902 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:16,902 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:16,902 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:16,902 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:16,902 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:16,903 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:16,903 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:16,903 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:16,903 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:16,903 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,903 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,904 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,904 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,904 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,904 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:16,904 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:16,904 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:16,904 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:16,904 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:16,907 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:16,909 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,909 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:16,909 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:16,909 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:16,909 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:16,909 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:16,909 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,912 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,914 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:16,914 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,914 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,914 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,914 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,914 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,914 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:16,914 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,915 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,915 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,915 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:16,916 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:16,916 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,916 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:16,916 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:16,916 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:16,916 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:16,916 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:16,916 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:16,916 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,916 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:16,916 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:16,916 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:16,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:16,916 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,917 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,918 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:16,919 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,919 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,919 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,919 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:16,919 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   learning_rate: 0.019721610970574007
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   subsample: 0.8056937753654446
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.836965827544817
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0029369981104377003
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO -   reg_lambda: 3.425445902633376e-07
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:16,920 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:16,923 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:16,923 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:16,923 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:16,923 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:16,923 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:16,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,923 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,923 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,924 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:16,930 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:16,930 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:16,930 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:16,930 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:16,930 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,930 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:16,930 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:16,930 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:16,931 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:16,931 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:16,931 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:16,931 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,931 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,931 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,932 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,932 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:16,932 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:16,932 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:16,932 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:16,932 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:16,932 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:16,932 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:16,932 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:16,932 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:16,932 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:16,932 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,932 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,932 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,932 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,935 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:16,935 - src.hyperparameter_tuning - ERROR - Trial 3 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:16,936 - src.hyperparameter_tuning - INFO - Trial 4: 모델 타입 = lightgbm
2025-06-24 09:37:16,939 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:16,940 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:16,940 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:16,940 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:16,940 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:16,940 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:16,940 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:16,940 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:16,940 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:16,941 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:16,941 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:16,941 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:16,941 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:16,941 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:16,941 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:16,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:16,941 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:16,941 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:16,942 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:16,942 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:16,942 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:16,942 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:16,946 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:16,948 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,948 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:16,948 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:16,948 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:16,948 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:16,948 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:16,948 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,950 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,952 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:16,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,952 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,952 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,953 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:16,953 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:16,953 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,953 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,953 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,953 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:16,954 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:16,954 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,954 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:16,954 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:16,954 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:16,954 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:16,954 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:16,954 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:16,954 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,954 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:16,954 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:16,954 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:16,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:16,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:16,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:16,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,957 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,957 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,957 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:16,957 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   learning_rate: 0.26690431824362526
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   subsample: 0.9233589392465844
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7218455076693483
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   reg_alpha: 0.014391207615728067
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO -   reg_lambda: 9.148975058772307e-05
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:16,958 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:16,961 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:16,961 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:16,961 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:16,961 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:16,962 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,962 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,963 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,963 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,963 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:16,969 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:16,969 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:16,969 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:16,969 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:16,969 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,969 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,969 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:16,969 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:16,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:16,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:16,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:16,970 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:16,970 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,970 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,971 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,971 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:16,971 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:16,971 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:16,971 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:16,971 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:16,971 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:16,971 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:16,971 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:16,971 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:16,971 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:16,971 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:16,971 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,971 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,971 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,971 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,974 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:16,974 - src.hyperparameter_tuning - ERROR - Trial 4 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:16,975 - src.hyperparameter_tuning - INFO - Trial 5: 모델 타입 = lightgbm
2025-06-24 09:37:16,979 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:16,980 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:16,980 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:16,980 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:16,980 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:16,980 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:16,980 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:16,980 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:16,980 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:16,980 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:16,980 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:16,980 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:16,980 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:16,980 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:16,980 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:16,980 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:16,981 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:16,981 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:16,981 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,982 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,982 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:16,982 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:16,982 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,982 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:16,982 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:16,982 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:16,982 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:16,982 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:16,985 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:16,987 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,987 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:16,987 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:16,987 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:16,987 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:16,987 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:16,987 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:16,989 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:16,991 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:16,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,991 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:16,992 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:16,992 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,992 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:16,992 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,993 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,993 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:16,993 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:16,994 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:16,994 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:16,994 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:16,994 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:16,994 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:16,994 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:16,994 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:16,994 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:16,994 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,994 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:16,994 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:16,994 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:16,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:16,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,994 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:16,995 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:16,996 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:16,997 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:16,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:16,997 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:16,997 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   learning_rate: 0.011240768803005551
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:16,997 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   n_estimators: 166
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   subsample: 0.9637281608315128
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7035119926400067
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   reg_alpha: 6.388511557344611e-06
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0004793052550782129
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:16,998 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,001 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,001 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,001 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,001 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,001 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,001 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,001 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,001 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,002 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,002 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,002 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,002 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,008 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,008 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,008 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,008 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,008 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,008 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,008 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,008 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,009 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,009 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,009 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,009 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,009 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,009 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,010 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,010 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,010 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,010 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,010 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,010 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,010 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,010 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,010 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,010 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,010 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,010 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,010 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,010 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,010 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,011 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,013 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,013 - src.hyperparameter_tuning - ERROR - Trial 5 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,014 - src.hyperparameter_tuning - INFO - Trial 6: 모델 타입 = lightgbm
2025-06-24 09:37:17,018 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,018 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,018 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,018 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,018 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,018 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,018 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,018 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,019 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,019 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,019 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,019 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,019 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,019 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,019 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,019 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,019 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,019 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,020 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,020 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,020 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,020 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,024 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,026 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,026 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,026 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,026 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,026 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,026 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,026 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,028 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,030 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,030 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,030 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,030 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,030 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,030 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,030 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,031 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,031 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,031 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,031 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,031 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,031 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,031 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,032 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,032 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,032 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,032 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,033 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,033 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,033 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,033 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,033 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,033 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,033 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,033 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,033 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,033 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,033 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,033 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,033 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,034 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,035 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   learning_rate: 0.27051668818999286
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   subsample: 0.9100531293444458
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9757995766256756
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   reg_alpha: 0.002404915432737351
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO -   reg_lambda: 1.9809253750493907
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,036 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,039 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,040 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,040 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,040 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,040 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,040 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,040 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,040 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,041 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,041 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,041 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,041 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,047 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,047 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,047 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,047 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,047 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,047 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,047 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,047 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,047 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,048 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,048 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,048 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,048 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,049 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,049 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,049 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,049 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,049 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,049 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,049 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,049 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,049 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,049 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,049 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,049 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,049 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,049 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,049 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,052 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,052 - src.hyperparameter_tuning - ERROR - Trial 6 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,053 - src.hyperparameter_tuning - INFO - Trial 7: 모델 타입 = lightgbm
2025-06-24 09:37:17,056 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,057 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,057 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,057 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,057 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,057 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,057 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,057 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,057 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,057 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,057 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,057 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,057 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,057 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,058 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,058 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,058 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,058 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,058 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,059 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,059 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,059 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,059 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,059 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,059 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,059 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,059 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,059 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,062 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,064 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,064 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,064 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,064 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,064 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,064 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,064 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,066 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,068 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,068 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,068 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,068 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,068 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,068 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,068 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,069 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,069 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,069 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,069 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,069 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,069 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,069 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,069 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,069 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,069 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,070 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,070 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,070 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,070 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,070 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,070 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,070 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,070 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,070 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,070 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,070 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,070 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,071 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,072 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,073 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,073 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,073 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,073 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   learning_rate: 0.011662890273931383
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   n_estimators: 134
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   subsample: 0.7301321323053057
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7554709158757928
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   reg_alpha: 0.28749982347407854
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO -   reg_lambda: 1.6247252885719427e-05
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,074 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,088 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,088 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,088 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,088 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,088 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,089 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,089 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,089 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,090 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,090 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,090 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,090 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,090 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,090 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,090 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,090 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,090 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,090 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,090 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,091 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,091 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,091 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,091 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,091 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,091 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,091 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,092 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,092 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,092 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,092 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,092 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,092 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,092 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,092 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,092 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,092 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,092 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,092 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,092 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,092 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,092 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,095 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,095 - src.hyperparameter_tuning - ERROR - Trial 7 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,096 - src.hyperparameter_tuning - INFO - Trial 8: 모델 타입 = lightgbm
2025-06-24 09:37:17,099 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,100 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,100 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,100 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,100 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,100 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,100 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,100 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,100 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,100 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,101 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,101 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,101 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,101 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,101 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,101 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,101 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,101 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,102 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,102 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,102 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,102 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,105 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,107 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,107 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,107 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,107 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,107 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,107 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,107 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,109 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,111 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,111 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,111 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,111 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,111 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,111 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,111 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,112 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,112 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,112 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,112 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,112 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,112 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,112 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,112 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,113 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,113 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,113 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,113 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,113 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,113 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,113 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,113 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,113 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,113 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,113 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,113 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,114 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,114 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,116 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,117 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,117 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   learning_rate: 0.016149614799999188
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   n_estimators: 317
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   subsample: 0.9208787923016158
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6298202574719083
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   reg_alpha: 0.08916674715636537
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO -   reg_lambda: 6.143857495033091e-07
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,117 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,118 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,121 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,121 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,121 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,121 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,121 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,122 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,123 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,123 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,128 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,129 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,129 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,129 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,129 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,129 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,129 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,129 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,129 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,129 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,129 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,129 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,129 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,130 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,130 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,130 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,130 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,130 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,130 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,130 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,130 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,130 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,130 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,130 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,130 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,130 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,131 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,131 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,131 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,131 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,133 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,133 - src.hyperparameter_tuning - ERROR - Trial 8 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,134 - src.hyperparameter_tuning - INFO - Trial 9: 모델 타입 = lightgbm
2025-06-24 09:37:17,138 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,138 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,138 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,138 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,138 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,138 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,138 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,138 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,139 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,139 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,139 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,139 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,139 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,139 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,139 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,139 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,139 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,139 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,140 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,140 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,140 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,140 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,140 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,140 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,140 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,140 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,141 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,141 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,144 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,146 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,146 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,146 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,146 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,146 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,146 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,146 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,148 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,150 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,150 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,151 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,151 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,151 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,152 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,152 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,152 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,153 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,153 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,153 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,153 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,153 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,153 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,153 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,153 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,153 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,153 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,153 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,153 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,153 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,154 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,154 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,155 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,156 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   learning_rate: 0.11069143219393454
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,157 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   n_estimators: 55
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   subsample: 0.8916028672163949
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9085081386743783
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   reg_alpha: 1.683416412018213e-05
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1036250149900698e-07
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,158 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,161 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,161 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,161 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,161 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,161 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,161 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,161 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,161 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,168 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,168 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,168 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,168 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,168 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,168 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,168 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,168 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,168 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,169 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,169 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,169 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,169 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,169 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,169 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,170 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,170 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,170 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,170 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,170 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,170 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,170 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,170 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,170 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,170 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,170 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,170 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,170 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,170 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,170 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,173 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,173 - src.hyperparameter_tuning - ERROR - Trial 9 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,184 - src.hyperparameter_tuning - INFO - Trial 10: 모델 타입 = lightgbm
2025-06-24 09:37:17,188 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,189 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,189 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,189 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,189 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,189 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,189 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,189 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,189 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,189 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,189 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,189 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,189 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,189 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,189 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,189 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,189 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,189 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,190 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,190 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,190 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,191 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,191 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,191 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,191 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,191 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,191 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,191 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,194 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,196 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,196 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,196 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,196 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,196 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,196 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,196 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,198 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,200 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,200 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,200 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,200 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,200 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,200 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,200 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,201 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,201 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,201 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,201 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,201 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,201 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,201 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,201 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,201 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,201 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,202 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,202 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,202 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,202 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,202 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,202 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,202 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,202 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,202 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,202 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,202 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,202 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,202 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,202 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,203 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,204 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,205 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,205 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,205 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,205 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   learning_rate: 0.09315744902122479
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   n_estimators: 901
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   subsample: 0.6071847502459278
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6061470949312417
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3686680646913267e-08
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO -   reg_lambda: 6.099006535330825
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,206 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,209 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,209 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,209 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,209 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,209 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,209 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,209 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,211 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,211 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,211 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,211 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,211 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,211 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,211 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,211 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,211 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,211 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,211 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,211 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,211 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,212 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,212 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,212 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,212 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,212 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,212 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,212 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,212 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,212 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,212 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,212 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,212 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,212 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,212 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,212 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,212 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,212 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,215 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,215 - src.hyperparameter_tuning - ERROR - Trial 10 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,226 - src.hyperparameter_tuning - INFO - Trial 11: 모델 타입 = lightgbm
2025-06-24 09:37:17,230 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,230 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,230 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,230 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,230 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,230 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,231 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,231 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,231 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,231 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,231 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,231 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,231 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,231 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,231 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,231 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,231 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,231 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,232 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,232 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,232 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,232 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,236 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,238 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,238 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,238 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,238 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,238 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,238 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,238 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,240 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,242 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,242 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,242 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,242 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,242 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,242 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,242 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,242 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,243 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,243 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,243 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,244 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,244 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,244 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,244 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,244 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,244 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,244 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,244 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,244 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,244 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,244 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,244 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,244 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,245 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,246 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,247 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,247 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   learning_rate: 0.037348440879763224
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,247 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   n_estimators: 705
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   subsample: 0.8275682686623269
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9801238964661396
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   reg_alpha: 2.0076751494057687e-08
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO -   reg_lambda: 0.050437107744728454
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,248 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,250 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,250 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,250 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,250 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,250 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,251 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,252 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,252 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,252 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,252 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,258 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,258 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,258 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,258 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,258 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,258 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,258 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,258 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,258 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,259 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,259 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,259 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,259 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,259 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,259 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,260 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,260 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,260 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,260 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,260 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,260 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,260 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,260 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,260 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,260 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,260 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,260 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,260 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,260 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,260 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,263 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,263 - src.hyperparameter_tuning - ERROR - Trial 11 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,275 - src.hyperparameter_tuning - INFO - Trial 12: 모델 타입 = lightgbm
2025-06-24 09:37:17,279 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,280 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,280 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,280 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,280 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,280 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,280 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,280 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,280 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,281 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,281 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,281 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,281 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,281 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,281 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,281 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,281 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,281 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,282 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,282 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,282 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,282 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,286 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,288 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,288 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,288 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,288 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,288 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,288 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,288 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,290 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,292 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,292 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,292 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,292 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,292 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,292 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,292 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,293 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,293 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,293 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,293 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,293 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,293 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,293 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,294 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,294 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,294 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,294 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,294 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,295 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,295 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,295 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,295 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,295 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,295 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,295 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,295 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,295 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,295 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,297 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,298 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   learning_rate: 0.11614923191803554
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   n_estimators: 706
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   subsample: 0.9831484441888799
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.902800604671404
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   reg_alpha: 5.997698489764049e-07
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO -   reg_lambda: 0.012341345845574371
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,298 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,301 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,301 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,301 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,301 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,301 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,301 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,302 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,303 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,305 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,305 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,305 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,305 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,305 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,305 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,305 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,305 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,306 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,306 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,306 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,306 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,306 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,306 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,306 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,306 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,306 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,306 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,306 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,307 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,307 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,307 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,307 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,307 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,307 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,307 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,307 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,307 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,307 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,307 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,307 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,310 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,310 - src.hyperparameter_tuning - ERROR - Trial 12 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,321 - src.hyperparameter_tuning - INFO - Trial 13: 모델 타입 = lightgbm
2025-06-24 09:37:17,325 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,326 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,326 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,326 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,326 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,326 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,326 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,326 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,326 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,327 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,327 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,327 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,327 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,327 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,327 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,327 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,327 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,327 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,328 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,328 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,328 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,328 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,332 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,334 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,334 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,334 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,334 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,334 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,334 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,334 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,336 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,338 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,338 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,338 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,338 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,339 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,339 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,339 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,339 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,339 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,339 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,339 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,340 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,340 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,340 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,340 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,340 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,340 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,340 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,340 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,340 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,340 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,340 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,340 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,341 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,342 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,343 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,343 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,343 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,343 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,343 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   learning_rate: 0.07369477793265464
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   n_estimators: 493
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   subsample: 0.8579178144028043
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6684815593910434
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   reg_alpha: 9.86874546485378
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1101875524587999e-08
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,344 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,347 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,347 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,347 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,347 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,347 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,348 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,354 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,354 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,354 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,354 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,354 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,354 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,354 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,354 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,355 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,355 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,355 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,356 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,356 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,356 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,356 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,356 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,356 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,356 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,356 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,356 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,356 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,356 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,356 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,356 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,356 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,356 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,359 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,359 - src.hyperparameter_tuning - ERROR - Trial 13 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,372 - src.hyperparameter_tuning - INFO - Trial 14: 모델 타입 = lightgbm
2025-06-24 09:37:17,376 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,376 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,376 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,376 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,376 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,377 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,377 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,377 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,377 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,377 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,377 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,377 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,377 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,377 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,377 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,377 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,377 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,377 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,378 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,378 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,378 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,378 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,378 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,379 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,379 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,379 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,379 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,379 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,382 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,384 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,385 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,385 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,385 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,385 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,385 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,385 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,387 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,388 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,389 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,389 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,389 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,389 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,389 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,390 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,390 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,390 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,391 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,391 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,391 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,391 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,391 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,391 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,391 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,391 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,391 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,391 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,391 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,391 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,391 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,394 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,394 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   learning_rate: 0.17646596150449262
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,394 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   n_estimators: 702
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   subsample: 0.7376022736475862
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8046295483602256
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   reg_alpha: 2.3549110805943098e-07
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO -   reg_lambda: 0.06760969294969883
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,395 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,398 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,398 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,398 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,398 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,398 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,398 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,401 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,401 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,401 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,401 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,401 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,401 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,401 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,401 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,402 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,402 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,402 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,402 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,403 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,403 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,403 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,403 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,403 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,403 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,403 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,403 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,403 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,403 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,403 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,403 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,403 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,403 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,405 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,405 - src.hyperparameter_tuning - ERROR - Trial 14 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,417 - src.hyperparameter_tuning - INFO - Trial 15: 모델 타입 = lightgbm
2025-06-24 09:37:17,421 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,422 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,422 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,422 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,422 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,422 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,422 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,422 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,422 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,422 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,422 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,422 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,422 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,422 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,422 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,422 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,422 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,422 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,423 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,423 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,423 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,423 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,423 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,423 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,424 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,424 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,424 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,424 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,427 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,429 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,429 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,429 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,429 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,429 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,429 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,429 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,431 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,433 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,433 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,433 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,433 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,433 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,433 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,433 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,434 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,434 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,434 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,434 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,434 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,434 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,434 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,434 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,434 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,434 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,435 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,435 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,435 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,435 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,435 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,435 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,435 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,435 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,435 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,435 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,435 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,435 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,435 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,436 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,437 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,438 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,438 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,438 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,438 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,438 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   learning_rate: 0.026752568195150317
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   n_estimators: 997
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   subsample: 0.9967544619046032
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.896461276471979
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   reg_alpha: 8.925905274192813e-05
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009166238280651257
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,439 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,442 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,442 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,442 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,442 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,442 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,442 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,442 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,443 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,444 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,444 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,444 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,444 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,444 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,444 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,444 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,444 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,445 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,445 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,445 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,445 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,445 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,445 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,446 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,446 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,446 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,446 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,446 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,446 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,446 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,446 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,446 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,446 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,446 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,446 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,446 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,446 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,446 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,446 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,446 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,446 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,448 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,448 - src.hyperparameter_tuning - ERROR - Trial 15 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,460 - src.hyperparameter_tuning - INFO - Trial 16: 모델 타입 = lightgbm
2025-06-24 09:37:17,464 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,465 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,465 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,465 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,465 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,465 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,465 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,465 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,465 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,466 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,466 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,466 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,466 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,466 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,466 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,466 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,466 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,466 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,467 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,467 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,467 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,467 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,470 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,472 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,473 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,473 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,473 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,473 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,473 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,473 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,475 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,476 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,476 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,477 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,477 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,477 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,477 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,477 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,477 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,478 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,478 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,478 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,479 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,479 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,479 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,479 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,479 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,479 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,479 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,479 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,479 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,479 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,479 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,479 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,479 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,479 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,480 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,481 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,482 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,482 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,482 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,482 - src.models.lightgbm_model - INFO -   learning_rate: 0.06988639938760517
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   n_estimators: 347
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   subsample: 0.769221734655711
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7657244060744415
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   reg_alpha: 2.9167530407966635e-07
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO -   reg_lambda: 0.4030789571311193
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,483 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,486 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,486 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,486 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,486 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,486 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,486 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,486 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,486 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,487 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,487 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,487 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,493 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,493 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,493 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,493 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,493 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,493 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,493 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,493 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,493 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,494 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,494 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,494 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,494 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,495 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,495 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,495 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,495 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,495 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,495 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,495 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,495 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,495 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,495 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,495 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,495 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,495 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,495 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,495 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,498 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,498 - src.hyperparameter_tuning - ERROR - Trial 16 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,509 - src.hyperparameter_tuning - INFO - Trial 17: 모델 타입 = lightgbm
2025-06-24 09:37:17,514 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,514 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,514 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,514 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,514 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,514 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,514 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,515 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,515 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,515 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,515 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,515 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,515 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,515 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,515 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,515 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,515 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,515 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,516 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,516 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,516 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,516 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,516 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,516 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,516 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,516 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,517 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,517 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,521 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,523 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,523 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,523 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,523 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,523 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,523 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,523 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,525 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,527 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,527 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,527 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,527 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,527 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,527 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,527 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,527 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,527 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,527 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,528 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,528 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,528 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,528 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,528 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,528 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,528 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,528 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,528 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,528 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,529 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,530 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,530 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,530 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,530 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,530 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,530 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,530 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,530 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,530 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,530 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,530 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,530 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,530 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,530 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,531 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,532 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,533 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,533 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   learning_rate: 0.15526074257939743
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,533 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   n_estimators: 600
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   subsample: 0.6732132011401761
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6721524828008189
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   reg_alpha: 9.14459959766754e-08
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO -   reg_lambda: 0.004840492100137957
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,534 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,537 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,537 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,537 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,537 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,537 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,537 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,537 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,537 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,538 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,538 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,538 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,538 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,544 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,544 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,544 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,544 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,544 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,544 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,544 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,544 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,544 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,545 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,545 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,545 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,545 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,545 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,545 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,546 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,546 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,546 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,546 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,546 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,546 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,546 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,546 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,546 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,546 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,546 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,546 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,546 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,546 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,546 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,548 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,549 - src.hyperparameter_tuning - ERROR - Trial 17 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,561 - src.hyperparameter_tuning - INFO - Trial 18: 모델 타입 = lightgbm
2025-06-24 09:37:17,565 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,565 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,565 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,565 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,565 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,565 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,565 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,565 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,565 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,566 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,566 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,566 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,566 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,566 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,566 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,566 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,566 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,566 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,567 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,567 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,567 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,567 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,571 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,573 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,573 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,573 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,573 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,573 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,573 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,573 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,575 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,577 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,577 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,577 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,577 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,577 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,577 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,577 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,577 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,577 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,577 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,578 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,578 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,578 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,578 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,578 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,578 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,578 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,579 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,579 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,579 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,579 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,579 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,579 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,579 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,579 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,579 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,580 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,580 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,580 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,580 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,580 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,580 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,580 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,581 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,582 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,583 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   learning_rate: 0.05533525328002605
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   subsample: 0.8551318001092548
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9338003283396146
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00011115273434769104
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO -   reg_lambda: 2.6037259691414086e-06
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,583 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,586 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,586 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,586 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,586 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,586 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,586 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,586 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,586 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,587 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,588 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,589 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,589 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,589 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,589 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,589 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,589 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,589 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,589 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,589 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,590 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,590 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,590 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,590 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,591 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,591 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,591 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,591 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,591 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,591 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,591 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,591 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,591 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,591 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,591 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,591 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,591 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,591 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,591 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,594 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,594 - src.hyperparameter_tuning - ERROR - Trial 18 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,606 - src.hyperparameter_tuning - INFO - Trial 19: 모델 타입 = lightgbm
2025-06-24 09:37:17,610 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,611 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,611 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,611 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,611 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,611 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,611 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,611 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,611 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,612 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,612 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,612 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,612 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,612 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,612 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,612 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,612 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,612 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,613 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,613 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,613 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,613 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,617 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,619 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,619 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,619 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,619 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,619 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,619 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,619 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,621 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,623 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,623 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,623 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,623 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,623 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,624 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,624 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,624 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,625 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,625 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,625 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,625 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,625 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,625 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,625 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,625 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,625 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,625 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,625 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,625 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,625 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,626 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,627 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,628 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,628 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,628 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,628 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,628 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   learning_rate: 0.02877361180532123
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   n_estimators: 835
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   subsample: 0.9423652436238517
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8416634198004798
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   reg_alpha: 2.4662900352851794e-06
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO -   reg_lambda: 4.7203867760430046e-08
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,629 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,632 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,632 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,632 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,632 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,632 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,632 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,632 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,633 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,639 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,639 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,639 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,639 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,639 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,639 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,639 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,639 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,639 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,640 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,640 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,640 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,640 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,640 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,640 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,641 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,641 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,641 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,641 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,641 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,641 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,641 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,641 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,641 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,641 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,641 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,641 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,641 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,641 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,641 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,643 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,643 - src.hyperparameter_tuning - ERROR - Trial 19 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,655 - src.hyperparameter_tuning - INFO - Trial 20: 모델 타입 = lightgbm
2025-06-24 09:37:17,660 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,660 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,660 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,660 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,660 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,660 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,660 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,660 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,661 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,661 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,661 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,661 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,661 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,661 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,661 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,661 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,661 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,661 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,662 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,662 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,662 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,662 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,666 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,668 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,668 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,668 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,668 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,668 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,668 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,668 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,670 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,672 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,672 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,672 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,672 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,672 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,672 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,672 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,673 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,673 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,673 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,673 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,673 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,673 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,673 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,673 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,673 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,673 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,674 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,674 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,674 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,674 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,674 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,674 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,674 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,674 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,674 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,674 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,674 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,675 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,675 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,675 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,675 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,676 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,677 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   learning_rate: 0.16522729299476813
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   n_estimators: 224
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   subsample: 0.87408467479411
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7727431143998708
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1069451775532163e-08
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO -   reg_lambda: 5.845016122261629e-06
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,678 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,681 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,681 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,681 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,681 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,682 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,682 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,683 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,683 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,683 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,684 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,685 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,685 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,685 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,685 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,685 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,685 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,685 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,685 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,686 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,686 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,686 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,686 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,686 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,686 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,686 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,686 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,686 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,686 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,686 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,686 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,686 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,686 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,686 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,686 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,686 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,689 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,689 - src.hyperparameter_tuning - ERROR - Trial 20 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,702 - src.hyperparameter_tuning - INFO - Trial 21: 모델 타입 = lightgbm
2025-06-24 09:37:17,706 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,707 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,707 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,707 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,707 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,708 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,708 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,708 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,708 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,708 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,708 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,708 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,708 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,708 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,708 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,708 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,708 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,708 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,709 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,709 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,709 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,709 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,709 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,709 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,709 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,710 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,710 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,710 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,714 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,716 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,716 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,716 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,716 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,716 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,716 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,716 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,718 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,719 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,719 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,719 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,720 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,720 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,720 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,720 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,720 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,721 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,721 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,721 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,722 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,722 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,722 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,722 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,722 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,722 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,722 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,722 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,722 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,722 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,722 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,722 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,722 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,725 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   learning_rate: 0.04529483298639887
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,725 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   n_estimators: 316
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   subsample: 0.6975620050707811
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8503251588841235
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   reg_alpha: 9.844852091987153e-07
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO -   reg_lambda: 4.797440969544924e-05
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,726 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,729 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,729 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,729 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,729 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,729 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,729 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,729 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,729 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,730 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,736 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,736 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,736 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,736 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,736 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,736 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,736 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,736 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,736 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,737 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,737 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,737 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,737 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,738 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,738 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,738 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,738 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,738 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,738 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,738 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,738 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,738 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,738 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,738 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,738 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,738 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,738 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,738 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,741 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,741 - src.hyperparameter_tuning - ERROR - Trial 21 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,753 - src.hyperparameter_tuning - INFO - Trial 22: 모델 타입 = lightgbm
2025-06-24 09:37:17,757 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,757 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,757 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,757 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,757 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,758 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,758 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,758 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,758 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,758 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,758 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,758 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,758 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,758 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,758 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,758 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,758 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,758 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,759 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,759 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,759 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,759 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,763 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,765 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,765 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,765 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,765 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,765 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,765 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,765 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,767 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,769 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,769 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,769 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,769 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,769 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,769 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,769 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,769 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,770 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,770 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,770 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,770 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,770 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,770 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,770 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,770 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,771 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,771 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,771 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,771 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,771 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,771 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,771 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,771 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,771 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,771 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,771 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,771 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO -   learning_rate: 0.015410150189628657
2025-06-24 09:37:17,774 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   n_estimators: 411
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   subsample: 0.6452606057786048
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8738445964974808
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1485400190421731e-05
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5162743738503278e-06
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,775 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,779 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,779 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,779 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,779 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,779 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,779 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,779 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,786 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,786 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,786 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,786 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,786 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,786 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,786 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,787 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,787 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,787 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,787 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,788 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,788 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,788 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,788 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,788 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,788 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,788 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,788 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,788 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,788 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,788 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,788 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,788 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,788 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,790 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,790 - src.hyperparameter_tuning - ERROR - Trial 22 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,803 - src.hyperparameter_tuning - INFO - Trial 23: 모델 타입 = lightgbm
2025-06-24 09:37:17,807 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,807 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,807 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,807 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,807 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,807 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,807 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,807 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,807 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,808 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,808 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,808 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,808 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,808 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,808 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,808 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,808 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,808 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,809 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,809 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,809 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,809 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,813 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,815 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,815 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,815 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,815 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,815 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,815 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,815 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,817 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,819 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,819 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,819 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,819 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,819 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,819 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,819 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,820 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,820 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,820 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,820 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,820 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,820 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,820 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,820 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,820 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,820 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,821 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,821 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,821 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,821 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,821 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,821 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,821 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,821 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,821 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,821 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,821 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,821 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,824 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,824 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,824 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,824 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   learning_rate: 0.02960427890913426
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   n_estimators: 240
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   subsample: 0.7742544913880576
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9449923596722283
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   reg_alpha: 6.189776343666531e-08
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO -   reg_lambda: 2.0050009913357152e-05
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,825 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,828 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,828 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,828 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,828 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,828 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,828 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,835 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,835 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,835 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,835 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,835 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,835 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,835 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,835 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,835 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,836 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,836 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,836 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,836 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,836 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,836 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,837 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,837 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,837 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,837 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,837 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,837 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,837 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,837 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,837 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,837 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,837 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,837 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,837 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,837 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,837 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,839 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,840 - src.hyperparameter_tuning - ERROR - Trial 23 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,852 - src.hyperparameter_tuning - INFO - Trial 24: 모델 타입 = lightgbm
2025-06-24 09:37:17,856 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,857 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,857 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,857 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,857 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,857 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,857 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,857 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,857 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,858 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,858 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,858 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,858 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,858 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,858 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,858 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,858 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,858 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,859 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,859 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,859 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,859 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,863 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,865 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,865 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,865 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,865 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,865 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,865 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,865 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,867 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,869 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,869 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,869 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,869 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,869 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,869 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,869 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,870 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,870 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,870 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,870 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,870 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,870 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,870 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,870 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,870 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,870 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,871 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,871 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,871 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,871 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,871 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,871 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,871 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,871 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,871 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,871 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,871 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,871 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,872 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   learning_rate: 0.052772641594485394
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:37:17,875 - src.models.lightgbm_model - INFO -   subsample: 0.709790030543809
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7956578586822305
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO -   reg_alpha: 2.8089508266239516e-05
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00016743745517347003
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,876 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,878 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,879 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,879 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,879 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,879 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,879 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,879 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,879 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,882 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,882 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,882 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,882 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,882 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,882 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,882 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,882 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,883 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,883 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,883 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,883 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,883 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,883 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,884 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,884 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,884 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,884 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,884 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,884 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,884 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,884 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,884 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,884 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,884 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,884 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,884 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,884 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,884 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,886 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,886 - src.hyperparameter_tuning - ERROR - Trial 24 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,899 - src.hyperparameter_tuning - INFO - Trial 25: 모델 타입 = lightgbm
2025-06-24 09:37:17,903 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,904 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,904 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,904 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,904 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,904 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,904 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,904 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,904 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,905 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,905 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,905 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,905 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,905 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,905 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,905 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,905 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,905 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,906 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,906 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,906 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,906 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,910 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,912 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,912 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,912 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,912 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,912 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,912 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,912 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,914 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,916 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,916 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,916 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,916 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,916 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,916 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,916 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,916 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,917 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,917 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,917 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,918 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,918 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,918 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,918 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,918 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,918 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,918 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,918 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,918 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,918 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,918 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,918 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,918 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,919 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,920 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,921 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,921 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,921 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,921 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   learning_rate: 0.02043311211274545
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,921 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   n_estimators: 410
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   subsample: 0.765836702637975
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9367310980059825
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   reg_alpha: 2.467723761283515e-06
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0025526354515177084
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,922 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,932 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,932 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,932 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,932 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,932 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,933 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,934 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,934 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,934 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,934 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,934 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,934 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,934 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,934 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,934 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,934 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,935 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,935 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,935 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,936 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,936 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,936 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,936 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,936 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,936 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,936 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,936 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,936 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,936 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,936 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,936 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,936 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,936 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,936 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,938 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,938 - src.hyperparameter_tuning - ERROR - Trial 25 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,951 - src.hyperparameter_tuning - INFO - Trial 26: 모델 타입 = lightgbm
2025-06-24 09:37:17,955 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:17,956 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:17,956 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:17,956 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:17,956 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:17,956 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:17,956 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:17,956 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:17,956 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:17,956 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:17,956 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:17,956 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:17,956 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:17,956 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:17,956 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:17,956 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:17,956 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:17,956 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:17,957 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:17,957 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:17,957 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:17,957 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:17,961 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:17,963 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,963 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:17,963 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:17,963 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:17,963 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:17,963 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:17,963 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:17,965 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:17,967 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:17,967 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,967 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,967 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:17,967 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:17,967 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,967 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:17,967 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:17,967 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,967 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,968 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:17,968 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:17,968 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,968 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,968 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:17,968 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:17,968 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,968 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,968 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:17,968 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:17,969 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:17,969 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:17,969 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:17,969 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:17,969 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:17,969 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:17,969 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:17,969 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:17,969 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,969 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:17,969 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:17,969 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:17,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:17,969 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,970 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,971 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:17,972 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,972 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:17,972 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,972 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:17,972 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   learning_rate: 0.21063894305336445
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   n_estimators: 656
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   subsample: 0.822656444358238
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8094408985463093
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0005539202839193388
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO -   reg_lambda: 6.440889140440102e-06
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:17,973 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:17,977 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:17,977 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:17,977 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:17,977 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:17,977 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:17,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:17,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:17,979 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:17,979 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:17,979 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:17,979 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:17,979 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,979 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:17,979 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:17,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:17,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:17,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:17,979 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:17,979 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,980 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,980 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,980 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:17,980 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:17,980 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:17,980 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:17,980 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:17,980 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:17,980 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:17,980 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:17,980 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:17,981 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:17,981 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:17,981 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,981 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,981 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:17,981 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:17,983 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:17,983 - src.hyperparameter_tuning - ERROR - Trial 26 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:17,996 - src.hyperparameter_tuning - INFO - Trial 27: 모델 타입 = lightgbm
2025-06-24 09:37:17,999 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,000 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,000 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,000 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,000 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,000 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,000 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,000 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,000 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,001 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,001 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,001 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,001 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,001 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,001 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,001 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,001 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,001 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,002 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,002 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,002 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,002 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,005 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,007 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,007 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,007 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,007 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,007 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,007 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,008 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,009 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,011 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,011 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,011 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,011 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,011 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,011 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,011 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,012 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,012 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,012 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,012 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,012 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,012 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,012 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,012 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,013 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,013 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,013 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,013 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,013 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,013 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,013 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,013 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,013 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,013 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,013 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,013 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,013 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,013 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,014 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,015 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,016 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,016 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,016 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,016 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   learning_rate: 0.0804852149570703
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   n_estimators: 483
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   subsample: 0.6346522194487378
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9964125388085947
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   reg_alpha: 8.253969505781612e-08
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO -   reg_lambda: 1.119023035815797e-07
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,017 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,020 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,020 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,020 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,020 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,020 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,020 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,021 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,027 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,027 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,027 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,027 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,027 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,027 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,027 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,027 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,027 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,028 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,028 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,028 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,028 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,028 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,028 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,029 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,029 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,029 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,029 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,029 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,029 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,029 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,029 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,029 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,029 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,029 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,029 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,029 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,029 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,029 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,031 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,032 - src.hyperparameter_tuning - ERROR - Trial 27 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,045 - src.hyperparameter_tuning - INFO - Trial 28: 모델 타입 = lightgbm
2025-06-24 09:37:18,049 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,050 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,050 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,050 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,050 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,050 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,050 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,050 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,050 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,050 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,050 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,050 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,050 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,050 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,050 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,050 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,050 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,050 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,051 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,051 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,051 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,051 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,051 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,051 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,051 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,051 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,051 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,052 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,055 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,057 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,057 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,057 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,057 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,057 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,057 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,057 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,059 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,061 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,061 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,061 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,061 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,061 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,061 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,061 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,062 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,062 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,062 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,062 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,062 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,062 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,062 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,062 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,062 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,062 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,063 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,063 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,063 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,063 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,063 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,063 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,063 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,063 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,063 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,063 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,063 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,063 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,064 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,064 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,065 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,066 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,066 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,066 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,066 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   learning_rate: 0.12404094717085312
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   n_estimators: 782
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   subsample: 0.6724055367984789
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8740038680959015
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0343558782044228e-06
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO -   reg_lambda: 0.33132712190213737
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,067 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,070 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,070 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,070 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,070 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,070 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,077 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,077 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,077 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,077 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,077 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,077 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,077 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,077 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,077 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,077 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,078 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,078 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,078 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,078 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,078 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,079 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,079 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,079 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,079 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,079 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,079 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,079 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,079 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,079 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,079 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,079 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,079 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,079 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,079 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,079 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,081 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,081 - src.hyperparameter_tuning - ERROR - Trial 28 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,094 - src.hyperparameter_tuning - INFO - Trial 29: 모델 타입 = lightgbm
2025-06-24 09:37:18,098 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,099 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,099 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,099 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,099 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,099 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,099 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,099 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,099 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,099 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,100 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,100 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,100 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,100 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,100 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,100 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,100 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,100 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,101 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,101 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,101 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,101 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,104 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,106 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,106 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,106 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,106 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,106 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,106 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,106 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,108 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,110 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,110 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,110 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,110 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,110 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,110 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,110 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,110 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,110 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,110 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,111 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,111 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,111 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,111 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,111 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,111 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,111 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,112 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,112 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,112 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,112 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,112 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,112 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,112 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,112 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,112 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,112 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,112 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,112 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,113 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,113 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,113 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,114 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,115 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,115 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,115 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,115 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   learning_rate: 0.021604981364913005
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   n_estimators: 515
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   subsample: 0.7969902083314745
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7309448291222742
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   reg_alpha: 4.867051057937844e-08
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO -   reg_lambda: 3.374072614356822e-07
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,116 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,119 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,119 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,119 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,119 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,119 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,120 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,121 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,121 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,121 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,121 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,121 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,121 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,121 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,122 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,122 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,122 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,122 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,122 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,122 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,122 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,122 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,122 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,122 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,122 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,122 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,122 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,123 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,123 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,123 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,123 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,123 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,123 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,123 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,123 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,123 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,123 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,123 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,125 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,125 - src.hyperparameter_tuning - ERROR - Trial 29 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,138 - src.hyperparameter_tuning - INFO - Trial 30: 모델 타입 = lightgbm
2025-06-24 09:37:18,141 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,142 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,142 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,142 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,142 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,142 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,142 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,142 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,142 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,143 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,143 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,143 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,143 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,143 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,143 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,143 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,143 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,143 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,144 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,144 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,144 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,144 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,148 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,150 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,150 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,150 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,150 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,150 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,150 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,152 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,153 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,153 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,154 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,154 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,154 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,154 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,155 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,155 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,155 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,156 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,156 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,156 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,156 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,156 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,156 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,156 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,156 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,156 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,156 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,156 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,156 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,156 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,156 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,156 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,156 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,156 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,157 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,158 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,159 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   learning_rate: 0.04035286091031472
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   n_estimators: 457
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   subsample: 0.8044792631641183
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8696839799381978
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   reg_alpha: 2.938419320810259e-06
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO -   reg_lambda: 1.474108753561657e-08
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,159 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,162 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,162 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,162 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,162 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,162 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,163 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,169 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,169 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,169 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,169 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,169 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,169 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,169 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,169 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,169 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,169 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,170 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,170 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,170 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,170 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,170 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,171 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,171 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,171 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,171 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,171 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,171 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,171 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,171 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,171 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,171 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,171 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,171 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,171 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,171 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,171 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,173 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,173 - src.hyperparameter_tuning - ERROR - Trial 30 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,187 - src.hyperparameter_tuning - INFO - Trial 31: 모델 타입 = lightgbm
2025-06-24 09:37:18,190 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,191 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,191 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,191 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,191 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,191 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,191 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,191 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,191 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,192 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,192 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,192 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,192 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,192 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,192 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,192 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,192 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,192 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,193 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,193 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,193 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,193 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,196 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,198 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,198 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,198 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,199 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,199 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,199 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,200 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,202 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,202 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,202 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,202 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,203 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,203 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,203 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,204 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,204 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,204 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,205 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,205 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,205 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,205 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,205 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,205 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,205 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,205 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,205 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,205 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,205 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,205 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,205 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,205 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,205 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,206 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,207 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,208 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   learning_rate: 0.013637410036364993
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   n_estimators: 358
2025-06-24 09:37:18,208 - src.models.lightgbm_model - INFO -   subsample: 0.8349337395484048
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.831861212497879
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO -   reg_alpha: 0.001834620070516215
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO -   reg_lambda: 6.362585398085402e-07
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,209 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,213 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,213 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,213 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,213 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,213 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,214 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,215 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,215 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,215 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,215 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,223 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,223 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,223 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,223 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,223 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,223 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,223 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,223 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,224 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,224 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,224 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,224 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,224 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,224 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,225 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,225 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,225 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,225 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,225 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,225 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,225 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,225 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,225 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,225 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,225 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,225 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,225 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,225 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,225 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,225 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,228 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,228 - src.hyperparameter_tuning - ERROR - Trial 31 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,241 - src.hyperparameter_tuning - INFO - Trial 32: 모델 타입 = lightgbm
2025-06-24 09:37:18,245 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,246 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,246 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,246 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,246 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,246 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,246 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,246 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,246 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,246 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,246 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,246 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,246 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,246 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,246 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,246 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,246 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,246 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,247 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,247 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,247 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,247 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,247 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,248 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,248 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,248 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,248 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,248 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,251 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,253 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,253 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,253 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,253 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,253 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,253 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,253 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,255 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,257 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,257 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,257 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,257 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,257 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,257 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,257 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,257 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,257 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,257 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,258 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,258 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,258 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,258 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,258 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,258 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,258 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,258 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,258 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,259 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,259 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,259 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,259 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,259 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,259 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,259 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,259 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,259 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,259 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,259 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,259 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,259 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,259 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,260 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,261 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,262 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,262 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,262 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   learning_rate: 0.010358238324974577
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   n_estimators: 269
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   subsample: 0.9392065580983905
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7242608165537173
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   reg_alpha: 0.07671535159777253
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO -   reg_lambda: 9.281031668514603e-05
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,263 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,266 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,266 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,266 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,266 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,266 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,266 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,267 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,268 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,268 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,268 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,268 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,268 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,268 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,268 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,268 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,269 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,269 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,269 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,269 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,270 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,270 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,270 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,270 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,270 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,270 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,270 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,270 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,270 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,270 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,270 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,270 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,270 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,270 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,272 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,272 - src.hyperparameter_tuning - ERROR - Trial 32 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,286 - src.hyperparameter_tuning - INFO - Trial 33: 모델 타입 = lightgbm
2025-06-24 09:37:18,289 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,290 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,290 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,290 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,290 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,290 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,290 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,290 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,290 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,291 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,291 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,291 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,291 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,291 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,291 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,291 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,291 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,291 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,292 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,292 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,292 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,292 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,296 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,298 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,298 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,298 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,298 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,298 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,298 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,298 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,300 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,301 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,301 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,302 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,302 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,302 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,302 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,302 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,302 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,303 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,303 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,303 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,304 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,304 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,304 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,304 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,304 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,304 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,304 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,304 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,304 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,304 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,304 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,304 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,304 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,304 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,305 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,306 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,307 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,307 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,307 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,307 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,307 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,307 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,307 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,307 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   learning_rate: 0.018528024944816653
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   n_estimators: 585
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   subsample: 0.7403423161145642
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.694494095260054
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009311170494905974
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO -   reg_lambda: 1.439483740775924e-07
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,308 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,311 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,311 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,311 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,311 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,311 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,311 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,316 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,316 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,316 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,316 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,317 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,317 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,317 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,317 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,317 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,317 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,318 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,318 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,318 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,318 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,318 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,318 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,318 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,318 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,318 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,318 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,318 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,318 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,318 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,318 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,318 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,318 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,321 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,321 - src.hyperparameter_tuning - ERROR - Trial 33 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,334 - src.hyperparameter_tuning - INFO - Trial 34: 모델 타입 = lightgbm
2025-06-24 09:37:18,338 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,338 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,338 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,338 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,338 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,338 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,338 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,338 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,339 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,339 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,339 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,339 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,339 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,339 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,339 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,339 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,339 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,339 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,340 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,340 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,340 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,340 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,344 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,346 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,346 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,346 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,346 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,346 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,346 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,346 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,348 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,350 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,350 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,350 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,350 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,350 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,350 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,350 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,351 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,351 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,351 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,351 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,351 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,351 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,351 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,351 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,351 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,352 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,352 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,352 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,352 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,352 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,352 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,352 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,352 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,352 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,352 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,352 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,352 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,352 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,353 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,354 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,355 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,356 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   learning_rate: 0.012603140096888722
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   n_estimators: 537
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   subsample: 0.887059385340847
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.814690263795279
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0007257356330429975
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0006511272157627004
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,356 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,357 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,359 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,359 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,359 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,359 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,359 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,359 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,360 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,361 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,361 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,361 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,361 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,367 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,367 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,367 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,367 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,367 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,367 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,367 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,367 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,368 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,368 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,368 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,368 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,369 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,369 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,369 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,369 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,369 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,369 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,369 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,369 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,369 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,369 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,369 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,369 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,369 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,369 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,371 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,371 - src.hyperparameter_tuning - ERROR - Trial 34 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,385 - src.hyperparameter_tuning - INFO - Trial 35: 모델 타입 = lightgbm
2025-06-24 09:37:18,389 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,390 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,390 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,390 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,390 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,390 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,390 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,390 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,390 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,390 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,390 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,390 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,390 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,390 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,390 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,390 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,390 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,390 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,391 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,391 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,391 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,391 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,391 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,391 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,391 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,391 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,392 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,392 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,395 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,397 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,397 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,397 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,397 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,397 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,397 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,397 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,399 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,401 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,401 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,401 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,401 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,402 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,402 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,402 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,402 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,403 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,403 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,403 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,404 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,404 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,404 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,404 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,404 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,404 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,404 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,404 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,404 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,404 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,404 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,404 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,404 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,405 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,406 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,407 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,407 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,407 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   learning_rate: 0.010078636987766579
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,407 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   n_estimators: 207
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   subsample: 0.9593052727074797
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9586658642491094
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   reg_alpha: 4.2693203841762886e-05
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO -   reg_lambda: 2.556230835595068e-05
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,408 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,413 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,413 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,413 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,413 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,413 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,413 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,414 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,415 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,415 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,416 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,416 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,416 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,416 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,416 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,416 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,416 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,416 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,416 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,416 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,416 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,417 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,417 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,417 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,417 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,417 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,418 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,418 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,418 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,418 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,418 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,418 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,418 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,418 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,418 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,418 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,418 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,418 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,418 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,418 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,420 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,420 - src.hyperparameter_tuning - ERROR - Trial 35 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,435 - src.hyperparameter_tuning - INFO - Trial 36: 모델 타입 = lightgbm
2025-06-24 09:37:18,438 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,439 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,439 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,439 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,439 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,439 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,439 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,439 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,439 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,440 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,440 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,440 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,440 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,440 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,440 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,440 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,440 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,440 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,441 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,441 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,441 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,441 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,445 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,447 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,447 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,447 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,447 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,447 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,447 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,447 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,449 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,451 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,451 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,451 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,451 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,451 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,452 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,452 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,453 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,453 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,453 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,454 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,454 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,454 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,454 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,454 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,454 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,454 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,454 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,454 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,454 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,454 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,454 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,454 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,454 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,454 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,454 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,456 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,457 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   learning_rate: 0.02487519724197392
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   n_estimators: 638
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   subsample: 0.7985560215507382
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7512759811523114
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   reg_alpha: 0.024900590270190155
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8961556446893008e-06
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,457 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,460 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,460 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,460 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,460 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,460 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,460 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,461 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,462 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,467 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,467 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,467 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,467 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,467 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,467 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,467 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,467 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,468 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,468 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,468 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,468 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,468 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,468 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,468 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,469 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,469 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,469 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,469 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,469 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,469 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,469 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,469 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,469 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,469 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,469 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,469 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,469 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,469 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,469 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,472 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,472 - src.hyperparameter_tuning - ERROR - Trial 36 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,486 - src.hyperparameter_tuning - INFO - Trial 37: 모델 타입 = lightgbm
2025-06-24 09:37:18,489 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,490 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,490 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,490 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,490 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,490 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,490 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,490 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,490 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,491 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,491 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,491 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,491 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,491 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,491 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,491 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,491 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,491 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,492 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,492 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,492 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,492 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,496 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,498 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,498 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,498 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,498 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,498 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,498 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,498 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,500 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,502 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,502 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,502 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,502 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,502 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,502 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,502 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,502 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,502 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,502 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,503 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,503 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,503 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,503 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,503 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,503 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,503 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,504 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,504 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,504 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,504 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,504 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,504 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,504 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,504 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,504 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,504 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,504 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,505 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,505 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,505 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,505 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,505 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,506 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,507 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,507 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,507 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   learning_rate: 0.01569833488957703
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   n_estimators: 283
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   subsample: 0.7125680491414248
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.784145332591274
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   reg_alpha: 0.766447656094571
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO -   reg_lambda: 6.133310095468243e-06
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,508 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,516 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,516 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,516 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,516 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,516 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,516 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,517 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,517 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,517 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,518 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,518 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,518 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,518 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,518 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,518 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,518 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,518 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,518 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,518 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,518 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,518 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,518 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,519 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,519 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,519 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,519 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,519 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,520 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,520 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,520 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,520 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,520 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,520 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,520 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,520 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,520 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,520 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,520 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,520 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,520 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,520 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,520 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,522 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,522 - src.hyperparameter_tuning - ERROR - Trial 37 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,536 - src.hyperparameter_tuning - INFO - Trial 38: 모델 타입 = lightgbm
2025-06-24 09:37:18,540 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,541 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,541 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,541 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,541 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,541 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,541 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,541 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,541 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,542 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,542 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,542 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,542 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,542 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,542 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,542 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,543 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,543 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,543 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,543 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,547 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,549 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,549 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,549 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,549 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,549 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,549 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,549 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,551 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,552 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,552 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,552 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,553 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,553 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,553 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,554 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,554 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,554 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,555 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,555 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,555 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,555 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,555 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,555 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,555 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,555 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,555 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,555 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,555 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,555 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,555 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,556 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,558 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,558 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,558 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,558 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,558 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   learning_rate: 0.032767807118294565
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   n_estimators: 150
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   subsample: 0.9178842372107386
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8277442294773829
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0037264473202334634
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO -   reg_lambda: 4.218833317145971e-08
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,559 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,562 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,562 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,562 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,562 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,562 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,562 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,563 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,569 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,569 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,569 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,569 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,569 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,569 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,569 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,570 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,570 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,570 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,571 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,571 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,571 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,571 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,571 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,571 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,571 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,571 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,571 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,571 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,571 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,571 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,571 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,571 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,571 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,574 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,574 - src.hyperparameter_tuning - ERROR - Trial 38 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,588 - src.hyperparameter_tuning - INFO - Trial 39: 모델 타입 = lightgbm
2025-06-24 09:37:18,592 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,593 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,593 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,593 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,593 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,593 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,593 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,593 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,593 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,593 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,593 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,593 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,593 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,593 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,593 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,593 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,593 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,593 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,594 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,594 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,594 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,594 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,594 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,595 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,595 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,595 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,595 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,595 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,599 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,601 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,601 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,601 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,601 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,601 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,601 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,601 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,603 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,605 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,605 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,605 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,605 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,605 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,605 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,605 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,605 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,605 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,605 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,606 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,606 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,606 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,606 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,606 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,606 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,606 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,606 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,606 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,606 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,607 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,607 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,607 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,607 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,607 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,607 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,607 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,607 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,607 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,607 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,607 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,607 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,607 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,608 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,610 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,610 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,610 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   learning_rate: 0.246113868759451
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   n_estimators: 376
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   subsample: 0.7569340813632006
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9165276790317524
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   reg_alpha: 3.2547826967952095e-07
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO -   reg_lambda: 9.914717715029425
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,611 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,614 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,614 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,614 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,614 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,614 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,615 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,615 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,616 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,616 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,622 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,622 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,622 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,622 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,622 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,622 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,622 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,622 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,623 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,623 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,623 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,624 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,624 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,624 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,624 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,624 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,624 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,624 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,624 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,624 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,624 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,624 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,624 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,624 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,624 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,624 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,627 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,627 - src.hyperparameter_tuning - ERROR - Trial 39 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,641 - src.hyperparameter_tuning - INFO - Trial 40: 모델 타입 = lightgbm
2025-06-24 09:37:18,644 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,645 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,645 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,645 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,645 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,645 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,645 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,645 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,645 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,645 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,645 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,645 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,645 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,645 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,645 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,645 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,646 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,646 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,646 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,646 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,647 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,647 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,647 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,647 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,647 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,647 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,650 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,652 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,652 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,652 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,653 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,653 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,653 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,654 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,656 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,656 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,656 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,656 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,656 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,657 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,657 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,658 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,658 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,658 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,659 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,659 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,659 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,659 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,659 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,659 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,659 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,659 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,659 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,659 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,659 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,659 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,659 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,659 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,659 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,660 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,661 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,662 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   learning_rate: 0.2986164631467998
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   n_estimators: 446
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   subsample: 0.8551720469993793
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6327085885569078
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   reg_alpha: 7.703681668328675e-06
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO -   reg_lambda: 6.634521545517012e-07
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,662 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,677 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,677 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,677 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,677 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,677 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,677 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,677 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,677 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,678 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,678 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,679 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,679 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,679 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,679 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,679 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,679 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,679 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,680 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,680 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,680 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,680 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,680 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,680 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,680 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,680 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,680 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,680 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,680 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,680 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,680 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,680 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,680 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,680 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,680 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,683 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,683 - src.hyperparameter_tuning - ERROR - Trial 40 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,698 - src.hyperparameter_tuning - INFO - Trial 41: 모델 타입 = lightgbm
2025-06-24 09:37:18,702 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,702 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,702 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,702 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,703 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,703 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,703 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,703 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,703 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,703 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,703 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,703 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,703 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,703 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,703 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,703 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,703 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,703 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,704 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,704 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,704 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,704 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,704 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,704 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,704 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,704 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,705 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,705 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,708 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,711 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,711 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,711 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,711 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,711 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,711 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,711 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,713 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,715 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,715 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,715 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,715 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,715 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,715 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,715 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,716 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,716 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,716 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,716 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,716 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,716 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,716 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,716 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,716 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,716 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,717 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,717 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,717 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,717 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,717 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,717 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,717 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,717 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,717 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,717 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,718 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,718 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,720 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   learning_rate: 0.09793882584456802
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,721 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   n_estimators: 123
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   subsample: 0.9640586492533287
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435146090531931
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   reg_alpha: 0.012306593994534086
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003273769666730943
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,722 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,725 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,725 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,725 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,725 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,725 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,725 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,732 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,732 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,732 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,732 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,732 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,732 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,732 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,732 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,733 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,733 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,734 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,734 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,734 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,734 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,734 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,734 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,734 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,734 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,734 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,734 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,734 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,734 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,734 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,734 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,734 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,734 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,737 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,737 - src.hyperparameter_tuning - ERROR - Trial 41 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,752 - src.hyperparameter_tuning - INFO - Trial 42: 모델 타입 = lightgbm
2025-06-24 09:37:18,755 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,756 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,756 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,756 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,756 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,756 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,756 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,756 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,756 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,757 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,757 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,757 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,757 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,757 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,757 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,757 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,757 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,757 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,758 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,758 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,758 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,758 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,762 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,765 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,765 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,765 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,765 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,765 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,765 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,765 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,767 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,768 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,769 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,769 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,769 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,769 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,770 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,770 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,770 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,771 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,771 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,771 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,771 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,771 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,771 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,771 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,771 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,771 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,771 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,771 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,771 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,771 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,771 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,774 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   learning_rate: 0.13733093633534701
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,774 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   n_estimators: 87
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   subsample: 0.8965101815345152
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6091730541587009
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   reg_alpha: 0.4907237459022601
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO -   reg_lambda: 6.576001803087445e-05
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,775 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,778 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,778 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,778 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,778 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,778 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,778 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,778 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,779 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,780 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,785 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,785 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,785 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,785 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,785 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,785 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,785 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,785 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,785 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,786 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,786 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,786 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,786 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,787 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,787 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,787 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,787 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,787 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,787 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,787 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,787 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,787 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,787 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,787 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,787 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,787 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,787 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,787 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,790 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,790 - src.hyperparameter_tuning - ERROR - Trial 42 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,804 - src.hyperparameter_tuning - INFO - Trial 43: 모델 타입 = lightgbm
2025-06-24 09:37:18,808 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,809 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,809 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,809 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,809 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,809 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,809 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,809 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,809 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,809 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,809 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,809 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,809 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,809 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,809 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,809 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,809 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,809 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,810 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,810 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,810 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,811 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,811 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,811 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,811 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,811 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,811 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,811 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,814 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,816 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,817 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,817 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,817 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,817 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,817 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,817 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,819 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,820 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,820 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,821 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,821 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,821 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,821 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,822 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,822 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,822 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,823 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,823 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,823 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,823 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,823 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,823 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,823 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,823 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,823 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,823 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,823 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,823 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,823 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,824 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,825 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,826 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,826 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,826 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   learning_rate: 0.21326734344408033
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,826 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   n_estimators: 539
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   subsample: 0.9673242456454179
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7044942853722713
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   reg_alpha: 0.059174749853088904
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02588182777279751
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,827 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,830 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,830 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,830 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,830 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,830 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,830 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,830 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,831 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,832 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,833 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,834 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,834 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,834 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,834 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,834 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,834 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,834 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,835 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,835 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,835 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,835 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,835 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,835 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,835 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,835 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,835 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,835 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,835 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,835 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,835 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,835 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,835 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,835 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,835 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,838 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,838 - src.hyperparameter_tuning - ERROR - Trial 43 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,853 - src.hyperparameter_tuning - INFO - Trial 44: 모델 타입 = lightgbm
2025-06-24 09:37:18,856 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,857 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,857 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,857 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,857 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,857 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,857 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,857 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,857 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,858 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,858 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,858 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,858 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,858 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,858 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,858 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,858 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,858 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,859 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,859 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,859 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,859 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,863 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,865 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,866 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,866 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,866 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,866 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,866 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,866 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,868 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,869 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,870 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,870 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,870 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,870 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,871 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,871 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,871 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,872 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,872 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,872 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,872 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,872 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,872 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,872 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,872 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,872 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,872 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,872 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,872 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,872 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,873 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,873 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,874 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,875 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,876 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,876 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,876 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,876 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,876 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,876 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   learning_rate: 0.05625048885017797
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   n_estimators: 651
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   subsample: 0.9936644823981703
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6776465721915215
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00018101280841052082
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO -   reg_lambda: 2.2021620859017483
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,877 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,880 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,880 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,880 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,880 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,880 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,880 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,890 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,890 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,890 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,890 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,890 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,890 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,890 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,890 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,891 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,891 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,891 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,891 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,892 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,892 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,892 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,892 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,892 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,892 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,892 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,892 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,892 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,892 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,892 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,892 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,892 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,892 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,892 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,894 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,894 - src.hyperparameter_tuning - ERROR - Trial 44 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,909 - src.hyperparameter_tuning - INFO - Trial 45: 모델 타입 = lightgbm
2025-06-24 09:37:18,913 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,914 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,914 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,914 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,914 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,914 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,914 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,914 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,914 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,915 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,915 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,915 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,915 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,915 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,915 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,915 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,915 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,915 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,916 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,916 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,916 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,916 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,920 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,922 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,922 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,922 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,922 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,922 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,922 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,922 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,924 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,926 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,926 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,927 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,927 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,927 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,927 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,928 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,928 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,928 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,929 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,929 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,929 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,929 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,929 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,929 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,929 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,929 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,929 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,929 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,929 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,929 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,929 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,929 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,930 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,931 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,932 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,932 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   learning_rate: 0.08474924091905767
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,932 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   n_estimators: 179
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   subsample: 0.9332399755244474
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6557272282328251
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0012292771784949972
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0023872846722201887
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,933 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,935 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,935 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,935 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,936 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,936 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,936 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,936 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,937 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,937 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,937 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,939 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,939 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,939 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,939 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,939 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,939 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,939 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,939 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,939 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,939 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,939 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,939 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,940 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,940 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,940 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,940 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,941 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,941 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,941 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,941 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,941 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,941 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,941 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,941 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,941 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,941 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,941 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,941 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,941 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,941 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,943 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,943 - src.hyperparameter_tuning - ERROR - Trial 45 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:18,958 - src.hyperparameter_tuning - INFO - Trial 46: 모델 타입 = lightgbm
2025-06-24 09:37:18,962 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:18,962 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:18,962 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:18,962 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:18,962 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:18,962 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:18,962 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:18,962 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:18,962 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:18,963 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:18,963 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:18,963 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:18,963 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:18,963 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:18,963 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:18,963 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:18,963 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:18,963 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:18,964 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:18,964 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:18,964 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:18,964 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:18,968 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:18,970 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,970 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:18,970 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:18,970 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:18,970 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:18,970 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:18,970 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:18,972 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:18,974 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:18,974 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,974 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,974 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:18,974 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:18,974 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,974 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:18,974 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:18,974 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,974 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,975 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:18,975 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:18,975 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,975 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,975 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:18,975 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:18,975 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,975 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,975 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:18,975 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:18,976 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:18,976 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:18,976 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:18,976 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:18,976 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:18,976 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:18,976 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:18,976 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:18,976 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,976 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:18,976 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:18,976 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:18,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:18,976 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:18,979 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,979 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:18,979 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,979 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:18,979 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   learning_rate: 0.012214781803232549
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   n_estimators: 319
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   subsample: 0.9011353546076427
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8923112812273108
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   reg_alpha: 1.819220639207179e-07
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO -   reg_lambda: 1.5563198677214068e-05
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:18,980 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:18,983 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:18,983 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:18,983 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:18,983 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:18,983 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:18,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:18,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:18,983 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,984 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:18,986 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:18,986 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:18,986 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:18,986 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:18,986 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,986 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:18,986 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:18,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:18,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:18,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:18,986 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:18,987 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,987 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,987 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,987 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:18,987 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:18,987 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:18,988 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:18,988 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:18,988 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:18,988 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:18,988 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:18,988 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:18,988 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:18,988 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:18,988 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:18,988 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:18,988 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:18,988 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:18,988 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:18,988 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:18,988 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,988 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,988 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:18,988 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:18,990 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:18,990 - src.hyperparameter_tuning - ERROR - Trial 46 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,005 - src.hyperparameter_tuning - INFO - Trial 47: 모델 타입 = lightgbm
2025-06-24 09:37:19,008 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,009 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,009 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,009 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,009 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,009 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,009 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,009 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,009 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,010 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,010 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,010 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,010 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,010 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,010 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,010 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,010 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,010 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,011 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,011 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,011 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,011 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,015 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,017 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,017 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,017 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,017 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,017 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,017 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,017 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,019 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,021 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,021 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,021 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,021 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,021 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,022 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,022 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,022 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,023 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,023 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,023 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,023 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,023 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,023 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,023 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,023 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,023 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,023 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,023 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,023 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,023 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,024 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,025 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,026 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,026 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,026 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,026 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   learning_rate: 0.03507645979363265
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   n_estimators: 761
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   subsample: 0.9824694942087706
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7417033228523667
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   reg_alpha: 0.004366446105347352
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO -   reg_lambda: 2.675638978946855e-07
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,027 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,030 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,030 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,030 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,030 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,030 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,031 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,032 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,032 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,033 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,033 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,033 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,033 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,033 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,033 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,033 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,033 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,034 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,034 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,034 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,034 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,035 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,035 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,035 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,035 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,035 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,035 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,035 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,035 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,035 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,035 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,035 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,035 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,035 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,035 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,037 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,037 - src.hyperparameter_tuning - ERROR - Trial 47 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,051 - src.hyperparameter_tuning - INFO - Trial 48: 모델 타입 = lightgbm
2025-06-24 09:37:19,055 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,056 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,056 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,056 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,056 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,056 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,056 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,056 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,056 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,056 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,056 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,056 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,056 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,056 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,056 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,056 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,056 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,056 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,057 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,057 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,057 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,057 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,061 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,063 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,063 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,063 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,063 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,063 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,063 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,063 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,065 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,066 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,066 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,067 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,067 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,067 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,067 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,068 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,068 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,068 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,069 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,069 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,069 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,069 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,069 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,069 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,069 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,069 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,069 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,069 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,069 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,069 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,069 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,069 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,069 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,070 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,071 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,072 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   learning_rate: 0.06459184368410763
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   n_estimators: 384
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   subsample: 0.8774992037260307
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.702163125786101
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   reg_alpha: 2.160303535766916e-08
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO -   reg_lambda: 1.1500879799835756e-06
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,072 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,075 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,075 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,075 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,075 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,075 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,075 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,076 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,077 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,077 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,077 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,079 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,079 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,079 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,079 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,079 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,079 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,079 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,079 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,080 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,080 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,080 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,080 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,080 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,081 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,081 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,081 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,081 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,081 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,081 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,081 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,081 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,081 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,081 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,081 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,081 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,081 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,083 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,083 - src.hyperparameter_tuning - ERROR - Trial 48 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,097 - src.hyperparameter_tuning - INFO - Trial 49: 모델 타입 = lightgbm
2025-06-24 09:37:19,101 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,102 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,102 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,102 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,102 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,102 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,102 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,102 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,102 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,103 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,103 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,103 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,103 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,103 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,103 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,103 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,103 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,103 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,104 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,104 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,104 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,104 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,108 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,110 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,110 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,110 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,110 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,110 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,110 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,110 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,112 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,114 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,114 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,114 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,114 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,114 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,114 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,114 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,114 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,114 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,114 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,115 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,115 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,115 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,115 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,115 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,115 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,115 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,116 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,116 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,116 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,116 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,116 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,116 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,117 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,117 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,117 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,117 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,117 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,117 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,117 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,117 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,117 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,117 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,118 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,119 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,119 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,119 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,119 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   learning_rate: 0.10017283165371263
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   n_estimators: 73
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   subsample: 0.8373072645672719
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8564848185348581
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   reg_alpha: 6.266565809920671
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO -   reg_lambda: 0.2714317924622672
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,120 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,123 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,123 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,123 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,123 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,123 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,123 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,123 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,123 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,124 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,124 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,124 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,124 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,126 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,127 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,127 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,127 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,127 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,127 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,127 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,127 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,127 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,127 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,128 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,128 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,128 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,128 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,128 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,128 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,128 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,128 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,128 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,128 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,128 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,128 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,128 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,128 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,128 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,128 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,131 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,131 - src.hyperparameter_tuning - ERROR - Trial 49 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,145 - src.hyperparameter_tuning - INFO - Trial 50: 모델 타입 = lightgbm
2025-06-24 09:37:19,148 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,149 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,149 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,149 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,149 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,149 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,149 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,149 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,149 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,150 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,150 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,150 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,150 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,150 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,150 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,150 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,150 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,150 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,151 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,151 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,151 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,151 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,154 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,156 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,156 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,156 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,156 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,156 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,156 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,157 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,158 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,160 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,160 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,160 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,160 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,160 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,160 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,160 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,161 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,161 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,161 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,161 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,161 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,161 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,161 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,161 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,162 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,162 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,162 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,162 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,162 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,162 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,162 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,162 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,162 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,162 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,162 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,162 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,162 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,162 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,163 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,165 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,165 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,165 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   learning_rate: 0.19354396033060667
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   n_estimators: 461
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   subsample: 0.8193951276727495
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7785557445809279
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00027869312762492945
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00013688798527848386
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,166 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,169 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,169 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,169 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,169 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,169 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,171 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,173 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,173 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,173 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,173 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,173 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,173 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,173 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,173 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,173 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,174 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,174 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,174 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,174 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,174 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,174 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,174 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,174 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,174 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,174 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,174 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,174 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,174 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,174 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,174 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,175 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,175 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,177 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,177 - src.hyperparameter_tuning - ERROR - Trial 50 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,192 - src.hyperparameter_tuning - INFO - Trial 51: 모델 타입 = lightgbm
2025-06-24 09:37:19,196 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,197 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,197 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,197 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,197 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,197 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,197 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,197 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,197 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,197 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,197 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,197 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,197 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,197 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,197 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,197 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,197 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,197 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,198 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,198 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,198 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,202 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,204 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,204 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,204 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,204 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,204 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,204 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,204 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,206 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,207 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,207 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,208 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,208 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,208 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,208 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,209 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,209 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,209 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,210 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,210 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,210 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,210 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,210 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,210 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,210 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,210 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,210 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,210 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,210 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,210 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,210 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,210 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,210 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,212 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   learning_rate: 0.0142443614712617
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   n_estimators: 129
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   subsample: 0.9746128038451177
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.718946577832295
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   reg_alpha: 4.407538220944994e-06
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO -   reg_lambda: 0.13079007377001461
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,213 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,216 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,216 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,216 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,216 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,216 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,216 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,216 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,216 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,217 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,218 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,218 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,218 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,218 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,218 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,218 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,218 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,218 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,218 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,218 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,218 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,218 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,218 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,219 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,219 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,219 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,219 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,219 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,219 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,219 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,219 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,219 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,219 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,219 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,219 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,219 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,219 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,219 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,219 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,219 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,222 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,222 - src.hyperparameter_tuning - ERROR - Trial 51 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,237 - src.hyperparameter_tuning - INFO - Trial 52: 모델 타입 = lightgbm
2025-06-24 09:37:19,240 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,241 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,241 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,241 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,241 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,241 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,241 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,241 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,241 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,242 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,242 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,242 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,242 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,242 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,242 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,242 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,242 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,242 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,243 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,243 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,243 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,243 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,247 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,249 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,249 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,249 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,249 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,249 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,249 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,249 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,251 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,253 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,253 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,253 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,253 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,253 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,253 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,253 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,253 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,254 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,254 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,254 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,254 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,254 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,254 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,254 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,254 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,254 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,255 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,255 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,255 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,255 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,255 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,255 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,255 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,255 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,255 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,255 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,255 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,255 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,255 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,256 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,257 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,258 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,258 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,258 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,258 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,258 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,258 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,258 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   learning_rate: 0.018456661428192748
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   n_estimators: 181
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   subsample: 0.9509603298852387
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911039091967015
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   reg_alpha: 7.612892550570312e-07
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO -   reg_lambda: 4.173453381060882e-06
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,259 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,262 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,262 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,262 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,262 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,262 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,262 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,263 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,264 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,264 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,269 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,269 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,269 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,269 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,269 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,269 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,269 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,269 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,270 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,270 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,270 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,271 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,271 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,271 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,271 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,271 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,271 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,271 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,271 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,271 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,271 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,271 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,271 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,272 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,272 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,272 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,272 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,274 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,274 - src.hyperparameter_tuning - ERROR - Trial 52 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,290 - src.hyperparameter_tuning - INFO - Trial 53: 모델 타입 = lightgbm
2025-06-24 09:37:19,294 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,295 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,295 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,295 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,295 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,295 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,295 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,295 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,295 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,296 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,296 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,296 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,296 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,296 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,296 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,296 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,296 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,296 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,297 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,297 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,297 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,297 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,301 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,303 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,303 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,303 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,303 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,303 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,303 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,303 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,305 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,307 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,307 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,307 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,307 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,307 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,307 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,307 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,307 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,307 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,307 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,308 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,308 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,308 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,308 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,308 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,308 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,308 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,308 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,308 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,308 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,309 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,309 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,309 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,309 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,309 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,309 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,309 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,309 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,309 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,309 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,309 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,309 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,309 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,310 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,311 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,312 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,312 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,312 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,312 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,312 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   learning_rate: 0.023387567111245493
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   n_estimators: 253
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   subsample: 0.9226975130375475
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6611933706717418
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5680490521396752e-08
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO -   reg_lambda: 0.008010451217063149
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,313 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,316 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,316 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,316 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,316 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,316 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,316 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,316 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,317 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,323 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,323 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,323 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,323 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,323 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,323 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,323 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,323 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,323 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,324 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,324 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,324 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,324 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,325 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,325 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,325 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,325 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,325 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,325 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,325 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,325 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,325 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,325 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,325 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,325 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,325 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,325 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,325 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,328 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,328 - src.hyperparameter_tuning - ERROR - Trial 53 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,343 - src.hyperparameter_tuning - INFO - Trial 54: 모델 타입 = lightgbm
2025-06-24 09:37:19,347 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,348 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,348 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,348 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,348 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,348 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,348 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,348 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,348 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,349 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,349 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,349 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,349 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,349 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,349 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,349 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,349 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,349 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,350 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,350 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,350 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,350 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,354 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,356 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,356 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,356 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,356 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,356 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,356 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,356 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,358 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,360 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,360 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,360 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,360 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,360 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,360 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,360 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,361 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,361 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,361 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,361 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,361 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,361 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,361 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,361 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,361 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,361 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,362 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,362 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,362 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,362 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,362 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,362 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,362 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,362 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,362 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,362 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,362 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,362 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,362 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,363 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,364 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,365 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,365 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,366 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,366 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,366 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO -   learning_rate: 0.017930539769372034
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,366 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   n_estimators: 292
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   subsample: 0.7831255552496368
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7589517267440986
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   reg_alpha: 3.771141225353274e-05
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO -   reg_lambda: 0.000530203372836347
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,367 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,370 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,370 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,370 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,370 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,370 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,370 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,370 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,371 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,374 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,374 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,374 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,374 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,374 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,374 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,374 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,374 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,374 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,374 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,374 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,374 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,375 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,375 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,375 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,375 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,375 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,375 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,375 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,375 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,375 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,375 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,375 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,375 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,375 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,375 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,376 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,376 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,376 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,376 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,376 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,376 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,376 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,376 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,376 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,376 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,378 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,378 - src.hyperparameter_tuning - ERROR - Trial 54 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,393 - src.hyperparameter_tuning - INFO - Trial 55: 모델 타입 = lightgbm
2025-06-24 09:37:19,396 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,397 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,397 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,397 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,397 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,397 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,397 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,397 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,397 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,398 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,398 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,398 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,398 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,398 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,398 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,398 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,398 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,398 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,399 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,399 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,399 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,399 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,403 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,405 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,405 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,405 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,405 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,405 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,405 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,405 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,407 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,409 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,409 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,409 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,409 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,409 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,409 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,409 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,409 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,410 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,410 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,410 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,411 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,411 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,411 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,411 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,411 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,411 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,411 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,411 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,411 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,411 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,411 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,411 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,411 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,411 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,411 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,411 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,412 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,413 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,414 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,414 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,414 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,414 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   learning_rate: 0.011437207024077016
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,414 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   n_estimators: 51
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   subsample: 0.9988910626470648
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7955253543847626
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   reg_alpha: 3.9245291180279974e-07
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO -   reg_lambda: 0.001413477088598793
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,415 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,418 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,418 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,418 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,418 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,418 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,418 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,418 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,418 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,419 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,419 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,419 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,419 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,425 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,425 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,425 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,425 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,425 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,425 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,425 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,425 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,425 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,426 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,426 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,426 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,426 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,426 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,426 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,427 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,427 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,427 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,427 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,427 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,427 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,427 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,427 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,427 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,427 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,427 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,427 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,427 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,427 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,427 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,430 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,430 - src.hyperparameter_tuning - ERROR - Trial 55 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,445 - src.hyperparameter_tuning - INFO - Trial 56: 모델 타입 = lightgbm
2025-06-24 09:37:19,449 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,449 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,449 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,449 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,449 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,449 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,449 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,450 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,450 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,450 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,450 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,450 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,450 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,450 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,450 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,450 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,450 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,450 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,451 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,451 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,451 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,451 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,455 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,457 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,457 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,457 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,457 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,457 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,457 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,457 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,459 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,461 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,461 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,461 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,462 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,462 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,462 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,463 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,463 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,463 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,464 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,464 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,464 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,464 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,464 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,464 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,464 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,464 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,464 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,464 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,464 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,464 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,464 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,464 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,464 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,465 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,466 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,467 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,467 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   learning_rate: 0.153186769078403
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,467 - src.models.lightgbm_model - INFO -   n_estimators: 620
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO -   subsample: 0.7475015634023295
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9150280338924608
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO -   reg_alpha: 1.1809416753112032e-07
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3713683152159453e-05
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,468 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,471 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,471 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,471 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,471 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,471 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,471 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,472 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,472 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,472 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,474 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,474 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,474 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,474 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,474 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,474 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,475 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,475 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,475 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,475 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,475 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,475 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,475 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,475 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,476 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,476 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,476 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,476 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,476 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,476 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,476 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,476 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,476 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,476 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,476 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,476 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,476 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,476 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,476 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,476 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,479 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,479 - src.hyperparameter_tuning - ERROR - Trial 56 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,494 - src.hyperparameter_tuning - INFO - Trial 57: 모델 타입 = lightgbm
2025-06-24 09:37:19,497 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,498 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,498 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,498 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,498 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,498 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,498 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,498 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,498 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,499 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,499 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,499 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,499 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,499 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,499 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,499 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,499 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,499 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,500 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,500 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,500 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,500 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,503 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,505 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,505 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,505 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,505 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,505 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,505 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,505 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,507 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,509 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,509 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,509 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,509 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,509 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,509 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,509 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,509 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,509 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,510 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,510 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,511 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,511 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,511 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,511 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,511 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,512 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,512 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,512 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,512 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,512 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,512 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,512 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,512 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,512 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,512 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,512 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,514 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,514 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,514 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,514 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   learning_rate: 0.04252092888793017
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   n_estimators: 555
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   subsample: 0.9111812059161246
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6841855639649754
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   reg_alpha: 1.469469291873918e-06
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO -   reg_lambda: 1.362640689879042
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,515 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,520 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,520 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,520 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,520 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,520 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,520 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,521 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,521 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,521 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,522 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,522 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,522 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,522 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,522 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,522 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,523 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,523 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,523 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,523 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,523 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,523 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,523 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,524 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,524 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,524 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,524 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,524 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,524 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,524 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,524 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,524 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,524 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,524 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,524 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,524 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,524 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,524 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,524 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,527 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,527 - src.hyperparameter_tuning - ERROR - Trial 57 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,542 - src.hyperparameter_tuning - INFO - Trial 58: 모델 타입 = lightgbm
2025-06-24 09:37:19,545 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,546 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,546 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,546 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,546 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,546 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,546 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,546 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,546 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,547 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,547 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,547 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,547 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,547 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,547 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,547 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,547 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,547 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,548 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,548 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,548 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,551 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,553 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,553 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,553 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,553 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,553 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,553 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,553 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,555 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,557 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,557 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,557 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,557 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,557 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,557 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,557 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,557 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,557 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,557 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,558 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,558 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,558 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,558 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,558 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,558 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,558 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,558 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,558 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,558 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,559 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,559 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,559 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,559 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,559 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,559 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,559 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,559 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,559 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,559 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,559 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,559 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,559 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,560 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,561 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,562 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,562 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,562 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,562 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   learning_rate: 0.01121632525249422
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   n_estimators: 506
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   subsample: 0.7239428053703661
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7096617144525774
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   reg_alpha: 1.2539835065528851e-05
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO -   reg_lambda: 3.479924777807695e-08
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,563 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,566 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,566 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,566 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,566 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,566 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,566 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,567 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,568 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,568 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,572 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,572 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,572 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,572 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,572 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,572 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,572 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,572 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,573 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,573 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,573 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,573 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,573 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,573 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,573 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,574 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,574 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,574 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,574 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,574 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,574 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,574 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,574 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,574 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,574 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,574 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,574 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,574 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,574 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,574 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,577 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,577 - src.hyperparameter_tuning - ERROR - Trial 58 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,592 - src.hyperparameter_tuning - INFO - Trial 59: 모델 타입 = lightgbm
2025-06-24 09:37:19,596 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,596 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,596 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,596 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,596 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,597 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,597 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,597 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,597 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,597 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,597 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,597 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,597 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,597 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,597 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,597 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,597 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,598 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,598 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,598 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,598 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,602 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,604 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,604 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,604 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,604 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,604 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,604 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,604 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,606 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,608 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,608 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,608 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,608 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,608 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,608 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,608 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,609 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,609 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,609 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,609 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,609 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,609 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,609 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,610 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,610 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,610 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,610 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,610 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,610 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,610 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,610 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,610 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,610 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,611 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,611 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,611 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,611 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,611 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,614 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   learning_rate: 0.24384133830368773
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   n_estimators: 335
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   subsample: 0.8683523300707465
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8857996984773274
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   reg_alpha: 4.439663032964412e-08
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO -   reg_lambda: 0.02341800942228853
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,614 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,617 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,617 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,617 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,617 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,618 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,618 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,619 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,619 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,619 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,625 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,625 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,625 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,625 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,625 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,625 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,625 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,625 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,625 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,626 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,626 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,626 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,626 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,626 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,626 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,627 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,627 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,627 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,627 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,627 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,627 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,627 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,627 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,627 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,627 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,627 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,627 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,627 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,627 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,627 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,629 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,629 - src.hyperparameter_tuning - ERROR - Trial 59 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,645 - src.hyperparameter_tuning - INFO - Trial 60: 모델 타입 = lightgbm
2025-06-24 09:37:19,649 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,649 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,650 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,650 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,650 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,650 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,650 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,650 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,650 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,650 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,650 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,650 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,650 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,650 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,650 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,650 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,650 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,650 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,651 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,651 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,651 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,651 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,655 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,657 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,657 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,657 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,657 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,657 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,657 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,657 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,659 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,661 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,661 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,661 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,661 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,661 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,661 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,662 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,662 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,662 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,662 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,662 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,662 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,662 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,662 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,662 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,662 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,663 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,663 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,663 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,663 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,663 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,663 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,663 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,663 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,663 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,663 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,663 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,663 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   learning_rate: 0.013791386929805163
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   n_estimators: 693
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   subsample: 0.6055182468435556
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7421066057531389
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   reg_alpha: 0.028410855500270112
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00020704799608554415
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,667 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,670 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,670 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,670 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,670 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,670 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,670 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,671 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,677 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,677 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,677 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,677 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,677 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,677 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,677 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,677 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,677 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,678 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,678 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,678 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,679 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,679 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,679 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,679 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,679 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,679 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,679 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,679 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,679 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,679 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,679 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,679 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,679 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,679 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,679 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,681 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,682 - src.hyperparameter_tuning - ERROR - Trial 60 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,697 - src.hyperparameter_tuning - INFO - Trial 61: 모델 타입 = lightgbm
2025-06-24 09:37:19,701 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,701 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,702 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,702 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,702 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,702 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,702 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,702 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,702 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,702 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,702 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,702 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,702 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,702 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,702 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,702 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,702 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,702 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,703 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,703 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,703 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,703 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,707 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,709 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,709 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,709 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,709 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,709 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,709 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,709 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,711 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,713 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,713 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,713 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,713 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,713 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,714 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,714 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,715 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,715 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,715 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,716 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,716 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,716 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,716 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,716 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,716 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,716 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,716 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,716 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,716 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,716 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,716 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,716 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,716 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,716 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,717 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,718 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   learning_rate: 0.29607121667659375
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   n_estimators: 571
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   subsample: 0.9492180121271596
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9835831542773467
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   reg_alpha: 0.1889918707742379
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO -   reg_lambda: 0.6510572184077662
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,719 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,723 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,723 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,723 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,723 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,723 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,723 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,723 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,723 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,724 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,724 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,724 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,724 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,726 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,726 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,726 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,726 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,726 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,726 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,726 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,727 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,727 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,727 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,727 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,728 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,728 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,728 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,728 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,728 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,728 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,728 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,728 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,728 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,728 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,728 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,728 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,728 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,728 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,730 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,730 - src.hyperparameter_tuning - ERROR - Trial 61 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,746 - src.hyperparameter_tuning - INFO - Trial 62: 모델 타입 = lightgbm
2025-06-24 09:37:19,750 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,750 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,750 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,750 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,750 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,750 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,750 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,750 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,750 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,751 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,751 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,751 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,751 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,751 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,751 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,751 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,751 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,751 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,752 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,752 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,752 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,752 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,756 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,758 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,758 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,758 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,758 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,758 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,758 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,758 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,760 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,762 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,762 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,762 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,762 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,762 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,762 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,762 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,762 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,762 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,762 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,763 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,763 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,763 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,763 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,763 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,763 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,763 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,763 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,763 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,763 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,764 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,764 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,764 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,764 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,764 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,764 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,764 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,764 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,764 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,764 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,764 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,764 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,764 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,765 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,765 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,765 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,766 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,767 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   learning_rate: 0.27145131192063576
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   n_estimators: 441
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   subsample: 0.8388888202790384
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9679527386504253
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0032641441634054954
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO -   reg_lambda: 3.55409111214763e-05
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,768 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,772 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,772 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,772 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,772 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,772 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,772 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,772 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,772 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,773 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,773 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,773 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,774 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,774 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,774 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,774 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,774 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,774 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,774 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,774 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,774 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,775 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,775 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,775 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,775 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,775 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,775 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,775 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,775 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,775 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,775 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,775 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,775 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,775 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,776 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,776 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,776 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,776 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,778 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,778 - src.hyperparameter_tuning - ERROR - Trial 62 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,794 - src.hyperparameter_tuning - INFO - Trial 63: 모델 타입 = lightgbm
2025-06-24 09:37:19,798 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,799 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,799 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,799 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,799 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,799 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,799 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,799 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,799 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,799 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,799 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,799 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,799 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,799 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,799 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,799 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,799 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,799 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,800 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,800 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,800 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,800 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,800 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,800 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,800 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,801 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,801 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,801 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,804 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,806 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,806 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,806 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,806 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,806 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,806 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,806 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,808 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,811 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,811 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,811 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,811 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,811 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,812 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,812 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,812 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,812 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,812 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,813 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,813 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,813 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,813 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,813 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,813 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,813 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,813 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,813 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,813 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,813 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,813 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,813 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,814 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,814 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,814 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,815 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,816 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,816 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,816 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,816 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   learning_rate: 0.18507739953392208
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   n_estimators: 501
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   subsample: 0.9255363949136147
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9478516979033457
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0016453016635939743
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO -   reg_lambda: 3.889292533372911
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,817 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,820 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,820 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,820 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,820 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,820 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,821 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,821 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,822 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,822 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,822 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,822 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,822 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,822 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,822 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,822 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,822 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,822 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,822 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,823 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,823 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,823 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,823 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,823 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,823 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,824 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,824 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,824 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,824 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,824 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,824 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,824 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,824 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,824 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,824 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,824 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,824 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,824 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,824 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,824 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,826 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,827 - src.hyperparameter_tuning - ERROR - Trial 63 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,842 - src.hyperparameter_tuning - INFO - Trial 64: 모델 타입 = lightgbm
2025-06-24 09:37:19,846 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,847 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,847 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,847 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,847 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,847 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,847 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,847 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,847 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,847 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,848 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,848 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,848 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,848 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,848 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,848 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,848 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,848 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,849 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,849 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,849 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,849 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,852 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,854 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,854 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,854 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,854 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,854 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,854 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,854 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,856 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,858 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,858 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,858 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,858 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,858 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,858 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,858 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,859 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,859 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,859 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,859 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,859 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,859 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,859 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,860 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,860 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,860 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,860 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,860 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,860 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,860 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,860 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,860 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,860 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,860 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,861 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,861 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,861 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,861 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,861 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,862 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,863 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,863 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,863 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,863 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   learning_rate: 0.12954824612423743
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   n_estimators: 98
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   subsample: 0.8112141622588307
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9260449527056052
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   reg_alpha: 0.009995808450449633
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO -   reg_lambda: 0.10706547190904596
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,864 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,867 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,867 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,867 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,867 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,867 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,867 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,868 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,869 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,869 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,869 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,869 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,869 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,869 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,869 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,869 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,870 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,870 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,870 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,870 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,870 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,870 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,870 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,870 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,870 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,870 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,871 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,871 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,871 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,871 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,871 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,871 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,871 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,871 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,873 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,873 - src.hyperparameter_tuning - ERROR - Trial 64 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,888 - src.hyperparameter_tuning - INFO - Trial 65: 모델 타입 = lightgbm
2025-06-24 09:37:19,892 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,893 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,893 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,893 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,893 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,893 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,893 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,893 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,893 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,894 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,894 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,894 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,894 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,894 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,894 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,894 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,894 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,894 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,895 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,895 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,895 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,895 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,898 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,900 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,900 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,900 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,900 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,900 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,900 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,900 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,902 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,904 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,904 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,904 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,904 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,904 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,904 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,904 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,905 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,905 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,905 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,905 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,905 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,905 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,905 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,905 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,905 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,905 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,906 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,906 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,906 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,906 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,906 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,906 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,906 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,906 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,906 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,906 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,906 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,906 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,906 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,907 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,907 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,907 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,908 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,909 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,909 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,909 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,909 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   learning_rate: 0.015953931804349637
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   n_estimators: 415
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   subsample: 0.9789455694045592
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9991613164008715
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   reg_alpha: 6.456208343096671e-05
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1200870633038303e-07
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,910 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,913 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,913 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,913 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,913 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,913 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,913 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,913 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,914 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,915 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,916 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,916 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,916 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,916 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,916 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,916 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,916 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,916 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,916 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,917 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,917 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,917 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,917 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,917 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,917 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,917 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,917 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,917 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,917 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,917 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,917 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,917 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,917 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,917 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,917 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,917 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,920 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,920 - src.hyperparameter_tuning - ERROR - Trial 65 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,936 - src.hyperparameter_tuning - INFO - Trial 66: 모델 타입 = lightgbm
2025-06-24 09:37:19,939 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,940 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,940 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,940 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,940 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,940 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,940 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,940 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,940 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,941 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,941 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,941 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,941 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,941 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,941 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,941 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,941 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,941 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,942 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,942 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,942 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,942 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,945 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,947 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,947 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,947 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,947 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,947 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,947 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,947 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,949 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,951 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:19,951 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,951 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,951 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:19,952 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:19,952 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,952 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:19,952 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,953 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,953 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:19,953 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:19,954 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:19,954 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:19,954 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:19,954 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:19,954 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:19,954 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:19,954 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:19,954 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:19,954 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,954 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:19,954 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:19,954 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:19,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:19,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,954 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,954 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,954 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,955 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,956 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:19,957 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   learning_rate: 0.11087159867996219
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   n_estimators: 679
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   subsample: 0.9403050846328712
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9758227150453681
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   reg_alpha: 1.0131157393738157e-08
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO -   reg_lambda: 0.8523746549601214
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:19,957 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:19,958 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:19,960 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:19,960 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:19,960 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:19,960 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:19,960 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:19,960 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:19,960 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:19,961 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:19,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:19,962 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,962 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:19,962 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:19,962 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:19,962 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:19,962 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:19,962 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,962 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:19,962 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:19,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:19,962 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:19,963 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:19,963 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:19,963 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,963 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,963 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,963 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:19,964 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:19,964 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:19,964 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:19,964 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:19,964 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:19,964 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:19,964 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:19,964 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:19,964 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:19,964 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:19,964 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,964 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,964 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:19,964 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:19,966 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:19,966 - src.hyperparameter_tuning - ERROR - Trial 66 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:19,983 - src.hyperparameter_tuning - INFO - Trial 67: 모델 타입 = lightgbm
2025-06-24 09:37:19,987 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:19,988 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:19,988 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:19,988 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:19,988 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:19,988 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:19,988 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:19,988 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:19,988 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:19,989 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:19,989 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:19,989 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:19,989 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:19,989 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:19,989 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:19,989 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:19,989 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:19,989 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:19,990 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:19,990 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:19,990 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:19,990 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:19,994 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:19,996 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:19,996 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:19,996 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:19,996 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:19,996 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:19,996 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:19,996 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:19,999 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,001 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,001 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,001 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,001 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,001 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,001 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,001 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,001 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,001 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,001 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,002 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,002 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,002 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,002 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,002 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,002 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,002 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,002 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,002 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,003 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,003 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,003 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,003 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,003 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,003 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,003 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,003 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,003 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,003 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,003 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,003 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,003 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,003 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,004 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,005 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,006 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,006 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,006 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,006 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   learning_rate: 0.22703332024128894
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   n_estimators: 738
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   subsample: 0.682593228121369
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8224029138278149
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   reg_alpha: 6.007326216970683e-06
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO -   reg_lambda: 7.268356621597371e-08
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,007 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,010 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,011 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,011 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,011 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,011 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,011 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,012 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,012 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,012 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,014 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,015 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,015 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,015 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,015 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,015 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,015 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,015 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,015 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,015 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,016 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,016 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,016 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,016 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,016 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,016 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,016 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,016 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,016 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,016 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,016 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,016 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,016 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,016 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,016 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,016 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,019 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,019 - src.hyperparameter_tuning - ERROR - Trial 67 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,036 - src.hyperparameter_tuning - INFO - Trial 68: 모델 타입 = lightgbm
2025-06-24 09:37:20,039 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,040 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,040 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,040 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,040 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,040 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,040 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,040 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,040 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,041 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,041 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,041 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,041 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,041 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,041 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,041 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,041 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,041 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,042 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,042 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,042 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,042 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,046 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,048 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,048 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,048 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,048 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,048 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,048 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,048 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,050 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,052 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,052 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,052 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,052 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,052 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,052 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,052 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,053 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,053 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,053 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,053 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,053 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,053 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,053 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,054 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,054 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,054 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,054 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,054 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,054 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,054 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,055 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,055 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,055 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,055 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,055 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,055 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,055 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,055 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,055 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,056 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,057 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,057 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   learning_rate: 0.04990710888816552
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   n_estimators: 609
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   subsample: 0.848270830948627
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.850598430172833
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0004951275409578349
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47820930095863e-06
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,058 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,063 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,063 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,063 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,063 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,063 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,063 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,063 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,063 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,064 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,064 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,064 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,064 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,066 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,066 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,066 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,066 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,066 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,066 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,066 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,066 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,067 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,067 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,067 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,067 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,067 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,067 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,068 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,068 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,068 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,068 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,068 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,068 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,068 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,068 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,068 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,068 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,068 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,068 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,068 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,068 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,068 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,071 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,071 - src.hyperparameter_tuning - ERROR - Trial 68 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,087 - src.hyperparameter_tuning - INFO - Trial 69: 모델 타입 = lightgbm
2025-06-24 09:37:20,091 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,092 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,092 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,092 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,092 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,092 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,092 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,092 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,092 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,093 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,093 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,093 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,093 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,093 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,093 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,093 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,093 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,093 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,094 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,094 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,094 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,094 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,097 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,100 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,100 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,100 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,100 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,100 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,100 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,100 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,102 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,104 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,104 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,104 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,104 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,104 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,104 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,104 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,104 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,105 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,105 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,105 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,106 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,106 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,106 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,106 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,106 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,106 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,106 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,106 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,106 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,106 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,106 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,106 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,106 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,107 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,108 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,109 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,109 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,109 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,109 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO -   learning_rate: 0.15916881726677745
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,109 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   max_depth: 6
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   n_estimators: 998
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   subsample: 0.9530544650204105
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8647144776940237
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6010135879554323e-06
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0999472666734155e-05
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,110 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,113 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,113 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,113 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,113 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,113 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,113 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,113 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,113 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,114 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,114 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,114 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,114 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,120 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,120 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,120 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,120 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,120 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,120 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,120 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,120 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,121 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,121 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,121 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,121 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,122 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,122 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,122 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,122 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,122 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,122 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,122 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,122 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,122 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,122 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,122 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,122 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,122 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,122 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,122 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,125 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,125 - src.hyperparameter_tuning - ERROR - Trial 69 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,142 - src.hyperparameter_tuning - INFO - Trial 70: 모델 타입 = lightgbm
2025-06-24 09:37:20,146 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,147 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,147 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,147 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,147 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,147 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,147 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,147 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,147 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,147 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,147 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,147 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,147 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,148 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,148 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,148 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,148 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,148 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,149 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,149 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,149 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,149 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,153 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,155 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,155 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,155 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,155 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,155 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,155 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,155 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,157 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,159 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,159 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,159 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,159 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,159 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,159 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,159 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,159 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,159 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,159 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,160 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,160 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,160 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,160 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,160 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,160 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,160 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,161 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,161 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,161 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,161 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,161 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,161 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,161 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,162 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,162 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,162 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,162 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,162 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,162 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,162 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,162 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,162 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,163 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,164 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,165 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   learning_rate: 0.020914360188651566
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   n_estimators: 220
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   subsample: 0.7847861042114909
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6157716992226357
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   reg_alpha: 2.2119025375971438e-05
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO -   reg_lambda: 2.5581389759662644e-08
2025-06-24 09:37:20,165 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,166 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,166 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,168 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,168 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,168 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,168 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,168 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,168 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,168 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,169 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,170 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,170 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,172 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,172 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,172 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,172 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,172 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,172 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,172 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,172 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,172 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,173 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,173 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,173 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,173 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,173 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,173 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,173 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,173 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,173 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,173 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,173 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,173 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,173 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,174 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,174 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,174 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,174 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,176 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,176 - src.hyperparameter_tuning - ERROR - Trial 70 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,192 - src.hyperparameter_tuning - INFO - Trial 71: 모델 타입 = lightgbm
2025-06-24 09:37:20,196 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,197 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,197 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,197 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,197 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,197 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,197 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,197 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,197 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,198 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,198 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,198 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,198 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,198 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,198 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,198 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,198 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,198 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,199 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,199 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,199 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,199 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,203 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,205 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,205 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,205 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,205 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,205 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,205 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,205 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,207 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,209 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,209 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,209 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,209 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,209 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,209 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,209 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,210 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,210 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,210 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,210 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,210 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,210 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,210 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,210 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,210 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,210 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,211 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,211 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,211 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,211 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,211 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,211 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,211 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,211 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,211 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,211 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,211 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,211 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,211 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,212 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,213 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,214 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,214 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,214 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,214 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   learning_rate: 0.010957129865736666
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   subsample: 0.6564142001008275
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8397815212987682
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   reg_alpha: 3.0126779680525884
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO -   reg_lambda: 6.874100189958323e-05
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,215 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,218 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,218 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,218 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,218 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,218 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,218 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,218 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,218 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,219 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,220 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,225 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,225 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,225 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,225 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,225 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,225 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,225 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,225 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,226 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,226 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,226 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,226 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,227 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,227 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,227 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,227 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,227 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,227 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,227 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,227 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,227 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,227 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,227 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,227 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,227 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,227 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,227 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,230 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,230 - src.hyperparameter_tuning - ERROR - Trial 71 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,246 - src.hyperparameter_tuning - INFO - Trial 72: 모델 타입 = lightgbm
2025-06-24 09:37:20,250 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,251 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,251 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,251 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,251 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,251 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,251 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,251 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,251 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,252 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,252 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,252 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,252 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,252 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,252 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,252 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,252 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,252 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,253 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,253 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,253 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,253 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,256 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,258 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,258 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,258 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,258 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,258 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,258 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,258 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,260 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,262 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,262 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,263 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,263 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,263 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,263 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,263 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,263 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,264 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,264 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,264 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,265 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,265 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,265 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,265 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,265 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,265 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,265 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,265 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,265 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,265 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,265 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,265 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,265 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,266 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,267 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,268 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,268 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,268 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,268 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,268 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,268 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,268 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,268 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,268 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   learning_rate: 0.012872128435596708
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   n_estimators: 108
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   subsample: 0.701870451203659
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7329492683995666
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   min_child_weight: 5
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   reg_alpha: 0.2817736475166566
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO -   reg_lambda: 6.653037142606319e-07
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,269 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,279 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,279 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,279 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,279 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,279 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,279 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,280 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,280 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,280 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,281 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,281 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,281 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,284 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,285 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,285 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,285 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,285 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,285 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,285 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,285 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,285 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,286 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,286 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,286 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,286 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,286 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,286 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,286 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,286 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,286 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,286 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,286 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,286 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,286 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,287 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,287 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,287 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,287 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,287 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,287 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,287 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,287 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,287 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,287 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,289 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,289 - src.hyperparameter_tuning - ERROR - Trial 72 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,307 - src.hyperparameter_tuning - INFO - Trial 73: 모델 타입 = lightgbm
2025-06-24 09:37:20,311 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,312 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,312 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,312 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,312 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,312 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,312 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,312 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,312 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,313 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,313 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,313 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,313 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,313 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,313 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,313 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,313 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,313 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,314 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,314 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,314 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,314 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,318 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,320 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,330 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,330 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,330 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,330 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,330 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,330 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,332 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,334 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,334 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,334 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,334 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,334 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,334 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,334 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,335 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,335 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,335 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,335 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,335 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,335 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,335 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,336 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,336 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,336 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,336 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,336 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,336 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,336 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,336 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,337 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,337 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,337 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,337 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,337 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,337 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,337 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,337 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,338 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,339 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,340 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   learning_rate: 0.014541973687489567
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   max_depth: 3
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   n_estimators: 188
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   subsample: 0.759421050732034
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7654101279240798
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   reg_alpha: 0.01722905276111146
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO -   reg_lambda: 1.263937240496527e-06
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,340 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,343 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,343 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,343 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,343 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,343 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,344 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,345 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,351 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,351 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,351 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,351 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,351 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,351 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,351 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,351 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,352 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,352 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,352 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,352 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,352 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,353 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,353 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,353 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,353 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,353 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,353 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,353 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,353 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,353 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,353 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,353 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,353 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,353 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,353 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,353 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,355 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,356 - src.hyperparameter_tuning - ERROR - Trial 73 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,372 - src.hyperparameter_tuning - INFO - Trial 74: 모델 타입 = lightgbm
2025-06-24 09:37:20,376 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,376 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,376 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,376 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,376 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,376 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,376 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,376 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,376 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,377 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,377 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,377 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,377 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,377 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,377 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,377 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,377 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,377 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,378 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,378 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,378 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,378 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,382 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,384 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,384 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,384 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,384 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,384 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,384 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,384 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,386 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,388 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,388 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,388 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,388 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,388 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,388 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,388 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,389 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,389 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,389 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,389 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,389 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,389 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,389 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,389 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,389 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,389 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,390 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,390 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,390 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,390 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,390 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,390 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,390 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,390 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,390 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,390 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,390 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,390 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,390 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,391 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,392 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,393 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,393 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,393 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,393 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,393 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   learning_rate: 0.010049681564965829
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   n_estimators: 472
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   subsample: 0.7277245828295967
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7166438037926771
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   reg_alpha: 0.006492067438794327
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO -   reg_lambda: 3.47045623771009e-05
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,394 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,397 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,397 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,397 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,397 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,397 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,397 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,398 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,404 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,404 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,404 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,404 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,404 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,404 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,404 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,404 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,405 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,405 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,405 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,405 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,406 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,406 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,406 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,406 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,406 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,406 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,406 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,406 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,406 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,406 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,406 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,406 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,406 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,406 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,406 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,408 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,408 - src.hyperparameter_tuning - ERROR - Trial 74 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,425 - src.hyperparameter_tuning - INFO - Trial 75: 모델 타입 = lightgbm
2025-06-24 09:37:20,429 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,429 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,429 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,430 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,430 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,430 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,430 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,430 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,430 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,430 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,430 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,430 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,430 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,430 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,430 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,430 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,430 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,430 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,431 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,431 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,431 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,431 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,435 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,437 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,437 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,437 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,437 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,437 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,437 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,437 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,439 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,441 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,441 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,441 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,441 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,441 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,441 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,441 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,442 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,442 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,442 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,442 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,442 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,442 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,442 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,442 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,443 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,443 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,443 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,443 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,443 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,443 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,443 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,443 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,443 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,443 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,443 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,443 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,443 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,444 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,444 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,445 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,446 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,446 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,446 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   learning_rate: 0.028490465891437326
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   n_estimators: 365
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   subsample: 0.6254706923605511
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7925475288364967
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   reg_alpha: 0.05495560517360351
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO -   reg_lambda: 3.551282729015529
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,447 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,450 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,450 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,450 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,450 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,450 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,450 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,451 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,457 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,457 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,457 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,457 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,457 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,457 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,457 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,457 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,457 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,458 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,458 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,458 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,458 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,459 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,459 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,459 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,459 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,459 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,459 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,459 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,459 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,459 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,459 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,459 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,459 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,459 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,459 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,459 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,461 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,461 - src.hyperparameter_tuning - ERROR - Trial 75 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,478 - src.hyperparameter_tuning - INFO - Trial 76: 모델 타입 = lightgbm
2025-06-24 09:37:20,482 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,483 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,483 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,483 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,483 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,483 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,483 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,483 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,483 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,483 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,483 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,483 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,483 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,483 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,483 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,484 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,484 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,484 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,484 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,485 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,485 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,485 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,485 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,485 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,485 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,485 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,485 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,488 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,490 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,490 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,490 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,490 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,490 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,490 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,490 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,492 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,494 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,494 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,494 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,494 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,494 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,494 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,495 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,495 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,495 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,496 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,496 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,496 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,497 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,497 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,497 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,497 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,497 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,498 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,498 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,498 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,498 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,498 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,498 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,498 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,498 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,498 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,499 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,500 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,501 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   learning_rate: 0.012115236479030286
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,502 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   n_estimators: 153
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   subsample: 0.9118267599058681
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6687523762556236
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6345515759655802
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO -   reg_lambda: 7.166551603900752e-06
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,503 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,505 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,505 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,505 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,505 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,505 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,505 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,506 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,506 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,506 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,507 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,507 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,507 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,513 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,513 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,513 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,513 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,513 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,513 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,513 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,513 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,514 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,514 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,514 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,515 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,515 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,515 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,515 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,515 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,515 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,515 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,515 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,515 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,515 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,515 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,515 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,515 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,515 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,515 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,518 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,518 - src.hyperparameter_tuning - ERROR - Trial 76 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,535 - src.hyperparameter_tuning - INFO - Trial 77: 모델 타입 = lightgbm
2025-06-24 09:37:20,539 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,540 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,540 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,540 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,540 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,540 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,540 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,540 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,540 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,541 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,541 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,541 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,541 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,541 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,541 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,541 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,541 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,541 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,542 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,542 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,542 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,542 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,546 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,548 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,548 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,548 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,548 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,548 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,548 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,551 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,553 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,553 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,553 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,553 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,554 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,554 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,554 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,555 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,555 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,555 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,555 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,555 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,555 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,555 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,555 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,555 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,555 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,555 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,555 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,556 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,557 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   learning_rate: 0.063637820225863
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   n_estimators: 881
2025-06-24 09:37:20,559 - src.models.lightgbm_model - INFO -   subsample: 0.9660419365576216
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9529111978290701
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO -   reg_alpha: 5.114020852306642e-07
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0003097731129743343
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,560 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,562 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,562 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,562 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,562 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,562 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,564 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,569 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,569 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,569 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,569 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,569 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,569 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,569 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,570 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,570 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,570 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,571 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,571 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,571 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,571 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,571 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,571 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,571 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,571 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,571 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,571 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,571 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,571 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,571 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,571 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,571 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,573 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,573 - src.hyperparameter_tuning - ERROR - Trial 77 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,590 - src.hyperparameter_tuning - INFO - Trial 78: 모델 타입 = lightgbm
2025-06-24 09:37:20,594 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,595 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,595 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,595 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,595 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,595 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,595 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,595 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,595 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,595 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,595 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,595 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,595 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,595 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,595 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,595 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,595 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,595 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,596 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,596 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,596 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,596 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,596 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,597 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,597 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,597 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,597 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,600 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,602 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,602 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,602 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,602 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,602 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,602 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,602 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,604 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,606 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,606 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,606 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,606 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,606 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,607 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,607 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,608 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,608 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,608 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,609 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,609 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,609 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,609 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,609 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,609 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,609 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,609 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,609 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,609 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,609 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,609 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,609 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,609 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,609 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,612 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,612 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,612 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,612 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,612 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,612 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,612 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   learning_rate: 0.016976948057482684
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   n_estimators: 393
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   subsample: 0.7883441898007725
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9375725893666309
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   min_child_weight: 4
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   reg_alpha: 1.6432227257309933e-07
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO -   reg_lambda: 0.0009728369901229373
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,613 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,615 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,615 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,615 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,615 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,615 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,615 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,616 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,616 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,617 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,623 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,623 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,623 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,623 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,623 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,623 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,623 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,624 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,624 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,624 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,625 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,625 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,625 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,625 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,625 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,625 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,625 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,625 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,625 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,625 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,625 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,625 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,625 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,625 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,625 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,627 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,627 - src.hyperparameter_tuning - ERROR - Trial 78 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,644 - src.hyperparameter_tuning - INFO - Trial 79: 모델 타입 = lightgbm
2025-06-24 09:37:20,648 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,649 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,649 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,649 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,649 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,649 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,649 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,649 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,649 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,650 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,650 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,650 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,650 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,650 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,650 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,650 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,650 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,650 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,651 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,651 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,651 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,651 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,654 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,656 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,656 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,656 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,656 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,656 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,656 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,656 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,658 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,660 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,661 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,661 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,661 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,662 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,662 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,662 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,663 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,663 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,663 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,663 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,663 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,663 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,663 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,663 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,663 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,663 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,663 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,663 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,663 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,666 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   learning_rate: 0.2593451809950288
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   max_depth: 5
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   n_estimators: 524
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   subsample: 0.9892833490980313
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8114549676244355
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0024320305460977846
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO -   reg_lambda: 0.00011587610553415014
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,667 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,668 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,670 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,670 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,670 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,670 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,671 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,678 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,678 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,678 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,678 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,678 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,678 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,678 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,679 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,679 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,679 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,679 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,680 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,680 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,680 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,680 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,680 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,680 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,680 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,680 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,680 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,680 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,680 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,680 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,680 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,680 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,682 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,682 - src.hyperparameter_tuning - ERROR - Trial 79 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,699 - src.hyperparameter_tuning - INFO - Trial 80: 모델 타입 = lightgbm
2025-06-24 09:37:20,703 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,704 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,704 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,704 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,704 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,704 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,704 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,704 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,704 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,705 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,705 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,705 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,705 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,705 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,705 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,705 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,705 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,705 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,706 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,706 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,706 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,706 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,709 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,711 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,711 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,711 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,711 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,712 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,712 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,712 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,714 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,716 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,716 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,716 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,716 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,716 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,716 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,716 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,716 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,717 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,717 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,717 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,718 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,718 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,718 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,718 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,718 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,718 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,718 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,718 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,718 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,718 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,718 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,718 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,718 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,718 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,719 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,721 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,721 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,721 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,721 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,721 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,721 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,721 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   learning_rate: 0.07813911661457104
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   n_estimators: 302
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   subsample: 0.8875096072240903
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6433794276239841
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0011379545210007589
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO -   reg_lambda: 4.306976213595928e-07
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,722 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,724 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,724 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,724 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,724 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,725 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,725 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,726 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,726 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,726 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,726 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,726 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,726 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,726 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,726 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,726 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,727 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,727 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,727 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,727 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,728 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,728 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,728 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,728 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,728 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,728 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,728 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,728 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,728 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,728 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,728 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,728 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,728 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,728 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,728 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,730 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,730 - src.hyperparameter_tuning - ERROR - Trial 80 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,748 - src.hyperparameter_tuning - INFO - Trial 81: 모델 타입 = lightgbm
2025-06-24 09:37:20,752 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,752 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,752 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,752 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,752 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,752 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,752 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,752 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,752 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,753 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,753 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,753 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,753 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,753 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,753 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,753 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,753 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,753 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,754 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,754 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,754 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,754 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,757 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,760 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,760 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,760 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,760 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,760 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,760 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,760 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,762 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,764 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,764 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,764 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,764 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,764 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,764 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,764 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,764 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,765 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,765 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,765 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,766 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,766 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,766 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,766 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,766 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,766 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,766 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,766 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,766 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,766 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,766 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,766 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,766 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,767 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,768 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,769 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,769 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,769 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,769 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,769 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,769 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,769 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   learning_rate: 0.013390824935990937
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   n_estimators: 225
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   subsample: 0.8655718258437664
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6268140816663329
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   reg_alpha: 0.13849867415852568
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1834271927039548e-06
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,770 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,773 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,773 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,773 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,773 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,773 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,773 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,774 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,775 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,780 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,780 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,780 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,780 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,780 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,780 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,780 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,780 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,781 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,781 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,781 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,781 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,782 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,782 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,782 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,782 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,782 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,782 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,782 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,782 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,782 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,782 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,782 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,782 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,782 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,782 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,782 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,784 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,784 - src.hyperparameter_tuning - ERROR - Trial 81 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,801 - src.hyperparameter_tuning - INFO - Trial 82: 모델 타입 = lightgbm
2025-06-24 09:37:20,805 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,806 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,806 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,806 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,806 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,806 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,806 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,806 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,806 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,806 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,806 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,806 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,806 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,807 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,807 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,807 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,807 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,807 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,808 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,808 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,808 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,808 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,811 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,813 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,813 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,813 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,813 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,813 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,813 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,813 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,815 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,817 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,817 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,818 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,818 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,818 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,818 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,818 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,819 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,819 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,819 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,820 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,820 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,820 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,820 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,820 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,820 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,820 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,820 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,820 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,820 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,820 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,820 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,820 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,820 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,821 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,822 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,823 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,823 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,823 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,823 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,823 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,823 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,823 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   learning_rate: 0.015254010311290964
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   n_estimators: 270
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   subsample: 0.9338363605752303
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6435775161794274
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   reg_alpha: 0.10966313007085868
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO -   reg_lambda: 1.8570005277345276e-07
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,824 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,827 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,827 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,827 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,827 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,827 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,827 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,828 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,829 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,829 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,833 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,833 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,833 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,833 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,833 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,833 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,833 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,833 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,834 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,834 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,834 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,834 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,835 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,835 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,835 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,835 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,835 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,835 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,835 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,835 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,835 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,835 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,835 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,835 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,835 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,835 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,835 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,837 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,837 - src.hyperparameter_tuning - ERROR - Trial 82 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,855 - src.hyperparameter_tuning - INFO - Trial 83: 모델 타입 = lightgbm
2025-06-24 09:37:20,858 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,859 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,859 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,859 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,859 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,859 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,859 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,859 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,859 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,860 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,860 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,860 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,860 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,860 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,860 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,860 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,860 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,860 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,861 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,861 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,861 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,861 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,864 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,866 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,866 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,866 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,867 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,867 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,867 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,867 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,869 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,871 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,871 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,871 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,871 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,871 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,871 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,871 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,871 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,871 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,871 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,871 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,871 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,872 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,872 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,872 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,872 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,872 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,872 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,872 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,872 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,873 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,873 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,873 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,873 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,873 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,873 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,873 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,873 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,873 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,873 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,873 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,873 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,873 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,874 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,874 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,875 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,876 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,876 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,876 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,876 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   learning_rate: 0.019506751038527934
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:20,877 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   n_estimators: 72
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   subsample: 0.9016055807922
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6786527742452434
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   reg_alpha: 0.5179817334010663
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO -   reg_lambda: 2.585526747106335e-05
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,878 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,880 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,880 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,880 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,880 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,880 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,880 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,881 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,882 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,882 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,885 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,885 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,885 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,885 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,885 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,885 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,885 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,885 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,886 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,886 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,886 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,886 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,886 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,887 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,887 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,887 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,887 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,887 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,887 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,887 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,887 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,887 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,887 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,887 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,887 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,887 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,887 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,887 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,889 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,889 - src.hyperparameter_tuning - ERROR - Trial 83 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,906 - src.hyperparameter_tuning - INFO - Trial 84: 모델 타입 = lightgbm
2025-06-24 09:37:20,910 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,910 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,910 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,910 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,910 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,911 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,911 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,911 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,911 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,911 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,911 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,911 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,911 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,911 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,911 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,911 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,911 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,911 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,912 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,912 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,912 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,912 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,916 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,918 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,918 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,918 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,918 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,918 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,918 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,918 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,920 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,922 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,922 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,922 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,922 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,922 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,922 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,922 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,922 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,922 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,922 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,923 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,923 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,923 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,923 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,923 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,923 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,923 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,924 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,924 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,924 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,924 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,924 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,924 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,924 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,925 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,925 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,925 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,925 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,925 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,925 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,925 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,925 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,925 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,925 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,925 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,926 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,927 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,928 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   learning_rate: 0.011761518315917473
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,928 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   max_depth: 8
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   n_estimators: 336
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   subsample: 0.8814774332424677
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6589836190226069
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   min_child_weight: 9
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   reg_alpha: 0.03740462540171629
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO -   reg_lambda: 9.421800508700533e-07
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,929 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,931 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,931 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,931 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,931 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,931 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,931 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,932 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,933 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,933 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,933 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,935 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,935 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,935 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,935 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,935 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,935 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,935 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,935 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,936 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,936 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,936 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,937 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,937 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,937 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,937 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,937 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,937 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,937 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,937 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,937 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,937 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,937 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,937 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,937 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,937 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,937 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,937 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,940 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,940 - src.hyperparameter_tuning - ERROR - Trial 84 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:20,957 - src.hyperparameter_tuning - INFO - Trial 85: 모델 타입 = lightgbm
2025-06-24 09:37:20,960 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:20,961 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:20,961 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:20,961 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:20,961 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:20,961 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:20,961 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:20,961 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:20,961 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:20,962 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:20,962 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:20,962 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:20,962 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:20,962 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:20,962 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:20,962 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:20,962 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:20,962 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:20,963 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:20,963 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:20,963 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:20,963 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:20,966 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:20,968 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,968 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:20,968 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:20,969 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:20,969 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:20,969 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:20,969 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:20,971 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:20,973 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:20,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:20,973 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:20,973 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:20,973 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,974 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,974 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:20,974 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:20,974 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,974 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,974 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:20,974 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:20,975 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:20,975 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:20,975 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:20,975 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:20,975 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:20,975 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:20,975 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:20,975 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:20,975 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,975 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:20,975 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:20,975 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:20,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:20,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,975 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,976 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,976 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,977 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:20,978 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,978 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:20,978 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,978 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   learning_rate: 0.023369091605691176
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   n_estimators: 416
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   subsample: 0.9285006889587568
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6911826263958073
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   reg_alpha: 0.005586000009250545
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO -   reg_lambda: 1.0365316887043513e-07
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:20,979 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:20,982 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:20,982 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:20,982 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:20,982 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:20,982 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:20,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:20,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,982 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:20,982 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:20,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:20,982 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:20,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:20,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:20,983 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:20,983 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:20,983 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,983 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:20,989 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:20,989 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:20,989 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:20,989 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:20,989 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,989 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,989 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:20,989 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:20,989 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:20,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:20,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:20,990 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:20,990 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,990 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,990 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,991 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:20,991 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:20,991 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:20,991 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:20,991 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:20,991 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:20,991 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:20,991 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:20,991 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:20,991 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:20,991 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:20,991 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,991 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,991 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:20,991 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:20,994 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:20,994 - src.hyperparameter_tuning - ERROR - Trial 85 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,011 - src.hyperparameter_tuning - INFO - Trial 86: 모델 타입 = lightgbm
2025-06-24 09:37:21,015 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,016 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,016 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,016 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,016 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,016 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,016 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,016 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,016 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,016 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,016 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,016 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,017 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,017 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,017 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,017 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,017 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,017 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,018 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,018 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,018 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,018 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,021 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,023 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,023 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,023 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,023 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,023 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,023 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,023 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,025 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,027 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,027 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,027 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,027 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,028 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,028 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,028 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,028 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,029 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,029 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,029 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,030 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,030 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,030 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,030 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,030 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,030 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,030 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,030 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,030 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,030 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,030 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,030 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,030 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,030 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,030 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,031 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,032 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,033 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,033 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,033 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   learning_rate: 0.0167210164277769
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,033 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   n_estimators: 126
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   subsample: 0.8121859411209759
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.600980416597681
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   reg_alpha: 0.015484276919204112
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO -   reg_lambda: 3.60403122472424e-07
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,034 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,036 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,036 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,036 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,036 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,036 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,036 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,037 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,037 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,037 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,038 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,038 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,038 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,038 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,038 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,038 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,038 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,038 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,038 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,038 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,038 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,038 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,039 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,039 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,039 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,039 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,039 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,039 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,039 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,040 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,040 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,040 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,040 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,040 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,040 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,040 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,040 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,040 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,040 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,040 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,040 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,040 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,040 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,040 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,043 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,043 - src.hyperparameter_tuning - ERROR - Trial 86 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,060 - src.hyperparameter_tuning - INFO - Trial 87: 모델 타입 = lightgbm
2025-06-24 09:37:21,064 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,065 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,065 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,065 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,065 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,065 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,065 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,065 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,065 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,065 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,065 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,066 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,066 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,066 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,066 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,066 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,066 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,066 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,067 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,067 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,067 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,067 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,070 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,072 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,072 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,072 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,072 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,072 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,072 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,072 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,074 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,076 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,076 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,077 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,077 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,077 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,077 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,077 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,077 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,078 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,078 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,078 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,079 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,079 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,079 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,079 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,079 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,079 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,079 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,079 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,079 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,079 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,079 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,079 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,079 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,079 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,080 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,081 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,082 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,082 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,082 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,082 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,082 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,082 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,082 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,082 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   learning_rate: 0.08737941929340731
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   max_depth: 7
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   n_estimators: 485
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   subsample: 0.7725397087037676
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9032259116266748
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   reg_alpha: 3.4172998319315425e-06
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO -   reg_lambda: 8.925646395185016e-06
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,083 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,086 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,086 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,086 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,086 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,086 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,086 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,086 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,086 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,087 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,087 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,088 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,093 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,093 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,093 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,093 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,093 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,093 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,093 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,093 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,094 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,094 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,094 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,094 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,095 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,095 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,095 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,095 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,095 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,095 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,095 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,095 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,095 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,095 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,095 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,095 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,095 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,095 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,095 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,097 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,098 - src.hyperparameter_tuning - ERROR - Trial 87 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,115 - src.hyperparameter_tuning - INFO - Trial 88: 모델 타입 = lightgbm
2025-06-24 09:37:21,118 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,119 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,119 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,119 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,119 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,119 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,119 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,119 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,119 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,120 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,120 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,120 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,120 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,120 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,120 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,120 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,120 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,120 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,121 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,121 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,121 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,121 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,124 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,126 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,126 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,127 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,127 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,127 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,127 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,127 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,129 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,131 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,131 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,131 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,131 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,131 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,131 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,131 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,132 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,132 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,132 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,132 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,132 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,132 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,132 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,132 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,132 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,132 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,133 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,133 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,133 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,133 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,133 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,133 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,133 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,133 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,133 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,133 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,133 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,133 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,133 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,134 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,134 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,134 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,135 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,136 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,137 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   learning_rate: 0.20084862043853582
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,137 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   n_estimators: 436
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   subsample: 0.6836681494518045
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7513030717936812
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0001317813499998491
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO -   reg_lambda: 2.3433791053557896e-06
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,138 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,145 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,145 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,145 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,145 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,145 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,145 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,145 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,145 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,146 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,146 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,146 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,146 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,146 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,146 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,147 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,147 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,147 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,147 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,147 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,147 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,147 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,147 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,147 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,147 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,147 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,147 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,148 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,148 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,148 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,148 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,148 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,148 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,148 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,148 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,148 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,148 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,148 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,148 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,148 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,148 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,148 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,148 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,151 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,151 - src.hyperparameter_tuning - ERROR - Trial 88 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,169 - src.hyperparameter_tuning - INFO - Trial 89: 모델 타입 = lightgbm
2025-06-24 09:37:21,173 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,173 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,173 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,173 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,173 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,173 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,173 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,173 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,173 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,174 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,174 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,174 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,174 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,174 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,174 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,174 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,174 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,174 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,175 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,175 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,175 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,175 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,179 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,181 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,181 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,181 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,181 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,181 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,181 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,181 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,183 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,185 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,185 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,185 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,185 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,185 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,185 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,185 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,186 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,186 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,186 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,186 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,186 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,186 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,186 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,186 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,186 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,186 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,187 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,187 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,187 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,187 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,187 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,187 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,187 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,187 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,187 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,187 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,187 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,187 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,187 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,188 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,189 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,190 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,190 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,190 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,190 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   learning_rate: 0.010712348865860803
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   n_estimators: 569
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   subsample: 0.9715163381303065
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8835099955381397
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   min_child_weight: 6
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   reg_alpha: 3.181288168420014e-08
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO -   reg_lambda: 0.003706339122281663
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,191 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,194 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,194 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,194 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,194 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,194 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,194 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,195 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,201 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,201 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,201 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,201 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,201 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,201 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,201 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,201 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,202 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,202 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,202 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,202 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,202 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,202 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,203 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,203 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,203 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,203 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,203 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,203 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,203 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,203 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,203 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,203 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,203 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,203 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,203 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,203 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,203 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,205 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,205 - src.hyperparameter_tuning - ERROR - Trial 89 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,223 - src.hyperparameter_tuning - INFO - Trial 90: 모델 타입 = lightgbm
2025-06-24 09:37:21,226 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,227 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,227 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,227 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,227 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,227 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,227 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,227 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,227 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,228 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,228 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,228 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,228 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,228 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,228 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,228 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,228 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,228 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,229 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,229 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,229 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,229 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,232 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,234 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,235 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,235 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,235 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,235 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,235 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,235 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,237 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,239 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,239 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,239 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,239 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,240 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,240 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,240 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,240 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,240 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,240 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,240 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,241 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,241 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,241 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,241 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,241 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,241 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,241 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,241 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,241 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,241 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,241 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,241 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,241 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,242 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,243 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,244 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,244 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,244 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,244 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   learning_rate: 0.17292774562587593
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   n_estimators: 249
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   subsample: 0.9100639628414496
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.7319861545848053
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   min_child_weight: 7
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   reg_alpha: 6.841319298994953e-08
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO -   reg_lambda: 7.294516932532824e-08
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,245 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,248 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,248 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,248 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,248 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,248 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,248 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,249 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,250 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,251 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,251 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,251 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,251 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,251 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,251 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,251 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,251 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,251 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,251 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,251 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,251 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,251 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,252 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,252 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,252 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,252 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,252 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,252 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,252 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,252 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,252 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,252 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,253 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,253 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,253 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,253 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,253 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,253 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,253 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,255 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,255 - src.hyperparameter_tuning - ERROR - Trial 90 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,273 - src.hyperparameter_tuning - INFO - Trial 91: 모델 타입 = lightgbm
2025-06-24 09:37:21,276 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,277 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,277 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,277 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,277 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,277 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,277 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,277 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,277 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,278 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,278 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,278 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,278 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,278 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,278 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,278 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,278 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,278 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,280 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,280 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,280 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,280 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,283 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,286 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,286 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,286 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,286 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,286 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,286 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,286 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,288 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,290 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,290 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,290 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,290 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,290 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,290 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,290 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,290 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,290 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,290 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,291 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,291 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,291 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,291 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,291 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,291 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,291 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,292 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,292 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,292 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,293 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,293 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,293 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,293 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,293 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,293 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,293 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,293 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,293 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,293 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,293 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,293 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,293 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,294 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,294 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,295 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,296 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,296 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,296 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   learning_rate: 0.11013898979209548
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   n_estimators: 86
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   subsample: 0.9578849478844019
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9636601537167676
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   reg_alpha: 1.4565994044938084e-05
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO -   reg_lambda: 4.107640210812544e-06
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,297 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,300 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,300 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,300 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,300 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,300 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,300 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,301 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,302 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,304 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,304 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,304 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,304 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,304 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,304 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,304 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,304 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,305 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,305 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,305 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,305 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,305 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,306 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,306 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,306 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,306 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,306 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,306 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,306 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,306 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,306 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,306 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,306 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,306 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,306 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,306 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,308 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,308 - src.hyperparameter_tuning - ERROR - Trial 91 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,326 - src.hyperparameter_tuning - INFO - Trial 92: 모델 타입 = lightgbm
2025-06-24 09:37:21,330 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,330 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,330 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,331 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,331 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,331 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,331 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,331 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,331 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,331 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,331 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,331 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,331 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,331 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,331 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,331 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,331 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,331 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,332 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,332 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,332 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,332 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,336 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,338 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,338 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,338 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,338 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,338 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,338 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,338 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,340 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,342 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,342 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,342 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,342 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,342 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,342 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,342 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,343 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,343 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,343 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,343 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,343 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,343 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,343 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,343 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,344 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,344 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,344 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,344 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,344 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,344 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,344 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,344 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,344 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,344 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,344 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,345 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,345 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,345 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,345 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,346 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,347 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   learning_rate: 0.06512620613719415
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   n_estimators: 62
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   subsample: 0.9440049750817702
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9069793609426638
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   reg_alpha: 1.3433121325142226e-06
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO -   reg_lambda: 2.1808112052856218e-08
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,348 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,351 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,351 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,351 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,351 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,351 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,351 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,352 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,353 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,355 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,355 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,355 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,355 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,355 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,355 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,355 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,355 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,356 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,356 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,356 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,356 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,356 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,356 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,356 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,356 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,356 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,357 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,357 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,357 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,357 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,357 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,357 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,357 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,357 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,357 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,357 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,357 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,357 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,357 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,357 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,357 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,359 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,359 - src.hyperparameter_tuning - ERROR - Trial 92 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,377 - src.hyperparameter_tuning - INFO - Trial 93: 모델 타입 = lightgbm
2025-06-24 09:37:21,380 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,381 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,381 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,381 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,381 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,381 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,381 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,381 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,381 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,382 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,382 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,382 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,382 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,382 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,382 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,382 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,382 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,382 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,383 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,383 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,383 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,383 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,387 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,389 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,389 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,389 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,389 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,389 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,389 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,389 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,391 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,393 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,393 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,393 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,393 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,393 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,393 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,393 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,394 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,394 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,394 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,394 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,394 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,394 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,394 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,394 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,394 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,394 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,395 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,395 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,395 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,395 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,395 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,395 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,395 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,395 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,395 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,395 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,395 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,395 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,395 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,396 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,396 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,396 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,397 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,398 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,399 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   learning_rate: 0.144034078327933
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   n_estimators: 161
2025-06-24 09:37:21,399 - src.models.lightgbm_model - INFO -   subsample: 0.891280205171518
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9241422630860318
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO -   reg_alpha: 7.365332985642187e-05
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO -   reg_lambda: 5.580919445808581e-05
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,400 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,402 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,402 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,402 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,402 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,402 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,402 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,403 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,403 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,403 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,404 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,404 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,404 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,406 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,406 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,406 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,406 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,406 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,406 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,406 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,406 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,406 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,407 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,407 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,407 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,407 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,407 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,407 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,407 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,407 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,407 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,407 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,407 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,407 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,407 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,407 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,407 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,407 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,407 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,410 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,410 - src.hyperparameter_tuning - ERROR - Trial 93 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,428 - src.hyperparameter_tuning - INFO - Trial 94: 모델 타입 = lightgbm
2025-06-24 09:37:21,431 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,432 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,432 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,432 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,432 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,432 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,432 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,432 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,432 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,433 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,433 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,433 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,433 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,433 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,433 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,433 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,433 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,433 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,434 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,434 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,434 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,434 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,437 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,439 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,439 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,439 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,440 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,440 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,440 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,440 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,442 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,444 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,444 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,444 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,444 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,444 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,444 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,444 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,444 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,445 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,445 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,445 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,445 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,445 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,445 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,445 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,445 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,445 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,446 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,446 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,446 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,446 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,446 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,446 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,446 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,446 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,446 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,446 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,446 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,446 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,446 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,447 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,447 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,448 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,449 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,449 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,449 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,449 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,449 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   learning_rate: 0.03226966411568605
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   n_estimators: 111
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   subsample: 0.8275247108212429
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.6198230292372529
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   reg_alpha: 0.00034040068930289746
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO -   reg_lambda: 4.96586351698221e-07
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,450 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,453 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,453 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,453 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,453 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,453 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,453 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,454 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,455 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,460 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,460 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,460 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,460 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,460 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,460 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,460 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,460 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,461 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,461 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,461 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,461 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,462 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,462 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,462 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,462 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,462 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,462 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,462 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,462 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,462 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,462 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,462 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,462 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,462 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,462 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,462 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,464 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,464 - src.hyperparameter_tuning - ERROR - Trial 94 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,482 - src.hyperparameter_tuning - INFO - Trial 95: 모델 타입 = lightgbm
2025-06-24 09:37:21,486 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,487 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,487 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,487 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,487 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,487 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,487 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,487 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,487 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,487 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,487 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,487 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,487 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,487 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,487 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,487 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,487 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,487 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,488 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,488 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,488 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,488 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,492 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,494 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,494 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,494 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,494 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,494 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,494 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,494 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,496 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,498 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,498 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,498 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,498 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,498 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,498 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,498 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,499 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,499 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,499 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,499 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,499 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,499 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,499 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,500 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,500 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,500 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,500 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,501 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,501 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,501 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,501 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,501 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,501 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,501 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,501 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,501 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,501 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,501 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,501 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,501 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,501 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,502 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,503 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,504 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   learning_rate: 0.23289446247753645
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   max_depth: 10
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,504 - src.models.lightgbm_model - INFO -   n_estimators: 199
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO -   subsample: 0.9182339907634957
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8414284434329359
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO -   min_child_weight: 2
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO -   reg_alpha: 0.30891866315595923
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO -   reg_lambda: 7.06945184557314
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,505 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,512 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,512 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,512 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,513 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,513 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,513 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,514 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,514 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,514 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,514 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,514 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,514 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,514 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,514 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,514 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,514 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,514 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,514 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,515 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,515 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,515 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,515 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,516 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,516 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,516 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,516 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,516 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,516 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,516 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,516 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,516 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,516 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,516 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,516 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,516 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,516 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,516 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,518 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,519 - src.hyperparameter_tuning - ERROR - Trial 95 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,537 - src.hyperparameter_tuning - INFO - Trial 96: 모델 타입 = lightgbm
2025-06-24 09:37:21,540 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,541 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,541 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,541 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,541 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,541 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,541 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,541 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,541 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,542 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,542 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,542 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,542 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,542 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,542 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,542 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,542 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,542 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,543 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,543 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,543 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,543 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,546 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,548 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,548 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,548 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,549 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,549 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,549 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,549 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,551 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,553 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,553 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,553 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,553 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,553 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,553 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,553 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,553 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,554 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,554 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,554 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,554 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,554 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,554 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,554 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,554 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,554 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,555 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,555 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,555 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,555 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,555 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,555 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,555 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,555 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,555 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,555 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,555 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,555 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,555 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,556 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,557 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,558 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,558 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,558 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,558 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   learning_rate: 0.0128858323826597
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   max_depth: 12
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   n_estimators: 392
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   subsample: 0.9883471561917563
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.9800264200829185
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   min_child_weight: 8
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   reg_alpha: 0.0008163736186869123
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO -   reg_lambda: 7.146987388366111e-08
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,559 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,562 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,562 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,562 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,562 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,562 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,562 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,563 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,564 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,569 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,569 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,569 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,569 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,569 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,569 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,569 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,569 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,570 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,570 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,570 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,570 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,571 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,571 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,571 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,571 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,571 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,571 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,571 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,571 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,571 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,571 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,571 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,571 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,571 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,571 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,571 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,573 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,573 - src.hyperparameter_tuning - ERROR - Trial 96 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,591 - src.hyperparameter_tuning - INFO - Trial 97: 모델 타입 = lightgbm
2025-06-24 09:37:21,595 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,596 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,596 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,596 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,596 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,596 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,596 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,596 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,596 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,596 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,596 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,596 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,596 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,596 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,596 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,596 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,596 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,596 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,597 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,597 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,597 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,597 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,601 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,603 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,603 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,603 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,603 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,603 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,603 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,603 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,605 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,607 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,607 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,607 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,607 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,607 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,607 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,607 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,608 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,608 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,608 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,608 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,608 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,608 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,608 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,609 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,609 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,609 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,609 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,609 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,609 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,609 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,609 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,609 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,610 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,610 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,610 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,610 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,610 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,610 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,610 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,611 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,612 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,613 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   learning_rate: 0.04708035431951437
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   max_depth: 11
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   n_estimators: 545
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   subsample: 0.8481306135407106
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8777043418153438
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   min_child_weight: 1
2025-06-24 09:37:21,613 - src.models.lightgbm_model - INFO -   reg_alpha: 5.301017506056371e-06
2025-06-24 09:37:21,614 - src.models.lightgbm_model - INFO -   reg_lambda: 1.4157321646404635e-07
2025-06-24 09:37:21,614 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,614 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,614 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,616 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,616 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,616 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,616 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,616 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,616 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,617 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,618 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,623 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,623 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,623 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,623 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,623 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,623 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,623 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,623 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,624 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,624 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,624 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,624 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,625 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,625 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,625 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,625 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,625 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,625 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,625 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,625 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,625 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,625 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,625 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,625 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,625 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,625 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,625 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,627 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,627 - src.hyperparameter_tuning - ERROR - Trial 97 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,645 - src.hyperparameter_tuning - INFO - Trial 98: 모델 타입 = lightgbm
2025-06-24 09:37:21,649 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,649 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,649 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,650 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,650 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,650 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,650 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,650 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,650 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,650 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,650 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,650 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,650 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,650 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,650 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,650 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,650 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,650 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,651 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,651 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,651 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,651 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,651 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,652 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,652 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,652 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,655 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,657 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,657 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,657 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,657 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,657 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,657 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,657 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,659 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,661 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,661 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,661 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,661 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,662 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,662 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,662 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,663 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,663 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,663 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,664 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,664 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,664 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,664 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,664 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,664 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,664 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,664 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,664 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,664 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,664 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,664 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,664 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,664 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,664 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,665 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,666 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,666 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,666 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,667 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,667 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,667 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,667 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   learning_rate: 0.014754168878137339
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   max_depth: 9
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   n_estimators: 354
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   subsample: 0.7178025885121065
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8037627937927796
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   min_child_weight: 10
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   reg_alpha: 2.5408310634329025e-06
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO -   reg_lambda: 1.658568588495107e-05
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,668 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,670 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,671 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,671 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,671 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,671 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,671 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,672 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,672 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,672 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,678 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,678 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,678 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,678 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,678 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,678 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,678 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,678 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,679 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,679 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,679 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,679 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,680 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,680 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,680 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,680 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,680 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,680 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,680 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,680 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,680 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,680 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,680 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,680 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,680 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,680 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,680 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,682 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,682 - src.hyperparameter_tuning - ERROR - Trial 98 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,700 - src.hyperparameter_tuning - INFO - Trial 99: 모델 타입 = lightgbm
2025-06-24 09:37:21,704 - src.hyperparameter_tuning - INFO - 데이터 로드: 1000개 행 사용
2025-06-24 09:37:21,705 - src.splits - INFO - 데이터 분할 완료:
2025-06-24 09:37:21,705 - src.splits - INFO -   - 전체 데이터: 1,000 행
2025-06-24 09:37:21,705 - src.splits - INFO -   - 훈련/검증 데이터: 856 행
2025-06-24 09:37:21,705 - src.splits - INFO -   - 테스트 데이터: 144 행
2025-06-24 09:37:21,705 - src.splits - INFO -   - 테스트 ID 수: 19개
2025-06-24 09:37:21,705 - src.training - INFO - 교차 검증 시작
2025-06-24 09:37:21,705 - src.splits - INFO - 순수 그룹 기반 K-Fold 검증 전략 사용
2025-06-24 09:37:21,705 - src.splits - INFO - 그룹 K-Fold 분할: 107개 ID를 3개 폴드로 분할
2025-06-24 09:37:21,705 - src.splits - INFO - 그룹 K-Fold 폴드 1 생성 완료
2025-06-24 09:37:21,705 - src.splits - INFO -   - 훈련 데이터: 570 행 (71개 ID)
2025-06-24 09:37:21,706 - src.splits - INFO -   - 검증 데이터: 286 행 (36개 ID)
2025-06-24 09:37:21,706 - src.splits - INFO -   - 훈련 연도 범위: (2015, 2024)
2025-06-24 09:37:21,706 - src.splits - INFO -   - 검증 연도 범위: (2015, 2024)
2025-06-24 09:37:21,706 - src.training - INFO - === 폴드 1 학습 ===
2025-06-24 09:37:21,706 - src.preprocessing - INFO - 전처리 파이프라인 피팅 시작
2025-06-24 09:37:21,706 - src.preprocessing - INFO - 시계열 보간 적용: ['anxiety_score', 'depress_score', 'sleep_score', 'comp']
2025-06-24 09:37:21,706 - src.preprocessing - INFO - Fallback 전략: mean
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 수치형 컬럼: ['anxiety_score', 'depress_score', 'sleep_score', 'comp', 'age']
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 범주형 컬럼: ['sex']
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 통과시킬 컬럼: ['suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 전처리 파이프라인 생성 완료
2025-06-24 09:37:21,707 - src.preprocessing - INFO -   - 수치형 전략: mean
2025-06-24 09:37:21,707 - src.preprocessing - INFO -   - 범주형 전략: most_frequent
2025-06-24 09:37:21,707 - src.preprocessing - INFO -   - 범주형 인코딩: ordinal
2025-06-24 09:37:21,707 - src.preprocessing - INFO - 전처리 파이프라인 피팅 중...
2025-06-24 09:37:21,710 - src.preprocessing - INFO - 데이터 변환 중...
2025-06-24 09:37:21,712 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,712 - src.preprocessing - INFO - 전처리 파이프라인 피팅 완료
2025-06-24 09:37:21,712 - src.feature_engineering - INFO - 피처 엔지니어링 비활성화 - 기본 피처만 사용
2025-06-24 09:37:21,712 - src.feature_engineering - INFO - 피처 엔지니어링 완료: 33개 피처
2025-06-24 09:37:21,712 - src.feature_engineering - INFO -   - 원본 피처: 33개
2025-06-24 09:37:21,712 - src.feature_engineering - INFO -   - 새로 생성된 피처: 0개 (비활성화)
2025-06-24 09:37:21,712 - src.feature_engineering - INFO - [DEBUG] 피처 엔지니어링 직후 컬럼 목록: ['id', 'yov', 'dov', 'age', 'sex', 'comp', 'anxiety_score', 'depress_score', 'sleep_score', 'suicide_t', 'suicide_a', 'suicide_c', 'suicide_y', 'psychia_cate', 'check', 'age_group', 'anxiety_score_next_year', 'depress_score_next_year', 'sleep_score_next_year', 'suicide_t_next_year', 'suicide_a_next_year', 'month', 'day_of_week', 'day_of_year', 'anxiety_score_rolling_mean_2y', 'anxiety_score_rolling_std_2y', 'anxiety_score_yoy_change', 'depress_score_rolling_mean_2y', 'depress_score_rolling_std_2y', 'depress_score_yoy_change', 'sleep_score_rolling_mean_2y', 'sleep_score_rolling_std_2y', 'sleep_score_yoy_change']
2025-06-24 09:37:21,714 - src.preprocessing - INFO - 데이터 변환 완료: (570, 33)
2025-06-24 09:37:21,716 - src.preprocessing - INFO - 데이터 변환 완료: (286, 33)
2025-06-24 09:37:21,716 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,717 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,717 - src.feature_engineering - INFO - 피처 엔지니어링 적용 (기본 피처만 사용)
2025-06-24 09:37:21,717 - src.feature_engineering - INFO - 피처 엔지니어링 적용 완료: 33개 피처
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] train_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] val_engineered 컬럼: ['num__anxiety_score', 'num__depress_score', 'num__sleep_score', 'num__comp', 'num__age', 'cat__sex', 'pass__suicide_t', 'pass__suicide_a', 'pass__suicide_c', 'pass__suicide_y', 'pass__psychia_cate', 'pass__check', 'pass__age_group', 'pass__anxiety_score_next_year', 'pass__depress_score_next_year', 'pass__sleep_score_next_year', 'pass__suicide_t_next_year', 'pass__suicide_a_next_year', 'pass__month', 'pass__day_of_week', 'pass__day_of_year', 'pass__anxiety_score_rolling_mean_2y', 'pass__anxiety_score_rolling_std_2y', 'pass__anxiety_score_yoy_change', 'pass__depress_score_rolling_mean_2y', 'pass__depress_score_rolling_std_2y', 'pass__depress_score_yoy_change', 'pass__sleep_score_rolling_mean_2y', 'pass__sleep_score_rolling_std_2y', 'pass__sleep_score_yoy_change', 'id', 'yov', 'dov']
2025-06-24 09:37:21,717 - src.feature_engineering - INFO - selected_features 기반 피처 컬럼 선택(타겟 제외): 6개
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] feature_columns: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] target_columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] X_train shape: (570, 6), y_train shape: (570, 1)
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] X_val shape: (286, 6), y_val shape: (286, 1)
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,717 - src.preprocessing - INFO - 리샘플링이 비활성화되어 있습니다.
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] X_train_resampled shape: (570, 6), y_train_resampled shape: (570, 1)
2025-06-24 09:37:21,717 - src.training - INFO - [DEBUG] y_train_resampled 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,718 - src.training - INFO - 폴드 1 - 리샘플링 전 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,718 - src.training - INFO - 폴드 1 - 리샘플링 후 클래스 분포: {(0.0,): 499, (1.0,): 1}
2025-06-24 09:37:21,718 - src.training - INFO - 모델 학습 시작
2025-06-24 09:37:21,719 - src.training - INFO - 결측 타겟 제거: train 570->500, val 286->250
2025-06-24 09:37:21,719 - src.training - INFO - 모델 타입: lightgbm
2025-06-24 09:37:21,719 - src.models.model_factory - INFO - 모델 타입 'lightgbm'으로 모델을 생성합니다.
2025-06-24 09:37:21,719 - src.models.base_model - INFO - LIGHTGBM 모델 초기화 완료
2025-06-24 09:37:21,719 - src.models.base_model - INFO -   - 회귀 타겟: []
2025-06-24 09:37:21,719 - src.models.base_model - INFO -   - 분류 타겟: ['suicide_a_next_year']
2025-06-24 09:37:21,719 - src.models.lightgbm_model - INFO -   - Focal Loss 사용: False
2025-06-24 09:37:21,719 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작
2025-06-24 09:37:21,719 - src.models.lightgbm_model - INFO - 입력 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,719 - src.models.lightgbm_model - INFO - Early Stopping 활성화 (rounds: 10)
2025-06-24 09:37:21,719 - src.models.lightgbm_model - INFO - 검증 데이터 형태: X_val=(250, 6), y_val=(250, 1)
2025-06-24 09:37:21,719 - src.models.lightgbm_model - INFO - 입력 데이터 검증 및 전처리 중...
2025-06-24 09:37:21,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (500, 6)
2025-06-24 09:37:21,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,719 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,719 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (500, 6)
2025-06-24 09:37:21,720 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (500, 6), y shape: (500, 1)
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,721 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6), y shape: (250, 1)
2025-06-24 09:37:21,722 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 y 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,722 - src.models.lightgbm_model - INFO - 전처리 후 데이터 형태: X=(500, 6), y=(500, 1)
2025-06-24 09:37:21,722 - src.models.lightgbm_model - INFO - 사용 가능한 타겟 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,722 - src.models.lightgbm_model - INFO - === 타겟 pass__suicide_a_next_year 모델 학습 시작 ===
2025-06-24 09:37:21,722 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 데이터 정리 후: X=(500, 6), y=500
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO - 검증 데이터 정리 후: X_val=(250, 6), y_val=250
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO - === pass__suicide_a_next_year 모델 파라미터 ===
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   num_leaves: 31
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   learning_rate: 0.03847826310814636
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   feature_fraction: 0.9
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   bagging_fraction: 0.8
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   bagging_freq: 5
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   min_data_in_leaf: 20
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   min_sum_hessian_in_leaf: 1e-3
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   lambda_l1: 0.1
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   lambda_l2: 0.1
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   num_threads: 28
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   verbose: -1
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   early_stopping_rounds: 10
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   max_cat_threshold: 32
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   cat_smooth: 10.0
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   cat_l2: 10.0
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   is_unbalance: True
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   scale_pos_weight: 1.0
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   class_weight: balanced
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   boosting_type: gbdt
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   objective: regression
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   metric: rmse
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   max_depth: 4
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   min_gain_to_split: 0.0
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   min_child_samples: 20
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   bagging_seed: 42
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   feature_fraction_seed: 42
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   drop_seed: 42
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   data_random_seed: 42
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   n_estimators: 139
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   subsample: 0.9029634435810079
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   colsample_bytree: 0.8644492537002094
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   min_child_weight: 3
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   reg_alpha: 1.8669869859858968e-05
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO -   reg_lambda: 1.3473548198935023e-08
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO - LightGBM 데이터셋 생성 중...
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO - 검증 데이터셋 생성 완료
2025-06-24 09:37:21,723 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 시작 (타겟: pass__suicide_a_next_year)
2025-06-24 09:37:21,726 - src.models.lightgbm_model - INFO - 타겟 pass__suicide_a_next_year 모델 학습 완료
2025-06-24 09:37:21,726 - src.models.lightgbm_model - INFO -   - Best Score: defaultdict(<class 'collections.OrderedDict'>, {'valid': OrderedDict({'rmse': 0.002})})
2025-06-24 09:37:21,726 - src.models.lightgbm_model - INFO -   - Best Iteration: 1
2025-06-24 09:37:21,726 - src.models.lightgbm_model - INFO - LightGBM 모델 학습 완료
2025-06-24 09:37:21,726 - src.models.lightgbm_model - INFO - LightGBM 모델 예측 시작
2025-06-24 09:37:21,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X shape: (250, 6)
2025-06-24 09:37:21,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,726 - src.models.base_model - INFO - [DEBUG] _validate_input_data 입력 X dtypes: object    6
Name: count, dtype: int64
2025-06-24 09:37:21,726 - src.models.base_model - INFO - [DEBUG] 컬럼 cat__sex을 숫자로 변환 성공
2025-06-24 09:37:21,726 - src.models.base_model - INFO - [DEBUG] 컬럼 num__age을 숫자로 변환 성공
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__anxiety_score을 숫자로 변환 성공
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__comp을 숫자로 변환 성공
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__depress_score을 숫자로 변환 성공
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] 컬럼 num__sleep_score을 숫자로 변환 성공
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X shape: (250, 6)
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] select_dtypes 후 X 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,727 - src.models.base_model - INFO - [DEBUG] _validate_input_data 출력 X shape: (250, 6)
2025-06-24 09:37:21,733 - src.models.lightgbm_model - INFO -   - pass__suicide_a_next_year 예측 완료
2025-06-24 09:37:21,733 - src.models.lightgbm_model - INFO - 예측 완료: (250, 1)
2025-06-24 09:37:21,733 - src.training - INFO - === 예측 결과 평가 시작 ===
2025-06-24 09:37:21,733 - src.training - INFO - y_true shape: (250, 1), y_pred shape: (250, 1)
2025-06-24 09:37:21,733 - src.training - INFO - y_true columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,733 - src.training - INFO - y_pred columns: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' 평가 중...
2025-06-24 09:37:21,733 - src.training - INFO -   정확한 매칭: pass__suicide_a_next_year
2025-06-24 09:37:21,733 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 유효한 샘플 수: 250
2025-06-24 09:37:21,734 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - true_vals unique: [0.0]
2025-06-24 09:37:21,734 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - pred_vals unique: [0.002]
2025-06-24 09:37:21,734 - src.training - INFO - 타겟 'pass__suicide_a_next_year' - 분류 문제로 처리
2025-06-24 09:37:21,734 - src.evaluation - WARNING - Precision 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,734 - src.evaluation - WARNING - Recall 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,734 - src.evaluation - WARNING - F1-score 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,735 - src.evaluation - WARNING - Balanced accuracy 계산 중 예외 발생: Classification metrics can't handle a mix of unknown and continuous targets, 0.0 반환
2025-06-24 09:37:21,735 - src.training - INFO -   precision: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   recall: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   f1: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   accuracy: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   balanced_accuracy: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   positive_samples: 0
2025-06-24 09:37:21,735 - src.training - INFO -   negative_samples: 250
2025-06-24 09:37:21,735 - src.training - INFO -   total_samples: 250
2025-06-24 09:37:21,735 - src.training - INFO -   positive_ratio: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   roc_auc: 0.0
2025-06-24 09:37:21,735 - src.training - INFO -   pr_auc: 0.0
2025-06-24 09:37:21,735 - src.training - INFO - === 예측 결과 평가 완료 - 1개 타겟 ===
2025-06-24 09:37:21,735 - src.training - INFO - 피처 검증은 원본 데이터에서 수행되어야 하므로 건너뜁니다.
2025-06-24 09:37:21,735 - src.models.lightgbm_model - WARNING - 타겟 suicide_a_next_year에 대한 모델이 없습니다. 건너뜁니다.
2025-06-24 09:37:21,735 - src.training - INFO - 모델 학습 완료
2025-06-24 09:37:21,735 - src.training - INFO - 검증 성능: {'pass__suicide_a_next_year': {'precision': 0.0, 'recall': 0.0, 'f1': 0.0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'positive_samples': 0, 'negative_samples': 250, 'total_samples': 250, 'positive_ratio': 0.0, 'roc_auc': 0.0, 'pr_auc': 0.0}}
2025-06-24 09:37:21,735 - src.training - INFO - [DEBUG] train_model 진입 - X_train 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,735 - src.training - INFO - [DEBUG] train_model 진입 - y_train 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,735 - src.training - INFO - [DEBUG] train_model 진입 - X_val 컬럼: ['cat__sex', 'num__age', 'num__anxiety_score', 'num__comp', 'num__depress_score', 'num__sleep_score']
2025-06-24 09:37:21,735 - src.training - INFO - [DEBUG] train_model 진입 - y_val 컬럼: ['pass__suicide_a_next_year']
2025-06-24 09:37:21,737 - src.training - INFO - 폴드 1 학습 결과 MLflow 로깅 완료
2025-06-24 09:37:21,738 - src.hyperparameter_tuning - ERROR - Trial 99 실패: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''
2025-06-24 09:37:21,738 - src.hyperparameter_tuning - INFO - 튜닝 완료 - 최고 성능: -inf
2025-06-24 09:37:21,738 - src.hyperparameter_tuning - INFO - 튜닝 시간: 4.95초
2025-06-24 09:37:21,742 - __main__ - INFO - 튜닝 결과 저장 중...
2025-06-24 09:37:21,742 - __main__ - ERROR - 결과 저장 실패: 'NoneType' object has no attribute 'copy'
2025-06-24 09:37:21,742 - __main__ - INFO - 최고 성능: -inf
2025-06-24 09:37:21,742 - __main__ - INFO - 최적 파라미터:
2025-06-24 09:37:21,743 - __main__ - INFO -   n_estimators: 406
2025-06-24 09:37:21,743 - __main__ - INFO -   max_depth: 12
2025-06-24 09:37:21,743 - __main__ - INFO -   learning_rate: 0.1205712628744377
2025-06-24 09:37:21,743 - __main__ - INFO -   subsample: 0.8394633936788146
2025-06-24 09:37:21,743 - __main__ - INFO -   colsample_bytree: 0.6624074561769746
2025-06-24 09:37:21,743 - __main__ - INFO -   min_child_weight: 2
2025-06-24 09:37:21,743 - __main__ - INFO -   reg_alpha: 3.3323645788192616e-08
2025-06-24 09:37:21,743 - __main__ - INFO -   reg_lambda: 0.6245760287469893

==================================================
튜닝 결과 요약
==================================================
모델 타입: lightgbm
실험 타입: hyperparameter_tuning
사용 데이터 행 수: 1,000
MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/6eb618e900404e7a8311273a915b44a5
최고 성능: -inf
최적 파라미터: {'n_estimators': 406, 'max_depth': 12, 'learning_rate': 0.1205712628744377, 'subsample': 0.8394633936788146, 'colsample_bytree': 0.6624074561769746, 'min_child_weight': 2, 'reg_alpha': 3.3323645788192616e-08, 'reg_lambda': 0.6245760287469893}
튜닝 시간: 4.954355716705322
==================================================
2025-06-24 09:37:21,744 - __main__ - INFO - 실험 결과가 /home/junhyung/Documents/simcare/kbsmc_suicide/results/experiment_results_20250624_093721.txt에 저장되었습니다.
2025-06-24 09:37:21,744 - __main__ - INFO - MLflow Experiment ID: 765186397364671153
2025-06-24 09:37:21,744 - __main__ - INFO - MLflow Run ID: 6eb618e900404e7a8311273a915b44a5
2025-06-24 09:37:21,744 - __main__ - INFO - MLflow 링크: http://localhost:5000/#/experiments/765186397364671153/runs/6eb618e900404e7a8311273a915b44a5
2025-06-24 09:37:21,744 - __main__ - ERROR - 하이퍼파라미터 튜닝 실패: 'tuple' object has no attribute 'get'
